
SQL*Plus: Release 11.2.0.1.0 Production on Tue Nov 9 18:35:17 2010

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

18:35:18 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.01
18:35:18 SQL> 18:35:18 SQL> --
18:35:18 SQL> -- sbw_wom.sql
18:35:18 SQL> --
18:35:18 SQL> 
18:35:18 SQL> SET LINES 66
18:35:18 SQL> DESC hourly
 Name				  Null?    Type
 -------------------------------- -------- -----------------------
 PAIR					   VARCHAR2(15)
 YDATE					   DATE
 VOL					   NUMBER
 OPN					   NUMBER
 CLSE					   NUMBER
 MN					   NUMBER
 MX					   NUMBER

18:35:18 SQL> SET LINES 166
18:35:18 SQL> 
18:35:18 SQL> -- For each pair, look at wom WHERE ydate > '2009-01-01'
18:35:18 SQL> SELECT pair,week_of_month,AVG(nhgain),SUM(nhgain),COUNT(nhgain)
18:35:18   2  FROM
18:35:18   3  (
18:35:18   4  	SELECT
18:35:18   5  	pair
18:35:18   6  	,ydate
18:35:18   7  	,opn
18:35:18   8  	,clse
18:35:18   9  	-- Hourly gain:
18:35:18  10  	,(clse-opn)	 hgain
18:35:18  11  	-- Normalized hourly gain:
18:35:18  12  	,(clse-opn)/opn nhgain
18:35:18  13  	,0+TO_CHAR(ydate,'W')week_of_month
18:35:18  14  	FROM hourly WHERE opn>0
18:35:18  15  )
18:35:18  16  WHERE ydate > '2009-01-01'
18:35:18  17  GROUP BY pair,week_of_month
18:35:18  18  ORDER BY ABS(AVG(nhgain))DESC
18:35:18  19  /

PAIR		WEEK_OF_MONTH AVG(NHGAIN) SUM(NHGAIN) COUNT(NHGAIN)
--------------- ------------- ----------- ----------- -------------
gbp_usd 		    5  .000095108  .085216558		896
usd_chf 		    5  -.00007708  -.06906327		896
usd_jpy 		    2	-.0000612  -.16390381	       2678
aud_usd 		    1	.00006102  .169574576	       2779
usd_cad 		    2  -.00005876  -.15736826	       2678
usd_cad 		    1  -.00005431  -.15091846	       2779
aud_usd 		    2  .000052838  .141499942	       2678
usd_chf 		    2	-.0000418  -.11193839	       2678
eur_usd 		    2  .000037721  .101018049	       2678
usd_jpy 		    1  .000036974  .102751974	       2779
aud_usd 		    3	-.0000358  -.09512569	       2657
aud_usd 		    5  .000026627  .023857728		896
usd_cad 		    3	.00002229  .059224864	       2657
eur_usd 		    5  .000022025  .019734154		896
gbp_usd 		    2  .000020711  .055463262	       2678
usd_jpy 		    3	-.0000196  -.05208242	       2657
gbp_usd 		    3  -.00001874  -.04969654	       2652
usd_chf 		    1  .000014172  .039384148	       2779
eur_usd 		    3  .000014025  .037265422	       2657
eur_usd 		    1  -.00001214  -.03374724	       2779
gbp_usd 		    1  .000010381  .028848434	       2779
eur_usd 		    4  7.0153E-06  .018555414	       2645
aud_usd 		    4  6.3436E-06  .016778794	       2645
usd_chf 		    3  -6.235E-06  -.01656746	       2657
gbp_usd 		    4  -4.915E-06  -.01296691	       2638
usd_jpy 		    5  3.6263E-06  .003249155		896
usd_cad 		    5  3.4071E-06  .003052725		896
usd_chf 		    4  1.5534E-06  .004108684	       2645
usd_cad 		    4  -5.664E-07  -.00149807	       2645
usd_jpy 		    4  5.1457E-07  .001361027	       2645

30 rows selected.

Elapsed: 00:00:00.18
18:35:18 SQL> 
18:35:18 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
