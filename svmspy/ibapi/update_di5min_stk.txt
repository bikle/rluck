
SQL*Plus: Release 11.2.0.1.0 Production on Wed Mar 30 22:26:08 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

22:26:09 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
22:26:09 SQL> 
22:26:09 SQL> 22:26:09 SQL> --
22:26:09 SQL> -- update_di5min_stk.sql
22:26:09 SQL> --
22:26:09 SQL> 
22:26:09 SQL> -- I use this script to keep di5min_stk up to date.
22:26:09 SQL> 
22:26:09 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
22:26:09 SQL> -- After that date, it holds data from IB.
22:26:09 SQL> 
22:26:09 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
22:26:09 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
22:26:09 SQL> 
22:26:09 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.45
22:26:09 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.13
22:26:09 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.67
22:26:10 SQL> 
22:26:10 SQL> 
22:26:10 SQL> -- I need to shave a second off of some of the dates:
22:26:10 SQL> 
22:26:10 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
22:26:10   2  WHERE TO_CHAR(ydate,'SS')='01'
22:26:10   3  /

0 rows updated.

Elapsed: 00:00:00.32
22:26:10 SQL> 
22:26:10 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    740109

Elapsed: 00:00:00.01
22:26:10 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    740109

Elapsed: 00:00:00.21
22:26:10 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.19
22:26:11 SQL> 
22:26:11 SQL> -- Copy in data from ibs5min:
22:26:11 SQL> 
22:26:11 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
22:26:11   2  SELECT	     tkr||ydate,tkr,ydate,clse
22:26:11   3  FROM ibs5min
22:26:11   4  WHERE ydate >= '2010-12-27 09:00:00'
22:26:11   5  /

740109 rows created.

Elapsed: 00:00:02.45
22:26:13 SQL> 
22:26:13 SQL> -- rpt
22:26:13 SQL> SELECT
22:26:13   2  tkr
22:26:13   3  ,MIN(ydate)
22:26:13   4  ,COUNT(tkr)
22:26:13   5  ,MAX(ydate)
22:26:13   6  FROM di5min_stk0
22:26:13   7  GROUP BY tkr
22:26:13   8  ORDER BY tkr
22:26:13   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ABT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ABX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ADBE	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AEM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AFL	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AGU	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
AIG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AKAM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ALL	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AMGN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AMT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AMX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AMZN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
APA	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
APC	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ARG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AXP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AXU	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
BA	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BBT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BBY	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BEN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BHP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BIDU	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BRCM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BTU	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BUCY	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CAT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CDE	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
CELG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CEO	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
CHK	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
CLF	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CMI	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
COF	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
COP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
COST	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CREE	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CRM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CSX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CTSH	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CVE	2011-02-14 14:30:00	  3227 2011-03-30 21:30:00
CVS	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CVX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DD	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DE	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DIA	2010-12-27 09:00:00	  6255 2011-03-30 19:55:00
DIS	2010-12-27 09:00:00	  6007 2011-03-30 19:55:00
DNDN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DTV	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DVN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
EBAY	2010-12-27 09:00:00	  6044 2011-03-30 19:55:00
EFA	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
EOG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ESRX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
EWZ	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
EXK	2011-01-21 14:30:00	  4573 2011-03-30 21:35:00
FCX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
FDX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
FFIV	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
FLS	2011-01-04 14:30:00	  4614 2011-03-30 19:55:00
FSLR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
GD	2011-01-28 14:30:00	  3354 2011-03-30 19:55:00
GDX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
GFI	2011-01-28 14:30:00	  3120 2011-03-30 19:55:00
GG	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
GILD	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
GLD	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
GOOG	2010-12-27 09:00:00	  6043 2011-03-30 19:55:00
GS	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
HD	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
HES	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
HL	2011-01-18 12:30:00	  4080 2011-03-30 19:55:00
HOC	2011-02-17 14:30:00	  2262 2011-03-30 19:55:00
HON	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
HPQ	2010-12-27 09:00:00	  6172 2011-03-30 19:55:00
IBM	2010-12-27 09:00:00	  6147 2011-03-30 19:55:00
IOC	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
IWM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
JNJ	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
JOYG	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
JPM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
JWN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
KO	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
LFT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
LMT	2011-01-28 14:30:00	  3120 2011-03-30 19:55:00
MAR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MCD	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
MDT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MDY	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MEE	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
MET	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MJN	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
MMM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MON	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MOS	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MRK	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MVG	2011-01-21 14:30:00	  3509 2011-03-30 19:55:00
NEM	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
NFLX	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
NOC	2011-01-28 14:30:00	  3120 2011-03-30 19:55:00
NUE	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
OIH	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ORCL	2011-03-01 14:30:00	  1716 2011-03-30 19:55:00
OXY	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PAAS	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
PALL	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
PBR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PEP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PNC	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
POT	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
PPLT	2011-01-21 14:30:00	  3741 2011-03-30 19:55:00
PRU	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
QCOM	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
QQQ	2010-12-27 09:00:00	  6363 2011-03-30 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
QQQQ	2010-12-27 09:00:00	  5895 2011-03-22 19:55:00
RDY	2011-01-24 14:30:00	  3432 2011-03-30 19:55:00
RIG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
RIMM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
RTN	2011-01-28 14:30:00	  3354 2011-03-30 19:55:00
SCCO	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
SINA	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
SJM	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
SKX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SLB	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SLV	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SLW	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
SNDK	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SOHU	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
SPY	2010-12-27 09:00:00	  6514 2011-03-30 19:55:00
STT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SU	2011-02-17 14:30:00	  2262 2011-03-30 19:55:00
SUN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SVM	2011-01-21 14:30:00	  4994 2011-03-30 22:10:00
SWC	2011-01-19 14:30:00	  3666 2011-03-30 19:55:00
T	2011-02-04 14:30:00	  1950 2011-03-30 19:55:00
TEVA	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
TGT	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
TKR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
TLT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
TSO	2011-02-17 14:30:00	  2262 2011-03-30 19:55:00
UNH	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
UNP	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
UPS	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
V	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
VALE	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
VECO	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
VLO	2011-02-17 14:30:00	  2262 2011-03-30 19:55:00
VMW	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
WDC	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
WFMI	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
WHR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
WMT	2010-12-27 09:00:00	  6129 2011-03-30 19:55:00
WYNN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
X	2011-01-04 12:40:00	  5190 2011-03-30 19:55:00
XLB	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
XLE	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
XLU	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
XOM	2010-12-27 09:00:00	  6416 2011-03-30 19:55:00

164 rows selected.

Elapsed: 00:00:00.29
22:26:13 SQL> 
22:26:13 SQL> -- Next, copy in data from dukas.
22:26:13 SQL> -- dukas5min_stk depends on:
22:26:13 SQL> -- - dukas10min_stk
22:26:13 SQL> -- - svmspy/dukas/fake5.sql
22:26:13 SQL> 
22:26:13 SQL> 
22:26:13 SQL> -- I need to shave a second off of some of the dates:
22:26:13 SQL> 
22:26:13 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
22:26:13   2  WHERE TO_CHAR(ydate,'SS')='01'
22:26:13   3  /

0 rows updated.

Elapsed: 00:00:00.46
22:26:14 SQL> 
22:26:14 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
22:26:14 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.08
22:26:14 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.08
22:26:14 SQL> 
22:26:14 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
22:26:14   2  SELECT	     tkr||ydate,tkr,ydate,clse
22:26:14   3  FROM dukas5min_stk
22:26:14   4  WHERE ydate < '2010-12-27 09:00:00'
22:26:14   5  /

230382 rows created.

Elapsed: 00:00:00.96
22:26:15 SQL> 
22:26:15 SQL> -- rpt
22:26:15 SQL> SELECT
22:26:15   2  tkr
22:26:15   3  ,MIN(ydate)
22:26:15   4  ,COUNT(tkr)
22:26:15   5  ,MAX(ydate)
22:26:15   6  FROM dukas5min_stk
22:26:15   7  WHERE ydate < '2010-12-27 09:00:00'
22:26:15   8  GROUP BY tkr
22:26:15   9  ORDER BY tkr
22:26:15  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.08
22:26:15 SQL> 
22:26:15 SQL> -- rpt
22:26:15 SQL> SELECT
22:26:15   2  tkr
22:26:15   3  ,MIN(ydate)
22:26:15   4  ,COUNT(tkr)
22:26:15   5  ,MAX(ydate)
22:26:15   6  FROM di5min_stk0
22:26:15   7  GROUP BY tkr
22:26:15   8  ORDER BY tkr
22:26:15   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ABT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ABX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ADBE	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AEM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AFL	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AGU	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
AIG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AKAM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ALL	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AMGN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AMT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AMX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AMZN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
APA	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
APC	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ARG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AXP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
AXU	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
BA	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BBT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BBY	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BEN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BHP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BIDU	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BRCM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BTU	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
BUCY	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CAT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CDE	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
CELG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CEO	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
CHK	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
CLF	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CMI	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
COF	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
COP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
COST	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CREE	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CRM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CSX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CTSH	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CVE	2011-02-14 14:30:00	  3227 2011-03-30 21:30:00
CVS	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
CVX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DD	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DE	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DIA	2009-10-28 18:10:00	 29684 2011-03-30 19:55:00
DIS	2009-10-28 18:10:00	 29436 2011-03-30 19:55:00
DNDN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DTV	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
DVN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
EBAY	2009-10-28 18:10:00	 29473 2011-03-30 19:55:00
EFA	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
EOG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ESRX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
EWZ	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
EXK	2011-01-21 14:30:00	  4573 2011-03-30 21:35:00
FCX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
FDX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
FFIV	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
FLS	2011-01-04 14:30:00	  4614 2011-03-30 19:55:00
FSLR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
GD	2011-01-28 14:30:00	  3354 2011-03-30 19:55:00
GDX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
GFI	2011-01-28 14:30:00	  3120 2011-03-30 19:55:00
GG	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
GILD	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
GLD	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
GOOG	2009-10-28 18:10:00	 29472 2011-03-30 19:55:00
GS	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
HD	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
HES	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
HL	2011-01-18 12:30:00	  4080 2011-03-30 19:55:00
HOC	2011-02-17 14:30:00	  2262 2011-03-30 19:55:00
HON	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
HPQ	2009-10-28 18:10:00	 29601 2011-03-30 19:55:00
IBM	2009-10-28 18:10:00	 29576 2011-03-30 19:55:00
IOC	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
IWM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
JNJ	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
JOYG	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
JPM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
JWN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
KO	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
LFT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
LMT	2011-01-28 14:30:00	  3120 2011-03-30 19:55:00
MAR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MCD	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
MDT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MDY	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MEE	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
MET	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MJN	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
MMM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MON	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MOS	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MRK	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
MVG	2011-01-21 14:30:00	  3509 2011-03-30 19:55:00
NEM	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
NFLX	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
NOC	2011-01-28 14:30:00	  3120 2011-03-30 19:55:00
NUE	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
OIH	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
ORCL	2011-03-01 14:30:00	  1716 2011-03-30 19:55:00
OXY	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PAAS	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
PALL	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
PBR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PEP	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
PNC	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
POT	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
PPLT	2011-01-21 14:30:00	  3741 2011-03-30 19:55:00
PRU	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
QCOM	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
QQQ	2010-12-27 09:00:00	  6363 2011-03-30 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
QQQQ	2009-10-28 18:10:00	 29324 2011-03-22 19:55:00
RDY	2011-01-24 14:30:00	  3432 2011-03-30 19:55:00
RIG	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
RIMM	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
RTN	2011-01-28 14:30:00	  3354 2011-03-30 19:55:00
SCCO	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
SINA	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
SJM	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
SKX	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SLB	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SLV	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SLW	2011-01-21 14:30:00	  3744 2011-03-30 19:55:00
SNDK	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SOHU	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
SPY	2009-10-28 18:10:00	 26035 2011-03-30 19:55:00
STT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SU	2011-02-17 14:30:00	  2262 2011-03-30 19:55:00
SUN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
SVM	2011-01-21 14:30:00	  4994 2011-03-30 22:10:00
SWC	2011-01-19 14:30:00	  3666 2011-03-30 19:55:00
T	2011-02-04 14:30:00	  1950 2011-03-30 19:55:00
TEVA	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
TGT	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
TKR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
TLT	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
TSO	2011-02-17 14:30:00	  2262 2011-03-30 19:55:00
UNH	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
UNP	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
UPS	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
V	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
VALE	2011-01-24 14:30:00	  3666 2011-03-30 19:55:00
VECO	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
VLO	2011-02-17 14:30:00	  2262 2011-03-30 19:55:00
VMW	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
WDC	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
WFMI	2011-01-04 14:30:00	  4446 2011-03-30 19:55:00
WHR	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
WMT	2009-10-28 18:10:00	 29558 2011-03-30 19:55:00
WYNN	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
X	2011-01-04 12:40:00	  5190 2011-03-30 19:55:00
XLB	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
XLE	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
XLU	2011-01-04 14:30:00	  4680 2011-03-30 19:55:00
XOM	2009-10-28 18:10:00	 29845 2011-03-30 19:55:00

164 rows selected.

Elapsed: 00:00:00.36
22:26:15 SQL> 
22:26:15 SQL> CREATE TABLE di5min_stk COMPRESS AS
22:26:15   2  SELECT
22:26:15   3  tkrdate
22:26:15   4  ,tkr
22:26:15   5  ,ydate
22:26:15   6  ,AVG(clse)clse
22:26:15   7  FROM di5min_stk0
22:26:15   8  -- I want weekdays:
22:26:15   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
22:26:15  10  GROUP BY
22:26:15  11  tkrdate
22:26:15  12  ,tkr
22:26:15  13  ,ydate
22:26:15  14  /

Table created.

Elapsed: 00:00:05.13
22:26:20 SQL> 
22:26:20 SQL> -- rpt
22:26:20 SQL> SELECT
22:26:20   2  TO_CHAR(ydate,'dy')
22:26:20   3  ,COUNT(ydate)
22:26:20   4  FROM di5min_stk
22:26:20   5  GROUP BY TO_CHAR(ydate,'dy')
22:26:20   6  /

TO_ COUNT(YDATE)
--- ------------
fri	  195441
mon	  171053
tue	  204927
thu	  194399
wed	  204451

Elapsed: 00:00:00.67
22:26:21 SQL> 
22:26:21 SQL> -- I need to shave a second off of some of the dates:
22:26:21 SQL> --
22:26:21 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
22:26:21 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
22:26:21 SQL> -- /
22:26:21 SQL> --
22:26:21 SQL> -- SELECT COUNT(*)FROM di5min_stk;
22:26:21 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
22:26:21 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
22:26:21 SQL> --
22:26:21 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
22:26:21 SQL> 
22:26:21 SQL> -- Add a column to help join with future dates
22:26:21 SQL> -- and then calculate 1 day gain:
22:26:21 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:01.35
22:26:22 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
22:26:22   2  SELECT
22:26:22   3  tkrdate
22:26:22   4  ,tkr
22:26:22   5  ,ydate
22:26:22   6  ,clse
22:26:22   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
22:26:22   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
22:26:22   9  	    ELSE NULL END selldate
22:26:22  10  FROM di5min_stk
22:26:22  11  /

Table created.

Elapsed: 00:00:02.74
22:26:25 SQL> 
22:26:25 SQL> -- Join with the future
22:26:25 SQL> 
22:26:25 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.05
22:26:25 SQL> 
22:26:25 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
22:26:25   2  SELECT
22:26:25   3  p.tkrdate
22:26:25   4  ,p.tkr
22:26:25   5  ,p.ydate
22:26:25   6  ,p.clse
22:26:25   7  ,p.selldate
22:26:25   8  ,f.clse clse2
22:26:25   9  ,f.clse - p.clse gain1day
22:26:25  10  FROM di5min_stk_fd p, di5min_stk f
22:26:25  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
22:26:25  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
22:26:25  13  /

Table created.

Elapsed: 00:00:04.94
22:26:30 SQL> 
22:26:30 SQL> -- rpt
22:26:30 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	195441
mon	171053
tue	204927
thu	194399
wed	204451

Elapsed: 00:00:00.59
22:26:31 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	195441
mon	171053
tue	204927
thu	194399
wed	204451

Elapsed: 00:00:00.77
22:26:32 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-03-30 22:10:00

Elapsed: 00:00:00.08
22:26:32 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-03-30 22:10:00

Elapsed: 00:00:00.08
22:26:32 SQL> 
22:26:32 SQL> -- rpt
22:26:32 SQL> SELECT
22:26:32   2  tkr
22:26:32   3  ,MIN(ydate)
22:26:32   4  ,COUNT(ydate)
22:26:32   5  ,MAX(ydate)
22:26:32   6  ,MIN(clse)
22:26:32   7  ,AVG(clse)
22:26:32   8  ,MAX(clse)
22:26:32   9  ,MAX(gain1day)
22:26:32  10  FROM di5min_stk_c2
22:26:32  11  GROUP BY tkr
22:26:32  12  ORDER BY tkr
22:26:32  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	200.725 338.877404     364.83	 145.278438
ABT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 39.115 46.7855817	49.16	     8.3225
ABX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  45.64 49.7380869	54.24	       2.14
ADBE	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  30.82 33.8825276	43.25	       1.64
AEM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	   63.6 69.8239749	76.47	       3.74
AFL	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  48.59 56.1979423	59.48	       3.71
AGU	2011-01-24 14:30:00	    3666 2011-03-30 19:55:00	  84.78 91.5926179	99.13	       4.71
AIG	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  35.17 43.4769828	62.47		4.8
AKAM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  34.85 42.9494669	52.47	       2.39
ALL	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  30.47 31.4387247	32.61		.83
AMGN	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  50.63 54.2884458	58.15	       1.92
AMT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  45.98 51.7968901	56.73	       2.44
AMX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  53.38 56.7852028	59.58	       1.74
AMZN	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 160.93 176.720513     191.55	       10.1
APA	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  110.8 121.413915     131.57	       5.98
APC	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	   73.1 78.3429984	83.97	       4.12
ARG	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  60.86 63.3048085	67.35	       2.46
AXP	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  42.31 44.6928321	 46.9	       1.92
AXU	2011-01-21 14:30:00	    3744 2011-03-30 19:55:00	   5.88 7.87397867	 9.64	       1.07
BA	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  66.51 72.5624665    102.935	       2.85
BBT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	     26  27.490161	29.55		1.3
BBY	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  28.71 33.2416059	36.18	       1.64
BEN	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 109.71 121.259958	130.6	       5.04
BHP	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  83.94 91.3232923	96.58	       3.59
BIDU	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  99.53 118.272358	137.8	      11.14
BP	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  42.55 47.5708773	64.49	       1.83
BRCM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  25.15 42.0954875	47.32	  16.154375
BTU	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	   57.7 64.9561265	73.49	       5.41
BUCY	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  89.67 91.7330175    107.275	       2.47
CAT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  92.37 100.256282     111.55	       3.79
CDE	2011-01-21 14:30:00	    3744 2011-03-30 19:55:00	  22.13 28.9136441	36.06		4.4
CELG	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  48.96 55.0506137     64.905	       2.45
CEO	2011-01-24 14:30:00	    3666 2011-03-30 19:55:00	 206.99 228.126592	251.6	      10.36
CHK	2011-01-24 14:30:00	    3666 2011-03-30 19:55:00	  27.24 32.1065457	35.83	       3.48
CLF	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  79.77 90.0206791	101.2	       8.31
CMI	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  94.36 106.420478     114.74	       6.52
COF	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  43.23 50.7009445     70.685		2.8
COP	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  65.11 72.7396735	80.87	 11.4215625
COST	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  69.56 72.6145883	75.43	       3.55
CREE	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  42.85 53.4046322	69.19	       2.89
CRM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 97.655 131.493094 146.866719	 47.6217188
CSX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  64.81 72.5449214	80.23	       3.28
CTSH	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  70.72 75.6016099	81.74	       3.45
CVE	2011-02-14 14:30:00	    3227 2011-03-30 21:30:00	  34.32  37.593627	40.98	 1.75985901
CVS	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  32.13 33.8697816	35.94	       1.17
CVX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  90.21 98.4255624     108.72	       3.55
DD	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  47.28 52.0927567	56.16	 5.09311826
DE	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  81.82  90.574009	97.03	       3.93
DIA	2009-10-28 18:10:00	   29672 2011-03-30 19:55:00	  96.34 108.762153     123.64	       4.35
DIS	2009-10-28 18:10:00	   29424 2011-03-30 19:55:00	  27.06 34.9700336	44.29	       3.13
DNDN	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  31.34 37.7637627     99.105	       2.92
DTV	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  40.79 43.9801477	47.38		2.4
DVN	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  77.06 86.8878562	93.42	       4.67
EBAY	2009-10-28 18:10:00	   29453 2011-03-30 19:55:00	  19.17  25.766176 47.5933333	       2.69
EFA	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	   54.7 62.2931192     99.265	       2.16
EOG	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  91.02 105.571906     120.99	       6.61
ESRX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  51.25 55.8505109	58.74		2.2
EWZ	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  70.16  74.365336	78.95	       2.02
EXK	2011-01-21 14:30:00	    4573 2011-03-30 21:35:00	    5.4 8.03569378	10.29	       1.46
FCX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  46.43 74.8371216     122.49	 48.3005005
FDX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  55.79 89.6738091	98.45	  31.839375
FFIV	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  91.18  116.90311     145.75	      11.02
FLS	2011-01-04 14:30:00	    4614 2011-03-30 19:55:00	   37.5 117.430274     132.49	   41.92375
FSLR	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 130.64 151.263912	  174	      12.54
GD	2011-01-28 14:30:00	    3354 2011-03-30 19:55:00 60.8145605 67.2019027	76.03	      8.645
GDX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  52.52 57.6120206	 67.1	       2.31
GFI	2011-01-28 14:30:00	    3120 2011-03-30 19:55:00	  15.67 16.9235104	18.32		.79
GG	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  39.13 44.8949579	50.69	       2.69
GILD	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  36.51 39.2947453	42.89	       1.75
GLD	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	 84.125 132.546563     141.16	  52.591875
GOOG	2009-10-28 18:10:00	   29448 2011-03-30 19:55:00	329.525 551.931316     641.65	 261.864063
GS	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  153.4 164.415717	  175	       6.13
HD	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  34.09 36.6677366	38.94	       1.42
HES	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  76.16 81.6026301	87.02	       4.51
HL	2011-01-18 12:30:00	    4072 2011-03-30 19:55:00	   7.84 9.36194183	11.08		.85
HOC	2011-02-17 14:30:00	    2262 2011-03-30 19:55:00	  50.79 56.5778643	63.17	       5.16
HON	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  53.03 56.2136775	59.86	       2.27
HPQ	2009-10-28 18:10:00	   29589 2011-03-30 19:55:00	  37.45  46.372643	 54.7		3.4
IBM	2009-10-28 18:10:00	   29564 2011-03-30 19:55:00	 119.59  136.13493     167.47	       6.28
IOC	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  66.18  73.509037	81.72	       4.58
IWM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  77.04 80.3898259	83.97	       2.49
JNJ	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	   57.5 60.6776248	63.49	       1.77
JOYG	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	 73.075 90.2805262     100.55	 21.9322852
JPM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  42.77   45.44217	48.27		2.5
JWN	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  40.03 43.3560481	47.49	       2.39
KO	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  61.35 64.6076726	79.42	       2.22
LFT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  28.04 32.2743958	   37	       4.03
LMT	2011-01-28 14:30:00	    3120 2011-03-30 19:55:00	  77.84 80.9380744	88.63	       2.23
MAR	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  34.99 39.3195227	42.58		1.5
MCD	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  72.15 74.8521951	77.23	       2.68
MDT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  36.18 38.4397478	41.32	       1.36
MDY	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 163.62 171.903644     178.94		4.5
MEE	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  52.03 61.0340783	69.06	       9.93
MET	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  41.29 45.8969486	48.71	       1.78
MJN	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  52.71 59.1781093	63.29	 6.94539063
MMM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  85.68 90.0270049	 94.1	       2.69
MON	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	   65.2 71.6218034	76.13	       4.04
MOS	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  71.87 80.3867935	89.17	       6.34
MRK	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  31.07 33.3982452	 37.6		.95
MT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  32.43  36.452598	41.21	       2.13
MVG	2011-01-21 14:30:00	    3509 2011-03-30 19:55:00	   9.25 11.0976076	13.35	       1.31
NEM	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  50.07 55.3776852	60.22	       2.16
NFLX	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  176.3 207.192954     241.75	      29.02
NOC	2011-01-28 14:30:00	    3120 2011-03-30 19:55:00	 62.335 67.5266778	 72.4	   4.690625
NUE	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  42.81 46.1499536	49.23	       2.14
OIH	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 135.78 153.782683     166.41	       8.52
ORCL	2011-03-01 14:30:00	    1716 2011-03-30 19:55:00	  29.63 31.9700744	33.72	       2.05
OXY	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  93.76 99.3966452     107.41	       3.94
PAAS	2011-01-21 14:30:00	    3744 2011-03-30 19:55:00	  31.13 35.8062247	40.53	       2.92
PALL	2011-01-21 14:30:00	    3744 2011-03-30 19:55:00	  68.75 78.5389575	85.33	       3.41
PBR	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  35.03 38.3026359	42.57		2.3
PEP	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  62.07 64.5163101	67.46	       1.56
PG	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  59.77 63.3212721	66.94	       1.74
PM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  55.88 60.3664057	65.86	       1.84
PNC	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  59.75 62.0725706	65.14	       3.13
POT	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  50.49 113.913974     189.19	      13.11
PPLT	2011-01-21 14:30:00	    3741 2011-03-30 19:55:00	 167.76 177.711169     185.21	 11.7949186
PRU	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  56.82 62.4600887	67.47	       3.25
QCOM	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	   49.9 54.3481468	59.79	       3.54
QQQ	2010-12-27 09:00:00	    6351 2011-03-30 19:55:00	  53.78 56.3273605	59.03	       1.44

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
QQQQ	2009-10-28 18:10:00	   29312 2011-03-22 19:55:00	   40.7 48.9803231	59.03		2.5
RDY	2011-01-24 14:30:00	    3432 2011-03-30 19:55:00	   32.6 34.6722749	37.36	       2.29
RIG	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  69.12 79.3763506	85.94	       5.25
RIMM	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  55.82  64.072437     85.395	       3.93
RTN	2011-01-28 14:30:00	    3354 2011-03-30 19:55:00	  49.21  51.013528	53.08	       1.65
SCCO	2011-01-24 14:30:00	    3666 2011-03-30 19:55:00	  38.12 42.6116228	47.56	       2.84
SINA	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  72.55 86.8797706     109.11		6.9
SJM	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	 52.045 65.4161491	73.11	  15.829375
SKX	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  17.87 20.6790985	23.65	       1.48
SLB	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  79.84 88.0240784	 95.1	       4.98
SLV	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  26.08 31.1380124	37.22	       1.66
SLW	2011-01-21 14:30:00	    3744 2011-03-30 19:55:00	   28.9 38.3494117	46.34	       2.87
SNDK	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  41.11 48.4300496	53.47		3.6
SOHU	2011-01-24 14:30:00	    3666 2011-03-30 19:55:00	  64.69  81.686385	90.95		7.8
SPY	2009-10-28 18:10:00	   26011 2011-03-30 19:55:00	 103.18 118.002186     134.66		5.1
STT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	   42.3 45.7529968	50.22		2.1
SU	2011-02-17 14:30:00	    2262 2011-03-30 19:55:00 41.3805991 44.4370363 46.8599992	 2.08441843
SUN	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  38.49 42.8641883	50.69	       2.07
SVM	2011-01-21 14:30:00	    4994 2011-03-30 22:10:00	   9.41 12.6510487	15.33		1.1
SWC	2011-01-19 14:30:00	    3666 2011-03-30 19:55:00	   19.5 22.7770813	25.88	       1.99
T	2011-02-04 14:30:00	    1950 2011-03-30 19:55:00	  20.58 41.3050647     53.766	 21.9851547
TEVA	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  47.33 51.7230749	56.96	       3.35
TGT	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  49.04 53.1966776	60.37	       1.99
TKR	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  43.44 49.2805266	52.67	    4.18875
TLT	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 74.605 90.5104424	94.55	 16.5532813
TSO	2011-02-17 14:30:00	    2262 2011-03-30 19:55:00	   22.4 24.7976625	 27.8	       3.17
UNH	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  36.95 41.9236281	45.56	       2.23
UNP	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	 85.445 94.8054916	99.44	   7.436875
UPS	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  70.24 73.1507418	76.97	       4.15
V	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00 42.5480164 59.5701903 79.2666571	 22.9764716
VALE	2011-01-24 14:30:00	    3666 2011-03-30 19:55:00	   30.7 33.7896624	36.36		1.3
VECO	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  42.58 47.5393317	53.12	       4.28
VLO	2011-02-17 14:30:00	    2262 2011-03-30 19:55:00	  25.97 28.3244424	30.91		2.5
VMW	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  74.39 85.4670904	95.94	 4.80213474
WDC	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  29.42 33.6997782	37.93	       5.73
WFMI	2011-01-04 14:30:00	    4446 2011-03-30 19:55:00	  47.85 56.0022113	65.94	       7.83
WHR	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	   79.2 84.4121767	92.05		3.8
WMT	2009-10-28 18:10:00	   29534 2011-03-30 19:55:00	  47.76 53.2434943	57.85	       2.22
WYNN	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 109.66 121.146422     131.95	       9.74
X	2011-01-04 12:40:00	    5178 2011-03-30 19:55:00  35.304713  57.228165	75.74	 15.8246652
XLB	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  36.57 38.7827439	40.72	       1.15
XLE	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	 66.775 73.6070062	80.34	 10.8921094
XLU	2011-01-04 14:30:00	    4680 2011-03-30 19:55:00	  30.75 31.7781999	32.89		.67
XOM	2009-10-28 18:10:00	   29809 2011-03-30 19:55:00	  56.05  68.810859 86.5315885	 9.62822917

164 rows selected.

Elapsed: 00:00:00.76
22:26:33 SQL> 
22:26:33 SQL> COLUMN clse FORMAT 999.9999
22:26:33 SQL> SELECT
22:26:33   2  tkr
22:26:33   3  ,ROUND(clse,4)clse
22:26:33   4  -- Should be NULL:
22:26:33   5  ,ROUND(clse2,4)clse2
22:26:33   6  ,ydate
22:26:33   7  FROM di5min_stk_c2
22:26:33   8  WHERE ydate > sysdate - 0.5/24
22:26:33   9  ORDER BY tkr,ydate
22:26:33  10  /

TKR	     CLSE      CLSE2 YDATE
------- --------- ---------- -------------------
SVM	  14.4200	     2011-03-30 22:00:00
SVM	  14.4200	     2011-03-30 22:05:00
SVM	  14.4200	     2011-03-30 22:10:00

Elapsed: 00:00:00.16
22:26:33 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
