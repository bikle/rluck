
SQL*Plus: Release 11.2.0.1.0 Production on Tue Mar 22 03:39:35 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

03:39:35 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
03:39:35 SQL> 
03:39:35 SQL> 03:39:35 SQL> --
03:39:35 SQL> -- update_di5min_stk.sql
03:39:35 SQL> --
03:39:35 SQL> 
03:39:35 SQL> -- I use this script to keep di5min_stk up to date.
03:39:35 SQL> 
03:39:35 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
03:39:35 SQL> -- After that date, it holds data from IB.
03:39:35 SQL> 
03:39:35 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
03:39:35 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
03:39:35 SQL> 
03:39:35 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.67
03:39:36 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.12
03:39:36 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:18.33
03:39:54 SQL> 
03:39:54 SQL> 
03:39:54 SQL> -- I need to shave a second off of some of the dates:
03:39:54 SQL> 
03:39:54 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
03:39:54   2  WHERE TO_CHAR(ydate,'SS')='01'
03:39:54   3  /

0 rows updated.

Elapsed: 00:00:00.22
03:39:54 SQL> 
03:39:54 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    644269

Elapsed: 00:00:00.01
03:39:54 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    644269

Elapsed: 00:00:00.24
03:39:55 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.17
03:39:55 SQL> 
03:39:55 SQL> -- Copy in data from ibs5min:
03:39:55 SQL> 
03:39:55 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
03:39:55   2  SELECT	     tkr||ydate,tkr,ydate,clse
03:39:55   3  FROM ibs5min
03:39:55   4  WHERE ydate >= '2010-12-27 09:00:00'
03:39:55   5  /

644269 rows created.

Elapsed: 00:00:04.20
03:39:59 SQL> 
03:39:59 SQL> -- rpt
03:39:59 SQL> SELECT
03:39:59   2  tkr
03:39:59   3  ,MIN(ydate)
03:39:59   4  ,COUNT(tkr)
03:39:59   5  ,MAX(ydate)
03:39:59   6  FROM di5min_stk0
03:39:59   7  GROUP BY tkr
03:39:59   8  ORDER BY tkr
03:39:59   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ABT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ABX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ADBE	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AEM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AFL	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AGU	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
AIG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AKAM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ALL	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AMGN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AMT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AMX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AMZN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
APA	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
APC	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ARG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AXP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AXU	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
BA	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BBT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BBY	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BEN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BHP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BIDU	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BRCM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BTU	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BUCY	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CAT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CDE	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
CELG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CEO	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
CHK	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
CLF	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CMI	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
COF	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
COP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
COST	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CREE	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CRM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CSX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CTSH	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CVE	2011-02-14 14:30:00	  2492 2011-03-21 19:55:00
CVS	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CVX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DD	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DE	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DIA	2010-12-27 09:00:00	  5709 2011-03-21 19:55:00
DIS	2010-12-27 09:00:00	  5461 2011-03-21 19:55:00
DNDN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DTV	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DVN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
EBAY	2010-12-27 09:00:00	  5498 2011-03-21 19:55:00
EFA	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
EOG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ESRX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
EWZ	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
EXK	2011-01-21 14:30:00	  3588 2011-03-21 23:55:00
FCX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
FDX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
FFIV	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
FLS	2011-01-04 14:30:00	  4068 2011-03-21 19:55:00
FSLR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
GD	2011-01-28 14:30:00	  2808 2011-03-21 19:55:00
GDX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
GFI	2011-01-28 14:30:00	  2574 2011-03-21 19:55:00
GG	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
GILD	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
GLD	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
GOOG	2010-12-27 09:00:00	  5497 2011-03-21 19:55:00
GS	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
HD	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
HES	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
HL	2011-01-18 12:30:00	  3534 2011-03-21 19:55:00
HOC	2011-02-17 14:30:00	  1716 2011-03-21 19:55:00
HON	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
HPQ	2010-12-27 09:00:00	  5626 2011-03-21 19:55:00
IBM	2010-12-27 09:00:00	  5601 2011-03-21 19:55:00
IOC	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
IWM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
JNJ	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
JOYG	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
JPM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
JWN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
KO	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
LFT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
LMT	2011-01-28 14:30:00	  2574 2011-03-21 19:55:00
MAR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MCD	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
MDT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MDY	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MEE	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
MET	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MJN	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
MMM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MON	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MOS	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MRK	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MVG	2011-01-21 14:30:00	  2963 2011-03-21 19:55:00
NEM	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
NFLX	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
NOC	2011-01-28 14:30:00	  2574 2011-03-21 19:55:00
NUE	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
OIH	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ORCL	2011-03-01 14:30:00	  1170 2011-03-21 19:55:00
OXY	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PAAS	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
PALL	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
PBR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PEP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PNC	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
POT	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
PPLT	2011-01-21 14:30:00	  3195 2011-03-21 19:55:00
PRU	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
QCOM	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
QQQQ	2010-12-27 09:00:00	  5817 2011-03-21 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
RDY	2011-01-24 14:30:00	  2808 2011-03-18 19:55:00
RIG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
RIMM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
RTN	2011-01-28 14:30:00	  2808 2011-03-21 19:55:00
SCCO	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
SINA	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
SJM	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
SKX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SLB	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SLV	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SLW	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
SNDK	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SOHU	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
SPY	2010-12-27 09:00:00	  5968 2011-03-21 19:55:00
STT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SU	2011-02-17 14:30:00	  1716 2011-03-21 19:55:00
SUN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SVM	2011-01-21 14:30:00	  4207 2011-03-21 19:55:00
SWC	2011-01-19 14:30:00	  3120 2011-03-21 19:55:00
T	2011-02-04 14:30:00	  1404 2011-03-21 19:55:00
TEVA	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
TGT	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
TKR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
TLT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
TSO	2011-02-17 14:30:00	  1716 2011-03-21 19:55:00
UNH	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
UNP	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
UPS	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
V	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
VALE	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
VECO	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
VLO	2011-02-17 14:30:00	  1716 2011-03-21 19:55:00
VMW	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
WDC	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
WFMI	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
WHR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
WMT	2010-12-27 09:00:00	  5583 2011-03-21 19:55:00
WYNN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
X	2011-01-04 12:40:00	  4644 2011-03-21 19:55:00
XLB	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
XLE	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
XLU	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
XOM	2010-12-27 09:00:00	  5870 2011-03-21 19:55:00

163 rows selected.

Elapsed: 00:00:00.25
03:39:59 SQL> 
03:39:59 SQL> -- Next, copy in data from dukas.
03:39:59 SQL> -- dukas5min_stk depends on:
03:39:59 SQL> -- - dukas10min_stk
03:39:59 SQL> -- - svmspy/dukas/fake5.sql
03:39:59 SQL> 
03:39:59 SQL> 
03:39:59 SQL> -- I need to shave a second off of some of the dates:
03:39:59 SQL> 
03:39:59 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
03:39:59   2  WHERE TO_CHAR(ydate,'SS')='01'
03:39:59   3  /

0 rows updated.

Elapsed: 00:00:00.70
03:40:00 SQL> 
03:40:00 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
03:40:00 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.08
03:40:00 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.07
03:40:00 SQL> 
03:40:00 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
03:40:00   2  SELECT	     tkr||ydate,tkr,ydate,clse
03:40:00   3  FROM dukas5min_stk
03:40:00   4  WHERE ydate < '2010-12-27 09:00:00'
03:40:00   5  /

230382 rows created.

Elapsed: 00:00:00.89
03:40:01 SQL> 
03:40:01 SQL> -- rpt
03:40:01 SQL> SELECT
03:40:01   2  tkr
03:40:01   3  ,MIN(ydate)
03:40:01   4  ,COUNT(tkr)
03:40:01   5  ,MAX(ydate)
03:40:01   6  FROM dukas5min_stk
03:40:01   7  WHERE ydate < '2010-12-27 09:00:00'
03:40:01   8  GROUP BY tkr
03:40:01   9  ORDER BY tkr
03:40:01  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.09
03:40:01 SQL> 
03:40:01 SQL> -- rpt
03:40:01 SQL> SELECT
03:40:01   2  tkr
03:40:01   3  ,MIN(ydate)
03:40:01   4  ,COUNT(tkr)
03:40:01   5  ,MAX(ydate)
03:40:01   6  FROM di5min_stk0
03:40:01   7  GROUP BY tkr
03:40:01   8  ORDER BY tkr
03:40:01   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ABT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ABX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ADBE	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AEM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AFL	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AGU	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
AIG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AKAM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ALL	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AMGN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AMT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AMX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AMZN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
APA	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
APC	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ARG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AXP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
AXU	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
BA	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BBT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BBY	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BEN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BHP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BIDU	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BRCM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BTU	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
BUCY	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CAT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CDE	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
CELG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CEO	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
CHK	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
CLF	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CMI	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
COF	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
COP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
COST	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CREE	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CRM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CSX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CTSH	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CVE	2011-02-14 14:30:00	  2492 2011-03-21 19:55:00
CVS	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
CVX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DD	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DE	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DIA	2009-10-28 18:10:00	 29138 2011-03-21 19:55:00
DIS	2009-10-28 18:10:00	 28890 2011-03-21 19:55:00
DNDN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DTV	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
DVN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
EBAY	2009-10-28 18:10:00	 28927 2011-03-21 19:55:00
EFA	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
EOG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ESRX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
EWZ	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
EXK	2011-01-21 14:30:00	  3588 2011-03-21 23:55:00
FCX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
FDX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
FFIV	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
FLS	2011-01-04 14:30:00	  4068 2011-03-21 19:55:00
FSLR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
GD	2011-01-28 14:30:00	  2808 2011-03-21 19:55:00
GDX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
GFI	2011-01-28 14:30:00	  2574 2011-03-21 19:55:00
GG	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
GILD	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
GLD	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
GOOG	2009-10-28 18:10:00	 28926 2011-03-21 19:55:00
GS	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
HD	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
HES	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
HL	2011-01-18 12:30:00	  3534 2011-03-21 19:55:00
HOC	2011-02-17 14:30:00	  1716 2011-03-21 19:55:00
HON	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
HPQ	2009-10-28 18:10:00	 29055 2011-03-21 19:55:00
IBM	2009-10-28 18:10:00	 29030 2011-03-21 19:55:00
IOC	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
IWM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
JNJ	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
JOYG	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
JPM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
JWN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
KO	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
LFT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
LMT	2011-01-28 14:30:00	  2574 2011-03-21 19:55:00
MAR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MCD	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
MDT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MDY	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MEE	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
MET	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MJN	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
MMM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MON	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MOS	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MRK	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
MVG	2011-01-21 14:30:00	  2963 2011-03-21 19:55:00
NEM	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
NFLX	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
NOC	2011-01-28 14:30:00	  2574 2011-03-21 19:55:00
NUE	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
OIH	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
ORCL	2011-03-01 14:30:00	  1170 2011-03-21 19:55:00
OXY	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PAAS	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
PALL	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
PBR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PEP	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
PNC	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
POT	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
PPLT	2011-01-21 14:30:00	  3195 2011-03-21 19:55:00
PRU	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
QCOM	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
QQQQ	2009-10-28 18:10:00	 29246 2011-03-21 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
RDY	2011-01-24 14:30:00	  2808 2011-03-18 19:55:00
RIG	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
RIMM	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
RTN	2011-01-28 14:30:00	  2808 2011-03-21 19:55:00
SCCO	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
SINA	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
SJM	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
SKX	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SLB	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SLV	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SLW	2011-01-21 14:30:00	  3198 2011-03-21 19:55:00
SNDK	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SOHU	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
SPY	2009-10-28 18:10:00	 25489 2011-03-21 19:55:00
STT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SU	2011-02-17 14:30:00	  1716 2011-03-21 19:55:00
SUN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
SVM	2011-01-21 14:30:00	  4207 2011-03-21 19:55:00
SWC	2011-01-19 14:30:00	  3120 2011-03-21 19:55:00
T	2011-02-04 14:30:00	  1404 2011-03-21 19:55:00
TEVA	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
TGT	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
TKR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
TLT	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
TSO	2011-02-17 14:30:00	  1716 2011-03-21 19:55:00
UNH	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
UNP	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
UPS	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
V	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
VALE	2011-01-24 14:30:00	  3120 2011-03-21 19:55:00
VECO	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
VLO	2011-02-17 14:30:00	  1716 2011-03-21 19:55:00
VMW	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
WDC	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
WFMI	2011-01-04 14:30:00	  3900 2011-03-21 19:55:00
WHR	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
WMT	2009-10-28 18:10:00	 29012 2011-03-21 19:55:00
WYNN	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
X	2011-01-04 12:40:00	  4644 2011-03-21 19:55:00
XLB	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
XLE	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
XLU	2011-01-04 14:30:00	  4134 2011-03-21 19:55:00
XOM	2009-10-28 18:10:00	 29299 2011-03-21 19:55:00

163 rows selected.

Elapsed: 00:00:00.34
03:40:01 SQL> 
03:40:01 SQL> CREATE TABLE di5min_stk COMPRESS AS
03:40:01   2  SELECT
03:40:01   3  tkrdate
03:40:01   4  ,tkr
03:40:01   5  ,ydate
03:40:01   6  ,AVG(clse)clse
03:40:01   7  FROM di5min_stk0
03:40:01   8  -- I want weekdays:
03:40:01   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
03:40:01  10  GROUP BY
03:40:01  11  tkrdate
03:40:01  12  ,tkr
03:40:01  13  ,ydate
03:40:01  14  /

Table created.

Elapsed: 00:00:05.19
03:40:07 SQL> 
03:40:07 SQL> -- rpt
03:40:07 SQL> SELECT
03:40:07   2  TO_CHAR(ydate,'dy')
03:40:07   3  ,COUNT(ydate)
03:40:07   4  FROM di5min_stk
03:40:07   5  GROUP BY TO_CHAR(ydate,'dy')
03:40:07   6  /

TO_ COUNT(YDATE)
--- ------------
fri	  181518
mon	  157056
tue	  177841
thu	  180465
wed	  177563

Elapsed: 00:00:00.81
03:40:07 SQL> 
03:40:07 SQL> -- I need to shave a second off of some of the dates:
03:40:07 SQL> --
03:40:07 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
03:40:07 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
03:40:07 SQL> -- /
03:40:07 SQL> --
03:40:07 SQL> -- SELECT COUNT(*)FROM di5min_stk;
03:40:07 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
03:40:07 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
03:40:07 SQL> --
03:40:07 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
03:40:07 SQL> 
03:40:07 SQL> -- Add a column to help join with future dates
03:40:07 SQL> -- and then calculate 1 day gain:
03:40:07 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:01.12
03:40:08 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
03:40:08   2  SELECT
03:40:08   3  tkrdate
03:40:08   4  ,tkr
03:40:08   5  ,ydate
03:40:08   6  ,clse
03:40:08   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
03:40:08   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
03:40:08   9  	    ELSE NULL END selldate
03:40:08  10  FROM di5min_stk
03:40:08  11  /

Table created.

Elapsed: 00:00:02.31
03:40:11 SQL> 
03:40:11 SQL> -- Join with the future
03:40:11 SQL> 
03:40:11 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.46
03:40:11 SQL> 
03:40:11 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
03:40:11   2  SELECT
03:40:11   3  p.tkrdate
03:40:11   4  ,p.tkr
03:40:11   5  ,p.ydate
03:40:11   6  ,p.clse
03:40:11   7  ,p.selldate
03:40:11   8  ,f.clse clse2
03:40:11   9  ,f.clse - p.clse gain1day
03:40:11  10  FROM di5min_stk_fd p, di5min_stk f
03:40:11  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
03:40:11  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
03:40:11  13  /

Table created.

Elapsed: 00:00:13.05
03:40:24 SQL> 
03:40:24 SQL> -- rpt
03:40:24 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	181518
mon	157056
tue	177841
thu	180465
wed	177563

Elapsed: 00:00:00.53
03:40:25 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	181518
mon	157056
tue	177841
thu	180465
wed	177563

Elapsed: 00:00:02.56
03:40:27 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-03-21 23:55:00

Elapsed: 00:00:00.07
03:40:27 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-03-21 23:55:00

Elapsed: 00:00:00.08
03:40:28 SQL> 
03:40:28 SQL> -- rpt
03:40:28 SQL> SELECT
03:40:28   2  tkr
03:40:28   3  ,MIN(ydate)
03:40:28   4  ,COUNT(ydate)
03:40:28   5  ,MAX(ydate)
03:40:28   6  ,MIN(clse)
03:40:28   7  ,AVG(clse)
03:40:28   8  ,MAX(clse)
03:40:28   9  ,MAX(gain1day)
03:40:28  10  FROM di5min_stk_c2
03:40:28  11  GROUP BY tkr
03:40:28  12  ORDER BY tkr
03:40:28  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	200.725 337.901728     364.83	 145.278438
ABT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 39.115 46.6110876	49.11	     8.3225
ABX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  45.64 49.5238848	54.24	       2.14
ADBE	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   31.3 34.0723376	43.25	       1.51
AEM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   63.6 70.1374278	76.47	       3.74
AFL	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  48.59  56.649165	59.48	       3.71
AGU	2011-01-24 14:30:00	    3120 2011-03-21 19:55:00	  84.78 92.1020313	99.13	       4.71
AIG	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  35.17 44.4012281	62.47		4.8
AKAM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  34.85 43.6474099	52.47	       2.39
ALL	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  30.47 31.4244514	32.61		.83
AMGN	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  50.63 54.4406726	58.15	       1.92
AMT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  45.98 52.0685163	56.73	       1.86
AMX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  53.38 56.8876139	59.58	       1.74
AMZN	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 160.93 177.547589     191.55	       9.32
APA	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  110.8   120.7464     127.55	       5.98
APC	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   73.1 77.8532181	82.62	       4.12
ARG	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  60.86 63.0515911	64.67	       1.48
AXP	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  42.31 44.5996937	 46.9	       1.92
AXU	2011-01-21 14:30:00	    3198 2011-03-21 19:55:00	   5.88 7.69222795	 9.64	       1.07
BA	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  66.51 72.5102873    102.935	       2.85
BBT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	     26 27.5473772	29.55		1.3
BBY	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  30.76 33.6574593	36.18	       1.29
BEN	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 109.71 121.427652	130.6	       5.04
BHP	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  83.94 91.3517368	96.58	       3.18
BIDU	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  99.53 116.301287     131.27	      11.14
BP	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  42.55 47.7956531	64.49	       1.83
BRCM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  25.15  42.296219	47.32	  16.154375
BTU	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   57.7 64.0527159	   72	       5.41
BUCY	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  89.67 91.8043438    107.275	       2.47
CAT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  92.37 99.1133152     107.63	       3.79
CDE	2011-01-21 14:30:00	    3198 2011-03-21 19:55:00	  22.13 27.9712759	35.57		4.4
CELG	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  48.96 55.0964541     64.905	       2.45
CEO	2011-01-24 14:30:00	    3120 2011-03-21 19:55:00	 206.99 225.726688     243.28	      10.36
CHK	2011-01-24 14:30:00	    3120 2011-03-21 19:55:00	  27.24 31.8013138	35.83	       3.48
CLF	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  79.77 89.3784988	101.2	       8.31
CMI	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  94.36 106.637716     114.74	       6.52
COF	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  43.23  50.568183     70.685		2.8
COP	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  65.11 71.8825736	80.87	 11.4215625
COST	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  69.56 72.7410085	75.43	       3.55
CREE	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  45.75  54.416722	69.19	       2.89
CRM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 97.655  132.12561 146.866719	 47.6217188
CSX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  64.81  71.687558	78.22	       3.28
CTSH	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  70.72 75.1151333	78.66	       2.75
CVE	2011-02-14 14:30:00	    2492 2011-03-21 19:55:00	  34.32 37.3476285	40.98	     1.7525
CVS	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  32.13 33.8883774	35.94	       1.17
CVX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  90.21 97.3778031     105.18	       3.55
DD	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  47.28 51.8254822	56.16	 5.09311826
DE	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  81.82 90.2673167	97.03	       3.93
DIA	2009-10-28 18:10:00	   29126 2011-03-21 19:55:00	  96.34 108.521447     123.64	       4.35
DIS	2009-10-28 18:10:00	   28878 2011-03-21 19:55:00	  27.06 34.8258368	44.29	       3.13
DNDN	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  31.34 38.3084075     99.105	       2.92
DTV	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  40.79 43.7050345	 46.8		2.4
DVN	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  77.06 86.1704549	92.98	       4.67
EBAY	2009-10-28 18:10:00	   28907 2011-03-21 19:55:00	  19.17 25.6661478 47.5933333	       2.69
EFA	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   54.7 62.6592084     99.265	       2.16
EOG	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  91.02 104.157513     114.72	       6.61
ESRX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  51.25 56.0533596	58.74		2.2
EWZ	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  70.16 74.2397461	78.95	       2.02
EXK	2011-01-21 14:30:00	    3588 2011-03-21 23:55:00	    5.4 7.65105168	10.29	       1.46
FCX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  46.43 77.5667402     122.49	 48.3005005
FDX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  55.79 89.5025131	98.45	  31.839375
FFIV	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  95.33 119.679132     145.75	      11.02
FLS	2011-01-04 14:30:00	    4068 2011-03-21 19:55:00	   37.5 116.320143     132.49	   41.92375
FSLR	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 130.64 151.184002	  174	      12.54
GD	2011-01-28 14:30:00	    2808 2011-03-21 19:55:00 60.8145605  67.711052	 76.4	 6.88543945
GDX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  52.52  57.379413	 67.1	       2.31
GFI	2011-01-28 14:30:00	    2574 2011-03-21 19:55:00	  15.67 16.9263029	18.32		.79
GG	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  39.13 44.3148727	50.69	       2.69
GILD	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  36.51 38.9489043	41.77	       1.75
GLD	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	 84.125 131.613908     140.53	  52.591875
GOOG	2009-10-28 18:10:00	   28902 2011-03-21 19:55:00	329.525 551.387722     641.65	 261.864063
GS	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  153.4 165.121919	  175	       6.13
HD	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  34.09 36.6096002	38.94	       1.18
HES	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  76.16 81.4632617	87.02	       4.51
HL	2011-01-18 12:30:00	    3526 2011-03-21 19:55:00	   7.84 9.41870287	11.08		.85
HOC	2011-02-17 14:30:00	    1716 2011-03-21 19:55:00	  50.79 55.8953711	61.83	       5.16
HON	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  53.03 55.9847473	58.08	       2.27
HPQ	2009-10-28 18:10:00	   29043 2011-03-21 19:55:00	  37.45 46.4545375	 54.7		3.4
IBM	2009-10-28 18:10:00	   29018 2011-03-21 19:55:00	 119.59 135.666947     167.47	       6.28
IOC	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  66.18 73.2233003	   80	       4.58
IWM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  77.04 80.1719687	83.75	       2.49
JNJ	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   57.5 60.8948612	63.49	       1.77
JOYG	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	 73.075 89.6474221     100.55	 21.9322852
JPM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  42.77 45.3874683	48.27		2.5
JWN	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  40.03 43.3484593	47.49	       2.39
KO	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  61.35 64.5593993	79.42	       2.22
LFT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  28.04 32.4270995	   37	       4.03
LMT	2011-01-28 14:30:00	    2574 2011-03-21 19:55:00	  77.84 81.0060778	88.63	       2.23
MAR	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  36.61 39.6786717	42.58		1.5
MCD	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  72.15 74.8394444	77.23	       2.68
MDT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  36.18 38.4488041	41.32	       1.36
MDY	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 163.62 171.442626     178.79		4.5
MEE	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  52.03 60.1827395	   67	       9.93
MET	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  41.29   46.05958	48.71	       1.78
MJN	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  52.71 59.3617637	63.29	 6.94539063
MMM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  85.68 89.7415255	 94.1	       2.69
MON	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   65.2 71.8115853	76.13	       4.04
MOS	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  71.87 80.6925298	89.17	       6.34
MRK	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  31.07 33.4888486	 37.6		.83
MT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  32.43 36.5236652	41.21	       2.13
MVG	2011-01-21 14:30:00	    2963 2011-03-21 19:55:00	   9.25 10.9113905	13.35	       1.31
NEM	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  50.07 55.5858501	60.22	       2.12
NFLX	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  176.3 203.780984     240.85	      29.02
NOC	2011-01-28 14:30:00	    2574 2011-03-21 19:55:00	 62.335 67.4312305	 72.4	   4.690625
NUE	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  42.81 46.1365124	49.23	       2.14
OIH	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 135.78 152.769961     165.75	       8.52
ORCL	2011-03-01 14:30:00	    1170 2011-03-21 19:55:00	  29.63 31.8087772	33.17	       1.14
OXY	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  93.76 99.1313049     107.41	       3.94
PAAS	2011-01-21 14:30:00	    3198 2011-03-21 19:55:00	  31.13 35.6262517	40.53	       2.92
PALL	2011-01-21 14:30:00	    3198 2011-03-21 19:55:00	  68.75 79.2506056	85.33	       3.41
PBR	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  35.03 38.0419057	42.57		2.3
PEP	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  62.07 64.5399073	67.46	       1.56
PG	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  59.77  63.614558	66.94	       1.74
PM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  55.88 59.7962255	64.52	       1.84
PNC	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  59.75 62.1190034	65.14	       3.13
POT	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  50.49 121.928478     189.19	      13.11
PPLT	2011-01-21 14:30:00	    3195 2011-03-21 19:55:00	 167.76 178.381169     185.21	 11.7949186
PRU	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  56.82 62.6731872	67.47	       3.25
QCOM	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	   49.9 54.5094813	59.79	       3.54
QQQQ	2009-10-28 18:10:00	   29234 2011-03-21 19:55:00	   40.7 48.9631517	59.03		2.5

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
RDY	2011-01-24 14:30:00	    2808 2011-03-18 19:55:00	   32.6 34.5106944	36.62		1.9
RIG	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  69.12 79.3617545	85.94	       5.25
RIMM	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  58.31  64.695083     85.395	       3.93
RTN	2011-01-28 14:30:00	    2808 2011-03-21 19:55:00	  49.21 51.0676103	53.08	       1.65
SCCO	2011-01-24 14:30:00	    3120 2011-03-21 19:55:00	  38.12 42.9165316	47.56	       2.84
SINA	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  72.55 84.7767411	98.92		6.9
SJM	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	 52.045 64.4836626	72.43	  15.829375
SKX	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  17.87 20.8899936	23.65	       1.33
SLB	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  79.84 87.7730126	 95.1	       4.98
SLV	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  26.08  30.467553	35.73	       1.66
SLW	2011-01-21 14:30:00	    3198 2011-03-21 19:55:00	   28.9 37.4485904	46.34	       2.87
SNDK	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  41.11  48.927905	53.47		3.6
SOHU	2011-01-24 14:30:00	    3120 2011-03-21 19:55:00	  64.69  81.269849	90.25	       6.65
SPY	2009-10-28 18:10:00	   25465 2011-03-21 19:55:00	 103.18 117.725184     134.66		5.1
STT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   42.3 45.9855745	50.22		2.1
SU	2011-02-17 14:30:00	    1716 2011-03-21 19:55:00	  40.89 44.2710279 46.8599992	      2.315
SUN	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  38.49 42.5372268	50.69	       2.07
SVM	2011-01-21 14:30:00	    4207 2011-03-21 19:55:00	   9.41  12.364338	15.33		1.1
SWC	2011-01-19 14:30:00	    3120 2011-03-21 19:55:00	   19.5 22.8499939	25.88	       1.99
T	2011-02-04 14:30:00	    1404 2011-03-21 19:55:00	  20.58 35.1756343     53.766	 1.37690476
TEVA	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  47.33 52.0020223	56.96	       3.35
TGT	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  49.57 53.6372349	60.37	       1.99
TKR	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  43.44 49.1382476	52.67	    4.18875
TLT	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 74.605 90.2452381	94.55	 16.5532813
TSO	2011-02-17 14:30:00	    1716 2011-03-21 19:55:00	   22.4 24.3243663	26.62	       3.17
UNH	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  36.95 41.6678154	44.85	       2.23
UNP	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	 85.445 94.5578856	99.44	   7.436875
UPS	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  70.24  73.194244	76.97	       4.15
V	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00 42.5480164 61.4596197 79.2666571	 22.9764716
VALE	2011-01-24 14:30:00	    3120 2011-03-21 19:55:00	   30.7 34.0114699	36.36		1.3
VECO	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  42.58 47.2248738	53.12	       4.28
VLO	2011-02-17 14:30:00	    1716 2011-03-21 19:55:00	  25.97 27.9887032	30.42		2.5
VMW	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  74.39 86.3206052	95.94	 4.80213474
WDC	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  29.42 33.3858984	36.78	       5.73
WFMI	2011-01-04 14:30:00	    3900 2011-03-21 19:55:00	  47.85 54.9913835	62.11	       7.83
WHR	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	   79.2 84.7881206	92.05		3.8
WMT	2009-10-28 18:10:00	   28988 2011-03-21 19:55:00	  47.76  53.263601	57.85	       2.22
WYNN	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 109.66 120.768104     131.95	       9.74
X	2011-01-04 12:40:00	    4632 2011-03-21 19:55:00  35.304713 57.1174882	75.74	 15.8246652
XLB	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  36.57 38.7432682	40.72	       1.15
XLE	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	 66.775 72.9607499	79.13	 10.8921094
XLU	2011-01-04 14:30:00	    4134 2011-03-21 19:55:00	  30.75 31.8190861	32.89		.55
XOM	2009-10-28 18:10:00	   29263 2011-03-21 19:55:00	  56.05 68.5401843 86.5315885	 9.62822917

163 rows selected.

Elapsed: 00:00:00.67
03:40:28 SQL> 
03:40:28 SQL> COLUMN clse FORMAT 999.9999
03:40:28 SQL> SELECT
03:40:28   2  tkr
03:40:28   3  ,ROUND(clse,4)clse
03:40:28   4  -- Should be NULL:
03:40:28   5  ,ROUND(clse2,4)clse2
03:40:28   6  ,ydate
03:40:28   7  FROM di5min_stk_c2
03:40:28   8  WHERE ydate > sysdate - 0.5/24
03:40:28   9  ORDER BY tkr,ydate
03:40:28  10  /

no rows selected

Elapsed: 00:00:00.10
03:40:28 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
