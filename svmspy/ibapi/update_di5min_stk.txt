
SQL*Plus: Release 11.2.0.1.0 Production on Wed Jan 12 08:21:15 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

08:21:15 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
08:21:15 SQL> 08:21:15 SQL> --
08:21:15 SQL> -- update_di5min_stk.sql
08:21:15 SQL> --
08:21:15 SQL> 
08:21:15 SQL> -- I use this script to keep di5min_stk up to date.
08:21:15 SQL> 
08:21:15 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
08:21:15 SQL> -- After that date, it holds data from IB.
08:21:15 SQL> 
08:21:15 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
08:21:15 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
08:21:15 SQL> 
08:21:15 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.61
08:21:15 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.18
08:21:16 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.18
08:21:16 SQL> 
08:21:16 SQL> -- Copy in data from ibs5min:
08:21:16 SQL> 
08:21:16 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
08:21:16   2  SELECT	     tkr||ydate,tkr,ydate,clse
08:21:16   3  FROM ibs5min
08:21:16   4  WHERE ydate >= '2010-12-27 09:00:00'
08:21:16   5  /

19814 rows created.

Elapsed: 00:00:00.09
08:21:16 SQL> 
08:21:16 SQL> -- rpt
08:21:16 SQL> SELECT
08:21:16   2  tkr
08:21:16   3  ,MIN(ydate)
08:21:16   4  ,COUNT(tkr)
08:21:16   5  ,MAX(ydate)
08:21:16   6  FROM di5min_stk0
08:21:16   7  GROUP BY tkr
08:21:16   8  ORDER BY tkr
08:21:16   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
DIA	2010-12-27 09:00:00	  2043 2011-01-11 20:55:00
DIS	2010-12-27 09:00:00	  1795 2011-01-11 21:30:00
EBAY	2010-12-27 09:00:00	  1812 2011-01-11 20:50:00
GOOG	2010-12-27 09:00:00	  1935 2011-01-11 21:00:00
HPQ	2010-12-27 09:00:00	  1960 2011-01-11 21:25:00
IBM	2010-12-27 09:00:00	  1935 2011-01-11 21:15:00
QQQQ	2010-12-27 09:00:00	  2151 2011-01-11 21:20:00
SPY	2010-12-27 09:00:00	  2175 2011-01-11 21:00:00
WMT	2010-12-27 09:00:00	  1917 2011-01-12 00:55:00
XOM	2010-12-27 09:00:00	  2091 2011-01-12 00:55:00

10 rows selected.

Elapsed: 00:00:00.02
08:21:16 SQL> 
08:21:16 SQL> -- Next, copy in data from dukas.
08:21:16 SQL> -- dukas5min_stk depends on:
08:21:16 SQL> -- - dukas10min_stk
08:21:16 SQL> -- - svmspy/dukas/fake5.sql
08:21:16 SQL> 
08:21:16 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
08:21:16   2  SELECT	     tkr||ydate,tkr,ydate,clse
08:21:16   3  FROM dukas5min_stk
08:21:16   4  WHERE ydate < '2010-12-27 09:00:00'
08:21:16   5  /

230382 rows created.

Elapsed: 00:00:00.36
08:21:16 SQL> 
08:21:16 SQL> -- rpt
08:21:16 SQL> SELECT
08:21:16   2  tkr
08:21:16   3  ,MIN(ydate)
08:21:16   4  ,COUNT(tkr)
08:21:16   5  ,MAX(ydate)
08:21:16   6  FROM dukas5min_stk
08:21:16   7  WHERE ydate < '2010-12-27 09:00:00'
08:21:16   8  GROUP BY tkr
08:21:16   9  ORDER BY tkr
08:21:16  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
DIS	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
EBAY	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
GOOG	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
HPQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
IBM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
QQQQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
SPY	 2009-10-28 18:10:01	  19521 2010-12-24 20:50:01
WMT	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
XOM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01

10 rows selected.

Elapsed: 00:00:00.08
08:21:16 SQL> 
08:21:16 SQL> -- rpt
08:21:16 SQL> SELECT
08:21:16   2  tkr
08:21:16   3  ,MIN(ydate)
08:21:16   4  ,COUNT(tkr)
08:21:16   5  ,MAX(ydate)
08:21:16   6  FROM di5min_stk0
08:21:16   7  GROUP BY tkr
08:21:16   8  ORDER BY tkr
08:21:16   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
DIA	2009-10-28 18:10:01	 25472 2011-01-11 20:55:00
DIS	2009-10-28 18:10:01	 25224 2011-01-11 21:30:00
EBAY	2009-10-28 18:10:01	 25241 2011-01-11 20:50:00
GOOG	2009-10-28 18:10:01	 25364 2011-01-11 21:00:00
HPQ	2009-10-28 18:10:01	 25389 2011-01-11 21:25:00
IBM	2009-10-28 18:10:01	 25364 2011-01-11 21:15:00
QQQQ	2009-10-28 18:10:01	 25580 2011-01-11 21:20:00
SPY	2009-10-28 18:10:01	 21696 2011-01-11 21:00:00
WMT	2009-10-28 18:10:01	 25346 2011-01-12 00:55:00
XOM	2009-10-28 18:10:01	 25520 2011-01-12 00:55:00

10 rows selected.

Elapsed: 00:00:00.08
08:21:16 SQL> 
08:21:16 SQL> CREATE TABLE di5min_stk COMPRESS AS
08:21:16   2  SELECT
08:21:16   3  tkrdate
08:21:16   4  ,tkr
08:21:16   5  ,ydate
08:21:16   6  ,AVG(clse)clse
08:21:16   7  FROM di5min_stk0
08:21:16   8  GROUP BY
08:21:16   9  tkrdate
08:21:16  10  ,tkr
08:21:16  11  ,ydate
08:21:16  12  /

Table created.

Elapsed: 00:00:00.86
08:21:17 SQL> 
08:21:17 SQL> -- rpt
08:21:17 SQL> SELECT
08:21:17   2  tkr
08:21:17   3  ,MIN(ydate)
08:21:17   4  ,COUNT(ydate)
08:21:17   5  ,MAX(ydate)
08:21:17   6  ,MIN(clse)
08:21:17   7  ,AVG(clse)
08:21:17   8  ,MAX(clse)
08:21:17   9  FROM di5min_stk
08:21:17  10  GROUP BY tkr
08:21:17  11  ORDER BY tkr
08:21:17  12  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE)
------- ------------------- ------------ ------------------- ---------- ---------- ----------
DIA	2009-10-28 18:10:01	   25472 2011-01-11 20:55:00	  96.34 106.839169     117.39
DIS	2009-10-28 18:10:01	   25224 2011-01-11 21:30:00	  27.06 33.8501149	   40
EBAY	2009-10-28 18:10:01	   25241 2011-01-11 20:50:00	  19.17 24.6127495	31.48
GOOG	2009-10-28 18:10:01	   25364 2011-01-11 21:00:00	  434.6  547.30096     629.82
HPQ	2009-10-28 18:10:01	   25389 2011-01-11 21:25:00	  37.45 46.6321499	 54.7
IBM	2009-10-28 18:10:01	   25364 2011-01-11 21:15:00	 119.59  132.12289     150.76
QQQQ	2009-10-28 18:10:01	   25580 2011-01-11 21:20:00	   40.7 47.8190003	56.37
SPY	2009-10-28 18:10:01	   21696 2011-01-11 21:00:00	 103.18 115.491215     128.04
WMT	2009-10-28 18:10:01	   25346 2011-01-12 00:55:00	  47.76 53.1252492	56.15
XOM	2009-10-28 18:10:01	   25520 2011-01-12 00:55:00	  56.05  66.679039	 76.5

10 rows selected.

Elapsed: 00:00:00.19
08:21:17 SQL> 
08:21:17 SQL> COLUMN clse FORMAT 999.9999
08:21:17 SQL> SELECT
08:21:17   2  tkr
08:21:17   3  ,ROUND(clse,4)clse
08:21:17   4  ,ydate
08:21:17   5  FROM di5min_stk
08:21:17   6  WHERE ydate > sysdate - 0.5/24
08:21:17   7  ORDER BY tkr,ydate
08:21:17   8  /

no rows selected

Elapsed: 00:00:00.02
08:21:17 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
