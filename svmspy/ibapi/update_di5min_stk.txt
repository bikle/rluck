
SQL*Plus: Release 11.2.0.1.0 Production on Thu May 19 22:32:18 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

22:32:18 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
22:32:18 SQL> 
22:32:18 SQL> 22:32:18 SQL> --
22:32:18 SQL> -- update_di5min_stk.sql
22:32:18 SQL> --
22:32:18 SQL> 
22:32:18 SQL> -- I use this script to keep di5min_stk up to date.
22:32:18 SQL> 
22:32:18 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
22:32:18 SQL> -- After that date, it holds data from IB.
22:32:18 SQL> 
22:32:18 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
22:32:18 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
22:32:18 SQL> 
22:32:18 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.59
22:32:19 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.06
22:32:19 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.08
22:32:19 SQL> 
22:32:19 SQL> 
22:32:19 SQL> -- I need to shave a second off of some of the dates:
22:32:19 SQL> 
22:32:19 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
22:32:19   2  WHERE TO_CHAR(ydate,'SS')='01'
22:32:19   3  /

0 rows updated.

Elapsed: 00:00:00.97
22:32:20 SQL> 
22:32:20 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
   1116737

Elapsed: 00:00:00.02
22:32:20 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
   1116737

Elapsed: 00:00:00.48
22:32:20 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.33
22:32:20 SQL> 
22:32:20 SQL> -- Remove data which is outside of RTH:
22:32:20 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') < '14:30'AND ydate < '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.40
22:32:21 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') > '20:55'AND ydate < '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.49
22:32:21 SQL> -- Daylight savings time started on 2011-03-14:
22:32:21 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') < '13:30'AND ydate > '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.29
22:32:22 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') > '19:55'AND ydate > '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.28
22:32:22 SQL> 
22:32:22 SQL> 
22:32:22 SQL> -- Copy in data from ibs5min:
22:32:22 SQL> 
22:32:22 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
22:32:22   2  SELECT	     tkr||ydate,tkr,ydate,clse
22:32:22   3  FROM ibs5min
22:32:22   4  WHERE ydate >= '2010-12-27 09:00:00'
22:32:22   5  /

1116737 rows created.

Elapsed: 00:00:02.58
22:32:25 SQL> 
22:32:25 SQL> -- rpt
22:32:25 SQL> SELECT
22:32:25   2  tkr
22:32:25   3  ,MIN(ydate)
22:32:25   4  ,COUNT(tkr)
22:32:25   5  ,MAX(ydate)
22:32:25   6  FROM di5min_stk0
22:32:25   7  GROUP BY tkr
22:32:25   8  ORDER BY tkr
22:32:25   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
ABT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
ABX	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
ACI	2011-04-19 13:30:00	  1638 2011-05-18 19:55:00
ADBE	2011-01-04 14:30:00	  7081 2011-05-19 18:30:00
ADM	2011-04-28 13:30:00	  1230 2011-05-19 18:25:00
AEM	2011-01-04 14:30:00	  7080 2011-05-19 18:25:00
AFL	2011-01-04 14:30:00	  7080 2011-05-19 18:25:00
AGU	2011-01-24 14:30:00	  6066 2011-05-19 18:25:00
AIG	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AKAM	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
ALL	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AMGN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AMT	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AMX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AMZN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
APA	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
APC	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
ARG	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AU	2011-05-05 13:30:00	   858 2011-05-19 19:55:00
AUY	2011-05-05 13:30:00	   858 2011-05-19 19:55:00
AXP	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AXU	2011-01-21 14:30:00	  6162 2011-05-19 19:55:00
BA	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BBT	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BBY	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BEN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BHP	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BIDU	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BP	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BRCM	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BTU	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BUCY	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
C	2011-05-09 13:30:00	   702 2011-05-19 19:55:00
CAT	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CDE	2011-01-21 14:30:00	  6162 2011-05-19 19:55:00
CELG	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CEO	2011-01-24 14:30:00	  6084 2011-05-19 19:55:00
CHK	2011-01-24 14:30:00	  6084 2011-05-19 19:55:00
CLF	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CMI	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
COF	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
COP	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
COST	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CREE	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CRM	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CSCO	2011-04-28 13:30:00	  1248 2011-05-19 19:55:00
CSX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CTSH	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CVE	2011-02-14 14:30:00	  4914 2011-05-19 19:55:00
CVS	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CVX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DD	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DE	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DIA	2010-12-27 14:30:00	  7566 2011-05-19 19:55:00
DIS	2010-12-27 14:30:00	  7566 2011-05-19 19:55:00
DNDN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DOW	2011-05-09 13:30:00	   702 2011-05-19 19:55:00
DTV	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DVN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
EBAY	2010-12-27 14:30:00	  7358 2011-05-19 19:55:00
EFA	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
EGO	2011-05-05 13:30:00	   858 2011-05-19 19:55:00
EOG	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
ESRX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
EWZ	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
EXK	2011-01-21 14:30:00	  6162 2011-05-19 19:55:00
FCX	2011-02-02 14:30:00	  5538 2011-05-19 19:55:00
FDX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
FFIV	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
FLS	2011-01-04 14:30:00	  6864 2011-05-19 19:55:00
FSLR	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
FXI	2011-04-06 13:30:00	  2418 2011-05-19 19:55:00
GD	2011-04-18 13:30:00	  1794 2011-05-19 19:55:00
GDX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
GFI	2011-01-28 14:30:00	  5538 2011-05-19 19:55:00
GG	2011-01-04 14:30:00	  6864 2011-05-19 19:55:00
GILD	2011-01-04 14:30:00	  6864 2011-05-19 19:55:00
GLD	2011-01-04 14:30:00	  6864 2011-05-19 19:55:00
GOOG	2010-12-27 14:30:00	  7331 2011-05-19 19:50:00
GS	2011-01-04 14:30:00	  7097 2011-05-19 19:50:00
HAL	2011-04-08 13:30:00	  2261 2011-05-19 19:50:00
HD	2011-01-04 14:30:00	  7097 2011-05-19 19:50:00
HES	2011-01-04 14:30:00	  7097 2011-05-19 19:50:00
HL	2011-01-18 14:30:00	  6233 2011-05-19 19:20:00
HMY	2011-05-05 13:30:00	   851 2011-05-19 19:20:00
HOC	2011-02-17 14:30:00	  4673 2011-05-19 19:20:00
HON	2011-01-04 14:30:00	  7091 2011-05-19 19:20:00
HPQ	2010-12-27 14:30:00	  7559 2011-05-19 19:20:00
IAG	2011-05-05 13:30:00	   851 2011-05-19 19:20:00
IBM	2010-12-27 14:30:00	  7559 2011-05-19 19:20:00
IOC	2011-01-04 14:30:00	  7091 2011-05-19 19:20:00
IWM	2011-01-04 14:30:00	  7091 2011-05-19 19:20:00
IYR	2011-05-09 13:30:00	   694 2011-05-19 19:15:00
JCP	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
JNJ	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
JOYG	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
JPM	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
JWN	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
KO	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
LFT	2011-01-04 14:30:00	  6864 2011-05-16 19:55:00
LLY	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
LMT	2011-01-28 14:30:00	  5460 2011-05-18 19:55:00
LVS	2011-04-13 13:30:00	  1950 2011-05-18 19:55:00
MA	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
MAR	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MCD	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
MDT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MDY	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MEE	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
MET	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MJN	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
MMM	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MON	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MOS	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MRK	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MRO	2011-04-19 13:30:00	  1638 2011-05-18 19:55:00
MSFT	2011-04-15 13:30:00	  1794 2011-05-18 19:55:00
MT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MVG	2011-01-21 14:30:00	  5849 2011-05-18 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
NEM	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
NFLX	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
NOC	2011-01-28 14:30:00	  5460 2011-05-18 19:55:00
NUE	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
NVDA	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
OIH	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
ORCL	2011-03-01 14:30:00	  4368 2011-05-18 19:55:00
OXY	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PAAS	2011-01-21 14:30:00	  6084 2011-05-18 19:55:00
PALL	2011-01-21 14:30:00	  6084 2011-05-18 19:55:00
PBR	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PEP	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PG	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PM	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PNC	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
POT	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
PPLT	2011-01-21 14:30:00	  6079 2011-05-18 19:55:00
PRU	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
QCOM	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
QQQ	2010-12-27 14:30:00	  7488 2011-05-18 19:55:00
RDY	2011-01-24 14:30:00	  5772 2011-05-18 19:55:00
RIG	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
RIMM	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
RTN	2011-01-28 14:30:00	  5694 2011-05-18 19:55:00
SBUX	2011-04-26 13:30:00	  1326 2011-05-18 19:55:00
SCCO	2011-01-24 14:30:00	  6006 2011-05-18 19:55:00
SINA	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
SJM	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
SKX	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SLB	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SLV	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SLW	2011-01-21 14:30:00	  6084 2011-05-18 19:55:00
SNDK	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SOHU	2011-01-24 14:30:00	  6006 2011-05-18 19:55:00
SPY	2010-12-27 14:30:00	  7488 2011-05-18 19:55:00
STT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SU	2011-04-18 13:30:00	  1716 2011-05-18 19:55:00
SUN	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SVM	2011-01-21 14:30:00	  6084 2011-05-18 19:55:00
SWC	2011-01-19 14:30:00	  6006 2011-05-18 19:55:00
T	2011-04-19 13:30:00	  1638 2011-05-18 19:55:00
TEVA	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
TGT	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
TKR	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
TLT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
TSO	2011-02-17 14:30:00	  4602 2011-05-18 19:55:00
TXN	2011-04-11 13:30:00	  2106 2011-05-18 19:55:00
UNH	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
UNP	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
UPS	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
V	2011-04-19 13:30:00	  1638 2011-05-18 19:55:00
VALE	2011-01-24 14:30:00	  6006 2011-05-18 19:55:00
VECO	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
VLO	2011-02-17 14:30:00	  4602 2011-05-18 19:55:00
VMW	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
VZ	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
WAG	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
WDC	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
WFC	2011-04-13 13:30:00	  1950 2011-05-18 19:55:00
WFM	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
WHR	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
WMT	2010-12-27 14:30:00	  7488 2011-05-18 19:55:00
WYNN	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
X	2011-04-18 13:30:00	  1716 2011-05-18 19:55:00
XLB	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
XLE	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
XLU	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
XOM	2010-12-27 14:30:00	  7332 2011-05-18 19:55:00
YUM	2011-04-12 13:30:00	  2028 2011-05-18 19:55:00

189 rows selected.

Elapsed: 00:00:00.45
22:32:25 SQL> 
22:32:25 SQL> -- Next, copy in data from dukas.
22:32:25 SQL> -- dukas5min_stk depends on:
22:32:25 SQL> -- - dukas10min_stk
22:32:25 SQL> -- - svmspy/dukas/fake5.sql
22:32:25 SQL> 
22:32:25 SQL> 
22:32:25 SQL> -- I need to shave a second off of some of the dates:
22:32:25 SQL> 
22:32:25 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
22:32:25   2  WHERE TO_CHAR(ydate,'SS')='01'
22:32:25   3  /

0 rows updated.

Elapsed: 00:00:00.27
22:32:25 SQL> 
22:32:25 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.00
22:32:25 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.08
22:32:25 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.07
22:32:25 SQL> 
22:32:25 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
22:32:25   2  SELECT	     tkr||ydate,tkr,ydate,clse
22:32:25   3  FROM dukas5min_stk
22:32:25   4  WHERE ydate < '2010-12-27 09:00:00'
22:32:25   5  /

230382 rows created.

Elapsed: 00:00:00.56
22:32:26 SQL> 
22:32:26 SQL> -- rpt
22:32:26 SQL> SELECT
22:32:26   2  tkr
22:32:26   3  ,MIN(ydate)
22:32:26   4  ,COUNT(tkr)
22:32:26   5  ,MAX(ydate)
22:32:26   6  FROM dukas5min_stk
22:32:26   7  WHERE ydate < '2010-12-27 09:00:00'
22:32:26   8  GROUP BY tkr
22:32:26   9  ORDER BY tkr
22:32:26  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.08
22:32:26 SQL> 
22:32:26 SQL> -- rpt
22:32:26 SQL> SELECT
22:32:26   2  tkr
22:32:26   3  ,MIN(ydate)
22:32:26   4  ,COUNT(tkr)
22:32:26   5  ,MAX(ydate)
22:32:26   6  FROM di5min_stk0
22:32:26   7  GROUP BY tkr
22:32:26   8  ORDER BY tkr
22:32:26   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
ABT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
ABX	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
ACI	2011-04-19 13:30:00	  1638 2011-05-18 19:55:00
ADBE	2011-01-04 14:30:00	  7081 2011-05-19 18:30:00
ADM	2011-04-28 13:30:00	  1230 2011-05-19 18:25:00
AEM	2011-01-04 14:30:00	  7080 2011-05-19 18:25:00
AFL	2011-01-04 14:30:00	  7080 2011-05-19 18:25:00
AGU	2011-01-24 14:30:00	  6066 2011-05-19 18:25:00
AIG	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AKAM	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
ALL	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AMGN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AMT	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AMX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AMZN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
APA	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
APC	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
ARG	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AU	2011-05-05 13:30:00	   858 2011-05-19 19:55:00
AUY	2011-05-05 13:30:00	   858 2011-05-19 19:55:00
AXP	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
AXU	2011-01-21 14:30:00	  6162 2011-05-19 19:55:00
BA	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BBT	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BBY	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BEN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BHP	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BIDU	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BP	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BRCM	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BTU	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
BUCY	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
C	2011-05-09 13:30:00	   702 2011-05-19 19:55:00
CAT	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CDE	2011-01-21 14:30:00	  6162 2011-05-19 19:55:00
CELG	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CEO	2011-01-24 14:30:00	  6084 2011-05-19 19:55:00
CHK	2011-01-24 14:30:00	  6084 2011-05-19 19:55:00
CLF	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CMI	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
COF	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
COP	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
COST	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CREE	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CRM	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CSCO	2011-04-28 13:30:00	  1248 2011-05-19 19:55:00
CSX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CTSH	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CVE	2011-02-14 14:30:00	  4914 2011-05-19 19:55:00
CVS	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
CVX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DD	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DE	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DIA	2009-10-28 18:10:00	 30995 2011-05-19 19:55:00
DIS	2009-10-28 18:10:00	 30995 2011-05-19 19:55:00
DNDN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DOW	2011-05-09 13:30:00	   702 2011-05-19 19:55:00
DTV	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
DVN	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
EBAY	2009-10-28 18:10:00	 30787 2011-05-19 19:55:00
EFA	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
EGO	2011-05-05 13:30:00	   858 2011-05-19 19:55:00
EOG	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
ESRX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
EWZ	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
EXK	2011-01-21 14:30:00	  6162 2011-05-19 19:55:00
FCX	2011-02-02 14:30:00	  5538 2011-05-19 19:55:00
FDX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
FFIV	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
FLS	2011-01-04 14:30:00	  6864 2011-05-19 19:55:00
FSLR	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
FXI	2011-04-06 13:30:00	  2418 2011-05-19 19:55:00
GD	2011-04-18 13:30:00	  1794 2011-05-19 19:55:00
GDX	2011-01-04 14:30:00	  7098 2011-05-19 19:55:00
GFI	2011-01-28 14:30:00	  5538 2011-05-19 19:55:00
GG	2011-01-04 14:30:00	  6864 2011-05-19 19:55:00
GILD	2011-01-04 14:30:00	  6864 2011-05-19 19:55:00
GLD	2011-01-04 14:30:00	  6864 2011-05-19 19:55:00
GOOG	2009-10-28 18:10:00	 30760 2011-05-19 19:50:00
GS	2011-01-04 14:30:00	  7097 2011-05-19 19:50:00
HAL	2011-04-08 13:30:00	  2261 2011-05-19 19:50:00
HD	2011-01-04 14:30:00	  7097 2011-05-19 19:50:00
HES	2011-01-04 14:30:00	  7097 2011-05-19 19:50:00
HL	2011-01-18 14:30:00	  6233 2011-05-19 19:20:00
HMY	2011-05-05 13:30:00	   851 2011-05-19 19:20:00
HOC	2011-02-17 14:30:00	  4673 2011-05-19 19:20:00
HON	2011-01-04 14:30:00	  7091 2011-05-19 19:20:00
HPQ	2009-10-28 18:10:00	 30988 2011-05-19 19:20:00
IAG	2011-05-05 13:30:00	   851 2011-05-19 19:20:00
IBM	2009-10-28 18:10:00	 30988 2011-05-19 19:20:00
IOC	2011-01-04 14:30:00	  7091 2011-05-19 19:20:00
IWM	2011-01-04 14:30:00	  7091 2011-05-19 19:20:00
IYR	2011-05-09 13:30:00	   694 2011-05-19 19:15:00
JCP	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
JNJ	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
JOYG	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
JPM	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
JWN	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
KO	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
LFT	2011-01-04 14:30:00	  6864 2011-05-16 19:55:00
LLY	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
LMT	2011-01-28 14:30:00	  5460 2011-05-18 19:55:00
LVS	2011-04-13 13:30:00	  1950 2011-05-18 19:55:00
MA	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
MAR	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MCD	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
MDT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MDY	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MEE	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
MET	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MJN	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
MMM	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MON	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MOS	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MRK	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MRO	2011-04-19 13:30:00	  1638 2011-05-18 19:55:00
MSFT	2011-04-15 13:30:00	  1794 2011-05-18 19:55:00
MT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
MVG	2011-01-21 14:30:00	  5849 2011-05-18 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
NEM	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
NFLX	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
NOC	2011-01-28 14:30:00	  5460 2011-05-18 19:55:00
NUE	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
NVDA	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
OIH	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
ORCL	2011-03-01 14:30:00	  4368 2011-05-18 19:55:00
OXY	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PAAS	2011-01-21 14:30:00	  6084 2011-05-18 19:55:00
PALL	2011-01-21 14:30:00	  6084 2011-05-18 19:55:00
PBR	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PEP	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PG	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PM	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
PNC	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
POT	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
PPLT	2011-01-21 14:30:00	  6079 2011-05-18 19:55:00
PRU	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
QCOM	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
QQQ	2010-12-27 14:30:00	  7488 2011-05-18 19:55:00
QQQQ	2009-10-28 18:10:00	 23429 2010-12-24 20:50:00
RDY	2011-01-24 14:30:00	  5772 2011-05-18 19:55:00
RIG	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
RIMM	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
RTN	2011-01-28 14:30:00	  5694 2011-05-18 19:55:00
SBUX	2011-04-26 13:30:00	  1326 2011-05-18 19:55:00
SCCO	2011-01-24 14:30:00	  6006 2011-05-18 19:55:00
SINA	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
SJM	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
SKX	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SLB	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SLV	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SLW	2011-01-21 14:30:00	  6084 2011-05-18 19:55:00
SNDK	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SOHU	2011-01-24 14:30:00	  6006 2011-05-18 19:55:00
SPY	2009-10-28 18:10:00	 27009 2011-05-18 19:55:00
STT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SU	2011-04-18 13:30:00	  1716 2011-05-18 19:55:00
SUN	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
SVM	2011-01-21 14:30:00	  6084 2011-05-18 19:55:00
SWC	2011-01-19 14:30:00	  6006 2011-05-18 19:55:00
T	2011-04-19 13:30:00	  1638 2011-05-18 19:55:00
TEVA	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
TGT	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
TKR	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
TLT	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
TSO	2011-02-17 14:30:00	  4602 2011-05-18 19:55:00
TXN	2011-04-11 13:30:00	  2106 2011-05-18 19:55:00
UNH	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
UNP	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
UPS	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
V	2011-04-19 13:30:00	  1638 2011-05-18 19:55:00
VALE	2011-01-24 14:30:00	  6006 2011-05-18 19:55:00
VECO	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
VLO	2011-02-17 14:30:00	  4602 2011-05-18 19:55:00
VMW	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
VZ	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
WAG	2011-05-09 13:30:00	   624 2011-05-18 19:55:00
WDC	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
WFC	2011-04-13 13:30:00	  1950 2011-05-18 19:55:00
WFM	2011-01-04 14:30:00	  6786 2011-05-18 19:55:00
WHR	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
WMT	2009-10-28 18:10:00	 30917 2011-05-18 19:55:00
WYNN	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
X	2011-04-18 13:30:00	  1716 2011-05-18 19:55:00
XLB	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
XLE	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
XLU	2011-01-04 14:30:00	  7020 2011-05-18 19:55:00
XOM	2009-10-28 18:10:00	 30761 2011-05-18 19:55:00
YUM	2011-04-12 13:30:00	  2028 2011-05-18 19:55:00

190 rows selected.

Elapsed: 00:00:00.54
22:32:27 SQL> 
22:32:27 SQL> CREATE TABLE di5min_stk COMPRESS AS
22:32:27   2  SELECT
22:32:27   3  tkrdate
22:32:27   4  ,tkr
22:32:27   5  ,ydate
22:32:27   6  ,AVG(clse)clse
22:32:27   7  FROM di5min_stk0
22:32:27   8  -- I want weekdays:
22:32:27   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
22:32:27  10  GROUP BY
22:32:27  11  tkrdate
22:32:27  12  ,tkr
22:32:27  13  ,ydate
22:32:27  14  /

Table created.

Elapsed: 00:00:07.13
22:32:34 SQL> 
22:32:34 SQL> -- rpt
22:32:34 SQL> SELECT
22:32:34   2  TO_CHAR(ydate,'dy')
22:32:34   3  ,COUNT(ydate)
22:32:34   4  FROM di5min_stk
22:32:34   5  GROUP BY TO_CHAR(ydate,'dy')
22:32:34   6  /

TO_ COUNT(YDATE)
--- ------------
fri	  256177
mon	  258492
tue	  278392
wed	  278931
thu	  275127

Elapsed: 00:00:02.81
22:32:36 SQL> 
22:32:36 SQL> -- I need to shave a second off of some of the dates:
22:32:36 SQL> --
22:32:36 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
22:32:36 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
22:32:36 SQL> -- /
22:32:36 SQL> --
22:32:36 SQL> -- SELECT COUNT(*)FROM di5min_stk;
22:32:36 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
22:32:36 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
22:32:36 SQL> --
22:32:36 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
22:32:36 SQL> 
22:32:36 SQL> -- Add a column to help join with future dates
22:32:36 SQL> -- and then calculate 1 day gain:
22:32:36 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:00.03
22:32:37 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
22:32:37   2  SELECT
22:32:37   3  tkrdate
22:32:37   4  ,tkr
22:32:37   5  ,ydate
22:32:37   6  ,clse
22:32:37   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
22:32:37   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
22:32:37   9  	    ELSE NULL END selldate
22:32:37  10  FROM di5min_stk
22:32:37  11  /

Table created.

Elapsed: 00:00:05.06
22:32:42 SQL> 
22:32:42 SQL> -- Join with the future
22:32:42 SQL> 
22:32:42 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.07
22:32:42 SQL> 
22:32:42 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
22:32:42   2  SELECT
22:32:42   3  p.tkrdate
22:32:42   4  ,p.tkr
22:32:42   5  ,p.ydate
22:32:42   6  ,p.clse
22:32:42   7  ,p.selldate
22:32:42   8  ,f.clse clse2
22:32:42   9  ,f.clse - p.clse gain1day
22:32:42  10  FROM di5min_stk_fd p, di5min_stk f
22:32:42  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
22:32:42  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
22:32:42  13  /

Table created.

Elapsed: 00:00:11.35
22:32:53 SQL> 
22:32:53 SQL> -- rpt
22:32:53 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	256177
mon	258492
tue	278392
wed	278931
thu	275127

Elapsed: 00:00:00.96
22:32:54 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	256177
mon	258492
tue	278392
wed	278931
thu	275127

Elapsed: 00:00:01.57
22:32:56 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-05-19 19:55:00

Elapsed: 00:00:00.16
22:32:56 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-05-19 19:55:00

Elapsed: 00:00:00.17
22:32:56 SQL> 
22:32:56 SQL> -- rpt
22:32:56 SQL> SELECT
22:32:56   2  tkr
22:32:56   3  ,MIN(ydate)
22:32:56   4  ,COUNT(ydate)
22:32:56   5  ,MAX(ydate)
22:32:56   6  ,MIN(clse)
22:32:56   7  ,AVG(clse)
22:32:56   8  ,MAX(clse)
22:32:56   9  ,MAX(gain1day)
22:32:56  10  FROM di5min_stk_c2
22:32:56  11  GROUP BY tkr
22:32:56  12  ORDER BY tkr
22:32:56  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	 320.68 344.652425     364.83	      13.64
ABT	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  45.09 48.9662515	54.22	       2.16
ABX	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  44.28 49.9259384	55.71	       3.42
ACI	2011-04-19 13:30:00	    1638 2011-05-18 19:55:00	  28.55 31.9661151	34.73	       1.26
ADBE	2011-01-04 14:30:00	    7081 2011-05-19 18:30:00	  30.82 33.6798324	35.96	       1.64
ADM	2011-04-28 13:30:00	    1230 2011-05-19 18:25:00	  31.13 33.7975689	37.21		.74
AEM	2011-01-04 14:30:00	    7080 2011-05-19 18:25:00	  60.46 67.9154071	76.47	       4.22
AFL	2011-01-04 14:30:00	    7080 2011-05-19 18:25:00	  48.59  55.239036	59.48	       4.07
AGU	2011-01-24 14:30:00	    6066 2011-05-19 18:25:00	  78.16 90.0340239	99.13	       4.71
AIG	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  29.28 38.7438288	62.47		4.8
AKAM	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  31.65 40.5480013	52.47	       3.01
ALL	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  30.47 31.7757691	34.35	       2.28
AMGN	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  51.39 55.2222582	61.38	       2.53
AMT	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  45.98 51.6964701	56.73	       2.44
AMX	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  49.29 56.2961408	59.58	       1.74
AMZN	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	 160.93 181.876127     206.21	      15.21
APA	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  110.8 123.204063     134.08	       5.98
APC	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  71.31 78.2873749	 85.5	       4.12
ARG	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  60.86  64.923125	69.82	       2.46
AU	2011-05-05 13:30:00	     858 2011-05-19 19:55:00	  43.34 45.1731352	46.91	       1.48
AUY	2011-05-05 13:30:00	     858 2011-05-19 19:55:00	  11.62 11.9502098	 12.3		.37
AXP	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  42.31 45.9750256	51.91	       1.92
AXU	2011-01-21 14:30:00	    6162 2011-05-19 19:55:00	   5.88 8.35305185	10.25	       1.07
BA	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  66.51  72.996585	 80.4	       3.47
BBT	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	   25.4 27.2349399	29.55		1.3
BBY	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  28.16  32.154601	36.18		1.8
BEN	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	 109.71 122.815213     130.71	       5.04
BHP	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  83.94 93.8616632     104.43	       3.59
BIDU	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  99.53 127.440218     154.87	      11.14
BP	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  42.31 46.0817317	49.38	       1.83
BRCM	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  32.98 40.5793476	47.32	       2.42
BTU	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  56.94 65.0329508	73.67	       5.41
BUCY	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  89.67 91.0026982 92.0759375		.24
C	2011-05-09 13:30:00	     702 2011-05-19 19:55:00	  41.01 42.3202279	44.75		.52
CAT	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  92.37  103.77617     115.83	       4.57
CDE	2011-01-21 14:30:00	    6162 2011-05-19 19:55:00	  22.13 29.8207616	37.46		3.7
CELG	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  48.96  55.802744	61.66	       2.45
CEO	2011-01-24 14:30:00	    6084 2011-05-19 19:55:00	 206.99 237.065763     271.74	      12.17
CHK	2011-01-24 14:30:00	    6084 2011-05-19 19:55:00	  27.24 32.0300949	35.83	       2.53
CLF	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  79.77 91.2199481     102.14	       8.31
CMI	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  94.36 108.545478     121.12	       9.16
COF	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  43.23 50.6798402	 56.2		3.5
COP	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  66.58 74.6247964	 81.7	       3.43
COST	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  69.56 75.0091883	83.87		3.6
CREE	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  38.57 48.9418354	69.19	       3.03
CRM	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	 117.84  133.46342     146.42	      12.14
CSCO	2011-04-28 13:30:00	    1248 2011-05-19 19:55:00	  16.34 17.2300689	17.97		.47
CSX	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  64.81  74.210693	80.23	       3.53
CTSH	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  70.72  76.994462	83.36	       3.64
CVE	2011-02-14 14:30:00	    4914 2011-05-19 19:55:00	  32.58 37.3050454	40.72		  2
CVS	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  32.29 34.9093955	 38.7	       1.42
CVX	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  90.21 101.118373     109.94	       3.65
DD	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  47.28 53.1869985	56.98	       1.91
DE	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  81.82 91.8128524	 99.8	       3.93
DIA	2009-10-28 18:10:00	   30995 2011-05-19 19:55:00	  96.34 109.806714	128.5	       4.35
DIS	2009-10-28 18:10:00	   30995 2011-05-19 19:55:00	  27.06 35.4409546	44.29	       3.13
DNDN	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  31.34 36.5185112	 43.8	       3.89
DOW	2011-05-09 13:30:00	     702 2011-05-19 19:55:00	  36.48 38.4780271	   41		1.2
DTV	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  40.79 45.4094236	50.64	       1.78
DVN	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  77.06 86.9111867	93.42	       4.67
EBAY	2009-10-28 18:10:00	   30787 2011-05-19 19:55:00	  19.17 26.0316388	 35.3	       2.69
EFA	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	   54.7 60.3869154	64.34	       2.16
EGO	2011-05-05 13:30:00	     858 2011-05-19 19:55:00	  14.78 15.6206367	16.66		.87
EOG	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  91.02 107.297433     120.99		8.1
ESRX	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  51.25 56.3850581	60.76	       3.09
EWZ	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  70.16 75.1495327	80.07		2.6
EXK	2011-01-21 14:30:00	    6162 2011-05-19 19:55:00	    5.4 9.03705108	12.73	       1.56
FCX	2011-02-02 14:30:00	    5538 2011-05-19 19:55:00	   46.1 52.9267997	58.66	       4.94
FDX	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  85.04  92.765592	98.45		3.9
FFIV	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  91.18 110.491053     145.75	      14.45
FLS	2011-01-04 14:30:00	    6864 2011-05-19 19:55:00	  112.9   124.9281     135.62	       5.86
FSLR	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	 122.99  145.59145	  174	      12.54
FXI	2011-04-06 13:30:00	    2418 2011-05-19 19:55:00	  42.81 44.7983603	 46.4	       1.18
GD	2011-04-18 13:30:00	    1794 2011-05-19 19:55:00	   70.5 73.3985503	75.18	       2.26
GDX	2011-01-04 14:30:00	    7098 2011-05-19 19:55:00	  52.52 58.0463669	64.14	       3.62
GFI	2011-01-28 14:30:00	    5538 2011-05-19 19:55:00	  15.13 16.9744186	18.69		.79
GG	2011-01-04 14:30:00	    6864 2011-05-19 19:55:00	  39.13 47.5953748	56.08	       4.45
GILD	2011-01-04 14:30:00	    6864 2011-05-19 19:55:00	  36.51 39.9630096	42.91	       1.83
GLD	2011-01-04 14:30:00	    6864 2011-05-19 19:55:00	 127.83 139.189627     153.46	       3.24
GOOG	2009-10-28 18:10:00	   30760 2011-05-19 19:50:00	  434.6 551.822138     641.65	      63.83
GS	2011-01-04 14:30:00	    7097 2011-05-19 19:50:00	 138.74 159.898167	  175	       6.13
HAL	2011-04-08 13:30:00	    2261 2011-05-19 19:50:00	   44.5 47.7701631	51.24	       2.73
HD	2011-01-04 14:30:00	    7097 2011-05-19 19:50:00	  34.09 36.9260385	38.49	       1.42
HES	2011-01-04 14:30:00	    7097 2011-05-19 19:50:00	  73.86 81.1428647	87.09		4.5
HL	2011-01-18 14:30:00	    6233 2011-05-19 19:20:00	   7.82 9.11517501	11.08		.85
HMY	2011-05-05 13:30:00	     851 2011-05-19 19:20:00	  12.96 13.5710253	14.33		.61
HOC	2011-02-17 14:30:00	    4673 2011-05-19 19:20:00	  50.79 58.2551003	66.41	       4.77
HON	2011-01-04 14:30:00	    7091 2011-05-19 19:20:00	  53.03 57.5676726	62.27	       2.29
HPQ	2009-10-28 18:10:00	   30988 2011-05-19 19:20:00	     36 45.9738673	 54.7		3.4
IAG	2011-05-05 13:30:00	     851 2011-05-19 19:20:00  18.500625 19.6242193	 20.7	       1.33
IBM	2009-10-28 18:10:00	   30988 2011-05-19 19:20:00	 119.59 138.297821     173.45	       6.28
IOC	2011-01-04 14:30:00	    7091 2011-05-19 19:20:00	   55.4 69.8469452	81.72	       4.58
IWM	2011-01-04 14:30:00	    7091 2011-05-19 19:20:00	  77.04 81.7372022	 86.7	       2.49
IYR	2011-05-09 13:30:00	     694 2011-05-19 19:15:00	  60.51 61.2616066	62.18		1.2
JCP	2011-05-09 13:30:00	     624 2011-05-18 19:55:00	  36.46 37.5732772	 40.5	       2.02
JNJ	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	   57.5 61.6768287	67.35	       2.51
JOYG	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  83.82 92.8933881     103.31	       6.04
JPM	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  42.77 45.3624554	48.27		2.5
JWN	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  40.03  44.594198	49.32	       2.39
KO	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  61.35 65.1186966	68.74	       2.22
LFT	2011-01-04 14:30:00	    6864 2011-05-16 19:55:00	  17.04 29.8624167	   37	       4.03
LLY	2011-05-09 13:30:00	     624 2011-05-18 19:55:00	   38.2  38.747516	 39.4		.72
LMT	2011-01-28 14:30:00	    5460 2011-05-18 19:55:00	  75.84 79.9976189	82.41	       2.23
LVS	2011-04-13 13:30:00	    1950 2011-05-18 19:55:00	  40.53 44.4549488	48.22		2.6
MA	2011-05-09 13:30:00	     624 2011-05-18 19:55:00	 274.96 279.847516     282.78		  6
MAR	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  33.65  37.868755	42.58	       1.63
MCD	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  72.15 76.0467086	81.49	       2.68
MDT	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  36.18 39.4189573	43.23	       1.36
MDY	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	 163.62 174.948449     184.92		4.5
MEE	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  52.03 62.4004775	 71.1	       9.93
MET	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  41.29 45.4915147	48.71	       2.17
MJN	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  55.29 60.7590696	68.44	       3.43
MMM	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  85.68 91.6971991	97.94	       2.82
MON	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  62.31 70.0154841	76.13	       4.04
MOS	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  66.27 78.1476456	89.17	       4.26
MRK	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  31.07 34.0793296	 37.6	 1.48993034
MRO	2011-04-19 13:30:00	    1638 2011-05-18 19:55:00	  49.11 51.7686148	54.26	       2.68
MSFT	2011-04-15 13:30:00	    1794 2011-05-18 19:55:00	  24.28 25.5210931	26.84	       1.03
MT	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  32.43 36.0311061	38.41	       2.13
MVG	2011-01-21 14:30:00	    5849 2011-05-18 19:55:00	   8.98 11.5494904	14.75		2.9

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
NEM	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  50.07 55.6767203 60.3845017	       2.83
NFLX	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  176.3 218.630102     253.46	      29.02
NOC	2011-01-28 14:30:00	    5460 2011-05-18 19:55:00	  59.93 65.6561013	 72.4	       2.25
NUE	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  42.18 45.8296092	49.23	       2.14
NVDA	2011-05-09 13:30:00	     624 2011-05-18 19:55:00	  17.14 18.9002244	20.49		.89
OIH	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	 135.78 154.431986     167.15	       8.52
ORCL	2011-03-01 14:30:00	    4368 2011-05-18 19:55:00	  29.63 33.5114803	36.46	       2.05
OXY	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  93.76 100.664997     117.67	      11.03
PAAS	2011-01-21 14:30:00	    6084 2011-05-18 19:55:00	  31.03 35.9178004	42.95	       3.49
PALL	2011-01-21 14:30:00	    6084 2011-05-18 19:55:00	  68.75 76.9889579	85.33	       3.41
PBR	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  32.77 37.8236047	42.57	       1.67
PEP	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  62.07 65.8681755	71.42	       2.03
PG	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  59.77 63.6518419	67.71	       1.75
PM	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  55.88 62.9353741	69.82	       1.94
PNC	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  59.75 62.3014791	65.14	       3.13
POT	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	   50.2 93.9270451     189.19	      13.11
PPLT	2011-01-21 14:30:00	    6079 2011-05-18 19:55:00	 167.76 178.346722     186.62	 11.7949186
PRU	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  56.82 62.3884304	67.47	       3.29
QCOM	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	   49.9  54.573388	59.79	       3.54
QQQ	2010-12-27 14:30:00	    7488 2011-05-18 19:55:00	  53.78 57.0287163	59.31	       1.69
QQQQ	2009-10-28 18:10:00	   23429 2010-12-24 20:50:00	   40.7 47.1419117	54.95		2.5
RDY	2011-01-24 14:30:00	    5772 2011-05-18 19:55:00	  32.68 36.0271186	39.37	       2.29
RIG	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  65.96 77.1441494	85.94	       5.25
RIMM	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	   42.8  58.435813	70.47	       3.93
RTN	2011-01-28 14:30:00	    5694 2011-05-18 19:55:00	  47.74 50.3082227	53.08	       1.65
SBUX	2011-04-26 13:30:00	    1326 2011-05-18 19:55:00	  34.88  36.309803	37.61	       1.43
SCCO	2011-01-24 14:30:00	    6006 2011-05-18 19:55:00	  33.36 40.1048305	47.56	       2.84
SINA	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  72.55 100.920864     146.39	      22.73
SJM	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  61.18 69.4312329	77.03	       3.08
SKX	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  17.53 20.2320435	23.65	       1.48
SLB	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  79.84 87.5526546	 95.1	       4.98
SLV	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  26.08 34.2355028	48.26	       4.21
SLW	2011-01-21 14:30:00	    6084 2011-05-18 19:55:00	   28.9 39.0834546	47.58	       3.06
SNDK	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  41.11 48.0735554	53.47		3.6
SOHU	2011-01-24 14:30:00	    6006 2011-05-18 19:55:00	  64.69 87.6275825	108.8	       9.31
SPY	2009-10-28 18:10:00	   27009 2011-05-18 19:55:00	 103.18 118.961114     137.15		5.1
STT	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	   42.3 45.9402617	50.22		2.1
SU	2011-04-18 13:30:00	    1716 2011-05-18 19:55:00	  38.82 42.8629492	46.96	       2.07
SUN	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  38.49 42.4444673	46.93	       2.07
SVM	2011-01-21 14:30:00	    6084 2011-05-18 19:55:00	   9.41 12.8697208	16.32	       1.21
SWC	2011-01-19 14:30:00	    6006 2011-05-18 19:55:00	  17.22 22.0219349	25.88	       1.88
T	2011-04-19 13:30:00	    1638 2011-05-18 19:55:00	  29.92 31.1716372	31.91		 .8
TEVA	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  44.87 50.5243716	56.96	       3.35
TGT	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  48.54 52.0842586	60.37	       2.01
TKR	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  44.57 50.6441559	 57.6	       4.83
TLT	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  88.19 91.9940513	96.57	       2.07
TSO	2011-02-17 14:30:00	    4602 2011-05-18 19:55:00	   22.4 25.5762561	28.66	       3.17
TXN	2011-04-11 13:30:00	    2106 2011-05-18 19:55:00	  33.93 35.0696486	35.97	       1.03
UNH	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  36.95 43.9982796	51.35	       3.99
UNP	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  91.04  96.977296     104.73	       3.77
UPS	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  70.24 73.3807052	76.97	       4.15
V	2011-04-19 13:30:00	    1638 2011-05-18 19:55:00	  75.17 78.9597528	81.18	       2.47
VALE	2011-01-24 14:30:00	    6006 2011-05-18 19:55:00	  29.29 33.1422382	36.36		1.3
VECO	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  42.58 48.4110298	55.36	       4.28
VLO	2011-02-17 14:30:00	    4602 2011-05-18 19:55:00	  25.62 28.1460587	31.05		2.5
VMW	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  74.39 87.0336894	99.02	      12.71
VZ	2011-05-09 13:30:00	     624 2011-05-18 19:55:00	  36.83 37.1970272	37.67		.56
WAG	2011-05-09 13:30:00	     624 2011-05-18 19:55:00	  42.63  44.139984	45.17		.99
WDC	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  29.42 35.6300594	41.77	       5.73
WFC	2011-04-13 13:30:00	    1950 2011-05-18 19:55:00	  27.71 28.9283388	31.43		 .9
WFM	2011-01-04 14:30:00	    6786 2011-05-18 19:55:00	  47.85 58.7828582	66.83	       7.83
WHR	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	   79.2 84.8715251	92.05	       3.97
WMT	2009-10-28 18:10:00	   30917 2011-05-18 19:55:00	  47.76 53.3035954	57.85	       2.22
WYNN	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	 109.66 128.701596     151.42	      11.22
X	2011-04-18 13:30:00	    1716 2011-05-18 19:55:00	  44.19 47.8059225	53.31	       3.07
XLB	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  36.57 39.1604949	41.17	       1.18
XLE	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  67.54 75.2707051	80.87	       2.54
XLU	2011-01-04 14:30:00	    7020 2011-05-18 19:55:00	  30.75 32.1272398	34.23		 .7
XOM	2009-10-28 18:10:00	   30761 2011-05-18 19:55:00	  56.05 69.7695736	87.98	       3.66
YUM	2011-04-12 13:30:00	    2028 2011-05-18 19:55:00	  49.67 52.9317773	55.62	       3.21

190 rows selected.

Elapsed: 00:00:01.13
22:32:57 SQL> 
22:32:57 SQL> COLUMN clse FORMAT 999.9999
22:32:57 SQL> SELECT
22:32:57   2  tkr
22:32:57   3  ,ROUND(clse,4)clse
22:32:57   4  -- Should be NULL:
22:32:57   5  ,ROUND(clse2,4)clse2
22:32:57   6  ,ydate
22:32:57   7  FROM di5min_stk_c2
22:32:57   8  WHERE ydate > sysdate - 0.5/24
22:32:57   9  ORDER BY tkr,ydate
22:32:57  10  /

no rows selected

Elapsed: 00:00:00.21
22:32:57 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
