
SQL*Plus: Release 11.2.0.1.0 Production on Wed Jan 12 09:11:48 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

09:11:48 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
09:11:48 SQL> 09:11:48 SQL> --
09:11:48 SQL> -- update_di5min_stk.sql
09:11:48 SQL> --
09:11:48 SQL> 
09:11:48 SQL> -- I use this script to keep di5min_stk up to date.
09:11:48 SQL> 
09:11:48 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
09:11:48 SQL> -- After that date, it holds data from IB.
09:11:48 SQL> 
09:11:48 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
09:11:48 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
09:11:48 SQL> 
09:11:48 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.71
09:11:48 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.21
09:11:49 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.20
09:11:49 SQL> 
09:11:49 SQL> -- Copy in data from ibs5min:
09:11:49 SQL> 
09:11:49 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
09:11:49   2  SELECT	     tkr||ydate,tkr,ydate,clse
09:11:49   3  FROM ibs5min
09:11:49   4  WHERE ydate >= '2010-12-27 09:00:00'
09:11:49   5  /

78145 rows created.

Elapsed: 00:00:00.20
09:11:49 SQL> 
09:11:49 SQL> -- rpt
09:11:49 SQL> SELECT
09:11:49   2  tkr
09:11:49   3  ,MIN(ydate)
09:11:49   4  ,COUNT(tkr)
09:11:49   5  ,MAX(ydate)
09:11:49   6  FROM di5min_stk0
09:11:49   7  GROUP BY tkr
09:11:49   8  ORDER BY tkr
09:11:49   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ABT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ABX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ADBE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AEM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AFL	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AIG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AKAM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ALL	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AMGN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AMT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AMX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AMZN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
APA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
APC	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ARG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AXP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BBT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BBY	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BEN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BHP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BIDU	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BRCM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BTU	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BUCY	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CAT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CELG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CLF	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CMI	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
COF	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
COP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
COST	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CREE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CRM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CSX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CTSH	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CVS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CVX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DIA	2010-12-27 09:00:00	  2043 2011-01-11 20:55:00
DIS	2010-12-27 09:00:00	  1795 2011-01-11 21:30:00
DNDN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DTV	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DVN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
EBAY	2010-12-27 09:00:00	  1812 2011-01-11 20:50:00
EFA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
EOG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ESRX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
EWZ	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FCX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FDX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FFIV	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FLS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FSLR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GDX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GILD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GLD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GOOG	2010-12-27 09:00:00	  2065 2011-01-12 00:55:00
GS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
HD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
HES	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
HON	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
HPQ	2010-12-27 09:00:00	  1960 2011-01-11 21:25:00
IBM	2010-12-27 09:00:00	  1935 2011-01-11 21:15:00
IOC	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
IWM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
JNJ	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
JOYG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
JPM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
JWN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
KO	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
LFT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MAR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MCD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MDT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MDY	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MEE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MET	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MJN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MMM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MON	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MOS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MRK	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
NEM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
NFLX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
NUE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
OIH	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
OXY	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PBR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PEP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PNC	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
POT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PRU	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
QCOM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
QQQQ	2010-12-27 09:00:00	  2151 2011-01-11 21:20:00
RIG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
RIMM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SINA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SJM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SKX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SLB	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SLV	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SNDK	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SPY	2010-12-27 09:00:00	  2302 2011-01-12 00:55:00
STT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SUN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
TEVA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
TGT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
TKR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
TLT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
UNH	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
UNP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
UPS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
VECO	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
VMW	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
WDC	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
WFMI	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
WHR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
WMT	2010-12-27 09:00:00	  1917 2011-01-12 00:55:00
WYNN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
X	2011-01-04 12:40:00	   978 2011-01-12 00:55:00
XLB	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
XLE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
XLU	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
XOM	2010-12-27 09:00:00	  2091 2011-01-12 00:55:00

133 rows selected.

Elapsed: 00:00:00.05
09:11:49 SQL> 
09:11:49 SQL> -- Next, copy in data from dukas.
09:11:49 SQL> -- dukas5min_stk depends on:
09:11:49 SQL> -- - dukas10min_stk
09:11:49 SQL> -- - svmspy/dukas/fake5.sql
09:11:49 SQL> 
09:11:49 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
09:11:49   2  SELECT	     tkr||ydate,tkr,ydate,clse
09:11:49   3  FROM dukas5min_stk
09:11:49   4  WHERE ydate < '2010-12-27 09:00:00'
09:11:49   5  /

230382 rows created.

Elapsed: 00:00:00.40
09:11:49 SQL> 
09:11:49 SQL> -- rpt
09:11:49 SQL> SELECT
09:11:49   2  tkr
09:11:49   3  ,MIN(ydate)
09:11:49   4  ,COUNT(tkr)
09:11:49   5  ,MAX(ydate)
09:11:49   6  FROM dukas5min_stk
09:11:49   7  WHERE ydate < '2010-12-27 09:00:00'
09:11:49   8  GROUP BY tkr
09:11:49   9  ORDER BY tkr
09:11:49  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
DIS	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
EBAY	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
GOOG	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
HPQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
IBM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
QQQQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
SPY	 2009-10-28 18:10:01	  19521 2010-12-24 20:50:01
WMT	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
XOM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01

10 rows selected.

Elapsed: 00:00:00.10
09:11:49 SQL> 
09:11:49 SQL> -- rpt
09:11:49 SQL> SELECT
09:11:49   2  tkr
09:11:49   3  ,MIN(ydate)
09:11:49   4  ,COUNT(tkr)
09:11:49   5  ,MAX(ydate)
09:11:49   6  FROM di5min_stk0
09:11:49   7  GROUP BY tkr
09:11:49   8  ORDER BY tkr
09:11:49   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ABT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ABX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ADBE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AEM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AFL	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AIG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AKAM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ALL	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AMGN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AMT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AMX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AMZN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
APA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
APC	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ARG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
AXP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BBT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BBY	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BEN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BHP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BIDU	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BRCM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BTU	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
BUCY	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CAT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CELG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CLF	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CMI	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
COF	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
COP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
COST	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CREE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CRM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CSX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CTSH	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CVS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
CVX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DIA	2009-10-28 18:10:01	 25472 2011-01-11 20:55:00
DIS	2009-10-28 18:10:01	 25224 2011-01-11 21:30:00
DNDN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DTV	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
DVN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
EBAY	2009-10-28 18:10:01	 25241 2011-01-11 20:50:00
EFA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
EOG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
ESRX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
EWZ	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FCX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FDX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FFIV	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FLS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
FSLR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GDX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GILD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GLD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
GOOG	2009-10-28 18:10:01	 25494 2011-01-12 00:55:00
GS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
HD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
HES	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
HON	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
HPQ	2009-10-28 18:10:01	 25389 2011-01-11 21:25:00
IBM	2009-10-28 18:10:01	 25364 2011-01-11 21:15:00
IOC	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
IWM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
JNJ	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
JOYG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
JPM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
JWN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
KO	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
LFT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MAR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MCD	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MDT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MDY	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MEE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MET	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MJN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MMM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MON	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MOS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MRK	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
MT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
NEM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
NFLX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
NUE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
OIH	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
OXY	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PBR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PEP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PNC	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
POT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
PRU	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
QCOM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
QQQQ	2009-10-28 18:10:01	 25580 2011-01-11 21:20:00
RIG	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
RIMM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SINA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SJM	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SKX	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SLB	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SLV	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SNDK	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SPY	2009-10-28 18:10:01	 21823 2011-01-12 00:55:00
STT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
SUN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
TEVA	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
TGT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
TKR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
TLT	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
UNH	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
UNP	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
UPS	2011-01-04 14:30:00	   468 2011-01-11 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
VECO	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
VMW	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
WDC	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
WFMI	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
WHR	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
WMT	2009-10-28 18:10:01	 25346 2011-01-12 00:55:00
WYNN	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
X	2011-01-04 12:40:00	   978 2011-01-12 00:55:00
XLB	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
XLE	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
XLU	2011-01-04 14:30:00	   468 2011-01-11 20:55:00
XOM	2009-10-28 18:10:01	 25520 2011-01-12 00:55:00

133 rows selected.

Elapsed: 00:00:00.12
09:11:50 SQL> 
09:11:50 SQL> CREATE TABLE di5min_stk COMPRESS AS
09:11:50   2  SELECT
09:11:50   3  tkrdate
09:11:50   4  ,tkr
09:11:50   5  ,ydate
09:11:50   6  ,AVG(clse)clse
09:11:50   7  FROM di5min_stk0
09:11:50   8  GROUP BY
09:11:50   9  tkrdate
09:11:50  10  ,tkr
09:11:50  11  ,ydate
09:11:50  12  /

Table created.

Elapsed: 00:00:01.08
09:11:51 SQL> 
09:11:51 SQL> -- rpt
09:11:51 SQL> SELECT
09:11:51   2  tkr
09:11:51   3  ,MIN(ydate)
09:11:51   4  ,COUNT(ydate)
09:11:51   5  ,MAX(ydate)
09:11:51   6  ,MIN(clse)
09:11:51   7  ,AVG(clse)
09:11:51   8  ,MAX(clse)
09:11:51   9  FROM di5min_stk
09:11:51  10  GROUP BY tkr
09:11:51  11  ORDER BY tkr
09:11:51  12  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE)
------- ------------------- ------------ ------------------- ---------- ---------- ----------
AAPL	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 328.28 335.686645	343.6
ABT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   47.7 48.1444017	48.76
ABX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  48.74 49.8419444	52.33
ADBE	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   31.3 32.1233761	33.17
AEM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  68.98 71.2416667	72.67
AFL	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  54.89 56.0502991	57.51
AIG	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  56.13 59.5069872	62.47
AKAM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  46.85 48.3760897	49.52
ALL	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   30.7 31.4903846	32.18
AMGN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  55.99     56.685	57.18
AMT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   50.1 50.8159402	52.16
AMX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   57.5 58.6122222	59.58
AMZN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 182.72 185.257244	188.4
APA	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  119.6  123.08265     125.32
APC	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   73.1 75.1590171	78.19
ARG	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  63.18    63.5875	63.92
AXP	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  43.29    44.5525	45.39
BA	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  66.51 68.4178205	69.94
BBT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	     26 26.7611111	27.67
BBY	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  34.65 35.3741239	36.18
BEN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 109.71 112.214658     117.06
BHP	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  87.68  89.505235	 92.7
BIDU	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  99.53 104.409252     107.21
BP	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   45.2 46.2276068	47.17
BRCM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  42.11 44.5510897	45.81
BTU	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	     61 62.3983547	65.57
BUCY	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  89.67 89.9224786	90.13
CAT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  92.37 93.7973718	94.67
CELG	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   56.3  58.615406	59.69
CLF	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  80.23 83.3911325	85.74
CMI	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 109.01 111.295385     113.59
COF	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  43.23 45.1131624	 46.6
COP	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  66.58 67.3352564	68.44
COST	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  70.07 71.0754274	72.43
CREE	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  65.69 67.4948504	68.66
CRM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 133.57 140.536538     144.69
CSX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  64.81  66.757094	68.47
CTSH	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   73.6 75.1751282	76.34
CVS	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  34.41 35.1372222	35.67
CVX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  90.21 91.1288675	92.29
DD	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  47.28 49.4823504	50.53
DE	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  81.82 84.2509615	86.59
DIA	2009-10-28 18:10:01	   25472 2011-01-11 20:55:00	  96.34 106.839174     117.39
DIS	2009-10-28 18:10:01	   25224 2011-01-11 21:30:00	  27.06 33.8501165	   40
DNDN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  34.93 36.4941667	38.85
DTV	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  40.79 41.4508333	42.15
DVN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  77.06  78.390406	80.85
EBAY	2009-10-28 18:10:01	   25241 2011-01-11 20:50:00	  19.17 24.6127495	31.48
EFA	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  56.77 57.7365171	 58.9
EOG	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  91.02 93.5469231	96.71
ESRX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  55.52 56.4006197	57.34
EWZ	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  75.21 76.8591667	78.61
FCX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  115.2 117.900192     121.93
FDX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  92.12 93.4349786	94.96
FFIV	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  131.7 138.030983     143.35
FLS	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  114.8 117.254316     120.98
FSLR	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 130.64 134.214551	138.4
GDX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  56.39 57.6104487	60.06
GG	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  42.59 43.5907906	44.84
GILD	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  36.51 37.2779701	37.78
GLD	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  133.2 134.195342     136.18
GOOG	2009-10-28 18:10:01	   25494 2011-01-12 00:55:00	  434.6 547.645711     629.82
GS	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 168.42 171.586603     174.44
HD	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  34.09 34.5851068	35.55
HES	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  77.11 78.7650855	 81.5
HON	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  53.03 54.0030983	54.61
HPQ	2009-10-28 18:10:01	   25389 2011-01-11 21:25:00	  37.45 46.6321508	 54.7
IBM	2009-10-28 18:10:01	   25364 2011-01-11 21:15:00	 119.59 132.122886     150.76
IOC	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  75.02 76.3954274	77.99
IWM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  77.55 78.8270726	79.72
JNJ	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  62.01 62.7472436	63.49
JOYG	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  84.65 87.3133761	   89
JPM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  42.77 43.9101282	44.93
JWN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  41.44 42.4637821	43.69
KO	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   62.6 63.2561752	65.04
LFT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  34.15 35.2651496	   37
MAR	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  40.17 41.0073077	   42
MCD	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  73.53 74.3720085	75.64
MDT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  36.18 36.5780769	37.34
MDY	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 163.62 165.725385     167.36
MEE	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  53.71 55.8236111	57.88
MET	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  45.07 45.9439957	46.84
MJN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  60.37 61.4512607	62.42
MMM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  85.68 86.8767308	88.33
MON	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  68.27 70.5882692	72.67
MOS	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  73.65  76.269188	78.64
MRK	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  35.88 36.8104487	 37.6
MT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  34.22 35.8791026	 38.2
NEM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   56.4 57.8943376	60.22
NFLX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  176.3 181.746432     190.78
NUE	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  42.81  43.977094	44.81
OIH	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 135.78 138.250214     141.45
OXY	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  94.33 96.2963248	 98.4
PBR	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  36.01 36.6586111	37.37
PEP	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  65.18 66.2391239	66.91
PG	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  63.75 64.4766026	65.05
PM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  55.88 57.3149145	58.93
PNC	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  60.16 61.5585256	63.11
POT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 153.56 163.332201     169.45
PRU	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  59.41 60.6464957	61.48
QCOM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   49.9  51.839188	52.97
QQQQ	2009-10-28 18:10:01	   25580 2011-01-11 21:20:00	   40.7 47.8190005	56.37
RIG	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  69.12 73.0389103	76.18
RIMM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  58.31  60.872906	63.61
SINA	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  72.55 76.7198077	83.33
SJM	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   62.2 63.0453419	63.93
SKX	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   19.3 20.1970513	20.98
SLB	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  79.84 81.4302991	83.67
SLV	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  27.95 28.5652778	29.59
SNDK	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  49.78 52.2043376	53.47
SPY	2009-10-28 18:10:01	   21823 2011-01-12 00:55:00	 103.18 115.559374     128.04
STT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  45.94 46.8422863	 47.7
SUN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  38.49 40.0573718	 41.6
TEVA	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  52.03 53.3396368	54.34
TGT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  54.39 56.5923504	60.37
TKR	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  48.64 49.7333761	51.12
TLT	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  91.05 92.2871154	93.74
UNH	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  36.95 38.0771795	 39.1
UNP	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	     92 94.5127137	97.95
UPS	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  71.37 72.3617521	73.06

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE)
------- ------------------- ------------ ------------------- ---------- ---------- ----------
V	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   70.3 72.0332265	 73.5
VECO	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  43.62 46.0122009	48.39
VMW	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  90.62 94.3021795	96.23
WDC	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  31.83 32.9006197	34.22
WFMI	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  47.85 48.7498291	49.92
WHR	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	   86.1 88.3419231	90.71
WMT	2009-10-28 18:10:01	   25346 2011-01-12 00:55:00	  47.76 53.1252503	56.15
WYNN	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	 109.66 115.503504     119.37
X	2011-01-04 12:40:00	     978 2011-01-12 00:55:00	  64.86 71.1184969	75.74
XLB	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  37.74 38.3874573	38.83
XLE	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  67.54 68.1750214	69.21
XLU	2011-01-04 14:30:00	     468 2011-01-11 20:55:00	  31.23 31.4338462	 31.7
XOM	2009-10-28 18:10:01	   25520 2011-01-12 00:55:00	  56.05 66.6790383	 76.5

133 rows selected.

Elapsed: 00:00:00.24
09:11:51 SQL> 
09:11:51 SQL> COLUMN clse FORMAT 999.9999
09:11:51 SQL> SELECT
09:11:51   2  tkr
09:11:51   3  ,ROUND(clse,4)clse
09:11:51   4  ,ydate
09:11:51   5  FROM di5min_stk
09:11:51   6  WHERE ydate > sysdate - 0.5/24
09:11:51   7  ORDER BY tkr,ydate
09:11:51   8  /

no rows selected

Elapsed: 00:00:00.04
09:11:51 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
