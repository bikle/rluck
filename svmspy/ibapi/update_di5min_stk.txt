
SQL*Plus: Release 11.2.0.1.0 Production on Thu Jan 27 22:12:03 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

22:12:03 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
22:12:03 SQL> 
22:12:03 SQL> 22:12:03 SQL> --
22:12:03 SQL> -- update_di5min_stk.sql
22:12:03 SQL> --
22:12:03 SQL> 
22:12:03 SQL> -- I use this script to keep di5min_stk up to date.
22:12:03 SQL> 
22:12:03 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
22:12:03 SQL> -- After that date, it holds data from IB.
22:12:03 SQL> 
22:12:03 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
22:12:03 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
22:12:03 SQL> 
22:12:03 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.29
22:12:03 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.05
22:12:03 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:32.48
22:12:36 SQL> 
22:12:36 SQL> 
22:12:36 SQL> -- I need to shave a second off of some of the dates:
22:12:36 SQL> 
22:12:36 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
22:12:36   2  WHERE TO_CHAR(ydate,'SS')='01'
22:12:36   3  /

0 rows updated.

Elapsed: 00:00:00.09
22:12:36 SQL> 
22:12:36 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    192182

Elapsed: 00:00:00.01
22:12:36 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    192182

Elapsed: 00:00:00.05
22:12:36 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.06
22:12:36 SQL> 
22:12:36 SQL> -- Copy in data from ibs5min:
22:12:36 SQL> 
22:12:36 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
22:12:36   2  SELECT	     tkr||ydate,tkr,ydate,clse
22:12:36   3  FROM ibs5min
22:12:36   4  WHERE ydate >= '2010-12-27 09:00:00'
22:12:36   5  /

192182 rows created.

Elapsed: 00:00:00.51
22:12:37 SQL> 
22:12:37 SQL> -- rpt
22:12:37 SQL> SELECT
22:12:37   2  tkr
22:12:37   3  ,MIN(ydate)
22:12:37   4  ,COUNT(tkr)
22:12:37   5  ,MAX(ydate)
22:12:37   6  FROM di5min_stk0
22:12:37   7  GROUP BY tkr
22:12:37   8  ORDER BY tkr
22:12:37   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ABT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ABX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ADBE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AEM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AFL	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AIG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AKAM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ALL	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AMGN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AMT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AMX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AMZN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
APA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
APC	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ARG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AXP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BBT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BBY	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BEN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BHP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BIDU	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BRCM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BTU	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BUCY	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CAT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CELG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CLF	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CMI	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
COF	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
COP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
COST	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CREE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CRM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CSX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CTSH	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CVS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CVX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DIA	2010-12-27 09:00:00	  2901 2011-01-27 20:55:00
DIS	2010-12-27 09:00:00	  2653 2011-01-27 20:55:00
DNDN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DTV	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DVN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
EBAY	2010-12-27 09:00:00	  2047 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
EOG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ESRX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
EWZ	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FCX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FDX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FFIV	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FLS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FSLR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GDX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GILD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GLD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GOOG	2010-12-27 09:00:00	  2923 2011-01-27 20:55:00
GS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
HD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
HES	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
HON	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
HPQ	2010-12-27 09:00:00	  2818 2011-01-27 20:55:00
IBM	2010-12-27 09:00:00	  2793 2011-01-27 20:55:00
IOC	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
IWM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
JNJ	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
JOYG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
JPM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
JWN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
KO	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
LFT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MAR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MCD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MDT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MDY	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MEE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MET	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MJN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MMM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MON	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MOS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MRK	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
NEM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
NFLX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
NUE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
OIH	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
OXY	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PBR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PEP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PNC	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
POT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PRU	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
QCOM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
QQQQ	2010-12-27 09:00:00	  3009 2011-01-27 20:55:00
RIG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
RIMM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SINA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SJM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SKX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SLB	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SLV	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SNDK	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SPY	2010-12-27 09:00:00	  3160 2011-01-27 20:55:00
STT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SUN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SWC	2011-01-19 14:30:00	   546 2011-01-27 20:55:00
TEVA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
TGT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
TKR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
TLT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
UNH	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
UNP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
UPS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
V	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
VECO	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
VMW	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
WDC	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
WFMI	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
WHR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
WMT	2010-12-27 09:00:00	  2775 2011-01-27 20:55:00
WYNN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
X	2011-01-04 12:40:00	  1836 2011-01-27 20:55:00
XLB	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
XLE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
XLU	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
XOM	2010-12-27 09:00:00	  2949 2011-01-27 20:55:00

134 rows selected.

Elapsed: 00:00:00.10
22:12:37 SQL> 
22:12:37 SQL> -- Next, copy in data from dukas.
22:12:37 SQL> -- dukas5min_stk depends on:
22:12:37 SQL> -- - dukas10min_stk
22:12:37 SQL> -- - svmspy/dukas/fake5.sql
22:12:37 SQL> 
22:12:37 SQL> 
22:12:37 SQL> -- I need to shave a second off of some of the dates:
22:12:37 SQL> 
22:12:37 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
22:12:37   2  WHERE TO_CHAR(ydate,'SS')='01'
22:12:37   3  /

0 rows updated.

Elapsed: 00:00:00.44
22:12:37 SQL> 
22:12:37 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
22:12:37 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.07
22:12:37 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.08
22:12:37 SQL> 
22:12:37 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
22:12:37   2  SELECT	     tkr||ydate,tkr,ydate,clse
22:12:37   3  FROM dukas5min_stk
22:12:37   4  WHERE ydate < '2010-12-27 09:00:00'
22:12:37   5  /

230382 rows created.

Elapsed: 00:00:00.42
22:12:38 SQL> 
22:12:38 SQL> -- rpt
22:12:38 SQL> SELECT
22:12:38   2  tkr
22:12:38   3  ,MIN(ydate)
22:12:38   4  ,COUNT(tkr)
22:12:38   5  ,MAX(ydate)
22:12:38   6  FROM dukas5min_stk
22:12:38   7  WHERE ydate < '2010-12-27 09:00:00'
22:12:38   8  GROUP BY tkr
22:12:38   9  ORDER BY tkr
22:12:38  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.09
22:12:38 SQL> 
22:12:38 SQL> -- rpt
22:12:38 SQL> SELECT
22:12:38   2  tkr
22:12:38   3  ,MIN(ydate)
22:12:38   4  ,COUNT(tkr)
22:12:38   5  ,MAX(ydate)
22:12:38   6  FROM di5min_stk0
22:12:38   7  GROUP BY tkr
22:12:38   8  ORDER BY tkr
22:12:38   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ABT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ABX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ADBE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AEM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AFL	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AIG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AKAM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ALL	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AMGN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AMT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AMX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AMZN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
APA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
APC	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ARG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
AXP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BBT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BBY	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BEN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BHP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BIDU	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BRCM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BTU	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
BUCY	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CAT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CELG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CLF	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CMI	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
COF	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
COP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
COST	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CREE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CRM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CSX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CTSH	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CVS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
CVX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DIA	2009-10-28 18:10:00	 26330 2011-01-27 20:55:00
DIS	2009-10-28 18:10:00	 26082 2011-01-27 20:55:00
DNDN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DTV	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
DVN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
EBAY	2009-10-28 18:10:00	 25476 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
EOG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
ESRX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
EWZ	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FCX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FDX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FFIV	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FLS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
FSLR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GDX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GILD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GLD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
GOOG	2009-10-28 18:10:00	 26352 2011-01-27 20:55:00
GS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
HD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
HES	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
HON	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
HPQ	2009-10-28 18:10:00	 26247 2011-01-27 20:55:00
IBM	2009-10-28 18:10:00	 26222 2011-01-27 20:55:00
IOC	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
IWM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
JNJ	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
JOYG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
JPM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
JWN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
KO	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
LFT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MAR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MCD	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MDT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MDY	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MEE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MET	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MJN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MMM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MON	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MOS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MRK	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
MT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
NEM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
NFLX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
NUE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
OIH	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
OXY	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PBR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PEP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PNC	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
POT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
PRU	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
QCOM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
QQQQ	2009-10-28 18:10:00	 26438 2011-01-27 20:55:00
RIG	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
RIMM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SINA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SJM	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SKX	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SLB	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SLV	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SNDK	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SPY	2009-10-28 18:10:00	 22681 2011-01-27 20:55:00
STT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SUN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
SWC	2011-01-19 14:30:00	   546 2011-01-27 20:55:00
TEVA	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
TGT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
TKR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
TLT	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
UNH	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
UNP	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
UPS	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
V	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
VECO	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
VMW	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
WDC	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
WFMI	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
WHR	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
WMT	2009-10-28 18:10:00	 26204 2011-01-27 20:55:00
WYNN	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
X	2011-01-04 12:40:00	  1836 2011-01-27 20:55:00
XLB	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
XLE	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
XLU	2011-01-04 14:30:00	  1326 2011-01-27 20:55:00
XOM	2009-10-28 18:10:00	 26378 2011-01-27 20:55:00

134 rows selected.

Elapsed: 00:00:00.15
22:12:38 SQL> 
22:12:38 SQL> CREATE TABLE di5min_stk COMPRESS AS
22:12:38   2  SELECT
22:12:38   3  tkrdate
22:12:38   4  ,tkr
22:12:38   5  ,ydate
22:12:38   6  ,AVG(clse)clse
22:12:38   7  FROM di5min_stk0
22:12:38   8  -- I want weekdays:
22:12:38   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
22:12:38  10  GROUP BY
22:12:38  11  tkrdate
22:12:38  12  ,tkr
22:12:38  13  ,ydate
22:12:38  14  /

Table created.

Elapsed: 00:00:01.73
22:12:40 SQL> 
22:12:40 SQL> -- rpt
22:12:40 SQL> SELECT
22:12:40   2  TO_CHAR(ydate,'dy')
22:12:40   3  ,COUNT(ydate)
22:12:40   4  FROM di5min_stk
22:12:40   5  GROUP BY TO_CHAR(ydate,'dy')
22:12:40   6  /

TO_ COUNT(YDATE)
--- ------------
fri	   80567
tue	   90385
thu	   91019
wed	   90039
mon	   70374

Elapsed: 00:00:00.31
22:12:40 SQL> 
22:12:40 SQL> -- I need to shave a second off of some of the dates:
22:12:40 SQL> --
22:12:40 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
22:12:40 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
22:12:40 SQL> -- /
22:12:40 SQL> --
22:12:40 SQL> -- SELECT COUNT(*)FROM di5min_stk;
22:12:40 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
22:12:40 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
22:12:40 SQL> --
22:12:40 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
22:12:40 SQL> 
22:12:40 SQL> -- Add a column to help join with future dates
22:12:40 SQL> -- and then calculate 1 day gain:
22:12:40 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:00.11
22:12:40 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
22:12:40   2  SELECT
22:12:40   3  tkrdate
22:12:40   4  ,tkr
22:12:40   5  ,ydate
22:12:40   6  ,clse
22:12:40   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
22:12:40   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
22:12:40   9  	    ELSE NULL END selldate
22:12:40  10  FROM di5min_stk
22:12:40  11  /

Table created.

Elapsed: 00:00:01.07
22:12:41 SQL> 
22:12:41 SQL> -- Join with the future
22:12:41 SQL> 
22:12:41 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.04
22:12:41 SQL> 
22:12:41 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
22:12:41   2  SELECT
22:12:41   3  p.tkrdate
22:12:41   4  ,p.tkr
22:12:41   5  ,p.ydate
22:12:41   6  ,p.clse
22:12:41   7  ,p.selldate
22:12:41   8  ,f.clse clse2
22:12:41   9  ,f.clse - p.clse gain1day
22:12:41  10  FROM di5min_stk_fd p, di5min_stk f
22:12:41  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
22:12:41  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
22:12:41  13  /

Table created.

Elapsed: 00:00:01.89
22:12:43 SQL> 
22:12:43 SQL> -- rpt
22:12:43 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 80567
tue	 90385
thu	 91019
wed	 90039
mon	 70374

Elapsed: 00:00:00.26
22:12:43 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 80567
mon	 70374
tue	 90385
thu	 91019
wed	 90039

Elapsed: 00:00:00.30
22:12:44 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-01-27 20:55:00

Elapsed: 00:00:00.03
22:12:44 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-01-27 20:55:00

Elapsed: 00:00:00.04
22:12:44 SQL> 
22:12:44 SQL> -- rpt
22:12:44 SQL> SELECT
22:12:44   2  tkr
22:12:44   3  ,MIN(ydate)
22:12:44   4  ,COUNT(ydate)
22:12:44   5  ,MAX(ydate)
22:12:44   6  ,MIN(clse)
22:12:44   7  ,AVG(clse)
22:12:44   8  ,MAX(clse)
22:12:44   9  ,MAX(gain1day)
22:12:44  10  FROM di5min_stk_c2
22:12:44  11  GROUP BY tkr
22:12:44  12  ORDER BY tkr
22:12:44  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 326.72 338.576929     348.46	      13.64
ABT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  46.13 47.6836378	48.76		.91
ABX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  45.64 48.2264037	52.33	       1.82
ADBE	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	   31.3 33.0856203	34.27	       1.15
AEM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  66.92 70.0582966	72.79	       2.95
AFL	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  54.89 57.1418524	58.78	       1.84
AIG	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  40.93 52.1868109	62.47		4.8
AKAM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  46.85 49.2204327	52.47	       2.39
ALL	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  30.47 31.3060888	32.18		.83
AMGN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  55.99 56.8267543	58.15	       1.03
AMT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  48.78 50.7232438	 52.2	       1.73
AMX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  57.32 58.4328978	59.58	       1.19
AMZN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 174.41 183.421747     191.55	       9.32
APA	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 114.14 123.513529     127.55	       4.04
APC	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	   73.1  76.405264	79.78	       3.94
ARG	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  61.95 63.3332928	63.97		.61
AXP	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  43.29 45.0424962	 46.7	       1.52
BA	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  66.51 70.1172738	72.79		2.6
BBT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	     26 27.2172455	28.41		1.3
BBY	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  34.65 35.3103149	36.18	       1.29
BEN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 109.71 116.810898	123.7	       5.04
BHP	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  87.11 89.6754355	 92.7	       2.75
BIDU	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  99.53 105.873723     109.82	       5.05
BP	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	   45.2  47.176135	49.38	       1.83
BRCM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  42.11 45.3936897	47.32	       2.09
BTU	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	   57.7 61.6138989	65.57	       3.97
BUCY	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  89.67 90.2506184	90.92		.24
CAT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  92.37 94.3163301	97.63		2.6
CELG	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  54.61  57.337336	59.69	       1.56
CLF	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  79.77 84.9996738	91.04	       7.09
CMI	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 102.64 110.463648     114.74	      4.855
COF	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  43.23 46.9018722	49.64		2.8
COP	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  66.58 67.7419655	69.72	       2.69
COST	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  70.07 71.8690309	73.68	       1.23
CREE	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  50.91 60.7679308	69.19	       2.11
CRM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 122.31 137.255621     146.42	       8.23
CSX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  64.81 68.1842878	71.43	       2.88
CTSH	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  72.61 74.5243788	76.42	       2.16
CVS	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  34.24 35.1480666	35.94	       1.17
CVX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  90.21 92.5362623	94.93	       1.84
DD	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  47.28 49.3594523	50.58	       1.84
DE	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  81.82 87.7120588	91.58	       2.84
DIA	2009-10-28 18:10:00	   26318 2011-01-27 20:55:00	  96.34 107.212249     119.89	       4.35
DIS	2009-10-28 18:10:00	   26070 2011-01-27 20:55:00	  27.06 34.0325191	   40		2.1
DNDN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  34.93 36.2889216	38.85	       2.92
DTV	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  40.79 42.0297747	   43		  1
DVN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  77.06 81.5094523	 86.3	       2.75
EBAY	2009-10-28 18:10:00	   25464 2011-01-14 20:55:00	  19.17  24.648826	31.48	       2.55
EFA	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  56.77 58.8538443	60.38	       1.37
EOG	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  91.02 98.1442063     103.86	       3.53
ESRX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  55.52 57.3054195	58.74	       1.35
EWZ	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  74.05 76.5469636	78.95	       1.94
FCX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 104.87 114.890096     122.49	       5.38
FDX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  92.12 94.0774863	96.98		2.4
FFIV	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 103.08 128.923946     145.75	       5.69
FLS	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  112.9 117.572582     123.58	       4.87
FSLR	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 130.64 142.481075     158.49	      10.78
GDX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  52.52 55.8583126	60.06	       2.31
GG	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  39.13 41.8942459	44.84	       1.68
GILD	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  36.51 37.9687491	39.75	       1.75
GLD	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 127.83 132.793811     136.18	       1.14
GOOG	2009-10-28 18:10:00	   26328 2011-01-27 20:55:00	  434.6  550.00961     641.65	      63.83
GS	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 160.21 169.159156	  175	       3.74
HD	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  34.09 35.6992006	38.07	       1.18
HES	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  76.16 79.3537217	 82.6	       3.75
HON	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  53.03 54.6182325	56.05	       1.54
HPQ	2009-10-28 18:10:00	   26235 2011-01-27 20:55:00	  37.45  46.629295	 54.7		3.4
IBM	2009-10-28 18:10:00	   26210 2011-01-27 20:55:00	 119.59 132.867623     162.13	       5.73
IOC	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  66.18 73.7372172	77.99	       3.57
IWM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  77.04 78.8968571	80.62	       1.96
JNJ	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  60.63 62.3406966	63.49		.89
JOYG	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  83.82 88.0696192	93.42	       4.55
JPM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  42.77 44.5390083	45.91		1.4
JWN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  40.87 41.9650396	43.69	       1.14
KO	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  62.57 63.1590469	65.04	       1.01
LFT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	     30 33.8354883	   37	       2.23
MAR	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  39.43  40.712631	42.01		.92
MCD	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  72.15 74.5542402	75.74	       1.64
MDT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  36.18 37.2541582	38.93	       1.36
MDY	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 163.62  167.15734     170.37		3.4
MEE	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  52.03 55.2441817	58.46	       2.64
MET	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  44.78 46.1079685	47.23	       1.38
MJN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  58.36 61.5994778	63.29	       1.16
MMM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  85.68 87.9764131	90.43	       2.08
MON	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  68.27 71.9087208	75.24	       4.04
MOS	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  71.87  77.572121	85.45	       4.26
MRK	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  33.21 35.1072323	 37.6		.72
MT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  34.22  36.383815	 38.3	       2.13
NEM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  54.42 56.7162443	60.22	       1.32
NFLX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  176.3 186.229494     211.49	      29.02
NUE	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  42.81  44.532779	46.63	       2.14
OIH	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 135.78 142.518766     151.42	       8.52
OXY	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  94.06 96.7533428	 98.9	       3.68
PBR	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  35.72 36.7371408	38.46	       1.58
PEP	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  65.18 66.2451084	67.46	       1.56
PG	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  63.25 65.2066879	66.94	       1.12
PM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  55.88  56.928996	58.93		.66
PNC	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  59.87 61.6002866	64.25	       3.13
POT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 153.56 166.145236     178.14	      13.11
PRU	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  59.41 61.1312217	63.18	       1.77
QCOM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	   49.9 51.9531269	54.98	       3.54
QQQQ	2009-10-28 18:10:00	   26426 2011-01-27 20:55:00	   40.7 48.0995353	57.31		2.5
RIG	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  69.12 76.7064197	82.97	       5.25
RIMM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  58.31  62.318808	66.33		  3
SINA	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  72.55 80.8207278	89.97	       6.68
SJM	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  61.66 63.2677545	64.64	       1.07
SKX	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	   19.3 20.9191648	21.97	       1.07
SLB	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  79.84  83.750165	87.73	       4.98
SLV	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  26.08 27.7896908	29.59		.88
SNDK	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  48.09 51.3584785	53.47		3.6
SPY	2009-10-28 18:10:00	   22657 2011-01-27 20:55:00	 103.18 116.050604     130.14		5.1
STT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  45.94 47.6555769	50.22		2.1
SUN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  38.49 40.6495437	42.81	       1.55
SWC	2011-01-19 14:30:00	     546 2011-01-27 20:55:00	  20.51 21.7185806	 23.4	       1.14
TEVA	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  52.03 53.9101442	56.96	       3.35
TGT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	   53.9 55.8146243	60.37	       1.67
TKR	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  48.28 50.2723369	52.42	       2.09
TLT	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  90.43 91.8514847	93.74	       1.77
UNH	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  36.95  39.512698	42.39	       2.11
UNP	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	     92 95.5757042	99.44	       3.77

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
UPS	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  71.37 72.5314701	73.29		.96
V	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00   54.34875 70.0549697     79.272	 5.16053333
VECO	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  42.99 46.2406429	49.65	       2.41
VMW	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  82.45 89.9248913	95.94	 5.49083452
WDC	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  31.39 32.8915366	34.93	       1.86
WFMI	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  47.85 50.9195428	53.35	       2.66
WHR	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  85.27 88.0542251	91.32	       3.56
WMT	2009-10-28 18:10:00	   26180 2011-01-27 20:55:00	  47.76 53.2130349	57.76	       2.22
WYNN	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	 109.66 116.563342     120.95	       6.66
X	2011-01-04 12:40:00	    1824 2011-01-27 20:55:00 48.9373333 60.5305444	75.74	 15.9436667
XLB	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  37.25 38.3446474     39.085	       1.15
XLE	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  67.54 69.5676923	   72		2.2
XLU	2011-01-04 14:30:00	    1326 2011-01-27 20:55:00	  31.23 31.7188433	32.19		.33
XOM	2009-10-28 18:10:00	   26354 2011-01-27 20:55:00	  56.05 67.0442846	79.97	       2.55

134 rows selected.

Elapsed: 00:00:00.44
22:12:44 SQL> 
22:12:44 SQL> COLUMN clse FORMAT 999.9999
22:12:44 SQL> SELECT
22:12:44   2  tkr
22:12:44   3  ,ROUND(clse,4)clse
22:12:44   4  -- Should be NULL:
22:12:44   5  ,ROUND(clse2,4)clse2
22:12:44   6  ,ydate
22:12:44   7  FROM di5min_stk_c2
22:12:44   8  WHERE ydate > sysdate - 0.5/24
22:12:44   9  ORDER BY tkr,ydate
22:12:44  10  /

no rows selected

Elapsed: 00:00:00.06
22:12:44 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
