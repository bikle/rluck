
SQL*Plus: Release 11.2.0.1.0 Production on Tue May 10 19:43:08 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

19:43:08 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
19:43:08 SQL> 
19:43:08 SQL> 19:43:08 SQL> --
19:43:08 SQL> -- update_di5min_stk.sql
19:43:08 SQL> --
19:43:08 SQL> 
19:43:08 SQL> -- I use this script to keep di5min_stk up to date.
19:43:08 SQL> 
19:43:08 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
19:43:08 SQL> -- After that date, it holds data from IB.
19:43:08 SQL> 
19:43:08 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
19:43:08 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
19:43:08 SQL> 
19:43:08 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.51
19:43:09 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.10
19:43:09 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.07
19:43:09 SQL> 
19:43:09 SQL> 
19:43:09 SQL> -- I need to shave a second off of some of the dates:
19:43:09 SQL> 
19:43:09 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
19:43:09   2  WHERE TO_CHAR(ydate,'SS')='01'
19:43:09   3  /

0 rows updated.

Elapsed: 00:00:00.86
19:43:10 SQL> 
19:43:10 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
   1010436

Elapsed: 00:00:00.02
19:43:10 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
   1010436

Elapsed: 00:00:00.63
19:43:11 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.35
19:43:11 SQL> 
19:43:11 SQL> -- Remove data which is outside of RTH:
19:43:11 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') < '14:30'AND ydate < '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.37
19:43:11 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') > '20:55'AND ydate < '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.45
19:43:12 SQL> -- Daylight savings time started on 2011-03-14:
19:43:12 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') < '13:30'AND ydate > '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.25
19:43:12 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') > '19:55'AND ydate > '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.24
19:43:12 SQL> 
19:43:12 SQL> 
19:43:12 SQL> -- Copy in data from ibs5min:
19:43:12 SQL> 
19:43:12 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
19:43:12   2  SELECT	     tkr||ydate,tkr,ydate,clse
19:43:12   3  FROM ibs5min
19:43:12   4  WHERE ydate >= '2010-12-27 09:00:00'
19:43:12   5  /

1010436 rows created.

Elapsed: 00:00:02.09
19:43:14 SQL> 
19:43:14 SQL> -- rpt
19:43:14 SQL> SELECT
19:43:14   2  tkr
19:43:14   3  ,MIN(ydate)
19:43:14   4  ,COUNT(tkr)
19:43:14   5  ,MAX(ydate)
19:43:14   6  FROM di5min_stk0
19:43:14   7  GROUP BY tkr
19:43:14   8  ORDER BY tkr
19:43:14   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  6521 2011-05-10 17:20:00
ABT	2011-01-04 14:30:00	  6521 2011-05-10 17:20:00
ABX	2011-01-04 14:30:00	  6521 2011-05-10 17:20:00
ACI	2011-04-19 13:30:00	  1139 2011-05-10 17:20:00
ADBE	2011-01-04 14:30:00	  6521 2011-05-10 17:20:00
ADM	2011-04-28 13:30:00	   668 2011-05-10 17:05:00
AEM	2011-01-04 14:30:00	  6518 2011-05-10 17:05:00
AFL	2011-01-04 14:30:00	  6518 2011-05-10 17:05:00
AGU	2011-01-24 14:30:00	  5504 2011-05-10 17:05:00
AIG	2011-01-04 14:30:00	  6518 2011-05-10 17:05:00
AKAM	2011-01-04 14:30:00	  6515 2011-05-10 16:50:00
ALL	2011-01-04 14:30:00	  6515 2011-05-10 16:50:00
AMGN	2011-01-04 14:30:00	  6515 2011-05-10 16:50:00
AMT	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
AMX	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
AMZN	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
APA	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
APC	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
ARG	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
AXP	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
AXU	2011-01-21 14:30:00	  5572 2011-05-10 16:15:00
BA	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
BBT	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
BBY	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
BEN	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
BHP	2011-01-04 14:30:00	  6505 2011-05-10 16:00:00
BIDU	2011-01-04 14:30:00	  6505 2011-05-10 16:00:00
BP	2011-01-04 14:30:00	  6505 2011-05-10 16:00:00
BRCM	2011-01-04 14:30:00	  6505 2011-05-10 16:00:00
BTU	2011-01-04 14:30:00	  6504 2011-05-10 15:55:00
BUCY	2011-01-04 14:30:00	  6502 2011-05-10 15:45:00
CAT	2011-01-04 14:30:00	  6501 2011-05-10 15:40:00
CDE	2011-01-21 14:30:00	  5565 2011-05-10 15:40:00
CELG	2011-01-04 14:30:00	  6501 2011-05-10 15:40:00
CEO	2011-01-24 14:30:00	  5487 2011-05-10 15:40:00
CHK	2011-01-24 14:30:00	  5484 2011-05-10 15:25:00
CLF	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
CMI	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
COF	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
COP	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
COST	2011-01-04 14:30:00	  6495 2011-05-10 15:10:00
CREE	2011-01-04 14:30:00	  6495 2011-05-10 15:10:00
CRM	2011-01-04 14:30:00	  6495 2011-05-10 15:10:00
CSCO	2011-04-28 13:30:00	   645 2011-05-10 15:10:00
CSX	2011-01-04 14:30:00	  6495 2011-05-10 15:10:00
CTSH	2011-01-04 14:30:00	  6492 2011-05-10 14:55:00
CVE	2011-02-14 14:30:00	  4308 2011-05-10 14:55:00
CVS	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
CVX	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
DD	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
DE	2011-01-04 14:30:00	  6488 2011-05-10 14:35:00
DIA	2010-12-27 14:30:00	  6956 2011-05-10 14:35:00
DIS	2010-12-27 14:30:00	  6956 2011-05-10 14:35:00
DNDN	2011-01-04 14:30:00	  6488 2011-05-10 14:35:00
DTV	2011-01-04 14:30:00	  6488 2011-05-10 14:35:00
DVN	2011-01-04 14:30:00	  6485 2011-05-10 14:20:00
EBAY	2010-12-27 14:30:00	  6745 2011-05-10 14:20:00
EFA	2011-01-04 14:30:00	  6485 2011-05-10 14:20:00
EOG	2011-01-04 14:30:00	  6485 2011-05-10 14:20:00
ESRX	2011-01-04 14:30:00	  6485 2011-05-10 14:20:00
EWZ	2011-01-04 14:30:00	  6546 2011-05-10 19:25:00
EXK	2011-01-21 14:30:00	  5610 2011-05-10 19:25:00
FCX	2011-02-02 14:30:00	  4986 2011-05-10 19:25:00
FDX	2011-01-04 14:30:00	  6546 2011-05-10 19:25:00
FFIV	2011-01-04 14:30:00	  6546 2011-05-10 19:25:00
FLS	2011-01-04 14:30:00	  6309 2011-05-10 19:10:00
FSLR	2011-01-04 14:30:00	  6542 2011-05-10 19:05:00
FXI	2011-04-06 13:30:00	  1862 2011-05-10 19:05:00
GD	2011-04-18 13:30:00	  1238 2011-05-10 19:05:00
GDX	2011-01-04 14:30:00	  6542 2011-05-10 19:05:00
GFI	2011-01-28 14:30:00	  4979 2011-05-10 18:50:00
GG	2011-01-04 14:30:00	  6305 2011-05-10 18:50:00
GILD	2011-01-04 14:30:00	  6305 2011-05-10 18:50:00
GLD	2011-01-04 14:30:00	  6305 2011-05-10 18:50:00
GOOG	2010-12-27 14:30:00	  6773 2011-05-10 18:50:00
GS	2011-01-04 14:30:00	  6535 2011-05-10 18:30:00
HAL	2011-04-08 13:30:00	  1699 2011-05-10 18:30:00
HD	2011-01-04 14:30:00	  6535 2011-05-10 18:30:00
HES	2011-01-04 14:30:00	  6535 2011-05-10 18:30:00
HL	2011-01-18 14:30:00	  5677 2011-05-10 18:30:00
HOC	2011-02-17 14:30:00	  4113 2011-05-10 18:10:00
HON	2011-01-04 14:30:00	  6531 2011-05-10 18:10:00
HPQ	2010-12-27 14:30:00	  6999 2011-05-10 18:10:00
IBM	2010-12-27 14:30:00	  6999 2011-05-10 18:10:00
IOC	2011-01-04 14:30:00	  6531 2011-05-10 18:10:00
IWM	2011-01-04 14:30:00	  6531 2011-05-10 18:10:00
JNJ	2011-01-04 14:30:00	  6531 2011-05-10 18:10:00
JOYG	2011-01-04 14:30:00	  6296 2011-05-10 18:05:00
JPM	2011-01-04 14:30:00	  6530 2011-05-10 18:05:00
JWN	2011-01-04 14:30:00	  6530 2011-05-10 18:05:00
KO	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
LFT	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
LMT	2011-01-28 14:30:00	  4954 2011-05-10 16:45:00
LVS	2011-04-13 13:30:00	  1444 2011-05-10 16:45:00
MAR	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
MCD	2011-01-04 14:30:00	  6277 2011-05-10 16:30:00
MDT	2011-01-04 14:30:00	  6510 2011-05-10 16:25:00
MDY	2011-01-04 14:30:00	  6510 2011-05-10 16:25:00
MEE	2011-01-04 14:30:00	  6276 2011-05-10 16:25:00
MET	2011-01-04 14:30:00	  6510 2011-05-10 16:25:00
MJN	2011-01-04 14:30:00	  6274 2011-05-10 16:15:00
MMM	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
MON	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
MOS	2011-01-04 14:30:00	  6507 2011-05-10 16:10:00
MRK	2011-01-04 14:30:00	  6507 2011-05-10 16:10:00
MRO	2011-04-19 13:30:00	  1122 2011-05-10 15:55:00
MSFT	2011-04-15 13:30:00	  1278 2011-05-10 15:55:00
MT	2011-01-04 14:30:00	  6504 2011-05-10 15:55:00
MVG	2011-01-21 14:30:00	  5333 2011-05-10 15:55:00
NEM	2011-01-04 14:30:00	  6240 2011-05-09 19:55:00
NFLX	2011-01-04 14:30:00	  6268 2011-05-10 15:45:00
NOC	2011-01-28 14:30:00	  4941 2011-05-10 15:40:00
NUE	2011-01-04 14:30:00	  6267 2011-05-10 15:40:00
OIH	2011-01-04 14:30:00	  6501 2011-05-10 15:40:00
ORCL	2011-03-01 14:30:00	  3822 2011-05-09 19:55:00
OXY	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
PAAS	2011-01-21 14:30:00	  5562 2011-05-10 15:25:00
PALL	2011-01-21 14:30:00	  5562 2011-05-10 15:25:00
PBR	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
PEP	2011-01-04 14:30:00	  6474 2011-05-09 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
PG	2011-01-04 14:30:00	  6494 2011-05-10 15:05:00
PM	2011-01-04 14:30:00	  6494 2011-05-10 15:05:00
PNC	2011-01-04 14:30:00	  6494 2011-05-10 15:05:00
POT	2011-01-04 14:30:00	  6260 2011-05-10 15:05:00
PPLT	2011-01-21 14:30:00	  5553 2011-05-10 15:05:00
PRU	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
QCOM	2011-01-04 14:30:00	  6257 2011-05-10 14:50:00
QQQ	2010-12-27 14:30:00	  6959 2011-05-10 14:50:00
RDY	2011-01-24 14:30:00	  5243 2011-05-10 14:50:00
RIG	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
RIMM	2011-01-04 14:30:00	  6489 2011-05-10 14:40:00
RTN	2011-01-28 14:30:00	  5163 2011-05-10 14:40:00
SBUX	2011-04-26 13:30:00	   794 2011-05-10 14:35:00
SCCO	2011-01-24 14:30:00	  5474 2011-05-10 14:35:00
SINA	2011-01-04 14:30:00	  6240 2011-05-09 19:55:00
SJM	2011-01-04 14:30:00	  6252 2011-05-10 14:25:00
SKX	2011-01-04 14:30:00	  6486 2011-05-10 14:25:00
SLB	2011-01-04 14:30:00	  6486 2011-05-10 14:25:00
SLV	2011-01-04 14:30:00	  6486 2011-05-10 14:25:00
SLW	2011-01-21 14:30:00	  5550 2011-05-10 14:25:00
SNDK	2011-01-04 14:30:00	  6484 2011-05-10 14:15:00
SOHU	2011-01-24 14:30:00	  5470 2011-05-10 14:15:00
SPY	2010-12-27 14:30:00	  6952 2011-05-10 14:15:00
STT	2011-01-04 14:30:00	  6484 2011-05-10 14:15:00
SU	2011-04-18 13:30:00	  1170 2011-05-09 19:55:00
SUN	2011-01-04 14:30:00	  6482 2011-05-10 14:05:00
SVM	2011-01-21 14:30:00	  5546 2011-05-10 14:05:00
SWC	2011-01-19 14:30:00	  5468 2011-05-10 14:05:00
T	2011-04-19 13:30:00	  1100 2011-05-10 14:05:00
TEVA	2011-01-04 14:30:00	  6240 2011-05-09 19:55:00
TGT	2011-01-04 14:30:00	  6247 2011-05-10 14:00:00
TKR	2011-01-04 14:30:00	  6481 2011-05-10 14:00:00
TLT	2011-01-04 14:30:00	  6481 2011-05-10 14:00:00
TSO	2011-02-17 14:30:00	  4063 2011-05-10 14:00:00
TXN	2011-04-11 13:30:00	  1567 2011-05-10 14:00:00
UNH	2011-01-04 14:30:00	  6246 2011-05-10 13:55:00
UNP	2011-01-04 14:30:00	  6246 2011-05-10 13:55:00
UPS	2011-01-04 14:30:00	  6480 2011-05-10 13:55:00
V	2011-04-19 13:30:00	  1098 2011-05-10 13:55:00
VALE	2011-01-24 14:30:00	  5460 2011-05-09 19:55:00
VECO	2011-01-04 14:30:00	  6479 2011-05-10 13:50:00
VLO	2011-02-17 14:30:00	  4061 2011-05-10 13:50:00
VMW	2011-01-04 14:30:00	  6245 2011-05-10 13:50:00
WDC	2011-01-04 14:30:00	  6478 2011-05-10 13:45:00
WFC	2011-04-13 13:30:00	  1408 2011-05-10 13:45:00
WFM	2011-01-04 14:30:00	  6290 2011-05-10 17:35:00
WHR	2011-01-04 14:30:00	  6524 2011-05-10 17:35:00
WMT	2010-12-27 14:30:00	  6992 2011-05-10 17:35:00
WYNN	2011-01-04 14:30:00	  6524 2011-05-10 17:35:00
X	2011-04-18 13:30:00	  1220 2011-05-10 17:35:00
XLB	2011-01-04 14:30:00	  6523 2011-05-10 17:30:00
XLE	2011-01-04 14:30:00	  6523 2011-05-10 17:30:00
XLU	2011-01-04 14:30:00	  6523 2011-05-10 17:30:00
XOM	2010-12-27 14:30:00	  6835 2011-05-10 17:30:00
YUM	2011-04-12 13:30:00	  1531 2011-05-10 17:30:00

175 rows selected.

Elapsed: 00:00:00.43
19:43:15 SQL> 
19:43:15 SQL> -- Next, copy in data from dukas.
19:43:15 SQL> -- dukas5min_stk depends on:
19:43:15 SQL> -- - dukas10min_stk
19:43:15 SQL> -- - svmspy/dukas/fake5.sql
19:43:15 SQL> 
19:43:15 SQL> 
19:43:15 SQL> -- I need to shave a second off of some of the dates:
19:43:15 SQL> 
19:43:15 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
19:43:15   2  WHERE TO_CHAR(ydate,'SS')='01'
19:43:15   3  /

0 rows updated.

Elapsed: 00:00:00.09
19:43:15 SQL> 
19:43:15 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
19:43:15 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.08
19:43:15 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.07
19:43:15 SQL> 
19:43:15 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
19:43:15   2  SELECT	     tkr||ydate,tkr,ydate,clse
19:43:15   3  FROM dukas5min_stk
19:43:15   4  WHERE ydate < '2010-12-27 09:00:00'
19:43:15   5  /

230382 rows created.

Elapsed: 00:00:00.43
19:43:15 SQL> 
19:43:15 SQL> -- rpt
19:43:15 SQL> SELECT
19:43:15   2  tkr
19:43:15   3  ,MIN(ydate)
19:43:15   4  ,COUNT(tkr)
19:43:15   5  ,MAX(ydate)
19:43:15   6  FROM dukas5min_stk
19:43:15   7  WHERE ydate < '2010-12-27 09:00:00'
19:43:15   8  GROUP BY tkr
19:43:15   9  ORDER BY tkr
19:43:15  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.09
19:43:15 SQL> 
19:43:15 SQL> -- rpt
19:43:15 SQL> SELECT
19:43:15   2  tkr
19:43:15   3  ,MIN(ydate)
19:43:15   4  ,COUNT(tkr)
19:43:15   5  ,MAX(ydate)
19:43:15   6  FROM di5min_stk0
19:43:15   7  GROUP BY tkr
19:43:15   8  ORDER BY tkr
19:43:15   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  6521 2011-05-10 17:20:00
ABT	2011-01-04 14:30:00	  6521 2011-05-10 17:20:00
ABX	2011-01-04 14:30:00	  6521 2011-05-10 17:20:00
ACI	2011-04-19 13:30:00	  1139 2011-05-10 17:20:00
ADBE	2011-01-04 14:30:00	  6521 2011-05-10 17:20:00
ADM	2011-04-28 13:30:00	   668 2011-05-10 17:05:00
AEM	2011-01-04 14:30:00	  6518 2011-05-10 17:05:00
AFL	2011-01-04 14:30:00	  6518 2011-05-10 17:05:00
AGU	2011-01-24 14:30:00	  5504 2011-05-10 17:05:00
AIG	2011-01-04 14:30:00	  6518 2011-05-10 17:05:00
AKAM	2011-01-04 14:30:00	  6515 2011-05-10 16:50:00
ALL	2011-01-04 14:30:00	  6515 2011-05-10 16:50:00
AMGN	2011-01-04 14:30:00	  6515 2011-05-10 16:50:00
AMT	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
AMX	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
AMZN	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
APA	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
APC	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
ARG	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
AXP	2011-01-04 14:30:00	  6511 2011-05-10 16:30:00
AXU	2011-01-21 14:30:00	  5572 2011-05-10 16:15:00
BA	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
BBT	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
BBY	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
BEN	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
BHP	2011-01-04 14:30:00	  6505 2011-05-10 16:00:00
BIDU	2011-01-04 14:30:00	  6505 2011-05-10 16:00:00
BP	2011-01-04 14:30:00	  6505 2011-05-10 16:00:00
BRCM	2011-01-04 14:30:00	  6505 2011-05-10 16:00:00
BTU	2011-01-04 14:30:00	  6504 2011-05-10 15:55:00
BUCY	2011-01-04 14:30:00	  6502 2011-05-10 15:45:00
CAT	2011-01-04 14:30:00	  6501 2011-05-10 15:40:00
CDE	2011-01-21 14:30:00	  5565 2011-05-10 15:40:00
CELG	2011-01-04 14:30:00	  6501 2011-05-10 15:40:00
CEO	2011-01-24 14:30:00	  5487 2011-05-10 15:40:00
CHK	2011-01-24 14:30:00	  5484 2011-05-10 15:25:00
CLF	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
CMI	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
COF	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
COP	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
COST	2011-01-04 14:30:00	  6495 2011-05-10 15:10:00
CREE	2011-01-04 14:30:00	  6495 2011-05-10 15:10:00
CRM	2011-01-04 14:30:00	  6495 2011-05-10 15:10:00
CSCO	2011-04-28 13:30:00	   645 2011-05-10 15:10:00
CSX	2011-01-04 14:30:00	  6495 2011-05-10 15:10:00
CTSH	2011-01-04 14:30:00	  6492 2011-05-10 14:55:00
CVE	2011-02-14 14:30:00	  4308 2011-05-10 14:55:00
CVS	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
CVX	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
DD	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
DE	2011-01-04 14:30:00	  6488 2011-05-10 14:35:00
DIA	2009-10-28 18:10:00	 30385 2011-05-10 14:35:00
DIS	2009-10-28 18:10:00	 30385 2011-05-10 14:35:00
DNDN	2011-01-04 14:30:00	  6488 2011-05-10 14:35:00
DTV	2011-01-04 14:30:00	  6488 2011-05-10 14:35:00
DVN	2011-01-04 14:30:00	  6485 2011-05-10 14:20:00
EBAY	2009-10-28 18:10:00	 30174 2011-05-10 14:20:00
EFA	2011-01-04 14:30:00	  6485 2011-05-10 14:20:00
EOG	2011-01-04 14:30:00	  6485 2011-05-10 14:20:00
ESRX	2011-01-04 14:30:00	  6485 2011-05-10 14:20:00
EWZ	2011-01-04 14:30:00	  6546 2011-05-10 19:25:00
EXK	2011-01-21 14:30:00	  5610 2011-05-10 19:25:00
FCX	2011-02-02 14:30:00	  4986 2011-05-10 19:25:00
FDX	2011-01-04 14:30:00	  6546 2011-05-10 19:25:00
FFIV	2011-01-04 14:30:00	  6546 2011-05-10 19:25:00
FLS	2011-01-04 14:30:00	  6309 2011-05-10 19:10:00
FSLR	2011-01-04 14:30:00	  6542 2011-05-10 19:05:00
FXI	2011-04-06 13:30:00	  1862 2011-05-10 19:05:00
GD	2011-04-18 13:30:00	  1238 2011-05-10 19:05:00
GDX	2011-01-04 14:30:00	  6542 2011-05-10 19:05:00
GFI	2011-01-28 14:30:00	  4979 2011-05-10 18:50:00
GG	2011-01-04 14:30:00	  6305 2011-05-10 18:50:00
GILD	2011-01-04 14:30:00	  6305 2011-05-10 18:50:00
GLD	2011-01-04 14:30:00	  6305 2011-05-10 18:50:00
GOOG	2009-10-28 18:10:00	 30202 2011-05-10 18:50:00
GS	2011-01-04 14:30:00	  6535 2011-05-10 18:30:00
HAL	2011-04-08 13:30:00	  1699 2011-05-10 18:30:00
HD	2011-01-04 14:30:00	  6535 2011-05-10 18:30:00
HES	2011-01-04 14:30:00	  6535 2011-05-10 18:30:00
HL	2011-01-18 14:30:00	  5677 2011-05-10 18:30:00
HOC	2011-02-17 14:30:00	  4113 2011-05-10 18:10:00
HON	2011-01-04 14:30:00	  6531 2011-05-10 18:10:00
HPQ	2009-10-28 18:10:00	 30428 2011-05-10 18:10:00
IBM	2009-10-28 18:10:00	 30428 2011-05-10 18:10:00
IOC	2011-01-04 14:30:00	  6531 2011-05-10 18:10:00
IWM	2011-01-04 14:30:00	  6531 2011-05-10 18:10:00
JNJ	2011-01-04 14:30:00	  6531 2011-05-10 18:10:00
JOYG	2011-01-04 14:30:00	  6296 2011-05-10 18:05:00
JPM	2011-01-04 14:30:00	  6530 2011-05-10 18:05:00
JWN	2011-01-04 14:30:00	  6530 2011-05-10 18:05:00
KO	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
LFT	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
LMT	2011-01-28 14:30:00	  4954 2011-05-10 16:45:00
LVS	2011-04-13 13:30:00	  1444 2011-05-10 16:45:00
MAR	2011-01-04 14:30:00	  6514 2011-05-10 16:45:00
MCD	2011-01-04 14:30:00	  6277 2011-05-10 16:30:00
MDT	2011-01-04 14:30:00	  6510 2011-05-10 16:25:00
MDY	2011-01-04 14:30:00	  6510 2011-05-10 16:25:00
MEE	2011-01-04 14:30:00	  6276 2011-05-10 16:25:00
MET	2011-01-04 14:30:00	  6510 2011-05-10 16:25:00
MJN	2011-01-04 14:30:00	  6274 2011-05-10 16:15:00
MMM	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
MON	2011-01-04 14:30:00	  6508 2011-05-10 16:15:00
MOS	2011-01-04 14:30:00	  6507 2011-05-10 16:10:00
MRK	2011-01-04 14:30:00	  6507 2011-05-10 16:10:00
MRO	2011-04-19 13:30:00	  1122 2011-05-10 15:55:00
MSFT	2011-04-15 13:30:00	  1278 2011-05-10 15:55:00
MT	2011-01-04 14:30:00	  6504 2011-05-10 15:55:00
MVG	2011-01-21 14:30:00	  5333 2011-05-10 15:55:00
NEM	2011-01-04 14:30:00	  6240 2011-05-09 19:55:00
NFLX	2011-01-04 14:30:00	  6268 2011-05-10 15:45:00
NOC	2011-01-28 14:30:00	  4941 2011-05-10 15:40:00
NUE	2011-01-04 14:30:00	  6267 2011-05-10 15:40:00
OIH	2011-01-04 14:30:00	  6501 2011-05-10 15:40:00
ORCL	2011-03-01 14:30:00	  3822 2011-05-09 19:55:00
OXY	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
PAAS	2011-01-21 14:30:00	  5562 2011-05-10 15:25:00
PALL	2011-01-21 14:30:00	  5562 2011-05-10 15:25:00
PBR	2011-01-04 14:30:00	  6498 2011-05-10 15:25:00
PEP	2011-01-04 14:30:00	  6474 2011-05-09 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
PG	2011-01-04 14:30:00	  6494 2011-05-10 15:05:00
PM	2011-01-04 14:30:00	  6494 2011-05-10 15:05:00
PNC	2011-01-04 14:30:00	  6494 2011-05-10 15:05:00
POT	2011-01-04 14:30:00	  6260 2011-05-10 15:05:00
PPLT	2011-01-21 14:30:00	  5553 2011-05-10 15:05:00
PRU	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
QCOM	2011-01-04 14:30:00	  6257 2011-05-10 14:50:00
QQQ	2010-12-27 14:30:00	  6959 2011-05-10 14:50:00
QQQQ	2009-10-28 18:10:00	 23429 2010-12-24 20:50:00
RDY	2011-01-24 14:30:00	  5243 2011-05-10 14:50:00
RIG	2011-01-04 14:30:00	  6491 2011-05-10 14:50:00
RIMM	2011-01-04 14:30:00	  6489 2011-05-10 14:40:00
RTN	2011-01-28 14:30:00	  5163 2011-05-10 14:40:00
SBUX	2011-04-26 13:30:00	   794 2011-05-10 14:35:00
SCCO	2011-01-24 14:30:00	  5474 2011-05-10 14:35:00
SINA	2011-01-04 14:30:00	  6240 2011-05-09 19:55:00
SJM	2011-01-04 14:30:00	  6252 2011-05-10 14:25:00
SKX	2011-01-04 14:30:00	  6486 2011-05-10 14:25:00
SLB	2011-01-04 14:30:00	  6486 2011-05-10 14:25:00
SLV	2011-01-04 14:30:00	  6486 2011-05-10 14:25:00
SLW	2011-01-21 14:30:00	  5550 2011-05-10 14:25:00
SNDK	2011-01-04 14:30:00	  6484 2011-05-10 14:15:00
SOHU	2011-01-24 14:30:00	  5470 2011-05-10 14:15:00
SPY	2009-10-28 18:10:00	 26473 2011-05-10 14:15:00
STT	2011-01-04 14:30:00	  6484 2011-05-10 14:15:00
SU	2011-04-18 13:30:00	  1170 2011-05-09 19:55:00
SUN	2011-01-04 14:30:00	  6482 2011-05-10 14:05:00
SVM	2011-01-21 14:30:00	  5546 2011-05-10 14:05:00
SWC	2011-01-19 14:30:00	  5468 2011-05-10 14:05:00
T	2011-04-19 13:30:00	  1100 2011-05-10 14:05:00
TEVA	2011-01-04 14:30:00	  6240 2011-05-09 19:55:00
TGT	2011-01-04 14:30:00	  6247 2011-05-10 14:00:00
TKR	2011-01-04 14:30:00	  6481 2011-05-10 14:00:00
TLT	2011-01-04 14:30:00	  6481 2011-05-10 14:00:00
TSO	2011-02-17 14:30:00	  4063 2011-05-10 14:00:00
TXN	2011-04-11 13:30:00	  1567 2011-05-10 14:00:00
UNH	2011-01-04 14:30:00	  6246 2011-05-10 13:55:00
UNP	2011-01-04 14:30:00	  6246 2011-05-10 13:55:00
UPS	2011-01-04 14:30:00	  6480 2011-05-10 13:55:00
V	2011-04-19 13:30:00	  1098 2011-05-10 13:55:00
VALE	2011-01-24 14:30:00	  5460 2011-05-09 19:55:00
VECO	2011-01-04 14:30:00	  6479 2011-05-10 13:50:00
VLO	2011-02-17 14:30:00	  4061 2011-05-10 13:50:00
VMW	2011-01-04 14:30:00	  6245 2011-05-10 13:50:00
WDC	2011-01-04 14:30:00	  6478 2011-05-10 13:45:00
WFC	2011-04-13 13:30:00	  1408 2011-05-10 13:45:00
WFM	2011-01-04 14:30:00	  6290 2011-05-10 17:35:00
WHR	2011-01-04 14:30:00	  6524 2011-05-10 17:35:00
WMT	2009-10-28 18:10:00	 30421 2011-05-10 17:35:00
WYNN	2011-01-04 14:30:00	  6524 2011-05-10 17:35:00
X	2011-04-18 13:30:00	  1220 2011-05-10 17:35:00
XLB	2011-01-04 14:30:00	  6523 2011-05-10 17:30:00
XLE	2011-01-04 14:30:00	  6523 2011-05-10 17:30:00
XLU	2011-01-04 14:30:00	  6523 2011-05-10 17:30:00
XOM	2009-10-28 18:10:00	 30264 2011-05-10 17:30:00
YUM	2011-04-12 13:30:00	  1531 2011-05-10 17:30:00

176 rows selected.

Elapsed: 00:00:00.47
19:43:16 SQL> 
19:43:16 SQL> CREATE TABLE di5min_stk COMPRESS AS
19:43:16   2  SELECT
19:43:16   3  tkrdate
19:43:16   4  ,tkr
19:43:16   5  ,ydate
19:43:16   6  ,AVG(clse)clse
19:43:16   7  FROM di5min_stk0
19:43:16   8  -- I want weekdays:
19:43:16   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
19:43:16  10  GROUP BY
19:43:16  11  tkrdate
19:43:16  12  ,tkr
19:43:16  13  ,ydate
19:43:16  14  /

Table created.

Elapsed: 00:00:06.47
19:43:22 SQL> 
19:43:22 SQL> -- rpt
19:43:22 SQL> SELECT
19:43:22   2  TO_CHAR(ydate,'dy')
19:43:22   3  ,COUNT(ydate)
19:43:22   4  FROM di5min_stk
19:43:22   5  GROUP BY TO_CHAR(ydate,'dy')
19:43:22   6  /

TO_ COUNT(YDATE)
--- ------------
fri	  241045
mon	  242658
tue	  254450
wed	  249525
thu	  253140

Elapsed: 00:00:00.94
19:43:23 SQL> 
19:43:23 SQL> -- I need to shave a second off of some of the dates:
19:43:23 SQL> --
19:43:23 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
19:43:23 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
19:43:23 SQL> -- /
19:43:23 SQL> --
19:43:23 SQL> -- SELECT COUNT(*)FROM di5min_stk;
19:43:23 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
19:43:23 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
19:43:23 SQL> --
19:43:23 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
19:43:23 SQL> 
19:43:23 SQL> -- Add a column to help join with future dates
19:43:23 SQL> -- and then calculate 1 day gain:
19:43:23 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:15.79
19:43:39 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
19:43:39   2  SELECT
19:43:39   3  tkrdate
19:43:39   4  ,tkr
19:43:39   5  ,ydate
19:43:39   6  ,clse
19:43:39   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
19:43:39   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
19:43:39   9  	    ELSE NULL END selldate
19:43:39  10  FROM di5min_stk
19:43:39  11  /

Table created.

Elapsed: 00:00:04.17
19:43:43 SQL> 
19:43:43 SQL> -- Join with the future
19:43:43 SQL> 
19:43:43 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:06.98
19:43:50 SQL> 
19:43:50 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
19:43:50   2  SELECT
19:43:50   3  p.tkrdate
19:43:50   4  ,p.tkr
19:43:50   5  ,p.ydate
19:43:50   6  ,p.clse
19:43:50   7  ,p.selldate
19:43:50   8  ,f.clse clse2
19:43:50   9  ,f.clse - p.clse gain1day
19:43:50  10  FROM di5min_stk_fd p, di5min_stk f
19:43:50  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
19:43:50  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
19:43:50  13  /

Table created.

Elapsed: 00:00:08.47
19:43:59 SQL> 
19:43:59 SQL> -- rpt
19:43:59 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	241045
mon	242658
tue	254450
wed	249525
thu	253140

Elapsed: 00:00:00.90
19:44:00 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	241045
mon	242658
tue	254450
wed	249525
thu	253140

Elapsed: 00:00:02.07
19:44:02 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-05-10 19:25:00

Elapsed: 00:00:00.09
19:44:02 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-05-10 19:25:00

Elapsed: 00:00:00.16
19:44:02 SQL> 
19:44:02 SQL> -- rpt
19:44:02 SQL> SELECT
19:44:02   2  tkr
19:44:02   3  ,MIN(ydate)
19:44:02   4  ,COUNT(ydate)
19:44:02   5  ,MAX(ydate)
19:44:02   6  ,MIN(clse)
19:44:02   7  ,AVG(clse)
19:44:02   8  ,MAX(clse)
19:44:02   9  ,MAX(gain1day)
19:44:02  10  FROM di5min_stk_c2
19:44:02  11  GROUP BY tkr
19:44:02  12  ORDER BY tkr
19:44:02  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    6521 2011-05-10 17:20:00	 320.68 344.913646     364.83	      13.64
ABT	2011-01-04 14:30:00	    6521 2011-05-10 17:20:00	  45.09 48.6210005	52.99	       2.16
ABX	2011-01-04 14:30:00	    6521 2011-05-10 17:20:00	  45.64 50.2648481	55.71	       3.42
ACI	2011-04-19 13:30:00	    1139 2011-05-10 17:20:00	  30.72 32.9331183	34.73	       1.26
ADBE	2011-01-04 14:30:00	    6521 2011-05-10 17:20:00	  30.82 33.5568535	35.84	       1.64
ADM	2011-04-28 13:30:00	     668 2011-05-10 17:05:00	  33.12 35.1459132	37.21		.74
AEM	2011-01-04 14:30:00	    6518 2011-05-10 17:05:00	  62.14 68.4038428	76.47	       4.22
AFL	2011-01-04 14:30:00	    6518 2011-05-10 17:05:00	  48.59 55.4093876	59.48	       4.07
AGU	2011-01-24 14:30:00	    5504 2011-05-10 17:05:00	  82.33 90.9594748	99.13	       4.71
AIG	2011-01-04 14:30:00	    6518 2011-05-10 17:05:00	  29.28 39.4533772	62.47		4.8
AKAM	2011-01-04 14:30:00	    6515 2011-05-10 16:50:00	  32.66 41.1868357	52.47	       3.01
ALL	2011-01-04 14:30:00	    6515 2011-05-10 16:50:00	  30.47 31.6990355	34.35	       2.28
AMGN	2011-01-04 14:30:00	    6515 2011-05-10 16:50:00	  51.39 54.7995103	58.15	       2.53
AMT	2011-01-04 14:30:00	    6514 2011-05-10 16:45:00	  45.98 51.6029083	56.73	       2.44
AMX	2011-01-04 14:30:00	    6514 2011-05-10 16:45:00	  51.54 56.7903347	59.58	       1.74
AMZN	2011-01-04 14:30:00	    6511 2011-05-10 16:30:00	 160.93 180.247121     205.08	      15.21
APA	2011-01-04 14:30:00	    6511 2011-05-10 16:30:00	  110.8 123.202317     134.08	       5.98
APC	2011-01-04 14:30:00	    6511 2011-05-10 16:30:00	   73.1 78.6979176	 85.5	       4.12
ARG	2011-01-04 14:30:00	    6511 2011-05-10 16:30:00	  60.86 64.6926142	69.82	       2.46
AXP	2011-01-04 14:30:00	    6511 2011-05-10 16:30:00	  42.31 45.5854557	50.46	       1.92
AXU	2011-01-21 14:30:00	    5572 2011-05-10 16:15:00	   5.88 8.41285632	10.25	       1.07
BA	2011-01-04 14:30:00	    6508 2011-05-10 16:15:00	  66.51 72.5123041	 80.4	       3.47
BBT	2011-01-04 14:30:00	    6508 2011-05-10 16:15:00	   25.4 27.2589933	29.55		1.3
BBY	2011-01-04 14:30:00	    6508 2011-05-10 16:15:00	  28.16 32.2077587	36.18	       1.66
BEN	2011-01-04 14:30:00	    6508 2011-05-10 16:15:00	 109.71 122.443959     130.71	       5.04
BHP	2011-01-04 14:30:00	    6505 2011-05-10 16:00:00	  83.94 93.8366527     104.43	       3.59
BIDU	2011-01-04 14:30:00	    6505 2011-05-10 16:00:00	  99.53 126.771918     154.87	      11.14
BP	2011-01-04 14:30:00	    6505 2011-05-10 16:00:00	  42.55 46.3269263	49.38	       1.83
BRCM	2011-01-04 14:30:00	    6505 2011-05-10 16:00:00	  33.24 41.1882159	47.32	       2.42
BTU	2011-01-04 14:30:00	    6504 2011-05-10 15:55:00	   57.7 65.4764197	73.67	       5.41
BUCY	2011-01-04 14:30:00	    6502 2011-05-10 15:45:00	  89.67 90.9750879 92.0759375		.24
CAT	2011-01-04 14:30:00	    6501 2011-05-10 15:40:00	  92.37 103.478191     115.83	       4.11
CDE	2011-01-21 14:30:00	    5565 2011-05-10 15:40:00	  22.13  30.272114	37.46		3.7
CELG	2011-01-04 14:30:00	    6501 2011-05-10 15:40:00	  48.96 55.4236724	61.66	       2.45
CEO	2011-01-24 14:30:00	    5487 2011-05-10 15:40:00	 206.99 237.444756     271.74	      12.17
CHK	2011-01-24 14:30:00	    5484 2011-05-10 15:25:00	  27.24 32.2337678	35.83	       2.53
CLF	2011-01-04 14:30:00	    6498 2011-05-10 15:25:00	  79.77 91.5823785     102.14	       8.31
CMI	2011-01-04 14:30:00	    6498 2011-05-10 15:25:00	  94.36 108.291729     121.12	       9.16
COF	2011-01-04 14:30:00	    6498 2011-05-10 15:25:00	  43.23 50.3876763	 55.6		3.5
COP	2011-01-04 14:30:00	    6498 2011-05-10 15:25:00	  66.58 74.8508264	 81.7	       3.43
COST	2011-01-04 14:30:00	    6495 2011-05-10 15:10:00	  69.56 74.3042048	 82.2		3.6
CREE	2011-01-04 14:30:00	    6495 2011-05-10 15:10:00	  38.57 49.6552098	69.19	       2.89
CRM	2011-01-04 14:30:00	    6495 2011-05-10 15:10:00	 117.84 133.466274     146.42	      12.14
CSCO	2011-04-28 13:30:00	     645 2011-05-10 15:10:00	  17.24 17.4796899	17.77		.34
CSX	2011-01-04 14:30:00	    6495 2011-05-10 15:10:00	  64.81  74.039208	80.23	       3.28
CTSH	2011-01-04 14:30:00	    6492 2011-05-10 14:55:00	  70.72 77.1389288	83.36	       3.64
CVE	2011-02-14 14:30:00	    4308 2011-05-10 14:55:00	  34.32 37.7059477	40.72	 1.75985901
CVS	2011-01-04 14:30:00	    6491 2011-05-10 14:50:00	  32.29 34.6115259	37.63	       1.42
CVX	2011-01-04 14:30:00	    6491 2011-05-10 14:50:00	  90.21 101.000207     109.94	       2.98
DD	2011-01-04 14:30:00	    6491 2011-05-10 14:50:00	  47.28 53.1488204	56.98	       1.91
DE	2011-01-04 14:30:00	    6488 2011-05-10 14:35:00	  81.82 92.0822623	 99.8	       3.93
DIA	2009-10-28 18:10:00	   30385 2011-05-10 14:35:00	  96.34 109.482438	128.5	       4.35
DIS	2009-10-28 18:10:00	   30385 2011-05-10 14:35:00	  27.06 35.3177791	44.29	       3.13
DNDN	2011-01-04 14:30:00	    6488 2011-05-10 14:35:00	  31.34   36.37457	 43.8	       3.89
DTV	2011-01-04 14:30:00	    6488 2011-05-10 14:35:00	  40.79 45.0040557	49.73	       1.78
DVN	2011-01-04 14:30:00	    6485 2011-05-10 14:20:00	  77.06 87.3113759	93.42	       4.67
EBAY	2009-10-28 18:10:00	   30174 2011-05-10 14:20:00	  19.17 25.8875382	 35.3	       2.69
EFA	2011-01-04 14:30:00	    6485 2011-05-10 14:20:00	   54.7 60.3145544	64.34	       2.16
EOG	2011-01-04 14:30:00	    6485 2011-05-10 14:20:00	  91.02 107.364605     120.99		8.1
ESRX	2011-01-04 14:30:00	    6485 2011-05-10 14:20:00	  51.25 56.0644771	 59.8	       3.09
EWZ	2011-01-04 14:30:00	    6546 2011-05-10 19:25:00	  70.16 75.3740959	80.07	       2.02
EXK	2011-01-21 14:30:00	    5610 2011-05-10 19:25:00	    5.4 9.05869576	12.73	       1.56
FCX	2011-02-02 14:30:00	    4986 2011-05-10 19:25:00	  46.43 53.4407193	58.66	       4.94
FDX	2011-01-04 14:30:00	    6546 2011-05-10 19:25:00	  85.04 92.6556886	98.45		3.9
FFIV	2011-01-04 14:30:00	    6546 2011-05-10 19:25:00	  91.18 110.891652     145.75	      14.45
FLS	2011-01-04 14:30:00	    6309 2011-05-10 19:10:00	  112.9 125.247229     135.62	       5.86
FSLR	2011-01-04 14:30:00	    6542 2011-05-10 19:05:00	 124.48 147.142102	  174	      12.54
FXI	2011-04-06 13:30:00	    1862 2011-05-10 19:05:00	   43.2 45.1804082	 46.4	       1.18
GD	2011-04-18 13:30:00	    1238 2011-05-10 19:05:00	   70.5 73.0193379	75.05	       2.26
GDX	2011-01-04 14:30:00	    6542 2011-05-10 19:05:00	  52.52 58.3069851	64.14	       3.62
GFI	2011-01-28 14:30:00	    4979 2011-05-10 18:50:00	  15.67 17.1417596	18.69		.79
GG	2011-01-04 14:30:00	    6305 2011-05-10 18:50:00	  39.13  47.531052	56.08	       4.45
GILD	2011-01-04 14:30:00	    6305 2011-05-10 18:50:00	  36.51 39.8993406	42.91	       1.83
GLD	2011-01-04 14:30:00	    6305 2011-05-10 18:50:00	 127.83 138.607071     153.46	       3.24
GOOG	2009-10-28 18:10:00	   30202 2011-05-10 18:50:00	  434.6 552.211209     641.65	      63.83
GS	2011-01-04 14:30:00	    6535 2011-05-10 18:30:00	 148.91 161.415627	  175	       6.13
HAL	2011-04-08 13:30:00	    1699 2011-05-10 18:30:00	  44.64 48.2260863	51.24	       2.17
HD	2011-01-04 14:30:00	    6535 2011-05-10 18:30:00	  34.09 36.9014056	38.49	       1.42
HES	2011-01-04 14:30:00	    6535 2011-05-10 18:30:00	  76.04 81.5387725	87.09		4.5
HL	2011-01-18 14:30:00	    5677 2011-05-10 18:30:00	   7.84 9.20945883	11.08		.85
HOC	2011-02-17 14:30:00	    4113 2011-05-10 18:10:00	  50.79 58.3032516	66.41	       4.77
HON	2011-01-04 14:30:00	    6531 2011-05-10 18:10:00	  53.03 57.3371116	62.27	       2.29
HPQ	2009-10-28 18:10:00	   30428 2011-05-10 18:10:00	  37.45 46.1039258	 54.7		3.4
IBM	2009-10-28 18:10:00	   30428 2011-05-10 18:10:00	 119.59 137.716311     173.45	       6.28
IOC	2011-01-04 14:30:00	    6531 2011-05-10 18:10:00	   55.4 70.7953005	81.72	       4.58
IWM	2011-01-04 14:30:00	    6531 2011-05-10 18:10:00	  77.04  81.591532	 86.7	       2.49
JNJ	2011-01-04 14:30:00	    6531 2011-05-10 18:10:00	   57.5 61.3247731	66.45	       2.51
JOYG	2011-01-04 14:30:00	    6296 2011-05-10 18:05:00	  83.82 93.2429955     103.31	       6.04
JPM	2011-01-04 14:30:00	    6530 2011-05-10 18:05:00	  42.77 45.4821274	48.27		2.5
JWN	2011-01-04 14:30:00	    6530 2011-05-10 18:05:00	  40.03 44.3855445	48.69	       2.39
KO	2011-01-04 14:30:00	    6514 2011-05-10 16:45:00	  61.35 64.9086343	68.45	       2.22
LFT	2011-01-04 14:30:00	    6514 2011-05-10 16:45:00	  17.04  30.425627	   37	       4.03
LMT	2011-01-28 14:30:00	    4954 2011-05-10 16:45:00	  75.84 80.0158184	82.41	       2.23
LVS	2011-04-13 13:30:00	    1444 2011-05-10 16:45:00	  42.43 45.0788322	48.22		2.6
MAR	2011-01-04 14:30:00	    6514 2011-05-10 16:45:00	  33.65 37.9874104	42.58	       1.63
MCD	2011-01-04 14:30:00	    6277 2011-05-10 16:30:00	  72.15  75.688917	79.78	       2.68
MDT	2011-01-04 14:30:00	    6510 2011-05-10 16:25:00	  36.18  39.186138	43.11	       1.36
MDY	2011-01-04 14:30:00	    6510 2011-05-10 16:25:00	 163.62 174.518276     184.92		4.5
MEE	2011-01-04 14:30:00	    6276 2011-05-10 16:25:00	  52.03 62.5484041	 71.1	       9.93
MET	2011-01-04 14:30:00	    6510 2011-05-10 16:25:00	  41.29 45.5578374	48.71	       2.17
MJN	2011-01-04 14:30:00	    6274 2011-05-10 16:15:00	  55.29 60.2297236	 67.4	       3.43
MMM	2011-01-04 14:30:00	    6508 2011-05-10 16:15:00	  85.68 91.4247484	97.94	       2.82
MON	2011-01-04 14:30:00	    6508 2011-05-10 16:15:00	  64.34 70.4645403	76.13	       4.04
MOS	2011-01-04 14:30:00	    6507 2011-05-10 16:10:00	  69.59 78.9060102	89.17	       4.26
MRK	2011-01-04 14:30:00	    6507 2011-05-10 16:10:00	  31.07 33.8443882	 37.6	 1.48993034
MRO	2011-04-19 13:30:00	    1122 2011-05-10 15:55:00	  49.11 52.1628855	54.26	       2.68
MSFT	2011-04-15 13:30:00	    1278 2011-05-10 15:55:00	  24.76 25.7420498	26.84	       1.03
MT	2011-01-04 14:30:00	    6504 2011-05-10 15:55:00	  32.43 36.1776667	38.41	       2.13
MVG	2011-01-21 14:30:00	    5333 2011-05-10 15:55:00	   9.25 11.7107952	14.75		2.9
NEM	2011-01-04 14:30:00	    6240 2011-05-09 19:55:00	  50.07 55.8599108 60.3845017	       2.83
NFLX	2011-01-04 14:30:00	    6268 2011-05-10 15:45:00	  176.3 216.794346     253.46	      29.02
NOC	2011-01-28 14:30:00	    4941 2011-05-10 15:40:00	  59.93 65.7336962	 72.4	       2.25
NUE	2011-01-04 14:30:00	    6267 2011-05-10 15:40:00	  42.81 46.0209252	49.23	       2.14
OIH	2011-01-04 14:30:00	    6501 2011-05-10 15:40:00	 135.78 154.953974     167.15	       8.52
ORCL	2011-03-01 14:30:00	    3822 2011-05-09 19:55:00	  29.63 33.3270898	36.46	       2.05
OXY	2011-01-04 14:30:00	    6498 2011-05-10 15:25:00	  93.76 100.475204     117.67	      11.03
PAAS	2011-01-21 14:30:00	    5562 2011-05-10 15:25:00	  31.13  36.238059	42.95	       3.49
PALL	2011-01-21 14:30:00	    5562 2011-05-10 15:25:00	  68.75 77.5102738	85.33	       3.41
PBR	2011-01-04 14:30:00	    6498 2011-05-10 15:25:00	  33.97 38.1265256	42.57	       1.67
PEP	2011-01-04 14:30:00	    6474 2011-05-09 19:55:00	  62.07 65.4684351	69.95	       2.03

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
PG	2011-01-04 14:30:00	    6494 2011-05-10 15:05:00	  59.77 63.4041139	66.94	       1.75
PM	2011-01-04 14:30:00	    6494 2011-05-10 15:05:00	  55.88 62.4856241	69.82	       1.94
PNC	2011-01-04 14:30:00	    6494 2011-05-10 15:05:00	  59.75  62.266991	65.14	       3.13
POT	2011-01-04 14:30:00	    6260 2011-05-10 15:05:00	  50.49 97.3819031     189.19	      13.11
PPLT	2011-01-21 14:30:00	    5553 2011-05-10 15:05:00	 167.76 178.602431     186.62	 11.7949186
PRU	2011-01-04 14:30:00	    6491 2011-05-10 14:50:00	  56.82 62.2873815	67.47	       3.29
QCOM	2011-01-04 14:30:00	    6257 2011-05-10 14:50:00	   49.9  54.391293	59.79	       3.54
QQQ	2010-12-27 14:30:00	    6959 2011-05-10 14:50:00	  53.78  56.931938	59.31	       1.69
QQQQ	2009-10-28 18:10:00	   23429 2010-12-24 20:50:00	   40.7 47.1419117	54.95		2.5
RDY	2011-01-24 14:30:00	    5243 2011-05-10 14:50:00	  32.68 35.9198208	39.37	       2.29
RIG	2011-01-04 14:30:00	    6491 2011-05-10 14:50:00	     66  77.891221	85.94	       5.25
RIMM	2011-01-04 14:30:00	    6489 2011-05-10 14:40:00	  44.24 59.6152335	70.47	       3.93
RTN	2011-01-28 14:30:00	    5163 2011-05-10 14:40:00	  47.74 50.4161881	53.08	       1.65
SBUX	2011-04-26 13:30:00	     794 2011-05-10 14:35:00	  35.85 36.6022544	37.61	       1.07
SCCO	2011-01-24 14:30:00	    5474 2011-05-10 14:35:00	  34.98 40.6321629	47.56	       2.84
SINA	2011-01-04 14:30:00	    6240 2011-05-09 19:55:00	  72.55 99.8168884     146.39	      22.73
SJM	2011-01-04 14:30:00	    6252 2011-05-10 14:25:00	  61.18 68.9034712	75.73	       3.08
SKX	2011-01-04 14:30:00	    6486 2011-05-10 14:25:00	  17.68 20.4060995	23.65	       1.48
SLB	2011-01-04 14:30:00	    6486 2011-05-10 14:25:00	  79.84 87.9349729	 95.1	       4.98
SLV	2011-01-04 14:30:00	    6486 2011-05-10 14:25:00	  26.08 34.2272543	48.26	       4.21
SLW	2011-01-21 14:30:00	    5550 2011-05-10 14:25:00	   28.9 39.5111072	47.58	       3.06
SNDK	2011-01-04 14:30:00	    6484 2011-05-10 14:15:00	  41.11 48.1409324	53.47		3.6
SOHU	2011-01-24 14:30:00	    5470 2011-05-10 14:15:00	  64.69 87.6873263	108.8	       9.31
SPY	2009-10-28 18:10:00	   26473 2011-05-10 14:15:00	 103.18 118.652465     137.15		5.1
STT	2011-01-04 14:30:00	    6484 2011-05-10 14:15:00	   42.3 45.9003557	50.22		2.1
SU	2011-04-18 13:30:00	    1170 2011-05-09 19:55:00	  40.83 43.9411929	46.96	       2.07
SUN	2011-01-04 14:30:00	    6482 2011-05-10 14:05:00	  38.49 42.6113039	46.93	       2.07
SVM	2011-01-21 14:30:00	    5546 2011-05-10 14:05:00	   9.41 13.0910708	16.32	       1.21
SWC	2011-01-19 14:30:00	    5468 2011-05-10 14:05:00	  19.36 22.3487629	25.88	       1.88
T	2011-04-19 13:30:00	    1100 2011-05-10 14:05:00	  29.92 31.0930336	31.91		 .8
TEVA	2011-01-04 14:30:00	    6240 2011-05-09 19:55:00	  44.87 50.6490202	56.96	       3.35
TGT	2011-01-04 14:30:00	    6247 2011-05-10 14:00:00	  48.54 52.1979367	60.37	       2.01
TKR	2011-01-04 14:30:00	    6481 2011-05-10 14:00:00	  44.57 50.5291293	 57.6	       4.83
TLT	2011-01-04 14:30:00	    6481 2011-05-10 14:00:00	  88.19 91.7323987	95.62	       2.07
TSO	2011-02-17 14:30:00	    4063 2011-05-10 14:00:00	   22.4 25.7532794	28.66	       3.17
TXN	2011-04-11 13:30:00	    1567 2011-05-10 14:00:00	  33.93 35.0670997	35.97		 .8
UNH	2011-01-04 14:30:00	    6246 2011-05-10 13:55:00	  36.95 43.4628112	50.96	       3.99
UNP	2011-01-04 14:30:00	    6246 2011-05-10 13:55:00	  91.04 96.5650517     104.09	       3.77
UPS	2011-01-04 14:30:00	    6480 2011-05-10 13:55:00	  70.24 73.3255544	76.97	       4.15
V	2011-04-19 13:30:00	    1098 2011-05-10 13:55:00	  75.17 78.4489531	80.12	       2.47
VALE	2011-01-24 14:30:00	    5460 2011-05-09 19:55:00	  30.56 33.4348138	36.36		1.3
VECO	2011-01-04 14:30:00	    6479 2011-05-10 13:50:00	  42.58 48.0837513	53.12	       4.28
VLO	2011-02-17 14:30:00	    4061 2011-05-10 13:50:00	  25.78 28.3153853	31.05		2.5
VMW	2011-01-04 14:30:00	    6245 2011-05-10 13:50:00	  74.39 86.5376458	99.02	      12.71
WDC	2011-01-04 14:30:00	    6478 2011-05-10 13:45:00	  29.42  35.463867	41.77	       5.73
WFC	2011-04-13 13:30:00	    1408 2011-05-10 13:45:00	  27.79 29.1750334	31.43		.72
WFM	2011-01-04 14:30:00	    6290 2011-05-10 17:35:00	  47.85 58.5038763	66.83	       7.83
WHR	2011-01-04 14:30:00	    6524 2011-05-10 17:35:00	   79.2  84.865796	92.05	       3.97
WMT	2009-10-28 18:10:00	   30421 2011-05-10 17:35:00	  47.76 53.2676494	57.85	       2.22
WYNN	2011-01-04 14:30:00	    6524 2011-05-10 17:35:00	 109.66 127.391205     151.42	      11.22
X	2011-04-18 13:30:00	    1220 2011-05-10 17:35:00	  45.31 48.7643975	53.31	       3.07
XLB	2011-01-04 14:30:00	    6523 2011-05-10 17:30:00	  36.57 39.1800488	41.17	       1.18
XLE	2011-01-04 14:30:00	    6523 2011-05-10 17:30:00	  67.54 75.3599067	80.87	       2.54
XLU	2011-01-04 14:30:00	    6523 2011-05-10 17:30:00	  30.75 31.9895144	33.88		 .7
XOM	2009-10-28 18:10:00	   30264 2011-05-10 17:30:00	  56.05 69.5849735	87.98	       3.66
YUM	2011-04-12 13:30:00	    1531 2011-05-10 17:30:00	  49.67 52.3670245	55.27	       3.21

176 rows selected.

Elapsed: 00:00:01.02
19:44:03 SQL> 
19:44:03 SQL> COLUMN clse FORMAT 999.9999
19:44:03 SQL> SELECT
19:44:03   2  tkr
19:44:03   3  ,ROUND(clse,4)clse
19:44:03   4  -- Should be NULL:
19:44:03   5  ,ROUND(clse2,4)clse2
19:44:03   6  ,ydate
19:44:03   7  FROM di5min_stk_c2
19:44:03   8  WHERE ydate > sysdate - 0.5/24
19:44:03   9  ORDER BY tkr,ydate
19:44:03  10  /

TKR	     CLSE      CLSE2 YDATE
------- --------- ---------- -------------------
EWZ	  74.9600	     2011-05-10 19:15:00
EWZ	  75.0000	     2011-05-10 19:20:00
EWZ	  75.0500	     2011-05-10 19:25:00
EXK	  10.0500	     2011-05-10 19:15:00
EXK	  10.0600	     2011-05-10 19:20:00
EXK	  10.0200	     2011-05-10 19:25:00
FCX	  51.6200	     2011-05-10 19:15:00
FCX	  51.6400	     2011-05-10 19:20:00
FCX	  51.5900	     2011-05-10 19:25:00
FDX	  95.8700	     2011-05-10 19:15:00
FDX	  95.8800	     2011-05-10 19:20:00
FDX	  95.9800	     2011-05-10 19:25:00
FFIV	 104.4700	     2011-05-10 19:15:00
FFIV	 104.5800	     2011-05-10 19:20:00
FFIV	 104.5100	     2011-05-10 19:25:00

15 rows selected.

Elapsed: 00:00:00.20
19:44:03 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
