
SQL*Plus: Release 11.2.0.1.0 Production on Wed Mar 30 15:15:32 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

15:15:32 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
15:15:32 SQL> 
15:15:32 SQL> 15:15:32 SQL> --
15:15:32 SQL> -- update_di5min_stk.sql
15:15:32 SQL> --
15:15:32 SQL> 
15:15:32 SQL> -- I use this script to keep di5min_stk up to date.
15:15:32 SQL> 
15:15:32 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
15:15:32 SQL> -- After that date, it holds data from IB.
15:15:32 SQL> 
15:15:32 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
15:15:32 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
15:15:32 SQL> 
15:15:32 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.54
15:15:32 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.65
15:15:33 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:04.71
15:15:38 SQL> 
15:15:38 SQL> 
15:15:38 SQL> -- I need to shave a second off of some of the dates:
15:15:38 SQL> 
15:15:38 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
15:15:38   2  WHERE TO_CHAR(ydate,'SS')='01'
15:15:38   3  /

0 rows updated.

Elapsed: 00:00:00.25
15:15:38 SQL> 
15:15:38 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    728933

Elapsed: 00:00:00.02
15:15:38 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    728933

Elapsed: 00:00:00.20
15:15:38 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.20
15:15:39 SQL> 
15:15:39 SQL> -- Copy in data from ibs5min:
15:15:39 SQL> 
15:15:39 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
15:15:39   2  SELECT	     tkr||ydate,tkr,ydate,clse
15:15:39   3  FROM ibs5min
15:15:39   4  WHERE ydate >= '2010-12-27 09:00:00'
15:15:39   5  /

728933 rows created.

Elapsed: 00:00:03.75
15:15:42 SQL> 
15:15:42 SQL> -- rpt
15:15:42 SQL> SELECT
15:15:42   2  tkr
15:15:42   3  ,MIN(ydate)
15:15:42   4  ,COUNT(tkr)
15:15:42   5  ,MAX(ydate)
15:15:42   6  FROM di5min_stk0
15:15:42   7  GROUP BY tkr
15:15:42   8  ORDER BY tkr
15:15:42   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
ABT	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
ABX	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
ADBE	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
AEM	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
AFL	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AGU	2011-01-24 14:30:00	  3596 2011-03-30 14:05:00
AIG	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AKAM	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
ALL	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AMGN	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AMT	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AMX	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AMZN	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
APA	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
APC	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
ARG	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AXP	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
AXU	2011-01-21 14:30:00	  3675 2011-03-30 14:10:00
BA	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BBT	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BBY	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BEN	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BHP	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BIDU	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BP	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BRCM	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BTU	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BUCY	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
CAT	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
CDE	2011-01-21 14:30:00	  3610 2011-03-29 15:15:00
CELG	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
CEO	2011-01-24 14:30:00	  3532 2011-03-29 15:15:00
CHK	2011-01-24 14:30:00	  3532 2011-03-29 15:15:00
CLF	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
CMI	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
COF	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
COP	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
COST	2011-01-04 14:30:00	  4547 2011-03-29 15:20:00
CREE	2011-01-04 14:30:00	  4612 2011-03-30 14:15:00
CRM	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
CSX	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
CTSH	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
CVE	2011-02-14 14:30:00	  3141 2011-03-30 14:20:00
CVS	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
CVX	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DD	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DE	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DIA	2010-12-27 09:00:00	  6188 2011-03-30 14:20:00
DIS	2010-12-27 09:00:00	  5940 2011-03-30 14:20:00
DNDN	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DTV	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DVN	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
EBAY	2010-12-27 09:00:00	  5978 2011-03-30 14:25:00
EFA	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
EOG	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
ESRX	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
EWZ	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
EXK	2011-01-21 14:30:00	  4487 2011-03-30 14:25:00
FCX	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
FDX	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
FFIV	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
FLS	2011-01-04 14:30:00	  4548 2011-03-30 14:25:00
FSLR	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
GD	2011-01-28 14:30:00	  3289 2011-03-30 14:30:00
GDX	2011-01-04 14:30:00	  4615 2011-03-30 14:30:00
GFI	2011-01-28 14:30:00	  3055 2011-03-30 14:30:00
GG	2011-01-04 14:30:00	  4381 2011-03-30 14:30:00
GILD	2011-01-04 14:30:00	  4381 2011-03-30 14:30:00
GLD	2011-01-04 14:30:00	  4381 2011-03-30 14:30:00
GOOG	2010-12-27 09:00:00	  5978 2011-03-30 14:30:00
GS	2011-01-04 14:30:00	  4615 2011-03-30 14:30:00
HD	2011-01-04 14:30:00	  4615 2011-03-30 14:30:00
HES	2011-01-04 14:30:00	  4615 2011-03-30 14:30:00
HL	2011-01-18 12:30:00	  4015 2011-03-30 14:30:00
HOC	2011-02-17 14:30:00	  2198 2011-03-30 14:35:00
HON	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
HPQ	2010-12-27 09:00:00	  6108 2011-03-30 14:35:00
IBM	2010-12-27 09:00:00	  6083 2011-03-30 14:35:00
IOC	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
IWM	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
JNJ	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
JOYG	2011-01-04 14:30:00	  4382 2011-03-30 14:35:00
JPM	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
JWN	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
KO	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
LFT	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
LMT	2011-01-28 14:30:00	  3057 2011-03-30 14:40:00
MAR	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MCD	2011-01-04 14:30:00	  4383 2011-03-30 14:40:00
MDT	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MDY	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MEE	2011-01-04 14:30:00	  4383 2011-03-30 14:40:00
MET	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MJN	2011-01-04 14:30:00	  4383 2011-03-30 14:40:00
MMM	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MON	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MOS	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MRK	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
MT	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
MVG	2011-01-21 14:30:00	  3447 2011-03-30 14:45:00
NEM	2011-01-04 14:30:00	  4384 2011-03-30 14:45:00
NFLX	2011-01-04 14:30:00	  4384 2011-03-30 14:45:00
NOC	2011-01-28 14:30:00	  3058 2011-03-30 14:45:00
NUE	2011-01-04 14:30:00	  4384 2011-03-30 14:45:00
OIH	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
ORCL	2011-03-01 14:30:00	  1645 2011-03-30 14:00:00
OXY	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
PAAS	2011-01-21 14:30:00	  3682 2011-03-30 14:45:00
PALL	2011-01-21 14:30:00	  3682 2011-03-30 14:45:00
PBR	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
PEP	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
PG	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
PM	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
PNC	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
POT	2011-01-04 14:30:00	  4385 2011-03-30 14:50:00
PPLT	2011-01-21 14:30:00	  3680 2011-03-30 14:50:00
PRU	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
QCOM	2011-01-04 14:30:00	  4385 2011-03-30 14:50:00
QQQ	2010-12-27 09:00:00	  6302 2011-03-30 14:50:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
QQQQ	2010-12-27 09:00:00	  5895 2011-03-22 19:55:00
RDY	2011-01-24 14:30:00	  3371 2011-03-30 14:50:00
RIG	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
RIMM	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
RTN	2011-01-28 14:30:00	  3294 2011-03-30 14:55:00
SCCO	2011-01-24 14:30:00	  3606 2011-03-30 14:55:00
SINA	2011-01-04 14:30:00	  4386 2011-03-30 14:55:00
SJM	2011-01-04 14:30:00	  4386 2011-03-30 14:55:00
SKX	2011-01-04 14:30:00	  4620 2011-03-30 14:55:00
SLB	2011-01-04 14:30:00	  4620 2011-03-30 14:55:00
SLV	2011-01-04 14:30:00	  4620 2011-03-30 14:55:00
SLW	2011-01-21 14:30:00	  3684 2011-03-30 14:55:00
SNDK	2011-01-04 14:30:00	  4620 2011-03-30 14:55:00
SOHU	2011-01-24 14:30:00	  3606 2011-03-30 14:55:00
SPY	2010-12-27 09:00:00	  6454 2011-03-30 14:55:00
STT	2011-01-04 14:30:00	  4621 2011-03-30 15:00:00
SU	2011-02-17 14:30:00	  2203 2011-03-30 15:00:00
SUN	2011-01-04 14:30:00	  4621 2011-03-30 15:00:00
SVM	2011-01-21 14:30:00	  4908 2011-03-30 15:00:00
SWC	2011-01-19 14:30:00	  3607 2011-03-30 15:00:00
T	2011-02-04 14:30:00	  1879 2011-03-30 14:00:00
TEVA	2011-01-04 14:30:00	  4387 2011-03-30 15:00:00
TGT	2011-01-04 14:30:00	  4387 2011-03-30 15:00:00
TKR	2011-01-04 14:30:00	  4621 2011-03-30 15:00:00
TLT	2011-01-04 14:30:00	  4621 2011-03-30 15:00:00
TSO	2011-02-17 14:30:00	  2203 2011-03-30 15:00:00
UNH	2011-01-04 14:30:00	  4387 2011-03-30 15:00:00
UNP	2011-01-04 14:30:00	  4388 2011-03-30 15:05:00
UPS	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
V	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
VALE	2011-01-24 14:30:00	  3608 2011-03-30 15:05:00
VECO	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
VLO	2011-02-17 14:30:00	  2204 2011-03-30 15:05:00
VMW	2011-01-04 14:30:00	  4388 2011-03-30 15:05:00
WDC	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
WFMI	2011-01-04 14:30:00	  4388 2011-03-30 15:05:00
WHR	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
WMT	2010-12-27 09:00:00	  6071 2011-03-30 15:05:00
WYNN	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
X	2011-01-04 12:40:00	  5133 2011-03-30 15:10:00
XLB	2011-01-04 14:30:00	  4623 2011-03-30 15:10:00
XLE	2011-01-04 14:30:00	  4623 2011-03-30 15:10:00
XLU	2011-01-04 14:30:00	  4623 2011-03-30 15:10:00
XOM	2010-12-27 09:00:00	  6359 2011-03-30 15:10:00

164 rows selected.

Elapsed: 00:00:00.31
15:15:43 SQL> 
15:15:43 SQL> -- Next, copy in data from dukas.
15:15:43 SQL> -- dukas5min_stk depends on:
15:15:43 SQL> -- - dukas10min_stk
15:15:43 SQL> -- - svmspy/dukas/fake5.sql
15:15:43 SQL> 
15:15:43 SQL> 
15:15:43 SQL> -- I need to shave a second off of some of the dates:
15:15:43 SQL> 
15:15:43 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
15:15:43   2  WHERE TO_CHAR(ydate,'SS')='01'
15:15:43   3  /

0 rows updated.

Elapsed: 00:00:00.63
15:15:43 SQL> 
15:15:43 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
15:15:43 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.08
15:15:43 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.07
15:15:43 SQL> 
15:15:43 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
15:15:43   2  SELECT	     tkr||ydate,tkr,ydate,clse
15:15:43   3  FROM dukas5min_stk
15:15:43   4  WHERE ydate < '2010-12-27 09:00:00'
15:15:43   5  /

230382 rows created.

Elapsed: 00:00:00.51
15:15:44 SQL> 
15:15:44 SQL> -- rpt
15:15:44 SQL> SELECT
15:15:44   2  tkr
15:15:44   3  ,MIN(ydate)
15:15:44   4  ,COUNT(tkr)
15:15:44   5  ,MAX(ydate)
15:15:44   6  FROM dukas5min_stk
15:15:44   7  WHERE ydate < '2010-12-27 09:00:00'
15:15:44   8  GROUP BY tkr
15:15:44   9  ORDER BY tkr
15:15:44  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.08
15:15:44 SQL> 
15:15:44 SQL> -- rpt
15:15:44 SQL> SELECT
15:15:44   2  tkr
15:15:44   3  ,MIN(ydate)
15:15:44   4  ,COUNT(tkr)
15:15:44   5  ,MAX(ydate)
15:15:44   6  FROM di5min_stk0
15:15:44   7  GROUP BY tkr
15:15:44   8  ORDER BY tkr
15:15:44   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
ABT	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
ABX	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
ADBE	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
AEM	2011-01-04 14:30:00	  4609 2011-03-30 14:00:00
AFL	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AGU	2011-01-24 14:30:00	  3596 2011-03-30 14:05:00
AIG	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AKAM	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
ALL	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AMGN	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AMT	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AMX	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AMZN	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
APA	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
APC	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
ARG	2011-01-04 14:30:00	  4610 2011-03-30 14:05:00
AXP	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
AXU	2011-01-21 14:30:00	  3675 2011-03-30 14:10:00
BA	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BBT	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BBY	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BEN	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BHP	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BIDU	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BP	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BRCM	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BTU	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
BUCY	2011-01-04 14:30:00	  4611 2011-03-30 14:10:00
CAT	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
CDE	2011-01-21 14:30:00	  3610 2011-03-29 15:15:00
CELG	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
CEO	2011-01-24 14:30:00	  3532 2011-03-29 15:15:00
CHK	2011-01-24 14:30:00	  3532 2011-03-29 15:15:00
CLF	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
CMI	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
COF	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
COP	2011-01-04 14:30:00	  4546 2011-03-29 15:15:00
COST	2011-01-04 14:30:00	  4547 2011-03-29 15:20:00
CREE	2011-01-04 14:30:00	  4612 2011-03-30 14:15:00
CRM	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
CSX	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
CTSH	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
CVE	2011-02-14 14:30:00	  3141 2011-03-30 14:20:00
CVS	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
CVX	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DD	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DE	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DIA	2009-10-28 18:10:00	 29617 2011-03-30 14:20:00
DIS	2009-10-28 18:10:00	 29369 2011-03-30 14:20:00
DNDN	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DTV	2011-01-04 14:30:00	  4613 2011-03-30 14:20:00
DVN	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
EBAY	2009-10-28 18:10:00	 29407 2011-03-30 14:25:00
EFA	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
EOG	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
ESRX	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
EWZ	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
EXK	2011-01-21 14:30:00	  4487 2011-03-30 14:25:00
FCX	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
FDX	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
FFIV	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
FLS	2011-01-04 14:30:00	  4548 2011-03-30 14:25:00
FSLR	2011-01-04 14:30:00	  4614 2011-03-30 14:25:00
GD	2011-01-28 14:30:00	  3289 2011-03-30 14:30:00
GDX	2011-01-04 14:30:00	  4615 2011-03-30 14:30:00
GFI	2011-01-28 14:30:00	  3055 2011-03-30 14:30:00
GG	2011-01-04 14:30:00	  4381 2011-03-30 14:30:00
GILD	2011-01-04 14:30:00	  4381 2011-03-30 14:30:00
GLD	2011-01-04 14:30:00	  4381 2011-03-30 14:30:00
GOOG	2009-10-28 18:10:00	 29407 2011-03-30 14:30:00
GS	2011-01-04 14:30:00	  4615 2011-03-30 14:30:00
HD	2011-01-04 14:30:00	  4615 2011-03-30 14:30:00
HES	2011-01-04 14:30:00	  4615 2011-03-30 14:30:00
HL	2011-01-18 12:30:00	  4015 2011-03-30 14:30:00
HOC	2011-02-17 14:30:00	  2198 2011-03-30 14:35:00
HON	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
HPQ	2009-10-28 18:10:00	 29537 2011-03-30 14:35:00
IBM	2009-10-28 18:10:00	 29512 2011-03-30 14:35:00
IOC	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
IWM	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
JNJ	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
JOYG	2011-01-04 14:30:00	  4382 2011-03-30 14:35:00
JPM	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
JWN	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
KO	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
LFT	2011-01-04 14:30:00	  4616 2011-03-30 14:35:00
LMT	2011-01-28 14:30:00	  3057 2011-03-30 14:40:00
MAR	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MCD	2011-01-04 14:30:00	  4383 2011-03-30 14:40:00
MDT	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MDY	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MEE	2011-01-04 14:30:00	  4383 2011-03-30 14:40:00
MET	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MJN	2011-01-04 14:30:00	  4383 2011-03-30 14:40:00
MMM	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MON	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MOS	2011-01-04 14:30:00	  4617 2011-03-30 14:40:00
MRK	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
MT	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
MVG	2011-01-21 14:30:00	  3447 2011-03-30 14:45:00
NEM	2011-01-04 14:30:00	  4384 2011-03-30 14:45:00
NFLX	2011-01-04 14:30:00	  4384 2011-03-30 14:45:00
NOC	2011-01-28 14:30:00	  3058 2011-03-30 14:45:00
NUE	2011-01-04 14:30:00	  4384 2011-03-30 14:45:00
OIH	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
ORCL	2011-03-01 14:30:00	  1645 2011-03-30 14:00:00
OXY	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
PAAS	2011-01-21 14:30:00	  3682 2011-03-30 14:45:00
PALL	2011-01-21 14:30:00	  3682 2011-03-30 14:45:00
PBR	2011-01-04 14:30:00	  4618 2011-03-30 14:45:00
PEP	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
PG	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
PM	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
PNC	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
POT	2011-01-04 14:30:00	  4385 2011-03-30 14:50:00
PPLT	2011-01-21 14:30:00	  3680 2011-03-30 14:50:00
PRU	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
QCOM	2011-01-04 14:30:00	  4385 2011-03-30 14:50:00
QQQ	2010-12-27 09:00:00	  6302 2011-03-30 14:50:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
QQQQ	2009-10-28 18:10:00	 29324 2011-03-22 19:55:00
RDY	2011-01-24 14:30:00	  3371 2011-03-30 14:50:00
RIG	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
RIMM	2011-01-04 14:30:00	  4619 2011-03-30 14:50:00
RTN	2011-01-28 14:30:00	  3294 2011-03-30 14:55:00
SCCO	2011-01-24 14:30:00	  3606 2011-03-30 14:55:00
SINA	2011-01-04 14:30:00	  4386 2011-03-30 14:55:00
SJM	2011-01-04 14:30:00	  4386 2011-03-30 14:55:00
SKX	2011-01-04 14:30:00	  4620 2011-03-30 14:55:00
SLB	2011-01-04 14:30:00	  4620 2011-03-30 14:55:00
SLV	2011-01-04 14:30:00	  4620 2011-03-30 14:55:00
SLW	2011-01-21 14:30:00	  3684 2011-03-30 14:55:00
SNDK	2011-01-04 14:30:00	  4620 2011-03-30 14:55:00
SOHU	2011-01-24 14:30:00	  3606 2011-03-30 14:55:00
SPY	2009-10-28 18:10:00	 25975 2011-03-30 14:55:00
STT	2011-01-04 14:30:00	  4621 2011-03-30 15:00:00
SU	2011-02-17 14:30:00	  2203 2011-03-30 15:00:00
SUN	2011-01-04 14:30:00	  4621 2011-03-30 15:00:00
SVM	2011-01-21 14:30:00	  4908 2011-03-30 15:00:00
SWC	2011-01-19 14:30:00	  3607 2011-03-30 15:00:00
T	2011-02-04 14:30:00	  1879 2011-03-30 14:00:00
TEVA	2011-01-04 14:30:00	  4387 2011-03-30 15:00:00
TGT	2011-01-04 14:30:00	  4387 2011-03-30 15:00:00
TKR	2011-01-04 14:30:00	  4621 2011-03-30 15:00:00
TLT	2011-01-04 14:30:00	  4621 2011-03-30 15:00:00
TSO	2011-02-17 14:30:00	  2203 2011-03-30 15:00:00
UNH	2011-01-04 14:30:00	  4387 2011-03-30 15:00:00
UNP	2011-01-04 14:30:00	  4388 2011-03-30 15:05:00
UPS	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
V	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
VALE	2011-01-24 14:30:00	  3608 2011-03-30 15:05:00
VECO	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
VLO	2011-02-17 14:30:00	  2204 2011-03-30 15:05:00
VMW	2011-01-04 14:30:00	  4388 2011-03-30 15:05:00
WDC	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
WFMI	2011-01-04 14:30:00	  4388 2011-03-30 15:05:00
WHR	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
WMT	2009-10-28 18:10:00	 29500 2011-03-30 15:05:00
WYNN	2011-01-04 14:30:00	  4622 2011-03-30 15:05:00
X	2011-01-04 12:40:00	  5133 2011-03-30 15:10:00
XLB	2011-01-04 14:30:00	  4623 2011-03-30 15:10:00
XLE	2011-01-04 14:30:00	  4623 2011-03-30 15:10:00
XLU	2011-01-04 14:30:00	  4623 2011-03-30 15:10:00
XOM	2009-10-28 18:10:00	 29788 2011-03-30 15:10:00

164 rows selected.

Elapsed: 00:00:00.38
15:15:44 SQL> 
15:15:44 SQL> CREATE TABLE di5min_stk COMPRESS AS
15:15:44   2  SELECT
15:15:44   3  tkrdate
15:15:44   4  ,tkr
15:15:44   5  ,ydate
15:15:44   6  ,AVG(clse)clse
15:15:44   7  FROM di5min_stk0
15:15:44   8  -- I want weekdays:
15:15:44   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
15:15:44  10  GROUP BY
15:15:44  11  tkrdate
15:15:44  12  ,tkr
15:15:44  13  ,ydate
15:15:44  14  /

Table created.

Elapsed: 00:00:06.59
15:15:51 SQL> 
15:15:51 SQL> -- rpt
15:15:51 SQL> SELECT
15:15:51   2  TO_CHAR(ydate,'dy')
15:15:51   3  ,COUNT(ydate)
15:15:51   4  FROM di5min_stk
15:15:51   5  GROUP BY TO_CHAR(ydate,'dy')
15:15:51   6  /

TO_ COUNT(YDATE)
--- ------------
fri	  195441
mon	  171053
tue	  204368
thu	  194399
wed	  193834

Elapsed: 00:00:01.13
15:15:52 SQL> 
15:15:52 SQL> -- I need to shave a second off of some of the dates:
15:15:52 SQL> --
15:15:52 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
15:15:52 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
15:15:52 SQL> -- /
15:15:52 SQL> --
15:15:52 SQL> -- SELECT COUNT(*)FROM di5min_stk;
15:15:52 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
15:15:52 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
15:15:52 SQL> --
15:15:52 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
15:15:52 SQL> 
15:15:52 SQL> -- Add a column to help join with future dates
15:15:52 SQL> -- and then calculate 1 day gain:
15:15:52 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:00.09
15:15:52 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
15:15:52   2  SELECT
15:15:52   3  tkrdate
15:15:52   4  ,tkr
15:15:52   5  ,ydate
15:15:52   6  ,clse
15:15:52   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
15:15:52   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
15:15:52   9  	    ELSE NULL END selldate
15:15:52  10  FROM di5min_stk
15:15:52  11  /

Table created.

Elapsed: 00:00:02.53
15:15:55 SQL> 
15:15:55 SQL> -- Join with the future
15:15:55 SQL> 
15:15:55 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.13
15:15:55 SQL> 
15:15:55 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
15:15:55   2  SELECT
15:15:55   3  p.tkrdate
15:15:55   4  ,p.tkr
15:15:55   5  ,p.ydate
15:15:55   6  ,p.clse
15:15:55   7  ,p.selldate
15:15:55   8  ,f.clse clse2
15:15:55   9  ,f.clse - p.clse gain1day
15:15:55  10  FROM di5min_stk_fd p, di5min_stk f
15:15:55  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
15:15:55  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
15:15:55  13  /

Table created.

Elapsed: 00:00:06.09
15:16:01 SQL> 
15:16:01 SQL> -- rpt
15:16:01 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	195441
mon	171053
tue	204368
thu	194399
wed	193834

Elapsed: 00:00:00.59
15:16:01 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	195441
mon	171053
tue	204368
thu	194399
wed	193834

Elapsed: 00:00:00.71
15:16:02 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-03-30 15:10:00

Elapsed: 00:00:00.07
15:16:02 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-03-30 15:10:00

Elapsed: 00:00:00.08
15:16:02 SQL> 
15:16:02 SQL> -- rpt
15:16:02 SQL> SELECT
15:16:02   2  tkr
15:16:02   3  ,MIN(ydate)
15:16:02   4  ,COUNT(ydate)
15:16:02   5  ,MAX(ydate)
15:16:02   6  ,MIN(clse)
15:16:02   7  ,AVG(clse)
15:16:02   8  ,MAX(clse)
15:16:02   9  ,MAX(gain1day)
15:16:02  10  FROM di5min_stk_c2
15:16:02  11  GROUP BY tkr
15:16:02  12  ORDER BY tkr
15:16:02  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    4609 2011-03-30 14:00:00	200.725 338.726107     364.83	 145.278438
ABT	2011-01-04 14:30:00	    4609 2011-03-30 14:00:00	 39.115  46.751088	49.11	     8.3225
ABX	2011-01-04 14:30:00	    4609 2011-03-30 14:00:00	  45.64 49.7112392	54.24	       2.14
ADBE	2011-01-04 14:30:00	    4609 2011-03-30 14:00:00	  30.82 33.8968391	43.25	       1.64
AEM	2011-01-04 14:30:00	    4609 2011-03-30 14:00:00	   63.6 69.8957659	76.47	       3.74
AFL	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  48.59 56.2479176	59.48	       3.71
AGU	2011-01-24 14:30:00	    3596 2011-03-30 14:05:00	  84.78 91.6387832	99.13	       4.71
AIG	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  35.17 43.5881061	62.47		4.8
AKAM	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  34.85 43.0220922	52.47	       2.39
ALL	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  30.47 31.4331414	32.61		.83
AMGN	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  50.63 54.2922248	58.15	       1.92
AMT	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  45.98 51.8021433	56.73	       2.44
AMX	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  53.38 56.7776153	59.58	       1.74
AMZN	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	 160.93 176.672627     191.55	       10.1
APA	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  110.8 121.279836     130.53	       5.98
APC	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	   73.1 78.2789937	83.97	       4.12
ARG	2011-01-04 14:30:00	    4610 2011-03-30 14:05:00	  60.86 63.2591541	67.35	       2.46
AXP	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	  42.31 44.6715443	 46.9	       1.92
AXU	2011-01-21 14:30:00	    3675 2011-03-30 14:10:00	   5.88 7.85694487	 9.64	       1.07
BA	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	  66.51 72.5431201    102.935	       2.85
BBT	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	     26 27.4861255	29.55		1.3
BBY	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	  28.71 33.3013111	36.18	       1.64
BEN	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	 109.71 121.237538	130.6	       5.04
BHP	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	  83.94 91.2761533	96.58	       3.59
BIDU	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	  99.53 117.995632	137.8	      11.14
BP	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	  42.55 47.6150094	64.49	       1.83
BRCM	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	  25.15 42.1208558	47.32	  16.154375
BTU	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	   57.7  64.848915	73.49	       5.41
BUCY	2011-01-04 14:30:00	    4611 2011-03-30 14:10:00	  89.67 91.7404282    107.275	       2.47
CAT	2011-01-04 14:30:00	    4546 2011-03-29 15:15:00	  92.37  99.945144     110.39	       3.79
CDE	2011-01-21 14:30:00	    3610 2011-03-29 15:15:00	  22.13 28.7085508	36.06		4.4
CELG	2011-01-04 14:30:00	    4546 2011-03-29 15:15:00	  48.96 55.0212453     64.905	       2.45
CEO	2011-01-24 14:30:00	    3532 2011-03-29 15:15:00	 206.99  227.36485     244.97	      10.36
CHK	2011-01-24 14:30:00	    3532 2011-03-29 15:15:00	  27.24 32.0381941	35.83	       3.48
CLF	2011-01-04 14:30:00	    4546 2011-03-29 15:15:00	  79.77 89.8032807	101.2	       8.31
CMI	2011-01-04 14:30:00	    4546 2011-03-29 15:15:00	  94.36  106.35299     114.74	       6.52
COF	2011-01-04 14:30:00	    4546 2011-03-29 15:15:00	  43.23 50.6556963     70.685		2.8
COP	2011-01-04 14:30:00	    4546 2011-03-29 15:15:00	  65.11 72.5361001	80.87	 11.4215625
COST	2011-01-04 14:30:00	    4547 2011-03-29 15:20:00	  69.56 72.6245378	75.43	       3.55
CREE	2011-01-04 14:30:00	    4612 2011-03-30 14:15:00	  42.85 53.5022619	69.19	       2.89
CRM	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	 97.655  131.48399 146.866719	 47.6217188
CSX	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	  64.81 72.4552952	80.23	       3.28
CTSH	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	  70.72 75.5146406	81.46	       3.45
CVE	2011-02-14 14:30:00	    3141 2011-03-30 14:20:00	  34.32 37.5484326	40.98	 1.75985901
CVS	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	  32.13  33.870652	35.94	       1.17
CVX	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	  90.21 98.2824143     108.39	       3.55
DD	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	  47.28   52.04652	56.16	 5.09311826
DE	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	  81.82 90.5203847	97.03	       3.93
DIA	2009-10-28 18:10:00	   29605 2011-03-30 14:20:00	  96.34 108.729089     123.64	       4.35
DIS	2009-10-28 18:10:00	   29357 2011-03-30 14:20:00	  27.06 34.9508578	44.29	       3.13
DNDN	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	  31.34 37.7889117     99.105	       2.92
DTV	2011-01-04 14:30:00	    4613 2011-03-30 14:20:00	  40.79 43.9445851	47.38		2.4
DVN	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	  77.06 86.8195009	93.42	       4.67
EBAY	2009-10-28 18:10:00	   29387 2011-03-30 14:25:00	  19.17 25.7528672 47.5933333	       2.69
EFA	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	   54.7 62.3219404     99.265	       2.16
EOG	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	  91.02 105.372159     120.99	       6.61
ESRX	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	  51.25 55.8574189	58.74		2.2
EWZ	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	  70.16 74.3335555	78.95	       2.02
EXK	2011-01-21 14:30:00	    4487 2011-03-30 14:25:00	    5.4 8.00671555	10.29	       1.46
FCX	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	  46.43 75.1247353     122.49	 48.3005005
FDX	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	  55.79 89.6131383	98.45	  31.839375
FFIV	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	  91.18 117.130563     145.75	      11.02
FLS	2011-01-04 14:30:00	    4548 2011-03-30 14:25:00	   37.5 117.268832     132.49	   41.92375
FSLR	2011-01-04 14:30:00	    4614 2011-03-30 14:25:00	 130.64 151.208166	  174	      12.54
GD	2011-01-28 14:30:00	    3289 2011-03-30 14:30:00 60.8145605 67.5710925	76.53	 6.88543945
GDX	2011-01-04 14:30:00	    4615 2011-03-30 14:30:00	  52.52  57.586389	 67.1	       2.31
GFI	2011-01-28 14:30:00	    3055 2011-03-30 14:30:00	  15.67 16.9162373	18.32		.79
GG	2011-01-04 14:30:00	    4381 2011-03-30 14:30:00	  39.13 44.8285244	50.69	       2.69
GILD	2011-01-04 14:30:00	    4381 2011-03-30 14:30:00	  36.51 39.2444836	42.87	       1.75
GLD	2011-01-04 14:30:00	    4381 2011-03-30 14:30:00	 84.125 132.456688     141.16	  52.591875
GOOG	2009-10-28 18:10:00	   29383 2011-03-30 14:30:00	329.525 551.860807     641.65	 261.864063
GS	2011-01-04 14:30:00	    4615 2011-03-30 14:30:00	  153.4 164.485507	  175	       6.13
HD	2011-01-04 14:30:00	    4615 2011-03-30 14:30:00	  34.09 36.6560855	38.94	       1.42
HES	2011-01-04 14:30:00	    4615 2011-03-30 14:30:00	  76.16 81.5690545	87.02	       4.51
HL	2011-01-18 12:30:00	    4007 2011-03-30 14:30:00	   7.84  9.3686479	11.08		.85
HOC	2011-02-17 14:30:00	    2198 2011-03-30 14:35:00	  50.79 56.4090305	62.55	       5.16
HON	2011-01-04 14:30:00	    4616 2011-03-30 14:35:00	  53.03 56.1659393	59.86	       2.27
HPQ	2009-10-28 18:10:00	   29525 2011-03-30 14:35:00	  37.45 46.3836188	 54.7		3.4
IBM	2009-10-28 18:10:00	   29500 2011-03-30 14:35:00	 119.59 136.075227     167.47	       6.28
IOC	2011-01-04 14:30:00	    4616 2011-03-30 14:35:00	  66.18 73.4865134	81.72	       4.58
IWM	2011-01-04 14:30:00	    4616 2011-03-30 14:35:00	  77.04 80.3439948	83.75	       2.49
JNJ	2011-01-04 14:30:00	    4616 2011-03-30 14:35:00	   57.5 60.6930474	63.49	       1.77
JOYG	2011-01-04 14:30:00	    4382 2011-03-30 14:35:00	 73.075 90.2095611     100.55	 21.9322852
JPM	2011-01-04 14:30:00	    4616 2011-03-30 14:35:00	  42.77 45.4266124	48.27		2.5
JWN	2011-01-04 14:30:00	    4616 2011-03-30 14:35:00	  40.03 43.3364402	47.49	       2.39
KO	2011-01-04 14:30:00	    4616 2011-03-30 14:35:00	  61.35 64.5832816	79.42	       2.22
LFT	2011-01-04 14:30:00	    4616 2011-03-30 14:35:00	  28.04 32.2875882	   37	       4.03
LMT	2011-01-28 14:30:00	    3057 2011-03-30 14:40:00	  77.84 80.9601404	88.63	       2.23
MAR	2011-01-04 14:30:00	    4617 2011-03-30 14:40:00	  34.99 39.3651952	42.58		1.5
MCD	2011-01-04 14:30:00	    4383 2011-03-30 14:40:00	  72.15 74.8381615	77.23	       2.68
MDT	2011-01-04 14:30:00	    4617 2011-03-30 14:40:00	  36.18 38.4264706	41.32	       1.36
MDY	2011-01-04 14:30:00	    4617 2011-03-30 14:40:00	 163.62 171.811623     178.79		4.5
MEE	2011-01-04 14:30:00	    4383 2011-03-30 14:40:00	  52.03 60.9296731	69.06	       9.93
MET	2011-01-04 14:30:00	    4617 2011-03-30 14:40:00	  41.29 45.9097887	48.71	       1.78
MJN	2011-01-04 14:30:00	    4383 2011-03-30 14:40:00	  52.71 59.1900317	63.29	 6.94539063
MMM	2011-01-04 14:30:00	    4617 2011-03-30 14:40:00	  85.68 89.9919294	 94.1	       2.69
MON	2011-01-04 14:30:00	    4617 2011-03-30 14:40:00	   65.2 71.6333046	76.13	       4.04
MOS	2011-01-04 14:30:00	    4617 2011-03-30 14:40:00	  71.87 80.3938004	89.17	       6.34
MRK	2011-01-04 14:30:00	    4618 2011-03-30 14:45:00	  31.07 33.3981605	 37.6		.84
MT	2011-01-04 14:30:00	    4618 2011-03-30 14:45:00	  32.43 36.4494394	41.21	       2.13
MVG	2011-01-21 14:30:00	    3447 2011-03-30 14:45:00	   9.25 11.0838555	13.35	       1.31
NEM	2011-01-04 14:30:00	    4384 2011-03-30 14:45:00	  50.07 55.3965319	60.22	       2.16
NFLX	2011-01-04 14:30:00	    4384 2011-03-30 14:45:00	  176.3 206.745158     241.75	      29.02
NOC	2011-01-28 14:30:00	    3058 2011-03-30 14:45:00	 62.335 67.5157202	 72.4	   4.690625
NUE	2011-01-04 14:30:00	    4384 2011-03-30 14:45:00	  42.81 46.1449347	49.23	       2.14
OIH	2011-01-04 14:30:00	    4618 2011-03-30 14:45:00	 135.78 153.630512     166.41	       8.52
ORCL	2011-03-01 14:30:00	    1645 2011-03-30 14:00:00	  29.63 31.9209469	33.72	       2.05
OXY	2011-01-04 14:30:00	    4618 2011-03-30 14:45:00	  93.76 99.3380645     107.41	       3.94
PAAS	2011-01-21 14:30:00	    3682 2011-03-30 14:45:00	  31.13  35.785698	40.53	       2.92
PALL	2011-01-21 14:30:00	    3682 2011-03-30 14:45:00	  68.75 78.6010251	85.33	       3.41
PBR	2011-01-04 14:30:00	    4618 2011-03-30 14:45:00	  35.03 38.2726291	42.57		2.3
PEP	2011-01-04 14:30:00	    4619 2011-03-30 14:50:00	  62.07 64.5090352	67.46	       1.56
PG	2011-01-04 14:30:00	    4619 2011-03-30 14:50:00	  59.77 63.3402946	66.94	       1.74
PM	2011-01-04 14:30:00	    4619 2011-03-30 14:50:00	  55.88 60.2967777	65.86	       1.84
PNC	2011-01-04 14:30:00	    4619 2011-03-30 14:50:00	  59.75 62.0612363	65.14	       3.13
POT	2011-01-04 14:30:00	    4385 2011-03-30 14:50:00	  50.49 114.691144     189.19	      13.11
PPLT	2011-01-21 14:30:00	    3680 2011-03-30 14:50:00	 167.76 177.749055     185.21	 11.7949186
PRU	2011-01-04 14:30:00	    4619 2011-03-30 14:50:00	  56.82 62.4767174	67.47	       3.25
QCOM	2011-01-04 14:30:00	    4385 2011-03-30 14:50:00	   49.9 54.3494454	59.79	       3.54
QQQ	2010-12-27 09:00:00	    6290 2011-03-30 14:50:00	  53.78 56.3175249	59.03	       1.44

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
QQQQ	2009-10-28 18:10:00	   29312 2011-03-22 19:55:00	   40.7 48.9803231	59.03		2.5
RDY	2011-01-24 14:30:00	    3371 2011-03-30 14:50:00	   32.6 34.6267517	37.29	       2.29
RIG	2011-01-04 14:30:00	    4619 2011-03-30 14:50:00	  69.12 79.3822096	85.94	       5.25
RIMM	2011-01-04 14:30:00	    4619 2011-03-30 14:50:00	  55.82 64.1648139     85.395	       3.93
RTN	2011-01-28 14:30:00	    3294 2011-03-30 14:55:00	  49.21 51.0217503	53.08	       1.65
SCCO	2011-01-24 14:30:00	    3606 2011-03-30 14:55:00	  38.12 42.6507693	47.56	       2.84
SINA	2011-01-04 14:30:00	    4386 2011-03-30 14:55:00	  72.55 86.5938024     109.11		6.9
SJM	2011-01-04 14:30:00	    4386 2011-03-30 14:55:00	 52.045 65.3308114	73.11	  15.829375
SKX	2011-01-04 14:30:00	    4620 2011-03-30 14:55:00	  17.87 20.6863893	23.65	       1.33
SLB	2011-01-04 14:30:00	    4620 2011-03-30 14:55:00	  79.84 87.9516817	 95.1	       4.98
SLV	2011-01-04 14:30:00	    4620 2011-03-30 14:55:00	  26.08  31.068624	37.22	       1.66
SLW	2011-01-21 14:30:00	    3684 2011-03-30 14:55:00	   28.9   38.26144	46.34	       2.87
SNDK	2011-01-04 14:30:00	    4620 2011-03-30 14:55:00	  41.11 48.4724063	53.47		3.6
SOHU	2011-01-24 14:30:00	    3606 2011-03-30 14:55:00	  64.69 81.5821173	90.95		7.8
SPY	2009-10-28 18:10:00	   25951 2011-03-30 14:55:00	 103.18 117.967739     134.66		5.1
STT	2011-01-04 14:30:00	    4621 2011-03-30 15:00:00	   42.3 45.7613276	50.22		2.1
SU	2011-02-17 14:30:00	    2203 2011-03-30 15:00:00 41.3805991 44.3873959 46.8599992	 2.08441843
SUN	2011-01-04 14:30:00	    4621 2011-03-30 15:00:00	  38.49 42.8212598	50.69	       2.07
SVM	2011-01-21 14:30:00	    4908 2011-03-30 15:00:00	   9.41 12.6202627	15.33		1.1
SWC	2011-01-19 14:30:00	    3607 2011-03-30 15:00:00	   19.5 22.7868063	25.88	       1.99
T	2011-02-04 14:30:00	    1879 2011-03-30 14:00:00	  20.58 38.9752909     53.766	 21.9851547
TEVA	2011-01-04 14:30:00	    4387 2011-03-30 15:00:00	  47.33 51.7444389	56.96	       3.35
TGT	2011-01-04 14:30:00	    4387 2011-03-30 15:00:00	  49.04 53.2390856	60.37	       1.99
TKR	2011-01-04 14:30:00	    4621 2011-03-30 15:00:00	  43.44 49.2524215	52.67	    4.18875
TLT	2011-01-04 14:30:00	    4621 2011-03-30 15:00:00	 74.605 90.4919813	94.55	 16.5532813
TSO	2011-02-17 14:30:00	    2203 2011-03-30 15:00:00	   22.4 24.7235384	27.49	       3.17
UNH	2011-01-04 14:30:00	    4387 2011-03-30 15:00:00	  36.95 41.8779241	44.99	       2.23
UNP	2011-01-04 14:30:00	    4388 2011-03-30 15:05:00	 85.445 94.7572175	99.44	   7.436875
UPS	2011-01-04 14:30:00	    4622 2011-03-30 15:05:00	  70.24 73.1308934	76.97	       4.15
V	2011-01-04 14:30:00	    4622 2011-03-30 15:05:00 42.5480164 60.3842152 79.2666571	 22.9764716
VALE	2011-01-24 14:30:00	    3608 2011-03-30 15:05:00	   30.7 33.8026552	36.36		1.3
VECO	2011-01-04 14:30:00	    4622 2011-03-30 15:05:00	  42.58 47.4937383	53.12	       4.28
VLO	2011-02-17 14:30:00	    2204 2011-03-30 15:05:00	  25.97 28.2618944	30.74		2.5
VMW	2011-01-04 14:30:00	    4388 2011-03-30 15:05:00	  74.39 85.5133999	95.94	 4.80213474
WDC	2011-01-04 14:30:00	    4622 2011-03-30 15:05:00	  29.42 33.6509183	37.93	       5.73
WFMI	2011-01-04 14:30:00	    4388 2011-03-30 15:05:00	  47.85 55.8761928	65.18	       7.83
WHR	2011-01-04 14:30:00	    4622 2011-03-30 15:05:00	   79.2 84.4236428	92.05		3.8
WMT	2009-10-28 18:10:00	   29476 2011-03-30 15:05:00	  47.76 53.2454336	57.85	       2.22
WYNN	2011-01-04 14:30:00	    4622 2011-03-30 15:05:00	 109.66 121.076262     131.95	       9.74
X	2011-01-04 12:40:00	    5121 2011-03-30 15:10:00  35.304713  57.134717	75.74	 15.8246652
XLB	2011-01-04 14:30:00	    4623 2011-03-30 15:10:00	  36.57 38.7696672	40.72	       1.15
XLE	2011-01-04 14:30:00	    4623 2011-03-30 15:10:00	 66.775 73.5267335	80.23	 10.8921094
XLU	2011-01-04 14:30:00	    4623 2011-03-30 15:10:00	  30.75 31.7755809	32.89		.67
XOM	2009-10-28 18:10:00	   29752 2011-03-30 15:10:00	  56.05 68.7805524 86.5315885	 9.62822917

164 rows selected.

Elapsed: 00:00:00.76
15:16:03 SQL> 
15:16:03 SQL> COLUMN clse FORMAT 999.9999
15:16:03 SQL> SELECT
15:16:03   2  tkr
15:16:03   3  ,ROUND(clse,4)clse
15:16:03   4  -- Should be NULL:
15:16:03   5  ,ROUND(clse2,4)clse2
15:16:03   6  ,ydate
15:16:03   7  FROM di5min_stk_c2
15:16:03   8  WHERE ydate > sysdate - 0.5/24
15:16:03   9  ORDER BY tkr,ydate
15:16:03  10  /

TKR	     CLSE      CLSE2 YDATE
------- --------- ---------- -------------------
PEP	  64.9000	     2011-03-30 14:50:00
PG	  61.8100	     2011-03-30 14:50:00
PM	  65.3500	     2011-03-30 14:50:00
PNC	  62.5300	     2011-03-30 14:50:00
POT	  57.8500	     2011-03-30 14:50:00
PPLT	 174.7000	     2011-03-30 14:50:00
PRU	  61.3300	     2011-03-30 14:50:00
QCOM	  54.0700	     2011-03-30 14:50:00
QQQ	  57.2000	     2011-03-30 14:50:00
RDY	  37.1100	     2011-03-30 14:50:00
RIG	  78.9500	     2011-03-30 14:50:00
RIMM	  57.3500	     2011-03-30 14:50:00
RTN	  50.6500	     2011-03-30 14:50:00
RTN	  50.6400	     2011-03-30 14:55:00
SCCO	  40.0200	     2011-03-30 14:50:00
SCCO	  40.0200	     2011-03-30 14:55:00
SINA	 107.9900	     2011-03-30 14:50:00
SINA	 107.9800	     2011-03-30 14:55:00
SJM	  72.3600	     2011-03-30 14:50:00
SJM	  72.3700	     2011-03-30 14:55:00
SKX	  20.0400	     2011-03-30 14:50:00
SKX	  20.0700	     2011-03-30 14:55:00
SLB	  93.1700	     2011-03-30 14:50:00
SLB	  93.2100	     2011-03-30 14:55:00
SLV	  36.4500	     2011-03-30 14:50:00
SLV	  36.4400	     2011-03-30 14:55:00
SLW	  43.8000	     2011-03-30 14:50:00
SLW	  43.7500	     2011-03-30 14:55:00
SNDK	  45.0500	     2011-03-30 14:50:00
SNDK	  45.0200	     2011-03-30 14:55:00
SOHU	  88.7100	     2011-03-30 14:50:00
SOHU	  88.9200	     2011-03-30 14:55:00
SPY	 132.6600	     2011-03-30 14:50:00
SPY	 132.7200	     2011-03-30 14:55:00
STT	  44.8600	     2011-03-30 14:50:00
STT	  44.8900	     2011-03-30 14:55:00
STT	  44.9000	     2011-03-30 15:00:00
SU	  44.5800	     2011-03-30 14:50:00
SU	  44.6000	     2011-03-30 14:55:00
SU	  44.5700	     2011-03-30 15:00:00
SUN	  45.6200	     2011-03-30 14:50:00
SUN	  45.7500	     2011-03-30 14:55:00
SUN	  45.7700	     2011-03-30 15:00:00
SVM	  14.4000	     2011-03-30 14:50:00
SVM	  14.3800	     2011-03-30 14:55:00
SVM	  14.3200	     2011-03-30 15:00:00
SWC	  22.0400	     2011-03-30 14:50:00
SWC	  21.9800	     2011-03-30 14:55:00
SWC	  21.8800	     2011-03-30 15:00:00
TEVA	  49.9900	     2011-03-30 14:50:00
TEVA	  50.0300	     2011-03-30 14:55:00
TEVA	  50.0200	     2011-03-30 15:00:00
TGT	  49.8700	     2011-03-30 14:50:00
TGT	  49.8600	     2011-03-30 14:55:00
TGT	  49.7600	     2011-03-30 15:00:00
TKR	  51.2300	     2011-03-30 14:50:00
TKR	  51.2600	     2011-03-30 14:55:00
TKR	  51.2900	     2011-03-30 15:00:00
TLT	  91.7600	     2011-03-30 14:50:00
TLT	  91.7600	     2011-03-30 14:55:00
TLT	  91.7600	     2011-03-30 15:00:00
TSO	  27.1100	     2011-03-30 14:50:00
TSO	  27.1200	     2011-03-30 14:55:00
TSO	  27.1600	     2011-03-30 15:00:00
UNH	  44.9200	     2011-03-30 14:50:00
UNH	  44.9900	     2011-03-30 14:55:00
UNH	  44.9800	     2011-03-30 15:00:00
UNP	  98.9100	     2011-03-30 14:50:00
UNP	  98.8700	     2011-03-30 14:55:00
UNP	  98.7000	     2011-03-30 15:00:00
UNP	  98.7000	     2011-03-30 15:05:00
UPS	  74.7400	     2011-03-30 14:50:00
UPS	  74.7600	     2011-03-30 14:55:00
UPS	  74.7600	     2011-03-30 15:00:00
UPS	  74.7300	     2011-03-30 15:05:00
V	  75.1600	     2011-03-30 14:50:00
V	  75.2300	     2011-03-30 14:55:00
V	  75.0900	     2011-03-30 15:00:00
V	  75.1000	     2011-03-30 15:05:00
VALE	  32.9400	     2011-03-30 14:50:00
VALE	  32.8900	     2011-03-30 14:55:00
VALE	  32.9300	     2011-03-30 15:00:00
VALE	  32.9500	     2011-03-30 15:05:00
VECO	  51.0000	     2011-03-30 14:50:00
VECO	  51.0800	     2011-03-30 14:55:00
VECO	  51.0200	     2011-03-30 15:00:00
VECO	  51.0200	     2011-03-30 15:05:00
VLO	  30.1800	     2011-03-30 14:50:00
VLO	  30.2600	     2011-03-30 14:55:00
VLO	  30.2900	     2011-03-30 15:00:00
VLO	  30.2800	     2011-03-30 15:05:00
VMW	  80.6900	     2011-03-30 14:50:00
VMW	  80.7800	     2011-03-30 14:55:00
VMW	  80.9800	     2011-03-30 15:00:00
VMW	  81.1200	     2011-03-30 15:05:00
WDC	  37.9300	     2011-03-30 14:50:00
WDC	  37.8900	     2011-03-30 14:55:00
WDC	  37.9300	     2011-03-30 15:00:00
WDC	  37.8500	     2011-03-30 15:05:00
WFMI	  65.1300	     2011-03-30 14:50:00
WFMI	  65.1800	     2011-03-30 14:55:00
WFMI	  64.9400	     2011-03-30 15:00:00
WFMI	  64.9600	     2011-03-30 15:05:00
WHR	  83.1000	     2011-03-30 14:50:00
WHR	  83.1100	     2011-03-30 14:55:00
WHR	  82.9200	     2011-03-30 15:00:00
WHR	  82.8900	     2011-03-30 15:05:00
WMT	  52.2300	     2011-03-30 14:50:00
WMT	  52.2100	     2011-03-30 14:55:00
WMT	  52.1900	     2011-03-30 15:00:00
WMT	  52.2000	     2011-03-30 15:05:00
WYNN	 126.1400	     2011-03-30 14:50:00
WYNN	 126.4000	     2011-03-30 14:55:00
WYNN	 126.1500	     2011-03-30 15:00:00
WYNN	 126.4000	     2011-03-30 15:05:00
X	  56.2800	     2011-03-30 14:50:00
X	  56.1900	     2011-03-30 14:55:00
X	  56.0900	     2011-03-30 15:00:00
X	  56.0800	     2011-03-30 15:05:00
X	  56.0700	     2011-03-30 15:10:00

TKR	     CLSE      CLSE2 YDATE
------- --------- ---------- -------------------
XLB	  39.6100	     2011-03-30 14:50:00
XLB	  39.6400	     2011-03-30 14:55:00
XLB	  39.5400	     2011-03-30 15:00:00
XLB	  39.5500	     2011-03-30 15:05:00
XLB	  39.5400	     2011-03-30 15:10:00
XLE	  79.5600	     2011-03-30 14:50:00
XLE	  79.6100	     2011-03-30 14:55:00
XLE	  79.5000	     2011-03-30 15:00:00
XLE	  79.5400	     2011-03-30 15:05:00
XLE	  79.5500	     2011-03-30 15:10:00
XLU	  31.8600	     2011-03-30 14:50:00
XLU	  31.8800	     2011-03-30 14:55:00
XLU	  31.9100	     2011-03-30 15:00:00
XLU	  31.9300	     2011-03-30 15:05:00
XLU	  31.9300	     2011-03-30 15:10:00
XOM	  84.2400	     2011-03-30 14:50:00
XOM	  84.3400	     2011-03-30 14:55:00
XOM	  84.3100	     2011-03-30 15:00:00
XOM	  84.2200	     2011-03-30 15:05:00
XOM	  84.1200	     2011-03-30 15:10:00

140 rows selected.

Elapsed: 00:00:00.15
15:16:03 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
