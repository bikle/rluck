
SQL*Plus: Release 11.2.0.1.0 Production on Wed Jan 19 11:54:33 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

11:54:33 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
11:54:33 SQL> 
11:54:33 SQL> 11:54:33 SQL> --
11:54:33 SQL> -- update_di5min_stk.sql
11:54:33 SQL> --
11:54:33 SQL> 
11:54:33 SQL> -- I use this script to keep di5min_stk up to date.
11:54:33 SQL> 
11:54:33 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
11:54:33 SQL> -- After that date, it holds data from IB.
11:54:33 SQL> 
11:54:33 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
11:54:33 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
11:54:33 SQL> 
11:54:33 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.51
11:54:33 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.11
11:54:34 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.63
11:54:34 SQL> 
11:54:34 SQL> 
11:54:34 SQL> -- I need to shave a second off of some of the dates:
11:54:34 SQL> 
11:54:34 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
11:54:34   2  WHERE TO_CHAR(ydate,'SS')='01'
11:54:34   3  /

0 rows updated.

Elapsed: 00:00:00.12
11:54:34 SQL> 
11:54:34 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    113090

Elapsed: 00:00:00.02
11:54:34 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    113090

Elapsed: 00:00:00.07
11:54:34 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.10
11:54:35 SQL> 
11:54:35 SQL> -- Copy in data from ibs5min:
11:54:35 SQL> 
11:54:35 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
11:54:35   2  SELECT	     tkr||ydate,tkr,ydate,clse
11:54:35   3  FROM ibs5min
11:54:35   4  WHERE ydate >= '2010-12-27 09:00:00'
11:54:35   5  /

113090 rows created.

Elapsed: 00:00:00.34
11:54:35 SQL> 
11:54:35 SQL> -- rpt
11:54:35 SQL> SELECT
11:54:35   2  tkr
11:54:35   3  ,MIN(ydate)
11:54:35   4  ,COUNT(tkr)
11:54:35   5  ,MAX(ydate)
11:54:35   6  FROM di5min_stk0
11:54:35   7  GROUP BY tkr
11:54:35   8  ORDER BY tkr
11:54:35   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
ABT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
ABX	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
ADBE	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AEM	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AFL	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AIG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AKAM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
ALL	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
AMGN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AMT	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
AMX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AMZN	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
APA	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
APC	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
ARG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AXP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BA	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BBT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BBY	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BEN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BHP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BIDU	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
BP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BRCM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
BTU	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BUCY	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CAT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CELG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CLF	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CMI	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
COF	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
COP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
COST	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CREE	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
CRM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
CSX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CTSH	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CVS	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CVX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
DD	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
DE	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
DIA	2010-12-27 09:00:00	  2355 2011-01-18 20:55:00
DIS	2010-12-27 09:00:00	  2107 2011-01-18 20:55:00
DNDN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
DTV	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
DVN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
EBAY	2010-12-27 09:00:00	  2047 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
EOG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
ESRX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
EWZ	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FCX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FDX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FFIV	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FLS	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FSLR	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
GDX	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
GG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
GILD	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
GLD	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
GOOG	2010-12-27 09:00:00	  2377 2011-01-18 20:55:00
GS	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
HD	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
HES	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
HON	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
HPQ	2010-12-27 09:00:00	  2194 2011-01-14 20:55:00
IBM	2010-12-27 09:00:00	  2247 2011-01-18 20:55:00
IOC	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
IWM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
JNJ	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
JOYG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
JPM	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
JWN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
KO	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
LFT	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MAR	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MCD	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MDT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MDY	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MEE	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MET	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MJN	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MMM	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MON	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MOS	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MRK	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
NEM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
NFLX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
NUE	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
OIH	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
OXY	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
PBR	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
PEP	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
PG	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
PM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
PNC	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
POT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
PRU	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
QCOM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
QQQQ	2010-12-27 09:00:00	  2463 2011-01-18 20:55:00
RIG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
RIMM	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
SINA	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
SJM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
SKX	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
SLB	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
SLV	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
SNDK	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
SPY	2010-12-27 09:00:00	  2614 2011-01-18 20:55:00
STT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
SUN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
TEVA	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
TGT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
TKR	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
TLT	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
UNH	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
UNP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
UPS	2011-01-04 14:30:00	   702 2011-01-14 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
VECO	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
VMW	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
WDC	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
WFMI	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
WHR	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
WMT	2010-12-27 09:00:00	  2151 2011-01-14 20:55:00
WYNN	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
X	2011-01-04 12:40:00	  1212 2011-01-14 20:55:00
XLB	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
XLE	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
XLU	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
XOM	2010-12-27 09:00:00	  2325 2011-01-14 20:55:00

133 rows selected.

Elapsed: 00:00:00.10
11:54:35 SQL> 
11:54:35 SQL> -- Next, copy in data from dukas.
11:54:35 SQL> -- dukas5min_stk depends on:
11:54:35 SQL> -- - dukas10min_stk
11:54:35 SQL> -- - svmspy/dukas/fake5.sql
11:54:35 SQL> 
11:54:35 SQL> 
11:54:35 SQL> -- I need to shave a second off of some of the dates:
11:54:35 SQL> 
11:54:35 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
11:54:35   2  WHERE TO_CHAR(ydate,'SS')='01'
11:54:35   3  /

0 rows updated.

Elapsed: 00:00:00.70
11:54:36 SQL> 
11:54:36 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.02
11:54:36 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.10
11:54:36 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.07
11:54:36 SQL> 
11:54:36 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
11:54:36   2  SELECT	     tkr||ydate,tkr,ydate,clse
11:54:36   3  FROM dukas5min_stk
11:54:36   4  WHERE ydate < '2010-12-27 09:00:00'
11:54:36   5  /

230382 rows created.

Elapsed: 00:00:00.43
11:54:36 SQL> 
11:54:36 SQL> -- rpt
11:54:36 SQL> SELECT
11:54:36   2  tkr
11:54:36   3  ,MIN(ydate)
11:54:36   4  ,COUNT(tkr)
11:54:36   5  ,MAX(ydate)
11:54:36   6  FROM dukas5min_stk
11:54:36   7  WHERE ydate < '2010-12-27 09:00:00'
11:54:36   8  GROUP BY tkr
11:54:36   9  ORDER BY tkr
11:54:36  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.08
11:54:36 SQL> 
11:54:36 SQL> -- rpt
11:54:36 SQL> SELECT
11:54:36   2  tkr
11:54:36   3  ,MIN(ydate)
11:54:36   4  ,COUNT(tkr)
11:54:36   5  ,MAX(ydate)
11:54:36   6  FROM di5min_stk0
11:54:36   7  GROUP BY tkr
11:54:36   8  ORDER BY tkr
11:54:36   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
ABT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
ABX	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
ADBE	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AEM	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AFL	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AIG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AKAM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
ALL	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
AMGN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AMT	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
AMX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AMZN	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
APA	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
APC	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
ARG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
AXP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BA	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BBT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BBY	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BEN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BHP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BIDU	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
BP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BRCM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
BTU	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
BUCY	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CAT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CELG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CLF	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CMI	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
COF	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
COP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
COST	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CREE	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
CRM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
CSX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CTSH	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CVS	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
CVX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
DD	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
DE	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
DIA	2009-10-28 18:10:00	 25784 2011-01-18 20:55:00
DIS	2009-10-28 18:10:00	 25536 2011-01-18 20:55:00
DNDN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
DTV	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
DVN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
EBAY	2009-10-28 18:10:00	 25476 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
EOG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
ESRX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
EWZ	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FCX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FDX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FFIV	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FLS	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
FSLR	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
GDX	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
GG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
GILD	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
GLD	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
GOOG	2009-10-28 18:10:00	 25806 2011-01-18 20:55:00
GS	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
HD	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
HES	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
HON	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
HPQ	2009-10-28 18:10:00	 25623 2011-01-14 20:55:00
IBM	2009-10-28 18:10:00	 25676 2011-01-18 20:55:00
IOC	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
IWM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
JNJ	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
JOYG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
JPM	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
JWN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
KO	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
LFT	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MAR	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MCD	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MDT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MDY	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MEE	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MET	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MJN	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MMM	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MON	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MOS	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
MRK	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
MT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
NEM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
NFLX	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
NUE	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
OIH	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
OXY	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
PBR	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
PEP	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
PG	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
PM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
PNC	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
POT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
PRU	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
QCOM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
QQQQ	2009-10-28 18:10:00	 25892 2011-01-18 20:55:00
RIG	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
RIMM	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
SINA	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
SJM	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
SKX	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
SLB	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
SLV	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
SNDK	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
SPY	2009-10-28 18:10:00	 22135 2011-01-18 20:55:00
STT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
SUN	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
TEVA	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
TGT	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
TKR	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
TLT	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
UNH	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
UNP	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
UPS	2011-01-04 14:30:00	   702 2011-01-14 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
VECO	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
VMW	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
WDC	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
WFMI	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
WHR	2011-01-04 14:30:00	   702 2011-01-14 20:55:00
WMT	2009-10-28 18:10:00	 25580 2011-01-14 20:55:00
WYNN	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
X	2011-01-04 12:40:00	  1212 2011-01-14 20:55:00
XLB	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
XLE	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
XLU	2011-01-04 14:30:00	   780 2011-01-18 20:55:00
XOM	2009-10-28 18:10:00	 25754 2011-01-14 20:55:00

133 rows selected.

Elapsed: 00:00:00.14
11:54:37 SQL> 
11:54:37 SQL> CREATE TABLE di5min_stk COMPRESS AS
11:54:37   2  SELECT
11:54:37   3  tkrdate
11:54:37   4  ,tkr
11:54:37   5  ,ydate
11:54:37   6  ,AVG(clse)clse
11:54:37   7  FROM di5min_stk0
11:54:37   8  -- I want weekdays:
11:54:37   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
11:54:37  10  GROUP BY
11:54:37  11  tkrdate
11:54:37  12  ,tkr
11:54:37  13  ,ydate
11:54:37  14  /

Table created.

Elapsed: 00:00:01.68
11:54:38 SQL> 
11:54:38 SQL> -- rpt
11:54:38 SQL> SELECT
11:54:38   2  TO_CHAR(ydate,'dy')
11:54:38   3  ,COUNT(ydate)
11:54:38   4  FROM di5min_stk
11:54:38   5  GROUP BY TO_CHAR(ydate,'dy')
11:54:38   6  /

TO_ COUNT(YDATE)
--- ------------
fri	   70193
tue	   73537
thu	   70271
wed	   69291
mon	   60000

Elapsed: 00:00:00.23
11:54:38 SQL> 
11:54:38 SQL> -- I need to shave a second off of some of the dates:
11:54:38 SQL> --
11:54:38 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
11:54:38 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
11:54:38 SQL> -- /
11:54:38 SQL> --
11:54:38 SQL> -- SELECT COUNT(*)FROM di5min_stk;
11:54:38 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
11:54:38 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
11:54:38 SQL> --
11:54:38 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
11:54:38 SQL> 
11:54:38 SQL> -- Add a column to help join with future dates
11:54:38 SQL> -- and then calculate 1 day gain:
11:54:38 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:00.68
11:54:39 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
11:54:39   2  SELECT
11:54:39   3  tkrdate
11:54:39   4  ,tkr
11:54:39   5  ,ydate
11:54:39   6  ,clse
11:54:39   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
11:54:39   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
11:54:39   9  	    ELSE NULL END selldate
11:54:39  10  FROM di5min_stk
11:54:39  11  /

Table created.

Elapsed: 00:00:00.86
11:54:40 SQL> 
11:54:40 SQL> -- Join with the future
11:54:40 SQL> 
11:54:40 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.06
11:54:40 SQL> 
11:54:40 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
11:54:40   2  SELECT
11:54:40   3  p.tkrdate
11:54:40   4  ,p.tkr
11:54:40   5  ,p.ydate
11:54:40   6  ,p.clse
11:54:40   7  ,p.selldate
11:54:40   8  ,f.clse clse2
11:54:40   9  ,f.clse - p.clse gain1day
11:54:40  10  FROM di5min_stk_fd p, di5min_stk f
11:54:40  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
11:54:40  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
11:54:40  13  /

Table created.

Elapsed: 00:00:01.62
11:54:42 SQL> 
11:54:42 SQL> -- rpt
11:54:42 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 70193
tue	 73537
thu	 70271
wed	 69291
mon	 60000

Elapsed: 00:00:00.22
11:54:42 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 70193
tue	 73537
thu	 70271
wed	 69291
mon	 60000

Elapsed: 00:00:00.29
11:54:42 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-01-18 20:55:00

Elapsed: 00:00:00.03
11:54:42 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-01-18 20:55:00

Elapsed: 00:00:00.03
11:54:42 SQL> 
11:54:42 SQL> -- rpt
11:54:42 SQL> SELECT
11:54:42   2  tkr
11:54:42   3  ,MIN(ydate)
11:54:42   4  ,COUNT(ydate)
11:54:42   5  ,MAX(ydate)
11:54:42   6  ,MIN(clse)
11:54:42   7  ,AVG(clse)
11:54:42   8  ,MAX(clse)
11:54:42   9  ,MAX(gain1day)
11:54:42  10  FROM di5min_stk_c2
11:54:42  11  GROUP BY tkr
11:54:42  12  ORDER BY tkr
11:54:42  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	 328.28 338.927771     348.46	       9.63
ABT	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	   46.8 47.8749003	48.76		.91
ABX	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  46.35 49.2189615	52.33		1.2
ADBE	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	   31.3 32.5852279	33.88	       1.15
AEM	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  68.98 71.1884687	72.79	       2.78
AFL	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  54.89 56.4725427	57.97	       1.84
AIG	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  53.18 58.7116667	62.47		4.8
AKAM	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  46.85  49.262891	52.39	       2.39
ALL	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  30.47 31.2250513	32.18		 .6
AMGN	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  55.99 56.6572436	57.26		.89
AMT	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  49.37 50.6835705	52.16		.97
AMX	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	   57.5 58.4575783	59.58	       1.19
AMZN	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	 182.72 185.867885     191.55	       3.43
APA	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  119.6 123.940634     127.11	       4.04
APC	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	   73.1 76.0505413	79.46	       3.94
ARG	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  63.18 63.5739459	63.92		.51
AXP	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  43.29 44.8661467	46.49	       1.52
BA	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  66.51 68.9351425	70.47		2.6
BBT	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	     26 26.8798148	27.85		.97
BBY	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  34.65 35.4658405	36.18	       1.29
BEN	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	 109.71  114.38505     121.32	       5.04
BHP	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  87.68 89.9175855	 92.7		2.4
BIDU	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  99.53   105.4465     108.96	       4.15
BP	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	   45.2 46.7419373	49.36	       1.83
BRCM	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  42.11 45.3379679	47.32	       2.09
BTU	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	     61 62.5524359	65.57	       2.87
BUCY	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  89.67 90.0224217	90.33		.24
CAT	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  92.37 93.8438034	94.67	       2.25
CELG	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	   56.3 58.2638462	59.69	       1.56
CLF	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  80.23 84.8196011	89.05	       5.53
CMI	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	 109.01 111.613226     113.59	       4.34
COF	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  43.23 45.8398291	48.56	       1.95
COP	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  66.58 67.5052422	68.97	       1.35
COST	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  70.07 71.2541809	72.49	       1.04
CREE	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  62.64 66.7292756	69.19	       2.11
CRM	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	 133.57 141.673391     146.42	       8.23
CSX	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  64.81 67.4878561	69.46	       1.63
CTSH	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	   73.6 75.1138675	76.34	       2.16
CVS	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  34.41 35.0971581	35.94		.59
CVX	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  90.21 91.5441168	92.86	       1.64
DD	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  47.28 49.5058462	50.53	       1.82
DE	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  81.82 85.7638177	89.93	       2.68
DIA	2009-10-28 18:10:00	   25772 2011-01-18 20:55:00	  96.34 106.964753     118.39	       4.35
DIS	2009-10-28 18:10:00	   25524 2011-01-18 20:55:00	  27.06 33.9147882	   40		2.1
DNDN	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  34.93  36.740933	38.85	       2.92
DTV	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  40.79 41.6593234	42.58		  1
DVN	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  77.06 79.5128561	82.78	       2.75
EBAY	2009-10-28 18:10:00	   25464 2011-01-14 20:55:00	  19.17  24.648826	31.48	       2.55
EFA	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  56.77 58.3435513	59.91	       1.37
EOG	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  91.02 95.0843803     100.58	       3.53
ESRX	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  55.52 56.6880627	 57.9	       1.32
EWZ	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  75.21 77.2167806	78.95	       1.94
FCX	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  115.2 118.640363     122.49	       4.32
FDX	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  92.12 94.0216311	96.98		2.4
FFIV	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  131.7 139.799594     145.75	       5.47
FLS	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  114.8 117.681332     121.04	       4.68
FSLR	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	 130.64 137.008032	148.4	       3.75
GDX	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  54.63 57.1050513	60.06	       1.54
GG	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  40.56 43.2076496	44.84	       1.26
GILD	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  36.51 37.5002137	38.49	       1.14
GLD	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	 132.37 134.124404     136.18	       1.14
GOOG	2009-10-28 18:10:00	   25782 2011-01-18 20:55:00	  434.6 548.504935     641.65	      63.83
GS	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	 168.42 172.080654	  175	       3.74
HD	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  34.09 34.8058191	35.98		.99
HES	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  77.11 79.3622293	82.11	       3.75
HON	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  53.03 54.2216524	54.99	       1.54
HPQ	2009-10-28 18:10:00	   25611 2011-01-14 20:55:00	  37.45 46.6264328	 54.7		3.4
IBM	2009-10-28 18:10:00	   25664 2011-01-18 20:55:00	 119.59 132.327144     151.38	       5.73
IOC	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  75.02 76.4572692	77.99	       1.89
IWM	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  77.55 79.3327885	80.62	       1.65
JNJ	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  62.01 62.7002849	63.49		.74
JOYG	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  84.65 88.0729345	91.25	       3.14
JPM	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  42.77 44.2372934	45.91	       1.36
JWN	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  41.44 42.2337322	43.69	       1.14
KO	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	   62.6 63.2665449	65.04	       1.01
LFT	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  32.66 34.7591154	   37	       1.43
MAR	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  40.17 41.1178718	42.01		.92
MCD	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  72.15 74.1592949	75.64	       1.64
MDT	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  36.18 36.7075427	37.34		.58
MDY	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	 163.62 166.497286     169.01		3.4
MEE	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  53.71 56.2167236	58.46	       2.64
MET	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  45.07 46.0744167	46.95	       1.25
MJN	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  60.37 61.9425385	63.29	       1.16
MMM	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  85.68 87.3035399	88.75	       1.85
MON	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  68.27 71.9115954	75.24	       4.04
MOS	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  73.65 77.7819658	83.21	       4.05
MRK	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  33.52   36.09225	 37.6		.72
MT	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  34.22 36.0072293	 38.2	       1.57
NEM	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  55.21 57.4034423	60.22	       1.22
NFLX	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  176.3  184.29386     192.33	       9.82
NUE	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  42.81 44.2060613	45.23	       1.62
OIH	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	 135.78 140.729173     147.27	       4.76
OXY	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  94.33 96.4967236	 98.4	       2.52
PBR	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  36.01 37.0173647	38.46	       1.58
PEP	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  65.18 66.4769231	67.46	       1.56
PG	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  63.75 64.8047436	65.91	       1.12
PM	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  55.88 56.9501987	58.93		 .6
PNC	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  60.16 61.8669587	64.25	       3.13
POT	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	 153.56 165.557977     172.76	       7.96
PRU	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  59.41 60.7999644	61.92	       1.37
QCOM	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	   49.9 51.9467885	53.06		2.3
QQQQ	2009-10-28 18:10:00	   25880 2011-01-18 20:55:00	   40.7 47.9231042	57.22		2.5
RIG	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  69.12 74.4708618	79.03	       5.25
RIMM	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  58.31 62.0440741	66.03		  3
SINA	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  72.55 79.4685541	88.37	       6.68
SJM	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	   62.2 63.3986154	64.64	       1.07
SKX	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	   19.3 20.6664423	21.97	       1.07
SLB	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  79.84 82.5345726	86.89	       2.65
SLV	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	   27.5 28.4694423	29.59		.63
SNDK	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  49.78 52.1460128	53.47		2.7
SPY	2009-10-28 18:10:00	   22111 2011-01-18 20:55:00	 103.18 115.734052	129.6		5.1
STT	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  45.94 47.3845798	49.97		2.1
SUN	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  38.49 39.9652991	 41.6	       1.27
TEVA	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  52.03 53.6277137	 54.6		1.8
TGT	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  54.39 56.2087963	60.37		.75
TKR	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  48.64 50.1311254	51.83	       1.78
TLT	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	   90.8 92.1133974	93.74	       1.77
UNH	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  36.95 38.5871011	40.88	       1.47
UNP	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	     92 95.8462678	99.44	       3.77
UPS	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  71.37 72.3324644	73.06		.96

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
V	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  60.16 71.2010699	72.45	 2.05333333
VECO	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  43.62     46.896	49.65	       2.41
VMW	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  90.62 94.9741026	97.55	       3.83
WDC	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  31.83 33.0327115	34.22		  1
WFMI	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	  47.85 49.7533476	53.02	       2.66
WHR	2011-01-04 14:30:00	     702 2011-01-14 20:55:00	   86.1 88.3243162	90.71	       2.42
WMT	2009-10-28 18:10:00	   25556 2011-01-14 20:55:00	  47.76 53.1406755	56.15	       2.22
WYNN	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	 109.66 116.442769     120.68		5.2
X	2011-01-04 12:40:00	    1200 2011-01-14 20:55:00 52.1166667 65.0660852	75.74	 14.4983333
XLB	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  37.74 38.5841346     39.085		 .8
XLE	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  67.54 68.9847051	 71.1	       1.56
XLU	2011-01-04 14:30:00	     780 2011-01-18 20:55:00	  31.23 31.5271987	31.84		.29
XOM	2009-10-28 18:10:00	   25730 2011-01-14 20:55:00	  56.05 66.7623916	77.99	       2.55

133 rows selected.

Elapsed: 00:00:00.31
11:54:43 SQL> 
11:54:43 SQL> COLUMN clse FORMAT 999.9999
11:54:43 SQL> SELECT
11:54:43   2  tkr
11:54:43   3  ,ROUND(clse,4)clse
11:54:43   4  -- Should be NULL:
11:54:43   5  ,ROUND(clse2,4)clse2
11:54:43   6  ,ydate
11:54:43   7  FROM di5min_stk_c2
11:54:43   8  WHERE ydate > sysdate - 0.5/24
11:54:43   9  ORDER BY tkr,ydate
11:54:43  10  /

no rows selected

Elapsed: 00:00:00.05
11:54:43 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
