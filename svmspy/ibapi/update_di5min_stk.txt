
SQL*Plus: Release 11.2.0.1.0 Production on Mon Apr 4 13:16:41 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

13:16:42 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
13:16:42 SQL> 
13:16:42 SQL> 13:16:42 SQL> --
13:16:42 SQL> -- update_di5min_stk.sql
13:16:42 SQL> --
13:16:42 SQL> 
13:16:42 SQL> -- I use this script to keep di5min_stk up to date.
13:16:42 SQL> 
13:16:42 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
13:16:42 SQL> -- After that date, it holds data from IB.
13:16:42 SQL> 
13:16:42 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
13:16:42 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
13:16:42 SQL> 
13:16:42 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:01.24
13:16:43 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.10
13:16:43 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.24
13:16:43 SQL> 
13:16:43 SQL> 
13:16:43 SQL> -- I need to shave a second off of some of the dates:
13:16:43 SQL> 
13:16:43 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
13:16:43   2  WHERE TO_CHAR(ydate,'SS')='01'
13:16:43   3  /

0 rows updated.

Elapsed: 00:00:00.23
13:16:43 SQL> 
13:16:43 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    744610

Elapsed: 00:00:00.01
13:16:43 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    744610

Elapsed: 00:00:00.20
13:16:44 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.19
13:16:44 SQL> 
13:16:44 SQL> -- Remove data which is outside of RTH:
13:16:44 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') < '14:30'AND ydate < '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.27
13:16:44 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') > '20:55'AND ydate < '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.26
13:16:44 SQL> -- Daylight savings time started on 2011-03-14:
13:16:44 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') < '13:30'AND ydate > '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.12
13:16:44 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') > '19:55'AND ydate > '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.12
13:16:45 SQL> 
13:16:45 SQL> 
13:16:45 SQL> -- Copy in data from ibs5min:
13:16:45 SQL> 
13:16:45 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
13:16:45   2  SELECT	     tkr||ydate,tkr,ydate,clse
13:16:45   3  FROM ibs5min
13:16:45   4  WHERE ydate >= '2010-12-27 09:00:00'
13:16:45   5  /

744610 rows created.

Elapsed: 00:00:01.67
13:16:46 SQL> 
13:16:46 SQL> -- rpt
13:16:46 SQL> SELECT
13:16:46   2  tkr
13:16:46   3  ,MIN(ydate)
13:16:46   4  ,COUNT(tkr)
13:16:46   5  ,MAX(ydate)
13:16:46   6  FROM di5min_stk0
13:16:46   7  GROUP BY tkr
13:16:46   8  ORDER BY tkr
13:16:46   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ABT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ABX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ADBE	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AEM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AFL	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AGU	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
AIG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AKAM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ALL	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AMGN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AMT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AMX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AMZN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
APA	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
APC	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ARG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AXP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AXU	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
BA	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BBT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BBY	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BEN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BHP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BIDU	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BRCM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BTU	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BUCY	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CAT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CDE	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
CELG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CEO	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
CHK	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
CLF	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CMI	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
COF	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
COP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
COST	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CREE	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CRM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CSX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CTSH	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CVE	2011-02-14 14:30:00	  2652 2011-04-01 19:55:00
CVS	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CVX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DD	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DE	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DIA	2010-12-27 14:30:00	  5304 2011-04-01 19:55:00
DIS	2010-12-27 14:30:00	  5304 2011-04-01 19:55:00
DNDN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DTV	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DVN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
EBAY	2010-12-27 14:30:00	  5096 2011-04-01 19:55:00
EFA	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
EOG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ESRX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
EWZ	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
EXK	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
FCX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
FDX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
FFIV	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
FLS	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
FSLR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
GD	2011-01-28 14:30:00	  3510 2011-04-01 19:55:00
GDX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
GFI	2011-01-28 14:30:00	  3276 2011-04-01 19:55:00
GG	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
GILD	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
GLD	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
GOOG	2010-12-27 14:30:00	  5070 2011-04-01 19:55:00
GS	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
HD	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
HES	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
HL	2011-01-18 14:30:00	  3978 2011-04-01 19:55:00
HOC	2011-02-17 14:30:00	  2418 2011-04-01 19:55:00
HON	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
HPQ	2010-12-27 14:30:00	  5304 2011-04-01 19:55:00
IBM	2010-12-27 14:30:00	  5304 2011-04-01 19:55:00
IOC	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
IWM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
JNJ	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
JOYG	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
JPM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
JWN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
KO	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
LFT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
LMT	2011-01-28 14:30:00	  3276 2011-04-01 19:55:00
MAR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MCD	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
MDT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MDY	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MEE	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
MET	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MJN	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
MMM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MON	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MOS	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MRK	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MVG	2011-01-21 14:30:00	  3665 2011-04-01 19:55:00
NEM	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
NFLX	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
NOC	2011-01-28 14:30:00	  3276 2011-04-01 19:55:00
NUE	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
OIH	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ORCL	2011-03-01 14:30:00	  1872 2011-04-01 19:55:00
OXY	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PAAS	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
PALL	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
PBR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PEP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PNC	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
POT	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
PPLT	2011-01-21 14:30:00	  3897 2011-04-01 19:55:00
PRU	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
QCOM	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
QQQ	2010-12-27 14:30:00	  5304 2011-04-01 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
RDY	2011-01-24 14:30:00	  3588 2011-04-01 19:55:00
RIG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
RIMM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
RTN	2011-01-28 14:30:00	  3510 2011-04-01 19:55:00
SCCO	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
SINA	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
SJM	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
SKX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SLB	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SLV	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SLW	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
SNDK	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SOHU	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
SPY	2010-12-27 14:30:00	  5304 2011-04-01 19:55:00
STT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SU	2011-02-17 14:30:00	  2418 2011-04-01 19:55:00
SUN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SVM	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
SWC	2011-01-19 14:30:00	  3822 2011-04-01 19:55:00
T	2011-02-04 14:30:00	  2106 2011-04-01 19:55:00
TEVA	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
TGT	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
TKR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
TLT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
TSO	2011-02-17 14:30:00	  2418 2011-04-01 19:55:00
UNH	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
UNP	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
UPS	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
V	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
VALE	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
VECO	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
VLO	2011-02-17 14:30:00	  2418 2011-04-01 19:55:00
VMW	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
WDC	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
WFMI	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
WHR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
WMT	2010-12-27 14:30:00	  5304 2011-04-01 19:55:00
WYNN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
X	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
XLB	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
XLE	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
XLU	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
XOM	2010-12-27 14:30:00	  5070 2011-04-01 19:55:00

163 rows selected.

Elapsed: 00:00:00.30
13:16:46 SQL> 
13:16:46 SQL> -- Next, copy in data from dukas.
13:16:46 SQL> -- dukas5min_stk depends on:
13:16:46 SQL> -- - dukas10min_stk
13:16:46 SQL> -- - svmspy/dukas/fake5.sql
13:16:46 SQL> 
13:16:46 SQL> 
13:16:46 SQL> -- I need to shave a second off of some of the dates:
13:16:46 SQL> 
13:16:46 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
13:16:46   2  WHERE TO_CHAR(ydate,'SS')='01'
13:16:46   3  /

0 rows updated.

Elapsed: 00:00:00.08
13:16:47 SQL> 
13:16:47 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
13:16:47 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.06
13:16:47 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.07
13:16:47 SQL> 
13:16:47 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
13:16:47   2  SELECT	     tkr||ydate,tkr,ydate,clse
13:16:47   3  FROM dukas5min_stk
13:16:47   4  WHERE ydate < '2010-12-27 09:00:00'
13:16:47   5  /

230382 rows created.

Elapsed: 00:00:00.45
13:16:47 SQL> 
13:16:47 SQL> -- rpt
13:16:47 SQL> SELECT
13:16:47   2  tkr
13:16:47   3  ,MIN(ydate)
13:16:47   4  ,COUNT(tkr)
13:16:47   5  ,MAX(ydate)
13:16:47   6  FROM dukas5min_stk
13:16:47   7  WHERE ydate < '2010-12-27 09:00:00'
13:16:47   8  GROUP BY tkr
13:16:47   9  ORDER BY tkr
13:16:47  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.08
13:16:47 SQL> 
13:16:47 SQL> -- rpt
13:16:47 SQL> SELECT
13:16:47   2  tkr
13:16:47   3  ,MIN(ydate)
13:16:47   4  ,COUNT(tkr)
13:16:47   5  ,MAX(ydate)
13:16:47   6  FROM di5min_stk0
13:16:47   7  GROUP BY tkr
13:16:47   8  ORDER BY tkr
13:16:47   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ABT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ABX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ADBE	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AEM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AFL	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AGU	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
AIG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AKAM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ALL	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AMGN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AMT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AMX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AMZN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
APA	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
APC	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ARG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AXP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
AXU	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
BA	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BBT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BBY	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BEN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BHP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BIDU	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BRCM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BTU	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
BUCY	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CAT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CDE	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
CELG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CEO	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
CHK	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
CLF	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CMI	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
COF	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
COP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
COST	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CREE	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CRM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CSX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CTSH	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CVE	2011-02-14 14:30:00	  2652 2011-04-01 19:55:00
CVS	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
CVX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DD	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DE	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DIA	2009-10-28 18:10:00	 28733 2011-04-01 19:55:00
DIS	2009-10-28 18:10:00	 28733 2011-04-01 19:55:00
DNDN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DTV	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
DVN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
EBAY	2009-10-28 18:10:00	 28525 2011-04-01 19:55:00
EFA	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
EOG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ESRX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
EWZ	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
EXK	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
FCX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
FDX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
FFIV	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
FLS	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
FSLR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
GD	2011-01-28 14:30:00	  3510 2011-04-01 19:55:00
GDX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
GFI	2011-01-28 14:30:00	  3276 2011-04-01 19:55:00
GG	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
GILD	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
GLD	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
GOOG	2009-10-28 18:10:00	 28499 2011-04-01 19:55:00
GS	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
HD	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
HES	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
HL	2011-01-18 14:30:00	  3978 2011-04-01 19:55:00
HOC	2011-02-17 14:30:00	  2418 2011-04-01 19:55:00
HON	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
HPQ	2009-10-28 18:10:00	 28733 2011-04-01 19:55:00
IBM	2009-10-28 18:10:00	 28733 2011-04-01 19:55:00
IOC	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
IWM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
JNJ	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
JOYG	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
JPM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
JWN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
KO	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
LFT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
LMT	2011-01-28 14:30:00	  3276 2011-04-01 19:55:00
MAR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MCD	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
MDT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MDY	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MEE	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
MET	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MJN	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
MMM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MON	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MOS	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MRK	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
MVG	2011-01-21 14:30:00	  3665 2011-04-01 19:55:00
NEM	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
NFLX	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
NOC	2011-01-28 14:30:00	  3276 2011-04-01 19:55:00
NUE	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
OIH	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
ORCL	2011-03-01 14:30:00	  1872 2011-04-01 19:55:00
OXY	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PAAS	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
PALL	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
PBR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PEP	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
PNC	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
POT	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
PPLT	2011-01-21 14:30:00	  3897 2011-04-01 19:55:00
PRU	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
QCOM	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
QQQ	2010-12-27 14:30:00	  5304 2011-04-01 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
QQQQ	2009-10-28 18:10:00	 23429 2010-12-24 20:50:00
RDY	2011-01-24 14:30:00	  3588 2011-04-01 19:55:00
RIG	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
RIMM	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
RTN	2011-01-28 14:30:00	  3510 2011-04-01 19:55:00
SCCO	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
SINA	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
SJM	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
SKX	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SLB	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SLV	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SLW	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
SNDK	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SOHU	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
SPY	2009-10-28 18:10:00	 24825 2011-04-01 19:55:00
STT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SU	2011-02-17 14:30:00	  2418 2011-04-01 19:55:00
SUN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
SVM	2011-01-21 14:30:00	  3900 2011-04-01 19:55:00
SWC	2011-01-19 14:30:00	  3822 2011-04-01 19:55:00
T	2011-02-04 14:30:00	  2106 2011-04-01 19:55:00
TEVA	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
TGT	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
TKR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
TLT	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
TSO	2011-02-17 14:30:00	  2418 2011-04-01 19:55:00
UNH	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
UNP	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
UPS	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
V	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
VALE	2011-01-24 14:30:00	  3822 2011-04-01 19:55:00
VECO	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
VLO	2011-02-17 14:30:00	  2418 2011-04-01 19:55:00
VMW	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
WDC	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
WFMI	2011-01-04 14:30:00	  4602 2011-04-01 19:55:00
WHR	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
WMT	2009-10-28 18:10:00	 28733 2011-04-01 19:55:00
WYNN	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
X	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
XLB	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
XLE	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
XLU	2011-01-04 14:30:00	  4836 2011-04-01 19:55:00
XOM	2009-10-28 18:10:00	 28499 2011-04-01 19:55:00

164 rows selected.

Elapsed: 00:00:00.37
13:16:48 SQL> 
13:16:48 SQL> CREATE TABLE di5min_stk COMPRESS AS
13:16:48   2  SELECT
13:16:48   3  tkrdate
13:16:48   4  ,tkr
13:16:48   5  ,ydate
13:16:48   6  ,AVG(clse)clse
13:16:48   7  FROM di5min_stk0
13:16:48   8  -- I want weekdays:
13:16:48   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
13:16:48  10  GROUP BY
13:16:48  11  tkrdate
13:16:48  12  ,tkr
13:16:48  13  ,ydate
13:16:48  14  /

Table created.

Elapsed: 00:00:04.69
13:16:52 SQL> 
13:16:52 SQL> -- rpt
13:16:52 SQL> SELECT
13:16:52   2  TO_CHAR(ydate,'dy')
13:16:52   3  ,COUNT(ydate)
13:16:52   4  FROM di5min_stk
13:16:52   5  GROUP BY TO_CHAR(ydate,'dy')
13:16:52   6  /

TO_ COUNT(YDATE)
--- ------------
fri	  204853
mon	  167128
tue	  199666
wed	  199891
thu	  203454

Elapsed: 00:00:00.67
13:16:53 SQL> 
13:16:53 SQL> -- I need to shave a second off of some of the dates:
13:16:53 SQL> --
13:16:53 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
13:16:53 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
13:16:53 SQL> -- /
13:16:53 SQL> --
13:16:53 SQL> -- SELECT COUNT(*)FROM di5min_stk;
13:16:53 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
13:16:53 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
13:16:53 SQL> --
13:16:53 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
13:16:53 SQL> 
13:16:53 SQL> -- Add a column to help join with future dates
13:16:53 SQL> -- and then calculate 1 day gain:
13:16:53 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:01.21
13:16:54 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
13:16:54   2  SELECT
13:16:54   3  tkrdate
13:16:54   4  ,tkr
13:16:54   5  ,ydate
13:16:54   6  ,clse
13:16:54   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
13:16:54   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
13:16:54   9  	    ELSE NULL END selldate
13:16:54  10  FROM di5min_stk
13:16:54  11  /

Table created.

Elapsed: 00:00:02.48
13:16:57 SQL> 
13:16:57 SQL> -- Join with the future
13:16:57 SQL> 
13:16:57 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.29
13:16:57 SQL> 
13:16:57 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
13:16:57   2  SELECT
13:16:57   3  p.tkrdate
13:16:57   4  ,p.tkr
13:16:57   5  ,p.ydate
13:16:57   6  ,p.clse
13:16:57   7  ,p.selldate
13:16:57   8  ,f.clse clse2
13:16:57   9  ,f.clse - p.clse gain1day
13:16:57  10  FROM di5min_stk_fd p, di5min_stk f
13:16:57  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
13:16:57  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
13:16:57  13  /

Table created.

Elapsed: 00:00:04.65
13:17:02 SQL> 
13:17:02 SQL> -- rpt
13:17:02 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	204853
mon	167128
tue	199666
wed	199891
thu	203454

Elapsed: 00:00:00.58
13:17:02 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	204853
mon	167128
tue	199666
wed	199891
thu	203454

Elapsed: 00:00:00.70
13:17:03 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-04-01 19:55:00

Elapsed: 00:00:00.08
13:17:03 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-04-01 19:55:00

Elapsed: 00:00:00.08
13:17:03 SQL> 
13:17:03 SQL> -- rpt
13:17:03 SQL> SELECT
13:17:03   2  tkr
13:17:03   3  ,MIN(ydate)
13:17:03   4  ,COUNT(ydate)
13:17:03   5  ,MAX(ydate)
13:17:03   6  ,MIN(clse)
13:17:03   7  ,AVG(clse)
13:17:03   8  ,MAX(clse)
13:17:03   9  ,MAX(gain1day)
13:17:03  10  FROM di5min_stk_c2
13:17:03  11  GROUP BY tkr
13:17:03  12  ORDER BY tkr
13:17:03  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	200.725 339.181668     364.83	 145.278438
ABT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 39.115 46.8647899	49.43	     8.3225
ABX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  45.64 49.8049435	54.24	       2.14
ADBE	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  30.82 33.8757217	43.25	       1.64
AEM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	   63.6 69.6811996	76.47	       3.74
AFL	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  48.59  56.099676	59.48	       3.71
AGU	2011-01-24 14:30:00	    3822 2011-04-01 19:55:00	  84.78 91.6477784	99.13	       4.71
AIG	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  34.91 43.2076646	62.47		4.8
AKAM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  34.85 42.7881986	52.47	       2.39
ALL	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  30.47 31.4477616	32.61		.83
AMGN	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  50.63 54.2625675	58.15	       1.92
AMT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  45.98 51.8060516	56.73	       2.44
AMX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  53.38 56.8352807	59.58	       1.74
AMZN	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 160.93 176.860343     191.55	       10.1
APA	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  110.8 121.728157     132.29	       5.98
APC	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	   73.1 78.4822105	83.97	       4.12
ARG	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  60.86 63.4176578	67.35	       2.46
AXP	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  42.31 44.7149442	 46.9	       1.92
AXU	2011-01-21 14:30:00	    3900 2011-04-01 19:55:00	   5.88 7.91441697	 9.64	       1.07
BA	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  66.51 72.6162002    102.935	       2.85
BBT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	     26 27.4915769	29.55		1.3
BBY	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  28.56 33.0954685	36.18	       1.64
BEN	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 109.71 121.382311	130.6	       5.04
BHP	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  83.94 91.4807523	97.04	       3.59
BIDU	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  99.53 118.907791     139.32	      11.14
BP	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  42.55 47.4862401	64.49	       1.83
BRCM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  25.15 41.9969497	47.32	  16.154375
BTU	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	   57.7 65.2118988	73.67	       5.41
BUCY	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  89.67 91.7212842    107.275	       2.47
CAT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  92.37  100.64499     113.59	       3.79
CDE	2011-01-21 14:30:00	    3900 2011-04-01 19:55:00	  22.13 29.1467231	36.06		4.4
CELG	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  48.96 55.1293706     64.905	       2.45
CEO	2011-01-24 14:30:00	    3822 2011-04-01 19:55:00	 206.99 229.339603     263.78	      12.17
CHK	2011-01-24 14:30:00	    3822 2011-04-01 19:55:00	  27.24 32.1729304	35.83	       3.48
CLF	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  79.77 90.2907101	101.2	       8.31
CMI	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  94.36 106.567816     114.74	       6.52
COF	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  43.23 50.7420256     70.685		2.8
COP	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  65.11 72.9822669	81.66	 11.4215625
COST	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  69.56 72.6396029	75.43	       3.55
CREE	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  42.85 53.1601468	69.19	       2.89
CRM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 97.655 131.574716 146.866719	 47.6217188
CSX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  64.81 72.7576575	80.23	       3.28
CTSH	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  70.72 75.8088302	82.81	       3.45
CVE	2011-02-14 14:30:00	    2652 2011-04-01 19:55:00	  34.32 37.7299746	40.43	 1.75985901
CVS	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  32.13 33.8880379	35.94	       1.17
CVX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  90.21 98.7466305     109.51	       3.55
DD	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  47.28  52.197756	56.16	 5.09311826
DE	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  81.82 90.8015923	 99.8	       3.93
DIA	2009-10-28 18:10:00	   28733 2011-04-01 19:55:00	  96.34  108.56447     123.94	       4.35
DIS	2009-10-28 18:10:00	   28733 2011-04-01 19:55:00	  27.06 34.9210002	44.29	       3.13
DNDN	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  31.34 37.7411806     99.105	       2.92
DTV	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  40.79 44.0760604	47.56		2.4
DVN	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  77.06 87.0546085	93.42	       4.67
EBAY	2009-10-28 18:10:00	   28525 2011-04-01 19:55:00	  19.17 25.6822832 47.5933333	       2.69
EFA	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	   54.7 62.2295827     99.265	       2.16
EOG	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  91.02 105.998751     120.99	       6.61
ESRX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  51.25 55.8542096	58.74		2.2
EWZ	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  70.16  74.491955	79.36	       2.02
EXK	2011-01-21 14:30:00	    3900 2011-04-01 19:55:00	    5.4 7.87645236	10.29	       1.46
FCX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  46.43 74.2109668     122.49	 48.3005005
FDX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  55.79 89.8360629	98.45	  31.839375
FFIV	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  91.18 116.306248     145.75	      11.02
FLS	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	 79.275 120.743083     132.49	   41.92375
FSLR	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 130.64  151.49286	  174	      12.54
GD	2011-01-28 14:30:00	    3510 2011-04-01 19:55:00 60.8145605 67.2150119	   78	       9.59
GDX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  52.52 57.6920332	 67.1	       2.31
GFI	2011-01-28 14:30:00	    3276 2011-04-01 19:55:00	  15.67 16.9507162	18.32		.79
GG	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  39.13 45.0568784	50.69	       2.69
GILD	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  36.51  39.406002	42.89	       1.75
GLD	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	 84.125 132.784209     141.16	  52.591875
GOOG	2009-10-28 18:10:00	   28499 2011-04-01 19:55:00	329.525   550.0951     641.65	 261.864063
GS	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  153.4 164.277526	  175	       6.13
HD	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  34.09 36.6887239	38.94	       1.42
HES	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  76.16 81.7504571	87.09	       4.51
HL	2011-01-18 14:30:00	    3978 2011-04-01 19:55:00	   7.84 9.37475292	11.08		.85
HOC	2011-02-17 14:30:00	    2418 2011-04-01 19:55:00	  50.79 56.8721379	63.17	       5.16
HON	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  53.03 56.3269329	59.97	       2.27
HPQ	2009-10-28 18:10:00	   28733 2011-04-01 19:55:00	  37.45 46.4603989	 54.7		3.4
IBM	2009-10-28 18:10:00	   28733 2011-04-01 19:55:00	 119.59 135.921732     167.47	       6.28
IOC	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  66.18 73.5672764	81.72	       4.58
IWM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  77.04 80.5185565	84.99	       2.49
JNJ	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	   57.5  60.636102	63.49	       1.77
JOYG	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	 73.075 90.5873499     103.31	 21.9322852
JPM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  42.77 45.4723215	48.27		2.5
JWN	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  40.03 43.4073931	47.49	       2.39
KO	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  61.35 64.6818365	79.42	       2.22
LFT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  28.04 32.2707826	   37	       4.03
LMT	2011-01-28 14:30:00	    3276 2011-04-01 19:55:00	  77.84  80.925107	88.63	       2.23
MAR	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  34.99 39.2019203	42.58		1.5
MCD	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  72.15 74.8995664	77.23	       2.68
MDT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  36.18 38.4759395	41.32	       1.36
MDY	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 163.62 172.164738     181.16		4.5
MEE	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  52.03 61.3058617	69.82	       9.93
MET	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  41.29 45.8751936	48.71	       1.78
MJN	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  52.71 59.1419775	63.29	 6.94539063
MMM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  85.68 90.1387675	94.28	       2.69
MON	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	   65.2  71.658386	76.13	       4.04
MOS	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  71.87 80.3798614	89.17	       6.34
MRK	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  31.07 33.3894332	 37.6		.95
MT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  32.43 36.4453551	41.21	       2.13
MVG	2011-01-21 14:30:00	    3665 2011-04-01 19:55:00	   9.25 11.1313739	13.35	       1.31
NEM	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  50.07 55.3508243	60.22	       2.16
NFLX	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  176.3 208.281718     244.23	      29.02
NOC	2011-01-28 14:30:00	    3276 2011-04-01 19:55:00	 62.335 67.3101231	 72.4	   4.690625
NUE	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  42.81 46.1548263	49.23	       2.14
OIH	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 135.78 154.168313     167.01	       8.52
ORCL	2011-03-01 14:30:00	    1872 2011-04-01 19:55:00	  29.63 32.1066467	34.09	       2.05
OXY	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  93.76 99.5787368     107.41	       3.94
PAAS	2011-01-21 14:30:00	    3900 2011-04-01 19:55:00	  31.13 35.8546099	40.53	       2.92
PALL	2011-01-21 14:30:00	    3900 2011-04-01 19:55:00	  68.75 78.4484416	85.33	       3.41
PBR	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  35.03 38.3883466	42.57		2.3
PEP	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  62.07 64.5327804	67.46	       1.56
PG	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  59.77 63.2770806	66.94	       1.74
PM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  55.88 60.5323034	65.86	       1.84
PNC	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  59.75 62.1122134	65.14	       3.13
POT	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  50.49 112.080812     189.19	      13.11
PPLT	2011-01-21 14:30:00	    3897 2011-04-01 19:55:00	 167.76 177.639489     185.21	 11.7949186
PRU	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  56.82 62.4426717	67.47	       3.25
QCOM	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	   49.9 54.3612368	59.79	       3.54
QQQ	2010-12-27 14:30:00	    5304 2011-04-01 19:55:00	  53.78 56.6271832	59.03	       1.44

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
QQQQ	2009-10-28 18:10:00	   23429 2010-12-24 20:50:00	   40.7 47.1419117	54.95		2.5
RDY	2011-01-24 14:30:00	    3588 2011-04-01 19:55:00	   32.6 34.7926438	37.74	       2.29
RIG	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  69.12 79.3628138	85.94	       5.25
RIMM	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  55.82 63.8222832     85.395	       3.93
RTN	2011-01-28 14:30:00	    3510 2011-04-01 19:55:00	  49.21 51.0168693	53.08	       1.65
SCCO	2011-01-24 14:30:00	    3822 2011-04-01 19:55:00	  38.12  42.506771	47.56	       2.84
SINA	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  72.55 87.6104813     112.09		6.9
SJM	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	 52.045 65.6358342	73.11	  15.829375
SKX	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  17.87 20.6670187	23.65	       1.48
SLB	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  79.84 88.2234916	 95.1	       4.98
SLV	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  26.08 31.3194776	37.22	       1.66
SLW	2011-01-21 14:30:00	    3900 2011-04-01 19:55:00	   28.9 38.5565783	46.34	       2.87
SNDK	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  41.11 48.3485667	53.47		3.6
SOHU	2011-01-24 14:30:00	    3822 2011-04-01 19:55:00	  64.69 82.0290744	91.79		7.8
SPY	2009-10-28 18:10:00	   24825 2011-04-01 19:55:00	 103.18  117.63652     134.66		5.1
STT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	   42.3 45.7394413	50.22		2.1
SU	2011-02-17 14:30:00	    2418 2011-04-01 19:55:00 41.3805991   44.52614 46.8599992	 2.08441843
SUN	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  38.49 42.9656578	50.69	       2.07
SVM	2011-01-21 14:30:00	    3900 2011-04-01 19:55:00	   9.41 12.6992296	15.33		1.1
SWC	2011-01-19 14:30:00	    3822 2011-04-01 19:55:00	   19.5 22.7807277	25.88	       1.99
T	2011-02-04 14:30:00	    2106 2011-04-01 19:55:00	  20.58 42.0037809 54.1909332	 21.9851547
TEVA	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  47.33 51.6769664	56.96	       3.35
TGT	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  49.04 53.0963005	60.37	       1.99
TKR	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  43.44 49.3726023	 52.8	    4.18875
TLT	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 74.605 90.5600292	94.55	 16.5532813
TSO	2011-02-17 14:30:00	    2418 2011-04-01 19:55:00	   22.4 24.9506483	27.84	       3.17
UNH	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  36.95 42.0434417	45.73	       2.23
UNP	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	 85.445 94.9355582	99.44	   7.436875
UPS	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  70.24 73.1975144	76.97	       4.15
V	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00 42.5480164 59.3758517 79.2666571	 22.9764716
VALE	2011-01-24 14:30:00	    3822 2011-04-01 19:55:00	   30.7 33.7709325	36.36		1.3
VECO	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  42.58 47.6306433	53.12	       4.28
VLO	2011-02-17 14:30:00	    2418 2011-04-01 19:55:00	  25.97 28.4382813	30.91		2.5
VMW	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  74.39  85.334927	95.94	 4.80213474
WDC	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  29.42 33.8280149	38.78	       5.73
WFMI	2011-01-04 14:30:00	    4602 2011-04-01 19:55:00	  47.85 56.3494553	66.83	       7.83
WHR	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	   79.2 84.4799153	92.05	       3.97
WMT	2009-10-28 18:10:00	   28733 2011-04-01 19:55:00	  47.76 53.2136224	57.85	       2.22
WYNN	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 109.66 121.442297     135.69	      10.17
X	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00  35.304713 55.3851707  62.868237	 15.8246652
XLB	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  36.57 38.8273487	40.72	       1.15
XLE	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	 66.775  73.822009	80.85	 10.8921094
XLU	2011-01-04 14:30:00	    4836 2011-04-01 19:55:00	  30.75 31.7853196	32.89		.67
XOM	2009-10-28 18:10:00	   28499 2011-04-01 19:55:00	  56.05 68.5726935 86.5315885	 9.62822917

164 rows selected.

Elapsed: 00:00:00.77
13:17:04 SQL> 
13:17:04 SQL> COLUMN clse FORMAT 999.9999
13:17:04 SQL> SELECT
13:17:04   2  tkr
13:17:04   3  ,ROUND(clse,4)clse
13:17:04   4  -- Should be NULL:
13:17:04   5  ,ROUND(clse2,4)clse2
13:17:04   6  ,ydate
13:17:04   7  FROM di5min_stk_c2
13:17:04   8  WHERE ydate > sysdate - 0.5/24
13:17:04   9  ORDER BY tkr,ydate
13:17:04  10  /

no rows selected

Elapsed: 00:00:00.11
13:17:04 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
