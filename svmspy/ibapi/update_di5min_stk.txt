
SQL*Plus: Release 11.2.0.1.0 Production on Wed May 4 17:18:20 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

17:18:20 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
17:18:20 SQL> 
17:18:20 SQL> 17:18:20 SQL> --
17:18:20 SQL> -- update_di5min_stk.sql
17:18:20 SQL> --
17:18:20 SQL> 
17:18:20 SQL> -- I use this script to keep di5min_stk up to date.
17:18:20 SQL> 
17:18:20 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
17:18:20 SQL> -- After that date, it holds data from IB.
17:18:20 SQL> 
17:18:20 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
17:18:20 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
17:18:20 SQL> 
17:18:20 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.53
17:18:21 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.08
17:18:21 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.08
17:18:21 SQL> 
17:18:21 SQL> 
17:18:21 SQL> -- I need to shave a second off of some of the dates:
17:18:21 SQL> 
17:18:21 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
17:18:21   2  WHERE TO_CHAR(ydate,'SS')='01'
17:18:21   3  /

0 rows updated.

Elapsed: 00:00:00.34
17:18:21 SQL> 
17:18:21 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    950855

Elapsed: 00:00:00.02
17:18:21 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    950855

Elapsed: 00:00:00.26
17:18:22 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.25
17:18:22 SQL> 
17:18:22 SQL> -- Remove data which is outside of RTH:
17:18:22 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') < '14:30'AND ydate < '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.34
17:18:22 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') > '20:55'AND ydate < '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.34
17:18:23 SQL> -- Daylight savings time started on 2011-03-14:
17:18:23 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') < '13:30'AND ydate > '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.22
17:18:23 SQL> DELETE ibs5min WHERE TO_CHAR(ydate,'HH24:MI') > '19:55'AND ydate > '2011-03-14';

0 rows deleted.

Elapsed: 00:00:00.22
17:18:23 SQL> 
17:18:23 SQL> 
17:18:23 SQL> -- Copy in data from ibs5min:
17:18:23 SQL> 
17:18:23 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
17:18:23   2  SELECT	     tkr||ydate,tkr,ydate,clse
17:18:23   3  FROM ibs5min
17:18:23   4  WHERE ydate >= '2010-12-27 09:00:00'
17:18:23   5  /

950855 rows created.

Elapsed: 00:00:01.78
17:18:25 SQL> 
17:18:25 SQL> -- rpt
17:18:25 SQL> SELECT
17:18:25   2  tkr
17:18:25   3  ,MIN(ydate)
17:18:25   4  ,COUNT(tkr)
17:18:25   5  ,MAX(ydate)
17:18:25   6  FROM di5min_stk0
17:18:25   7  GROUP BY tkr
17:18:25   8  ORDER BY tkr
17:18:25   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  6188 2011-05-04 15:35:00
ABT	2011-01-04 14:30:00	  6188 2011-05-04 15:35:00
ABX	2011-01-04 14:30:00	  6188 2011-05-04 15:35:00
ACI	2011-04-19 13:30:00	   806 2011-05-04 15:35:00
ADBE	2011-01-04 14:30:00	  6188 2011-05-04 15:35:00
AEM	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AFL	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AGU	2011-01-24 14:30:00	  5175 2011-05-04 15:40:00
AIG	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AKAM	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
ALL	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AMGN	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AMT	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AMX	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AMZN	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
APA	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
APC	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
ARG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
AXP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
AXU	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
BA	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BBT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BBY	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BEN	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BHP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BIDU	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BRCM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BTU	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BUCY	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CAT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CDE	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
CELG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CEO	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
CHK	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
CLF	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CMI	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
COF	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
COP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
COST	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CREE	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CRM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CSX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CTSH	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CVE	2011-02-14 14:30:00	  3978 2011-05-03 19:55:00
CVS	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CVX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
DD	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
DE	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
DIA	2010-12-27 14:30:00	  6658 2011-05-04 15:45:00
DIS	2010-12-27 14:30:00	  6658 2011-05-04 15:45:00
DNDN	2011-01-04 14:30:00	  6190 2011-05-04 15:45:00
DTV	2011-01-04 14:30:00	  6190 2011-05-04 15:45:00
DVN	2011-01-04 14:30:00	  6197 2011-05-04 16:20:00
EBAY	2010-12-27 14:30:00	  6457 2011-05-04 16:20:00
EFA	2011-01-04 14:30:00	  6198 2011-05-04 16:25:00
EOG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
ESRX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
EWZ	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
EXK	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
FCX	2011-02-02 14:30:00	  4602 2011-05-03 19:55:00
FDX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
FFIV	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
FLS	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
FSLR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
FXI	2011-04-06 13:30:00	  1482 2011-05-03 19:55:00
GD	2011-04-18 13:30:00	   858 2011-05-03 19:55:00
GDX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
GFI	2011-01-28 14:30:00	  4602 2011-05-03 19:55:00
GG	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
GILD	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
GLD	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
GOOG	2010-12-27 14:30:00	  6396 2011-05-03 19:55:00
GS	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
HAL	2011-04-08 13:30:00	  1326 2011-05-03 19:55:00
HD	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
HES	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
HL	2011-01-18 14:30:00	  5340 2011-05-04 16:25:00
HOC	2011-02-17 14:30:00	  3780 2011-05-04 16:25:00
HON	2011-01-04 14:30:00	  6198 2011-05-04 16:25:00
HPQ	2010-12-27 14:30:00	  6666 2011-05-04 16:25:00
IBM	2010-12-27 14:30:00	  6666 2011-05-04 16:25:00
IOC	2011-01-04 14:30:00	  6198 2011-05-04 16:25:00
IWM	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
JNJ	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
JOYG	2011-01-04 14:30:00	  5969 2011-05-04 16:50:00
JPM	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
JWN	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
KO	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
LFT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
LMT	2011-01-28 14:30:00	  4602 2011-05-03 19:55:00
LVS	2011-04-13 13:30:00	  1092 2011-05-03 19:55:00
MAR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MCD	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
MDT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MDY	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MEE	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
MET	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MJN	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
MMM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MON	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MOS	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MRK	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MRO	2011-04-19 13:30:00	   780 2011-05-03 19:55:00
MSFT	2011-04-15 13:30:00	   936 2011-05-03 19:55:00
MT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MVG	2011-01-21 14:30:00	  4991 2011-05-03 19:55:00
NEM	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
NFLX	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
NOC	2011-01-28 14:30:00	  4602 2011-05-03 19:55:00
NUE	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
OIH	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
ORCL	2011-03-01 14:30:00	  3510 2011-05-03 19:55:00
OXY	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
PAAS	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
PALL	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
PBR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
PEP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
PG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
PM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
PNC	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
POT	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
PPLT	2011-01-21 14:30:00	  5221 2011-05-03 19:55:00
PRU	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
QCOM	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
QQQ	2010-12-27 14:30:00	  6630 2011-05-03 19:55:00
RDY	2011-01-24 14:30:00	  4914 2011-05-03 19:55:00
RIG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
RIMM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
RTN	2011-01-28 14:30:00	  4836 2011-05-03 19:55:00
SBUX	2011-04-26 13:30:00	   468 2011-05-03 19:55:00
SCCO	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
SINA	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
SJM	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
SKX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SLB	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SLV	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SLW	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
SNDK	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SOHU	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
SPY	2010-12-27 14:30:00	  6630 2011-05-03 19:55:00
STT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SU	2011-04-18 13:30:00	   858 2011-05-03 19:55:00
SUN	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SVM	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
SWC	2011-01-19 14:30:00	  5148 2011-05-03 19:55:00
T	2011-04-19 13:30:00	   780 2011-05-03 19:55:00
TEVA	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
TGT	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
TKR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
TLT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
TSO	2011-02-17 14:30:00	  3744 2011-05-03 19:55:00
TXN	2011-04-11 13:30:00	  1248 2011-05-03 19:55:00
UNH	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
UNP	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
UPS	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
V	2011-04-19 13:30:00	   780 2011-05-03 19:55:00
VALE	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
VECO	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
VLO	2011-02-17 14:30:00	  3744 2011-05-03 19:55:00
VMW	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
WDC	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
WFC	2011-04-13 13:30:00	  1092 2011-05-03 19:55:00
WFMI	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
WHR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
WMT	2010-12-27 14:30:00	  6630 2011-05-03 19:55:00
WYNN	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
X	2011-04-18 13:30:00	   858 2011-05-03 19:55:00
XLB	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
XLE	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
XLU	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
XOM	2010-12-27 14:30:00	  6474 2011-05-03 19:55:00
YUM	2011-04-12 13:30:00	  1170 2011-05-03 19:55:00

173 rows selected.

Elapsed: 00:00:00.38
17:18:25 SQL> 
17:18:25 SQL> -- Next, copy in data from dukas.
17:18:25 SQL> -- dukas5min_stk depends on:
17:18:25 SQL> -- - dukas10min_stk
17:18:25 SQL> -- - svmspy/dukas/fake5.sql
17:18:25 SQL> 
17:18:25 SQL> 
17:18:25 SQL> -- I need to shave a second off of some of the dates:
17:18:25 SQL> 
17:18:25 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
17:18:25   2  WHERE TO_CHAR(ydate,'SS')='01'
17:18:25   3  /

0 rows updated.

Elapsed: 00:00:00.66
17:18:26 SQL> 
17:18:26 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
17:18:26 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.07
17:18:26 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.08
17:18:26 SQL> 
17:18:26 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
17:18:26   2  SELECT	     tkr||ydate,tkr,ydate,clse
17:18:26   3  FROM dukas5min_stk
17:18:26   4  WHERE ydate < '2010-12-27 09:00:00'
17:18:26   5  /

230382 rows created.

Elapsed: 00:00:00.42
17:18:27 SQL> 
17:18:27 SQL> -- rpt
17:18:27 SQL> SELECT
17:18:27   2  tkr
17:18:27   3  ,MIN(ydate)
17:18:27   4  ,COUNT(tkr)
17:18:27   5  ,MAX(ydate)
17:18:27   6  FROM dukas5min_stk
17:18:27   7  WHERE ydate < '2010-12-27 09:00:00'
17:18:27   8  GROUP BY tkr
17:18:27   9  ORDER BY tkr
17:18:27  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.08
17:18:27 SQL> 
17:18:27 SQL> -- rpt
17:18:27 SQL> SELECT
17:18:27   2  tkr
17:18:27   3  ,MIN(ydate)
17:18:27   4  ,COUNT(tkr)
17:18:27   5  ,MAX(ydate)
17:18:27   6  FROM di5min_stk0
17:18:27   7  GROUP BY tkr
17:18:27   8  ORDER BY tkr
17:18:27   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  6188 2011-05-04 15:35:00
ABT	2011-01-04 14:30:00	  6188 2011-05-04 15:35:00
ABX	2011-01-04 14:30:00	  6188 2011-05-04 15:35:00
ACI	2011-04-19 13:30:00	   806 2011-05-04 15:35:00
ADBE	2011-01-04 14:30:00	  6188 2011-05-04 15:35:00
AEM	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AFL	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AGU	2011-01-24 14:30:00	  5175 2011-05-04 15:40:00
AIG	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AKAM	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
ALL	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AMGN	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AMT	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AMX	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
AMZN	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
APA	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
APC	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
ARG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
AXP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
AXU	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
BA	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BBT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BBY	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BEN	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BHP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BIDU	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BRCM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BTU	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
BUCY	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CAT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CDE	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
CELG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CEO	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
CHK	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
CLF	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CMI	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
COF	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
COP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
COST	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CREE	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CRM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CSX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CTSH	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CVE	2011-02-14 14:30:00	  3978 2011-05-03 19:55:00
CVS	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
CVX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
DD	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
DE	2011-01-04 14:30:00	  6189 2011-05-04 15:40:00
DIA	2009-10-28 18:10:00	 30087 2011-05-04 15:45:00
DIS	2009-10-28 18:10:00	 30087 2011-05-04 15:45:00
DNDN	2011-01-04 14:30:00	  6190 2011-05-04 15:45:00
DTV	2011-01-04 14:30:00	  6190 2011-05-04 15:45:00
DVN	2011-01-04 14:30:00	  6197 2011-05-04 16:20:00
EBAY	2009-10-28 18:10:00	 29886 2011-05-04 16:20:00
EFA	2011-01-04 14:30:00	  6198 2011-05-04 16:25:00
EOG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
ESRX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
EWZ	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
EXK	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
FCX	2011-02-02 14:30:00	  4602 2011-05-03 19:55:00
FDX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
FFIV	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
FLS	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
FSLR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
FXI	2011-04-06 13:30:00	  1482 2011-05-03 19:55:00
GD	2011-04-18 13:30:00	   858 2011-05-03 19:55:00
GDX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
GFI	2011-01-28 14:30:00	  4602 2011-05-03 19:55:00
GG	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
GILD	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
GLD	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
GOOG	2009-10-28 18:10:00	 29825 2011-05-03 19:55:00
GS	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
HAL	2011-04-08 13:30:00	  1326 2011-05-03 19:55:00
HD	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
HES	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
HL	2011-01-18 14:30:00	  5340 2011-05-04 16:25:00
HOC	2011-02-17 14:30:00	  3780 2011-05-04 16:25:00
HON	2011-01-04 14:30:00	  6198 2011-05-04 16:25:00
HPQ	2009-10-28 18:10:00	 30095 2011-05-04 16:25:00
IBM	2009-10-28 18:10:00	 30095 2011-05-04 16:25:00
IOC	2011-01-04 14:30:00	  6198 2011-05-04 16:25:00
IWM	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
JNJ	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
JOYG	2011-01-04 14:30:00	  5969 2011-05-04 16:50:00
JPM	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
JWN	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
KO	2011-01-04 14:30:00	  6203 2011-05-04 16:50:00
LFT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
LMT	2011-01-28 14:30:00	  4602 2011-05-03 19:55:00
LVS	2011-04-13 13:30:00	  1092 2011-05-03 19:55:00
MAR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MCD	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
MDT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MDY	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MEE	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
MET	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MJN	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
MMM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MON	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MOS	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MRK	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MRO	2011-04-19 13:30:00	   780 2011-05-03 19:55:00
MSFT	2011-04-15 13:30:00	   936 2011-05-03 19:55:00
MT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
MVG	2011-01-21 14:30:00	  4991 2011-05-03 19:55:00
NEM	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
NFLX	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
NOC	2011-01-28 14:30:00	  4602 2011-05-03 19:55:00
NUE	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
OIH	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
ORCL	2011-03-01 14:30:00	  3510 2011-05-03 19:55:00
OXY	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
PAAS	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
PALL	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
PBR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
PEP	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
PG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
PM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
PNC	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
POT	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
PPLT	2011-01-21 14:30:00	  5221 2011-05-03 19:55:00
PRU	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
QCOM	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
QQQ	2010-12-27 14:30:00	  6630 2011-05-03 19:55:00
QQQQ	2009-10-28 18:10:00	 23429 2010-12-24 20:50:00
RDY	2011-01-24 14:30:00	  4914 2011-05-03 19:55:00
RIG	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
RIMM	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
RTN	2011-01-28 14:30:00	  4836 2011-05-03 19:55:00
SBUX	2011-04-26 13:30:00	   468 2011-05-03 19:55:00
SCCO	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
SINA	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
SJM	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
SKX	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SLB	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SLV	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SLW	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
SNDK	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SOHU	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
SPY	2009-10-28 18:10:00	 26151 2011-05-03 19:55:00
STT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SU	2011-04-18 13:30:00	   858 2011-05-03 19:55:00
SUN	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
SVM	2011-01-21 14:30:00	  5226 2011-05-03 19:55:00
SWC	2011-01-19 14:30:00	  5148 2011-05-03 19:55:00
T	2011-04-19 13:30:00	   780 2011-05-03 19:55:00
TEVA	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
TGT	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
TKR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
TLT	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
TSO	2011-02-17 14:30:00	  3744 2011-05-03 19:55:00
TXN	2011-04-11 13:30:00	  1248 2011-05-03 19:55:00
UNH	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
UNP	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
UPS	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
V	2011-04-19 13:30:00	   780 2011-05-03 19:55:00
VALE	2011-01-24 14:30:00	  5148 2011-05-03 19:55:00
VECO	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
VLO	2011-02-17 14:30:00	  3744 2011-05-03 19:55:00
VMW	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
WDC	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
WFC	2011-04-13 13:30:00	  1092 2011-05-03 19:55:00
WFMI	2011-01-04 14:30:00	  5928 2011-05-03 19:55:00
WHR	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
WMT	2009-10-28 18:10:00	 30059 2011-05-03 19:55:00
WYNN	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
X	2011-04-18 13:30:00	   858 2011-05-03 19:55:00
XLB	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
XLE	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
XLU	2011-01-04 14:30:00	  6162 2011-05-03 19:55:00
XOM	2009-10-28 18:10:00	 29903 2011-05-03 19:55:00
YUM	2011-04-12 13:30:00	  1170 2011-05-03 19:55:00

174 rows selected.

Elapsed: 00:00:00.46
17:18:27 SQL> 
17:18:27 SQL> CREATE TABLE di5min_stk COMPRESS AS
17:18:27   2  SELECT
17:18:27   3  tkrdate
17:18:27   4  ,tkr
17:18:27   5  ,ydate
17:18:27   6  ,AVG(clse)clse
17:18:27   7  FROM di5min_stk0
17:18:27   8  -- I want weekdays:
17:18:27   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
17:18:27  10  GROUP BY
17:18:27  11  tkrdate
17:18:27  12  ,tkr
17:18:27  13  ,ydate
17:18:27  14  /

Table created.

Elapsed: 00:00:06.79
17:18:34 SQL> 
17:18:34 SQL> -- rpt
17:18:34 SQL> SELECT
17:18:34   2  TO_CHAR(ydate,'dy')
17:18:34   3  ,COUNT(ydate)
17:18:34   4  FROM di5min_stk
17:18:34   5  GROUP BY TO_CHAR(ydate,'dy')
17:18:34   6  /

TO_ COUNT(YDATE)
--- ------------
fri	  227239
mon	  228852
tue	  248830
thu	  239334
wed	  236982

Elapsed: 00:00:00.78
17:18:35 SQL> 
17:18:35 SQL> -- I need to shave a second off of some of the dates:
17:18:35 SQL> --
17:18:35 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
17:18:35 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
17:18:35 SQL> -- /
17:18:35 SQL> --
17:18:35 SQL> -- SELECT COUNT(*)FROM di5min_stk;
17:18:35 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
17:18:35 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
17:18:35 SQL> --
17:18:35 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
17:18:35 SQL> 
17:18:35 SQL> -- Add a column to help join with future dates
17:18:35 SQL> -- and then calculate 1 day gain:
17:18:35 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:00.61
17:18:35 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
17:18:35   2  SELECT
17:18:35   3  tkrdate
17:18:35   4  ,tkr
17:18:35   5  ,ydate
17:18:35   6  ,clse
17:18:35   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
17:18:35   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
17:18:35   9  	    ELSE NULL END selldate
17:18:35  10  FROM di5min_stk
17:18:35  11  /

Table created.

Elapsed: 00:00:02.89
17:18:38 SQL> 
17:18:38 SQL> -- Join with the future
17:18:38 SQL> 
17:18:38 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.04
17:18:38 SQL> 
17:18:38 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
17:18:38   2  SELECT
17:18:38   3  p.tkrdate
17:18:38   4  ,p.tkr
17:18:38   5  ,p.ydate
17:18:38   6  ,p.clse
17:18:38   7  ,p.selldate
17:18:38   8  ,f.clse clse2
17:18:38   9  ,f.clse - p.clse gain1day
17:18:38  10  FROM di5min_stk_fd p, di5min_stk f
17:18:38  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
17:18:38  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
17:18:38  13  /

Table created.

Elapsed: 00:00:07.24
17:18:45 SQL> 
17:18:45 SQL> -- rpt
17:18:45 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	227239
mon	228852
tue	248830
thu	239334
wed	236982

Elapsed: 00:00:00.74
17:18:46 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	227239
mon	228852
tue	248830
thu	239334
wed	236982

Elapsed: 00:00:01.27
17:18:47 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-05-04 16:50:00

Elapsed: 00:00:00.09
17:18:48 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-05-04 16:50:00

Elapsed: 00:00:00.15
17:18:48 SQL> 
17:18:48 SQL> -- rpt
17:18:48 SQL> SELECT
17:18:48   2  tkr
17:18:48   3  ,MIN(ydate)
17:18:48   4  ,COUNT(ydate)
17:18:48   5  ,MAX(ydate)
17:18:48   6  ,MIN(clse)
17:18:48   7  ,AVG(clse)
17:18:48   8  ,MAX(clse)
17:18:48   9  ,MAX(gain1day)
17:18:48  10  FROM di5min_stk_c2
17:18:48  11  GROUP BY tkr
17:18:48  12  ORDER BY tkr
17:18:48  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    6188 2011-05-04 15:35:00	 320.68  344.73223     364.83	      13.64
ABT	2011-01-04 14:30:00	    6188 2011-05-04 15:35:00	  45.09 48.4040619	52.97	       2.16
ABX	2011-01-04 14:30:00	    6188 2011-05-04 15:35:00	  45.64 50.4187836	55.71	       3.42
ACI	2011-04-19 13:30:00	     806 2011-05-04 15:35:00	  31.62 33.5681641	34.73	       1.26
ADBE	2011-01-04 14:30:00	    6188 2011-05-04 15:35:00	  30.82   33.55553	35.84	       1.64
AEM	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  62.79 68.6690861	76.47	       4.22
AFL	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  48.59 55.4238254	59.48	       4.07
AGU	2011-01-24 14:30:00	    5175 2011-05-04 15:40:00	  82.33 91.3684346	99.13	       4.71
AIG	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  30.79 39.9224249	62.47		4.8
AKAM	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  32.66 41.5304722	52.47	       2.56
ALL	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  30.47 31.6048936	34.35	       2.28
AMGN	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  51.39 54.6484646	58.15	       2.53
AMT	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  45.98 51.5457367	56.73	       2.44
AMX	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  52.82 57.0235939	59.58	       1.74
AMZN	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	 160.93 179.152723	203.2	      15.21
APA	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  110.8 123.055989     134.08	       5.98
APC	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	   73.1 78.8563712	 85.5	       4.12
ARG	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  60.86 64.5201669	69.82	       2.46
AXP	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  42.31 45.3380037	50.05	       1.92
AXU	2011-01-21 14:30:00	    5226 2011-05-03 19:55:00	   5.88 8.40547405	10.25	       1.07
BA	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  66.51 72.1230435	80.29	       3.47
BBT	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	   25.4 27.2831677	29.55		1.3
BBY	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  28.16 32.2810001	36.18	       1.66
BEN	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	 109.71 122.191529     130.71	       5.04
BHP	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  83.94  93.727274     104.43	       3.59
BIDU	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  99.53 125.984071     154.87	      11.14
BP	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  42.55 46.4346084	49.38	       1.83
BRCM	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  34.19 41.5763302	47.32	       2.42
BTU	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	   57.7 65.6021151	73.67	       5.41
BUCY	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  89.67 90.9536326 92.0759375		.24
CAT	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  92.37 103.054128     115.83	       4.11
CDE	2011-01-21 14:30:00	    5226 2011-05-03 19:55:00	  22.13 30.4498252	37.46		3.7
CELG	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  48.96 55.1835402	61.27	       2.45
CEO	2011-01-24 14:30:00	    5148 2011-05-03 19:55:00	 206.99 237.604058     271.74	      12.17
CHK	2011-01-24 14:30:00	    5148 2011-05-03 19:55:00	  27.24 32.3138293	35.83	       2.53
CLF	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  79.77 91.7067994     102.14	       8.31
CMI	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  94.36 107.841777     121.12	       9.16
COF	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  43.23 50.2193976	 55.6		3.5
COP	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  66.58 74.9407032	 81.7	       3.43
COST	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  69.56 73.9551789	81.48		3.6
CREE	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  38.57 50.2055821	69.19	       2.89
CRM	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	 117.84  133.54637     146.42	      12.14
CSX	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  64.81 73.8202267	80.23	       3.28
CTSH	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  70.72 77.1287317	83.36	       3.64
CVE	2011-02-14 14:30:00	    3978 2011-05-03 19:55:00	  34.32 37.8805659	40.72	 1.75985901
CVS	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  32.29 34.4898259	36.81	       1.17
CVX	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  90.21 100.856667     109.94	       2.98
DD	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  47.28 53.0683725	56.98	       1.91
DE	2011-01-04 14:30:00	    6189 2011-05-04 15:40:00	  81.82 92.0520951	 99.8	       3.93
DIA	2009-10-28 18:10:00	   30087 2011-05-04 15:45:00	  96.34 109.312551	128.5	       4.35
DIS	2009-10-28 18:10:00	   30087 2011-05-04 15:45:00	  27.06 35.2419016	44.29	       3.13
DNDN	2011-01-04 14:30:00	    6190 2011-05-04 15:45:00	  31.34 36.2492185	 43.8	       3.89
DTV	2011-01-04 14:30:00	    6190 2011-05-04 15:45:00	  40.79 44.8206141	 49.2	       1.78
DVN	2011-01-04 14:30:00	    6197 2011-05-04 16:20:00	  77.06 87.4334408	93.42	       4.67
EBAY	2009-10-28 18:10:00	   29886 2011-05-04 16:20:00	  19.17 25.8184544	 35.3	       2.69
EFA	2011-01-04 14:30:00	    6198 2011-05-04 16:25:00	   54.7 60.2335613	64.34	       2.16
EOG	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  91.02 107.356176     120.99	       6.61
ESRX	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  51.25 55.9548715	58.74	       3.09
EWZ	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  70.16 75.4581352	80.07	       2.02
EXK	2011-01-21 14:30:00	    5226 2011-05-03 19:55:00	    5.4 9.01302401	12.73	       1.56
FCX	2011-02-02 14:30:00	    4602 2011-05-03 19:55:00	  46.43  53.648802	58.66	       4.94
FDX	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  85.04 92.5158668	98.45		3.9
FFIV	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  91.18  111.47691     145.75	      14.45
FLS	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  112.9 125.421714     135.62	       5.86
FSLR	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	 130.64 148.298547	  174	      12.54
FXI	2011-04-06 13:30:00	    1482 2011-05-03 19:55:00	  44.24 45.5166172	 46.4	       1.18
GD	2011-04-18 13:30:00	     858 2011-05-03 19:55:00	   70.5 72.4035606	74.41	       2.26
GDX	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  52.52 58.3858485	64.14	       3.62
GFI	2011-01-28 14:30:00	    4602 2011-05-03 19:55:00	  15.67 17.2227147	18.69		.79
GG	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  39.13 47.3891853	56.08	       4.45
GILD	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  36.51 39.8213332	42.91	       1.83
GLD	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	 127.83 138.100005     153.46	       3.24
GOOG	2009-10-28 18:10:00	   29825 2011-05-03 19:55:00	  434.6 552.395364     641.65	      63.83
GS	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	 149.75 162.085211	  175	       6.13
HAL	2011-04-08 13:30:00	    1326 2011-05-03 19:55:00	  44.64 48.4411893	51.24	       2.17
HD	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  34.09 36.8887431	38.49	       1.42
HES	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  76.16 81.7407951	87.09		4.5
HL	2011-01-18 14:30:00	    5340 2011-05-04 16:25:00	   7.84 9.26492388	11.08		.85
HOC	2011-02-17 14:30:00	    3780 2011-05-04 16:25:00	  50.79 58.4608499	66.41	       4.61
HON	2011-01-04 14:30:00	    6198 2011-05-04 16:25:00	  53.03 57.1367268	62.27	       2.29
HPQ	2009-10-28 18:10:00	   30095 2011-05-04 16:25:00	  37.45 46.1589416	 54.7		3.4
IBM	2009-10-28 18:10:00	   30095 2011-05-04 16:25:00	 119.59 137.364935     173.45	       6.28
IOC	2011-01-04 14:30:00	    6198 2011-05-04 16:25:00	  56.25 71.4701336	81.72	       4.58
IWM	2011-01-04 14:30:00	    6203 2011-05-04 16:50:00	  77.04 81.4738174	 86.7	       2.49
JNJ	2011-01-04 14:30:00	    6203 2011-05-04 16:50:00	   57.5 61.1081898	66.45	       2.51
JOYG	2011-01-04 14:30:00	    5969 2011-05-04 16:50:00	  83.82 93.3126266     103.31	       6.04
JPM	2011-01-04 14:30:00	    6203 2011-05-04 16:50:00	  42.77 45.4979432	48.27		2.5
JWN	2011-01-04 14:30:00	    6203 2011-05-04 16:50:00	  40.03 44.2132073	48.69	       2.39
KO	2011-01-04 14:30:00	    6203 2011-05-04 16:50:00	  61.35 64.7981772	68.45	       2.22
LFT	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  17.31 31.0312023	   37	       4.03
LMT	2011-01-28 14:30:00	    4602 2011-05-03 19:55:00	  75.84 80.0259309	82.41	       2.23
LVS	2011-04-13 13:30:00	    1092 2011-05-03 19:55:00	  42.92  45.687522	48.22		2.6
MAR	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  33.65 38.1032771	42.58	       1.63
MCD	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  72.15 75.4855711	79.03	       2.68
MDT	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  36.18 39.0015235	 42.5	       1.36
MDY	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	 163.62 174.181177     184.92		4.5
MEE	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  52.03 62.5455411	 71.1	       9.93
MET	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  41.29 45.5863194	48.71	       2.17
MJN	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  55.29 59.8776872	 67.4	       3.43
MMM	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  85.68 91.1675962	97.94	       2.82
MON	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	   65.2 70.7365025	76.13	       4.04
MOS	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  70.78 79.3335397	89.17	       4.26
MRK	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  31.07 33.6958317	 37.6	 1.48993034
MRO	2011-04-19 13:30:00	     780 2011-05-03 19:55:00	  50.37 52.6761811	54.26	       2.53
MSFT	2011-04-15 13:30:00	     936 2011-05-03 19:55:00	  24.76 25.6758736	26.84	       1.03
MT	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  32.43 36.2049748	38.41	       2.13
MVG	2011-01-21 14:30:00	    4991 2011-05-03 19:55:00	   9.25 11.7526494	14.75		2.9
NEM	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  50.07 55.8951236 60.3845017	       2.83
NFLX	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  176.3 215.916561     253.46	      29.02
NOC	2011-01-28 14:30:00	    4602 2011-05-03 19:55:00	  59.93  65.809818	 72.4	       2.25
NUE	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  42.81 46.0804613	49.23	       2.14
OIH	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	 135.78 155.222439     167.15	       8.52
ORCL	2011-03-01 14:30:00	    3510 2011-05-03 19:55:00	  29.63 33.1606875	36.46	       2.05
OXY	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  93.76 100.099631     117.67	      11.03
PAAS	2011-01-21 14:30:00	    5226 2011-05-03 19:55:00	  31.13 36.3960705	42.95	       3.49
PALL	2011-01-21 14:30:00	    5226 2011-05-03 19:55:00	  68.75 77.8478036	85.33	       3.41
PBR	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  35.03 38.2996396	42.57	       1.67
PEP	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  62.07 65.2622462	69.87	       2.03
PG	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  59.77 63.2773927	66.94	       1.75
PM	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  55.88 62.1437054	 69.8	       1.94

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
PNC	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  59.75  62.229097	65.14	       3.13
POT	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  50.49 99.8331697     189.19	      13.11
PPLT	2011-01-21 14:30:00	    5221 2011-05-03 19:55:00	 167.76 178.639459     186.62	 11.7949186
PRU	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  56.82 62.2360032	67.47	       3.25
QCOM	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	   49.9 54.2761011	59.79	       3.54
QQQ	2010-12-27 14:30:00	    6630 2011-05-03 19:55:00	  53.78 56.8459679	59.31	       1.69
QQQQ	2009-10-28 18:10:00	   23429 2010-12-24 20:50:00	   40.7 47.1419117	54.95		2.5
RDY	2011-01-24 14:30:00	    4914 2011-05-03 19:55:00	  32.68 35.8687424	39.37	       2.29
RIG	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  68.48 78.3862438	85.94	       5.25
RIMM	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  47.71 60.3075926	70.47	       3.93
RTN	2011-01-28 14:30:00	    4836 2011-05-03 19:55:00	  47.74 50.4950031	53.08	       1.65
SBUX	2011-04-26 13:30:00	     468 2011-05-03 19:55:00	  35.85 36.6211966	37.37		.66
SCCO	2011-01-24 14:30:00	    5148 2011-05-03 19:55:00	  35.05 40.9472953	47.56	       2.84
SINA	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  72.55 98.5780804     146.39	      22.73
SJM	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  61.18 68.5918046	75.44	       3.08
SKX	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  17.87 20.5118283	23.65	       1.48
SLB	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  79.84 88.1520334	 95.1	       4.98
SLV	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  26.08 34.1146899	48.26	       4.21
SLW	2011-01-21 14:30:00	    5226 2011-05-03 19:55:00	   28.9 39.7068051	47.58	       3.06
SNDK	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  41.11  48.179387	53.47		3.6
SOHU	2011-01-24 14:30:00	    5148 2011-05-03 19:55:00	  64.69 87.2990342	108.8	       9.31
SPY	2009-10-28 18:10:00	   26151 2011-05-03 19:55:00	 103.18 118.455774     137.15		5.1
STT	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	   42.3   45.87669	50.22		2.1
SU	2011-04-18 13:30:00	     858 2011-05-03 19:55:00	  41.95 44.5811859	46.96	       2.07
SUN	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  38.49 42.6980381	46.93	       2.07
SVM	2011-01-21 14:30:00	    5226 2011-05-03 19:55:00	   9.41 13.1945086	16.32	       1.21
SWC	2011-01-19 14:30:00	    5148 2011-05-03 19:55:00	   19.5 22.4894895	25.88	       1.88
T	2011-04-19 13:30:00	     780 2011-05-03 19:55:00	  29.92 30.9509936	31.91		 .8
TEVA	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  44.87 50.8330523	56.96	       3.35
TGT	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  48.54 52.3162882	60.37	       1.67
TKR	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  44.57 50.4100632	 57.6	       4.83
TLT	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  88.19 91.5699327	94.55	       2.07
TSO	2011-02-17 14:30:00	    3744 2011-05-03 19:55:00	   22.4 25.8261078	28.66	       3.17
TXN	2011-04-11 13:30:00	    1248 2011-05-03 19:55:00	  33.93   35.02842	35.97		 .8
UNH	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  36.95 43.1162769	50.14	       3.99
UNP	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  91.04  96.273218     104.09	       3.77
UPS	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  70.24   73.27835	76.97	       4.15
V	2011-04-19 13:30:00	     780 2011-05-03 19:55:00	  75.17 78.0603045	79.98	       2.47
VALE	2011-01-24 14:30:00	    5148 2011-05-03 19:55:00	   30.7 33.5744681	36.36		1.3
VECO	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  42.58 47.9696326	53.12	       4.28
VLO	2011-02-17 14:30:00	    3744 2011-05-03 19:55:00	  25.97 28.4399657	31.05		2.5
VMW	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  74.39 86.2164864	99.02	      12.71
WDC	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  29.42 35.3273608	41.77	       5.73
WFC	2011-04-13 13:30:00	    1092 2011-05-03 19:55:00	  28.28 29.3710612	31.43		.72
WFMI	2011-01-04 14:30:00	    5928 2011-05-03 19:55:00	  47.85 58.3592265	66.83	       7.83
WHR	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	   79.2 84.9134945	92.05	       3.97
WMT	2009-10-28 18:10:00	   30059 2011-05-03 19:55:00	  47.76 53.2439106	57.85	       2.22
WYNN	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	 109.66 126.353327     151.42	      11.22
X	2011-04-18 13:30:00	     858 2011-05-03 19:55:00	  46.71 49.7310278	53.31	       3.07
XLB	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  36.57 39.1539858	41.17	       1.18
XLE	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  67.54 75.3464205	80.87	       2.54
XLU	2011-01-04 14:30:00	    6162 2011-05-03 19:55:00	  30.75 31.9102244	33.61		 .7
XOM	2009-10-28 18:10:00	   29903 2011-05-03 19:55:00	  56.05  69.418508	87.98	       3.66
YUM	2011-04-12 13:30:00	    1170 2011-05-03 19:55:00	  49.67 51.8935186	54.65	       3.21

174 rows selected.

Elapsed: 00:00:00.96
17:18:49 SQL> 
17:18:49 SQL> COLUMN clse FORMAT 999.9999
17:18:49 SQL> SELECT
17:18:49   2  tkr
17:18:49   3  ,ROUND(clse,4)clse
17:18:49   4  -- Should be NULL:
17:18:49   5  ,ROUND(clse2,4)clse2
17:18:49   6  ,ydate
17:18:49   7  FROM di5min_stk_c2
17:18:49   8  WHERE ydate > sysdate - 0.5/24
17:18:49   9  ORDER BY tkr,ydate
17:18:49  10  /

TKR	     CLSE      CLSE2 YDATE
------- --------- ---------- -------------------
IWM	  82.8500	     2011-05-04 16:50:00
JNJ	  65.5900	     2011-05-04 16:50:00
JOYG	  93.3300	     2011-05-04 16:50:00
JPM	  45.5300	     2011-05-04 16:50:00
JWN	  47.7500	     2011-05-04 16:50:00
KO	  67.3100	     2011-05-04 16:50:00

6 rows selected.

Elapsed: 00:00:00.19
17:18:49 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
