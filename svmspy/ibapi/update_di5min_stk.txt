
SQL*Plus: Release 11.2.0.1.0 Production on Thu Jan 27 20:09:35 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

20:09:35 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.01
20:09:35 SQL> 
20:09:35 SQL> 20:09:35 SQL> --
20:09:35 SQL> -- update_di5min_stk.sql
20:09:35 SQL> --
20:09:35 SQL> 
20:09:35 SQL> -- I use this script to keep di5min_stk up to date.
20:09:35 SQL> 
20:09:35 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
20:09:35 SQL> -- After that date, it holds data from IB.
20:09:35 SQL> 
20:09:35 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
20:09:35 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
20:09:35 SQL> 
20:09:35 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.28
20:09:35 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.04
20:09:36 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.59
20:09:36 SQL> 
20:09:36 SQL> 
20:09:36 SQL> -- I need to shave a second off of some of the dates:
20:09:36 SQL> 
20:09:36 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
20:09:36   2  WHERE TO_CHAR(ydate,'SS')='01'
20:09:36   3  /

0 rows updated.

Elapsed: 00:00:00.07
20:09:36 SQL> 
20:09:36 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    182224

Elapsed: 00:00:00.00
20:09:36 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    182224

Elapsed: 00:00:00.05
20:09:36 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.05
20:09:36 SQL> 
20:09:36 SQL> -- Copy in data from ibs5min:
20:09:36 SQL> 
20:09:36 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
20:09:36   2  SELECT	     tkr||ydate,tkr,ydate,clse
20:09:36   3  FROM ibs5min
20:09:36   4  WHERE ydate >= '2010-12-27 09:00:00'
20:09:36   5  /

182224 rows created.

Elapsed: 00:00:00.41
20:09:37 SQL> 
20:09:37 SQL> -- rpt
20:09:37 SQL> SELECT
20:09:37   2  tkr
20:09:37   3  ,MIN(ydate)
20:09:37   4  ,COUNT(tkr)
20:09:37   5  ,MAX(ydate)
20:09:37   6  FROM di5min_stk0
20:09:37   7  GROUP BY tkr
20:09:37   8  ORDER BY tkr
20:09:37   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
ABT	2011-01-04 14:30:00	  1261 2011-01-27 15:30:00
ABX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
ADBE	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AEM	2011-01-04 14:30:00	  1267 2011-01-27 16:00:00
AFL	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AIG	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AKAM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
ALL	2011-01-04 14:30:00	  1258 2011-01-27 15:15:00
AMGN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AMT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AMX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AMZN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
APA	2011-01-04 14:30:00	  1241 2011-01-26 20:20:00
APC	2011-01-04 14:30:00	  1232 2011-01-26 19:35:00
ARG	2011-01-04 14:30:00	  1279 2011-01-27 17:00:00
AXP	2011-01-04 14:30:00	  1245 2011-01-26 20:40:00
BA	2011-01-04 14:30:00	  1231 2011-01-26 19:30:00
BBT	2011-01-04 14:30:00	  1236 2011-01-26 19:55:00
BBY	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
BEN	2011-01-04 14:30:00	  1313 2011-01-27 19:50:00
BHP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
BIDU	2011-01-04 14:30:00	  1237 2011-01-26 20:00:00
BP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
BRCM	2011-01-04 14:30:00	  1313 2011-01-27 19:50:00
BTU	2011-01-04 14:30:00	  1241 2011-01-26 20:20:00
BUCY	2011-01-04 14:30:00	  1233 2011-01-26 19:40:00
CAT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CELG	2011-01-04 14:30:00	  1245 2011-01-26 20:40:00
CLF	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CMI	2011-01-04 14:30:00	  1236 2011-01-26 19:55:00
COF	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
COP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
COST	2011-01-04 14:30:00	  1235 2011-01-26 19:50:00
CREE	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CRM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CSX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CTSH	2011-01-04 14:30:00	  1315 2011-01-27 20:00:00
CVS	2011-01-04 14:30:00	  1310 2011-01-27 19:35:00
CVX	2011-01-04 14:30:00	  1264 2011-01-27 15:45:00
DD	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
DE	2011-01-04 14:30:00	  1239 2011-01-26 20:10:00
DIA	2010-12-27 09:00:00	  2822 2011-01-26 20:50:00
DIS	2010-12-27 09:00:00	  2615 2011-01-27 17:45:00
DNDN	2011-01-04 14:30:00	  1233 2011-01-26 19:40:00
DTV	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
DVN	2011-01-04 14:30:00	  1285 2011-01-27 17:30:00
EBAY	2010-12-27 09:00:00	  2047 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
EOG	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
ESRX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
EWZ	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
FCX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
FDX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
FFIV	2011-01-04 14:30:00	  1273 2011-01-27 16:30:00
FLS	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
FSLR	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
GDX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
GG	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
GILD	2011-01-04 14:30:00	  1254 2011-01-27 14:55:00
GLD	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
GOOG	2010-12-27 09:00:00	  2839 2011-01-26 20:25:00
GS	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
HD	2011-01-04 14:30:00	  1243 2011-01-26 20:30:00
HES	2011-01-04 14:30:00	  1238 2011-01-26 20:05:00
HON	2011-01-04 14:30:00	  1282 2011-01-27 17:15:00
HPQ	2010-12-27 09:00:00	  2732 2011-01-26 20:15:00
IBM	2010-12-27 09:00:00	  2715 2011-01-26 20:55:00
IOC	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
IWM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
JNJ	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
JOYG	2011-01-04 14:30:00	  1244 2011-01-26 20:35:00
JPM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
JWN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
KO	2011-01-04 14:30:00	  1251 2011-01-27 14:40:00
LFT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MAR	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MCD	2011-01-04 14:30:00	  1246 2011-01-26 20:45:00
MDT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MDY	2011-01-04 14:30:00	  1238 2011-01-26 20:05:00
MEE	2011-01-04 14:30:00	  1237 2011-01-26 20:00:00
MET	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MJN	2011-01-04 14:30:00	  1042 2011-01-24 16:45:00
MMM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MON	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MOS	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MRK	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
NEM	2011-01-04 14:30:00	  1229 2011-01-26 19:20:00
NFLX	2011-01-04 14:30:00	  1307 2011-01-27 19:20:00
NUE	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
OIH	2011-01-04 14:30:00	  1270 2011-01-27 16:15:00
OXY	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
PBR	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
PEP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
PG	2011-01-04 14:30:00	  1314 2011-01-27 19:55:00
PM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
PNC	2011-01-04 14:30:00	  1230 2011-01-26 19:25:00
POT	2011-01-04 14:30:00	  1242 2011-01-26 20:25:00
PRU	2011-01-04 14:30:00	  1303 2011-01-27 19:00:00
QCOM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
QQQQ	2010-12-27 09:00:00	  2931 2011-01-26 20:55:00
RIG	2011-01-04 14:30:00	  1300 2011-01-27 18:45:00
RIMM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SINA	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SJM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SKX	2011-01-04 14:30:00	  1232 2011-01-26 19:35:00
SLB	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SLV	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SNDK	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SPY	2010-12-27 09:00:00	  3082 2011-01-26 20:55:00
STT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SUN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SWC	2011-01-19 14:30:00	   468 2011-01-26 20:55:00
TEVA	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
TGT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
TKR	2011-01-04 14:30:00	  1229 2011-01-26 19:20:00
TLT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
UNH	2011-01-04 14:30:00	  1313 2011-01-27 19:50:00
UNP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
UPS	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
V	2011-01-04 14:30:00	  1297 2011-01-27 18:30:00
VECO	2011-01-04 14:30:00	  1293 2011-01-27 18:10:00
VMW	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
WDC	2011-01-04 14:30:00	  1247 2011-01-26 20:50:00
WFMI	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
WHR	2011-01-04 14:30:00	  1244 2011-01-26 20:35:00
WMT	2010-12-27 09:00:00	  2683 2011-01-26 19:45:00
WYNN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
X	2011-01-04 12:40:00	  1758 2011-01-26 20:55:00
XLB	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
XLE	2011-01-04 14:30:00	  1276 2011-01-27 16:45:00
XLU	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
XOM	2010-12-27 09:00:00	  2853 2011-01-26 19:25:00

134 rows selected.

Elapsed: 00:00:00.14
20:09:37 SQL> 
20:09:37 SQL> -- Next, copy in data from dukas.
20:09:37 SQL> -- dukas5min_stk depends on:
20:09:37 SQL> -- - dukas10min_stk
20:09:37 SQL> -- - svmspy/dukas/fake5.sql
20:09:37 SQL> 
20:09:37 SQL> 
20:09:37 SQL> -- I need to shave a second off of some of the dates:
20:09:37 SQL> 
20:09:37 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
20:09:37   2  WHERE TO_CHAR(ydate,'SS')='01'
20:09:37   3  /

0 rows updated.

Elapsed: 00:00:00.33
20:09:37 SQL> 
20:09:37 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.02
20:09:37 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.16
20:09:37 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.11
20:09:37 SQL> 
20:09:37 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
20:09:37   2  SELECT	     tkr||ydate,tkr,ydate,clse
20:09:37   3  FROM dukas5min_stk
20:09:37   4  WHERE ydate < '2010-12-27 09:00:00'
20:09:37   5  /

230382 rows created.

Elapsed: 00:00:00.54
20:09:38 SQL> 
20:09:38 SQL> -- rpt
20:09:38 SQL> SELECT
20:09:38   2  tkr
20:09:38   3  ,MIN(ydate)
20:09:38   4  ,COUNT(tkr)
20:09:38   5  ,MAX(ydate)
20:09:38   6  FROM dukas5min_stk
20:09:38   7  WHERE ydate < '2010-12-27 09:00:00'
20:09:38   8  GROUP BY tkr
20:09:38   9  ORDER BY tkr
20:09:38  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.09
20:09:38 SQL> 
20:09:38 SQL> -- rpt
20:09:38 SQL> SELECT
20:09:38   2  tkr
20:09:38   3  ,MIN(ydate)
20:09:38   4  ,COUNT(tkr)
20:09:38   5  ,MAX(ydate)
20:09:38   6  FROM di5min_stk0
20:09:38   7  GROUP BY tkr
20:09:38   8  ORDER BY tkr
20:09:38   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
ABT	2011-01-04 14:30:00	  1261 2011-01-27 15:30:00
ABX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
ADBE	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AEM	2011-01-04 14:30:00	  1267 2011-01-27 16:00:00
AFL	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AIG	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AKAM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
ALL	2011-01-04 14:30:00	  1258 2011-01-27 15:15:00
AMGN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AMT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AMX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
AMZN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
APA	2011-01-04 14:30:00	  1241 2011-01-26 20:20:00
APC	2011-01-04 14:30:00	  1232 2011-01-26 19:35:00
ARG	2011-01-04 14:30:00	  1279 2011-01-27 17:00:00
AXP	2011-01-04 14:30:00	  1245 2011-01-26 20:40:00
BA	2011-01-04 14:30:00	  1231 2011-01-26 19:30:00
BBT	2011-01-04 14:30:00	  1236 2011-01-26 19:55:00
BBY	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
BEN	2011-01-04 14:30:00	  1313 2011-01-27 19:50:00
BHP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
BIDU	2011-01-04 14:30:00	  1237 2011-01-26 20:00:00
BP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
BRCM	2011-01-04 14:30:00	  1313 2011-01-27 19:50:00
BTU	2011-01-04 14:30:00	  1241 2011-01-26 20:20:00
BUCY	2011-01-04 14:30:00	  1233 2011-01-26 19:40:00
CAT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CELG	2011-01-04 14:30:00	  1245 2011-01-26 20:40:00
CLF	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CMI	2011-01-04 14:30:00	  1236 2011-01-26 19:55:00
COF	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
COP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
COST	2011-01-04 14:30:00	  1235 2011-01-26 19:50:00
CREE	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CRM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CSX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
CTSH	2011-01-04 14:30:00	  1315 2011-01-27 20:00:00
CVS	2011-01-04 14:30:00	  1310 2011-01-27 19:35:00
CVX	2011-01-04 14:30:00	  1264 2011-01-27 15:45:00
DD	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
DE	2011-01-04 14:30:00	  1239 2011-01-26 20:10:00
DIA	2009-10-28 18:10:00	 26251 2011-01-26 20:50:00
DIS	2009-10-28 18:10:00	 26044 2011-01-27 17:45:00
DNDN	2011-01-04 14:30:00	  1233 2011-01-26 19:40:00
DTV	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
DVN	2011-01-04 14:30:00	  1285 2011-01-27 17:30:00
EBAY	2009-10-28 18:10:00	 25476 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
EOG	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
ESRX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
EWZ	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
FCX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
FDX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
FFIV	2011-01-04 14:30:00	  1273 2011-01-27 16:30:00
FLS	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
FSLR	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
GDX	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
GG	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
GILD	2011-01-04 14:30:00	  1254 2011-01-27 14:55:00
GLD	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
GOOG	2009-10-28 18:10:00	 26268 2011-01-26 20:25:00
GS	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
HD	2011-01-04 14:30:00	  1243 2011-01-26 20:30:00
HES	2011-01-04 14:30:00	  1238 2011-01-26 20:05:00
HON	2011-01-04 14:30:00	  1282 2011-01-27 17:15:00
HPQ	2009-10-28 18:10:00	 26161 2011-01-26 20:15:00
IBM	2009-10-28 18:10:00	 26144 2011-01-26 20:55:00
IOC	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
IWM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
JNJ	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
JOYG	2011-01-04 14:30:00	  1244 2011-01-26 20:35:00
JPM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
JWN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
KO	2011-01-04 14:30:00	  1251 2011-01-27 14:40:00
LFT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MAR	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MCD	2011-01-04 14:30:00	  1246 2011-01-26 20:45:00
MDT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MDY	2011-01-04 14:30:00	  1238 2011-01-26 20:05:00
MEE	2011-01-04 14:30:00	  1237 2011-01-26 20:00:00
MET	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MJN	2011-01-04 14:30:00	  1042 2011-01-24 16:45:00
MMM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MON	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MOS	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MRK	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
MT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
NEM	2011-01-04 14:30:00	  1229 2011-01-26 19:20:00
NFLX	2011-01-04 14:30:00	  1307 2011-01-27 19:20:00
NUE	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
OIH	2011-01-04 14:30:00	  1270 2011-01-27 16:15:00
OXY	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
PBR	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
PEP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
PG	2011-01-04 14:30:00	  1314 2011-01-27 19:55:00
PM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
PNC	2011-01-04 14:30:00	  1230 2011-01-26 19:25:00
POT	2011-01-04 14:30:00	  1242 2011-01-26 20:25:00
PRU	2011-01-04 14:30:00	  1303 2011-01-27 19:00:00
QCOM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
QQQQ	2009-10-28 18:10:00	 26360 2011-01-26 20:55:00
RIG	2011-01-04 14:30:00	  1300 2011-01-27 18:45:00
RIMM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SINA	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SJM	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SKX	2011-01-04 14:30:00	  1232 2011-01-26 19:35:00
SLB	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SLV	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SNDK	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SPY	2009-10-28 18:10:00	 22603 2011-01-26 20:55:00
STT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SUN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
SWC	2011-01-19 14:30:00	   468 2011-01-26 20:55:00
TEVA	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
TGT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
TKR	2011-01-04 14:30:00	  1229 2011-01-26 19:20:00
TLT	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
UNH	2011-01-04 14:30:00	  1313 2011-01-27 19:50:00
UNP	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
UPS	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
V	2011-01-04 14:30:00	  1297 2011-01-27 18:30:00
VECO	2011-01-04 14:30:00	  1293 2011-01-27 18:10:00
VMW	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
WDC	2011-01-04 14:30:00	  1247 2011-01-26 20:50:00
WFMI	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
WHR	2011-01-04 14:30:00	  1244 2011-01-26 20:35:00
WMT	2009-10-28 18:10:00	 26112 2011-01-26 19:45:00
WYNN	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
X	2011-01-04 12:40:00	  1758 2011-01-26 20:55:00
XLB	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
XLE	2011-01-04 14:30:00	  1276 2011-01-27 16:45:00
XLU	2011-01-04 14:30:00	  1248 2011-01-26 20:55:00
XOM	2009-10-28 18:10:00	 26282 2011-01-26 19:25:00

134 rows selected.

Elapsed: 00:00:00.16
20:09:38 SQL> 
20:09:38 SQL> CREATE TABLE di5min_stk COMPRESS AS
20:09:38   2  SELECT
20:09:38   3  tkrdate
20:09:38   4  ,tkr
20:09:38   5  ,ydate
20:09:38   6  ,AVG(clse)clse
20:09:38   7  FROM di5min_stk0
20:09:38   8  -- I want weekdays:
20:09:38   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
20:09:38  10  GROUP BY
20:09:38  11  tkrdate
20:09:38  12  ,tkr
20:09:38  13  ,ydate
20:09:38  14  /

Table created.

Elapsed: 00:00:01.63
20:09:40 SQL> 
20:09:40 SQL> -- rpt
20:09:40 SQL> SELECT
20:09:40   2  TO_CHAR(ydate,'dy')
20:09:40   3  ,COUNT(ydate)
20:09:40   4  FROM di5min_stk
20:09:40   5  GROUP BY TO_CHAR(ydate,'dy')
20:09:40   6  /

TO_ COUNT(YDATE)
--- ------------
fri	   80567
tue	   90307
wed	   89649
thu	   81579
mon	   70324

Elapsed: 00:00:00.27
20:09:40 SQL> 
20:09:40 SQL> -- I need to shave a second off of some of the dates:
20:09:40 SQL> --
20:09:40 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
20:09:40 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
20:09:40 SQL> -- /
20:09:40 SQL> --
20:09:40 SQL> -- SELECT COUNT(*)FROM di5min_stk;
20:09:40 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
20:09:40 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
20:09:40 SQL> --
20:09:40 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
20:09:40 SQL> 
20:09:40 SQL> -- Add a column to help join with future dates
20:09:40 SQL> -- and then calculate 1 day gain:
20:09:40 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:00.05
20:09:40 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
20:09:40   2  SELECT
20:09:40   3  tkrdate
20:09:40   4  ,tkr
20:09:40   5  ,ydate
20:09:40   6  ,clse
20:09:40   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
20:09:40   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
20:09:40   9  	    ELSE NULL END selldate
20:09:40  10  FROM di5min_stk
20:09:40  11  /

Table created.

Elapsed: 00:00:01.05
20:09:41 SQL> 
20:09:41 SQL> -- Join with the future
20:09:41 SQL> 
20:09:41 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.03
20:09:41 SQL> 
20:09:41 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
20:09:41   2  SELECT
20:09:41   3  p.tkrdate
20:09:41   4  ,p.tkr
20:09:41   5  ,p.ydate
20:09:41   6  ,p.clse
20:09:41   7  ,p.selldate
20:09:41   8  ,f.clse clse2
20:09:41   9  ,f.clse - p.clse gain1day
20:09:41  10  FROM di5min_stk_fd p, di5min_stk f
20:09:41  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
20:09:41  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
20:09:41  13  /

Table created.

Elapsed: 00:00:01.80
20:09:43 SQL> 
20:09:43 SQL> -- rpt
20:09:43 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 80567
mon	 70324
tue	 90307
wed	 89649
thu	 81579

Elapsed: 00:00:00.25
20:09:43 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 80567
tue	 90307
wed	 89649
thu	 81579
mon	 70324

Elapsed: 00:00:00.28
20:09:44 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-01-27 20:00:00

Elapsed: 00:00:00.04
20:09:44 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-01-27 20:00:00

Elapsed: 00:00:00.03
20:09:44 SQL> 
20:09:44 SQL> -- rpt
20:09:44 SQL> SELECT
20:09:44   2  tkr
20:09:44   3  ,MIN(ydate)
20:09:44   4  ,COUNT(ydate)
20:09:44   5  ,MAX(ydate)
20:09:44   6  ,MIN(clse)
20:09:44   7  ,AVG(clse)
20:09:44   8  ,MAX(clse)
20:09:44   9  ,MAX(gain1day)
20:09:44  10  FROM di5min_stk_c2
20:09:44  11  GROUP BY tkr
20:09:44  12  ORDER BY tkr
20:09:44  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	 326.72 338.249327     348.46	      13.64
ABT	2011-01-04 14:30:00	    1261 2011-01-27 15:30:00	  46.35 47.7527974	48.76		.91
ABX	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  45.64 48.3266526	52.33	       1.82
ADBE	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	   31.3 33.0378646	34.27	       1.15
AEM	2011-01-04 14:30:00	    1267 2011-01-27 16:00:00	  66.92 70.1644416	72.79	       2.95
AFL	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  54.89 57.0567648	58.76	       1.84
AIG	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  40.93 52.8395453	62.47		4.8
AKAM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  46.85 49.2835036	52.47	       2.39
ALL	2011-01-04 14:30:00	    1258 2011-01-27 15:15:00	  30.47 31.2790401	32.18		.83
AMGN	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  55.99 56.8475861	58.15	       1.03
AMT	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  48.78  50.655026	 52.2	       1.73
AMX	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	   57.5 58.4740425	59.58	       1.19
AMZN	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	 174.41 183.538251     191.55	       3.43
APA	2011-01-04 14:30:00	    1241 2011-01-26 20:20:00	  119.6 123.959867     127.55	       4.04
APC	2011-01-04 14:30:00	    1232 2011-01-26 19:35:00	   73.1 76.4544481	79.78	       3.94
ARG	2011-01-04 14:30:00	    1279 2011-01-27 17:00:00	  61.95 63.3749883	63.97		.61
AXP	2011-01-04 14:30:00	    1245 2011-01-26 20:40:00	  43.29 45.0840281	 46.7	       1.52
BA	2011-01-04 14:30:00	    1231 2011-01-26 19:30:00	  66.51  70.080853	72.79		2.6
BBT	2011-01-04 14:30:00	    1236 2011-01-26 19:55:00	     26 27.1930461	28.41		1.3
BBY	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  34.65 35.3316747	36.18	       1.29
BEN	2011-01-04 14:30:00	    1313 2011-01-27 19:50:00	 109.71 116.755802	123.7	       5.04
BHP	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  87.11  89.686262	 92.7	       2.75
BIDU	2011-01-04 14:30:00	    1237 2011-01-26 20:00:00	  99.53 105.663141     108.96	       5.05
BP	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	   45.2  47.208149	49.38	       1.83
BRCM	2011-01-04 14:30:00	    1313 2011-01-27 19:50:00	  42.11 45.3844059	47.32	       2.09
BTU	2011-01-04 14:30:00	    1241 2011-01-26 20:20:00	   57.7 61.5587349	65.57	       3.97
BUCY	2011-01-04 14:30:00	    1233 2011-01-26 19:40:00	  89.67 90.2118978	90.92		.24
CAT	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  92.37 94.1650942	96.67		2.6
CELG	2011-01-04 14:30:00	    1245 2011-01-26 20:40:00	  55.64  57.481008	59.69	       1.56
CLF	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  79.77 84.9517348	91.04	       7.09
CMI	2011-01-04 14:30:00	    1236 2011-01-26 19:55:00	 102.64 110.459426     114.74		4.8
COF	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  43.23 46.8232532	49.64		2.8
COP	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  66.58 67.6538482	69.72	       2.69
COST	2011-01-04 14:30:00	    1235 2011-01-26 19:50:00	  70.07 71.7857206	72.94	       1.04
CREE	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  50.91 61.3230148	69.19	       2.11
CRM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	 122.31 137.778896     146.42	       8.23
CSX	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  64.81 68.0146454	71.43	       2.88
CTSH	2011-01-04 14:30:00	    1315 2011-01-27 20:00:00	  72.61 74.5347224	76.42	       2.16
CVS	2011-01-04 14:30:00	    1310 2011-01-27 19:35:00	  34.24 35.1419866	35.94	       1.17
CVX	2011-01-04 14:30:00	    1264 2011-01-27 15:45:00	  90.21 92.4344165	94.93	       1.84
DD	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  47.28 49.3051983	50.58	       1.84
DE	2011-01-04 14:30:00	    1239 2011-01-26 20:10:00	  81.82 87.4986037	91.58	       2.84
DIA	2009-10-28 18:10:00	   26239 2011-01-26 20:50:00	  96.34 107.174733     119.89	       4.35
DIS	2009-10-28 18:10:00	   26032 2011-01-27 17:45:00	  27.06 34.0245396	   40		2.1
DNDN	2011-01-04 14:30:00	    1233 2011-01-26 19:40:00	  34.93 36.3255191	38.85	       2.92
DTV	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  40.79  41.984389	   43		  1
DVN	2011-01-04 14:30:00	    1285 2011-01-27 17:30:00	  77.06 81.4305156	 86.3	       2.75
EBAY	2009-10-28 18:10:00	   25464 2011-01-14 20:55:00	  19.17  24.648826	31.48	       2.55
EFA	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  56.77 58.7708694	60.22	       1.37
EOG	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  91.02 97.8265705     103.13	       3.53
ESRX	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  55.52  57.279974	58.74	       1.35
EWZ	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  74.61 76.6778926	78.95	       1.94
FCX	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	 104.87 115.319355     122.49	       5.38
FDX	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  92.12 94.0576863	96.98		2.4
FFIV	2011-01-04 14:30:00	    1273 2011-01-27 16:30:00	 103.08 129.673967     145.75	       5.69
FLS	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  112.9 117.253167     121.36	       4.87
FSLR	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	 130.64 141.910012     158.49	      10.78
GDX	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  52.52 55.9810697	60.06	       2.31
GG	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  39.13  41.976851	44.84	       1.68
GILD	2011-01-04 14:30:00	    1254 2011-01-27 14:55:00	  36.51 37.9061583	39.75	       1.75
GLD	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	 129.17 133.033319     136.18	       1.14
GOOG	2009-10-28 18:10:00	   26244 2011-01-26 20:25:00	  434.6 549.794952     641.65	      63.83
GS	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	 160.21 169.495799	  175	       3.74
HD	2011-01-04 14:30:00	    1243 2011-01-26 20:30:00	  34.09 35.5563274	37.95	       1.18
HES	2011-01-04 14:30:00	    1238 2011-01-26 20:05:00	  76.16 79.3671041	 82.6	       3.75
HON	2011-01-04 14:30:00	    1282 2011-01-27 17:15:00	  53.03 54.5790971	56.05	       1.54
HPQ	2009-10-28 18:10:00	   26149 2011-01-26 20:15:00	  37.45 46.6287703	 54.7		3.4
IBM	2009-10-28 18:10:00	   26132 2011-01-26 20:55:00	 119.59 132.781689     161.78	       5.73
IOC	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  66.18 73.9422837	77.99	       3.57
IWM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  77.04 78.8703446	80.62	       1.96
JNJ	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  60.63 62.4329948	63.49		.89
JOYG	2011-01-04 14:30:00	    1244 2011-01-26 20:35:00	  83.82 88.0937379	93.42	       4.55
JPM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  42.77 44.5045272	45.91		1.4
JWN	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  40.87 41.9664263	43.69	       1.14
KO	2011-01-04 14:30:00	    1251 2011-01-27 14:40:00	  62.57  63.179966	65.04	       1.01
LFT	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	     30 33.8952123	   37	       1.43
MAR	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  39.43 40.7515925	42.01		.92
MCD	2011-01-04 14:30:00	    1246 2011-01-26 20:45:00	  72.15 74.5338724	75.74	       1.64
MDT	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  36.18 37.2076783	38.93	       1.36
MDY	2011-01-04 14:30:00	    1238 2011-01-26 20:05:00	 163.62 166.984847     170.37		3.4
MEE	2011-01-04 14:30:00	    1237 2011-01-26 20:00:00	  52.03 55.3177445	58.46	       2.64
MET	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  44.78 46.0529207	46.95	       1.38
MJN	2011-01-04 14:30:00	    1042 2011-01-24 16:45:00	  60.37   61.93119	63.29	       1.16
MMM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  85.68 87.8703546	90.43	       2.08
MON	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  68.27 71.8357572	75.24	       4.04
MOS	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  71.87  77.477492	85.45	       4.26
MRK	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  33.21 35.2200361	 37.6		.72
MT	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  34.22 36.3072817	 38.3	       2.13
NEM	2011-01-04 14:30:00	    1229 2011-01-26 19:20:00	  54.42 56.7834296	60.22	       1.22
NFLX	2011-01-04 14:30:00	    1307 2011-01-27 19:20:00	  176.3 185.873081	210.8	      28.14
NUE	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  42.81 44.4809856	46.63	       2.14
OIH	2011-01-04 14:30:00	    1270 2011-01-27 16:15:00	 135.78  142.19047     151.42	       8.52
OXY	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  94.06 96.7689263	 98.9	       2.52
PBR	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  35.78 36.7860397	38.46	       1.58
PEP	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  65.18 66.2829868	67.46	       1.56
PG	2011-01-04 14:30:00	    1314 2011-01-27 19:55:00	  63.38 65.2206906	66.94	       1.12
PM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  55.88 56.9141847	58.93		.66
PNC	2011-01-04 14:30:00	    1230 2011-01-26 19:25:00	  59.87 61.6082886	64.25	       3.13
POT	2011-01-04 14:30:00	    1242 2011-01-26 20:25:00	 153.56 165.651083     174.19	       7.96
PRU	2011-01-04 14:30:00	    1303 2011-01-27 19:00:00	  59.41  61.099152	63.06	       1.77
QCOM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	   49.9 51.7848057	53.06		2.3
QQQQ	2009-10-28 18:10:00	   26348 2011-01-26 20:55:00	   40.7 48.0727556	57.22		2.5
RIG	2011-01-04 14:30:00	    1300 2011-01-27 18:45:00	  69.12 76.6432192	82.97	       5.25
RIMM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  58.31 62.3624499	66.33		  3
SINA	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  72.55 80.7102284	89.97	       6.68
SJM	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  62.17 63.3516987	64.64	       1.07
SKX	2011-01-04 14:30:00	    1232 2011-01-26 19:35:00	   19.3 20.8791802	21.97	       1.07
SLB	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  79.84 83.5871374	87.73	       4.98
SLV	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  26.08 27.8707692	29.59		.66
SNDK	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  48.09 51.3769231	53.47		2.7
SPY	2009-10-28 18:10:00	   22579 2011-01-26 20:55:00	 103.18 116.002859     129.98		5.1
STT	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  45.94  47.669355	50.22		2.1
SUN	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  38.49 40.5392348	42.79	       1.55
SWC	2011-01-19 14:30:00	     468 2011-01-26 20:55:00	  20.51 21.6677457	 23.4	       1.14
TEVA	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  52.03 53.7942929	56.96	       3.35
TGT	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	   53.9 55.8637159	60.37	       1.67
TKR	2011-01-04 14:30:00	    1229 2011-01-26 19:20:00	  48.64 50.3009235	52.42	       2.09
TLT	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  90.43 91.8981951	93.74	       1.77
UNH	2011-01-04 14:30:00	    1313 2011-01-27 19:50:00	  36.95 39.4850114	42.33	       2.11
UNP	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	     92 95.5951583	99.44	       3.77

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
UPS	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  71.37 72.5097175	73.29		.96
V	2011-01-04 14:30:00	    1297 2011-01-27 18:30:00	 57.445 70.3240306     79.272	      5.215
VECO	2011-01-04 14:30:00	    1293 2011-01-27 18:10:00	  42.99 46.2776914	49.65	       2.41
VMW	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  82.45  90.025398	95.94	 4.25666905
WDC	2011-01-04 14:30:00	    1247 2011-01-26 20:50:00	  31.39  32.787923	34.22	       1.86
WFMI	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  47.85 50.8603826	53.35	       2.66
WHR	2011-01-04 14:30:00	    1244 2011-01-26 20:35:00	  85.27  87.922295	90.71	       3.56
WMT	2009-10-28 18:10:00	   26088 2011-01-26 19:45:00	  47.76 53.1978188	57.72	       2.22
WYNN	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	 109.66 116.433916     120.95	       6.66
X	2011-01-04 12:40:00	    1746 2011-01-26 20:55:00 43.2666667 60.0960915	75.74	  4.1019204
XLB	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  37.25 38.3388782     39.085	       1.15
XLE	2011-01-04 14:30:00	    1276 2011-01-27 16:45:00	  67.54 69.5001058	   72		2.2
XLU	2011-01-04 14:30:00	    1248 2011-01-26 20:55:00	  31.23 31.6959756	32.19		.33
XOM	2009-10-28 18:10:00	   26258 2011-01-26 19:25:00	  56.05 66.9980709	79.29	       2.55

134 rows selected.

Elapsed: 00:00:00.32
20:09:44 SQL> 
20:09:44 SQL> COLUMN clse FORMAT 999.9999
20:09:44 SQL> SELECT
20:09:44   2  tkr
20:09:44   3  ,ROUND(clse,4)clse
20:09:44   4  -- Should be NULL:
20:09:44   5  ,ROUND(clse2,4)clse2
20:09:44   6  ,ydate
20:09:44   7  FROM di5min_stk_c2
20:09:44   8  WHERE ydate > sysdate - 0.5/24
20:09:44   9  ORDER BY tkr,ydate
20:09:44  10  /

TKR	     CLSE      CLSE2 YDATE
------- --------- ---------- -------------------
BEN	 122.0100	     2011-01-27 19:40:00
BEN	 122.1800	     2011-01-27 19:45:00
BEN	 122.0800	     2011-01-27 19:50:00
BRCM	  46.4500	     2011-01-27 19:40:00
BRCM	  46.4300	     2011-01-27 19:45:00
BRCM	  46.3900	     2011-01-27 19:50:00
CTSH	  73.2300	     2011-01-27 19:40:00
CTSH	  73.2900	     2011-01-27 19:45:00
CTSH	  73.2500	     2011-01-27 19:50:00
CTSH	  73.2700	     2011-01-27 19:55:00
CTSH	  73.2400	     2011-01-27 20:00:00
PG	  63.6300	     2011-01-27 19:40:00
PG	  63.5700	     2011-01-27 19:45:00
PG	  63.7300	     2011-01-27 19:50:00
PG	  63.7400	     2011-01-27 19:55:00
UNH	  42.2900	     2011-01-27 19:40:00
UNH	  42.3000	     2011-01-27 19:45:00
UNH	  42.3300	     2011-01-27 19:50:00

18 rows selected.

Elapsed: 00:00:00.04
20:09:44 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
