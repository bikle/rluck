
SQL*Plus: Release 11.2.0.1.0 Production on Wed Jan 26 16:12:18 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

16:12:18 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
16:12:18 SQL> 
16:12:18 SQL> 16:12:18 SQL> --
16:12:18 SQL> -- update_di5min_stk.sql
16:12:18 SQL> --
16:12:18 SQL> 
16:12:18 SQL> -- I use this script to keep di5min_stk up to date.
16:12:18 SQL> 
16:12:18 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
16:12:18 SQL> -- After that date, it holds data from IB.
16:12:18 SQL> 
16:12:18 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
16:12:18 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
16:12:18 SQL> 
16:12:18 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:01.18
16:12:19 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.22
16:12:20 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.27
16:12:20 SQL> 
16:12:20 SQL> 
16:12:20 SQL> -- I need to shave a second off of some of the dates:
16:12:20 SQL> 
16:12:20 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
16:12:20   2  WHERE TO_CHAR(ydate,'SS')='01'
16:12:20   3  /

0 rows updated.

Elapsed: 00:00:00.05
16:12:20 SQL> 
16:12:20 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    152895

Elapsed: 00:00:00.00
16:12:20 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    152895

Elapsed: 00:00:00.05
16:12:20 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.04
16:12:20 SQL> 
16:12:20 SQL> -- Copy in data from ibs5min:
16:12:20 SQL> 
16:12:20 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
16:12:20   2  SELECT	     tkr||ydate,tkr,ydate,clse
16:12:20   3  FROM ibs5min
16:12:20   4  WHERE ydate >= '2010-12-27 09:00:00'
16:12:20   5  /

152895 rows created.

Elapsed: 00:00:00.44
16:12:20 SQL> 
16:12:20 SQL> -- rpt
16:12:20 SQL> SELECT
16:12:20   2  tkr
16:12:20   3  ,MIN(ydate)
16:12:20   4  ,COUNT(tkr)
16:12:20   5  ,MAX(ydate)
16:12:20   6  FROM di5min_stk0
16:12:20   7  GROUP BY tkr
16:12:20   8  ORDER BY tkr
16:12:20   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ABT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ABX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ADBE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AEM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AFL	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AIG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AKAM	2011-01-04 14:30:00	  1075 2011-01-24 19:30:00
ALL	2011-01-04 14:30:00	  1067 2011-01-24 18:50:00
AMGN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AMT	2011-01-04 14:30:00	  1055 2011-01-24 17:50:00
AMX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AMZN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
APA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
APC	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ARG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AXP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BBT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BBY	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BEN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BHP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BIDU	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BRCM	2011-01-04 14:30:00	  1062 2011-01-24 18:25:00
BTU	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BUCY	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CAT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CELG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CLF	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CMI	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
COF	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
COP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
COST	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CREE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CRM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CSX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CTSH	2011-01-04 14:30:00	  1187 2011-01-26 15:50:00
CVS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CVX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DD	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DIA	2010-12-27 09:00:00	  2632 2011-01-24 18:00:00
DIS	2010-12-27 09:00:00	  2341 2011-01-21 20:55:00
DNDN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DTV	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DVN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
EBAY	2010-12-27 09:00:00	  2047 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
EOG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ESRX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
EWZ	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FCX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FDX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FFIV	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FLS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FSLR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
GDX	2011-01-04 14:30:00	  1054 2011-01-24 17:45:00
GG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
GILD	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
GLD	2011-01-04 14:30:00	  1063 2011-01-24 18:30:00
GOOG	2010-12-27 09:00:00	  2679 2011-01-24 20:05:00
GS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
HD	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
HES	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
HON	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
HPQ	2010-12-27 09:00:00	  2506 2011-01-21 20:55:00
IBM	2010-12-27 09:00:00	  2554 2011-01-24 20:30:00
IOC	2011-01-04 14:30:00	  1050 2011-01-24 17:25:00
IWM	2011-01-04 14:30:00	  1190 2011-01-26 16:05:00
JNJ	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
JOYG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
JPM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
JWN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
KO	2011-01-04 14:30:00	  1071 2011-01-24 19:10:00
LFT	2011-01-04 14:30:00	  1042 2011-01-24 16:45:00
MAR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MCD	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MDT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MDY	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MEE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MET	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MJN	2011-01-04 14:30:00	  1042 2011-01-24 16:45:00
MMM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MON	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MOS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MRK	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
NEM	2011-01-04 14:30:00	  1053 2011-01-24 17:40:00
NFLX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
NUE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
OIH	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
OXY	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
PBR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
PEP	2011-01-04 14:30:00	  1186 2011-01-26 15:45:00
PG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
PM	2011-01-04 14:30:00	  1049 2011-01-24 17:20:00
PNC	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
POT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
PRU	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
QCOM	2011-01-04 14:30:00	  1077 2011-01-24 19:40:00
QQQQ	2010-12-27 09:00:00	  2730 2011-01-24 17:10:00
RIG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
RIMM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SINA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SJM	2011-01-04 14:30:00	  1051 2011-01-24 17:30:00
SKX	2011-01-04 14:30:00	  1060 2011-01-24 18:15:00
SLB	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SLV	2011-01-04 14:30:00	  1074 2011-01-24 19:25:00
SNDK	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SPY	2010-12-27 09:00:00	  2848 2011-01-21 20:55:00
STT	2011-01-04 14:30:00	  1188 2011-01-26 15:55:00
SUN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SWC	2011-01-19 14:30:00	   407 2011-01-26 15:50:00
TEVA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
TGT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
TKR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
TLT	2011-01-04 14:30:00	  1046 2011-01-24 17:05:00
UNH	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
UNP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
UPS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
V	2011-01-04 14:30:00	  1043 2011-01-24 16:50:00
VECO	2011-01-04 14:30:00	  1065 2011-01-24 18:40:00
VMW	2011-01-04 14:30:00	  1045 2011-01-24 17:00:00
WDC	2011-01-04 14:30:00	  1069 2011-01-24 19:00:00
WFMI	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
WHR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
WMT	2010-12-27 09:00:00	  2463 2011-01-21 20:55:00
WYNN	2011-01-04 14:30:00	  1189 2011-01-26 16:00:00
X	2011-01-04 12:40:00	  1524 2011-01-21 20:55:00
XLB	2011-01-04 14:30:00	  1044 2011-01-24 16:55:00
XLE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
XLU	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
XOM	2010-12-27 09:00:00	  2637 2011-01-21 20:55:00

134 rows selected.

Elapsed: 00:00:00.07
16:12:20 SQL> 
16:12:20 SQL> -- Next, copy in data from dukas.
16:12:20 SQL> -- dukas5min_stk depends on:
16:12:20 SQL> -- - dukas10min_stk
16:12:20 SQL> -- - svmspy/dukas/fake5.sql
16:12:20 SQL> 
16:12:20 SQL> 
16:12:20 SQL> -- I need to shave a second off of some of the dates:
16:12:20 SQL> 
16:12:20 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
16:12:20   2  WHERE TO_CHAR(ydate,'SS')='01'
16:12:20   3  /

0 rows updated.

Elapsed: 00:00:00.08
16:12:21 SQL> 
16:12:21 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
16:12:21 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.07
16:12:21 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.07
16:12:21 SQL> 
16:12:21 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
16:12:21   2  SELECT	     tkr||ydate,tkr,ydate,clse
16:12:21   3  FROM dukas5min_stk
16:12:21   4  WHERE ydate < '2010-12-27 09:00:00'
16:12:21   5  /

230382 rows created.

Elapsed: 00:00:00.51
16:12:21 SQL> 
16:12:21 SQL> -- rpt
16:12:21 SQL> SELECT
16:12:21   2  tkr
16:12:21   3  ,MIN(ydate)
16:12:21   4  ,COUNT(tkr)
16:12:21   5  ,MAX(ydate)
16:12:21   6  FROM dukas5min_stk
16:12:21   7  WHERE ydate < '2010-12-27 09:00:00'
16:12:21   8  GROUP BY tkr
16:12:21   9  ORDER BY tkr
16:12:21  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.09
16:12:21 SQL> 
16:12:21 SQL> -- rpt
16:12:21 SQL> SELECT
16:12:21   2  tkr
16:12:21   3  ,MIN(ydate)
16:12:21   4  ,COUNT(tkr)
16:12:21   5  ,MAX(ydate)
16:12:21   6  FROM di5min_stk0
16:12:21   7  GROUP BY tkr
16:12:21   8  ORDER BY tkr
16:12:21   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ABT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ABX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ADBE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AEM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AFL	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AIG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AKAM	2011-01-04 14:30:00	  1075 2011-01-24 19:30:00
ALL	2011-01-04 14:30:00	  1067 2011-01-24 18:50:00
AMGN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AMT	2011-01-04 14:30:00	  1055 2011-01-24 17:50:00
AMX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AMZN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
APA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
APC	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ARG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
AXP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BBT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BBY	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BEN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BHP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BIDU	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BRCM	2011-01-04 14:30:00	  1062 2011-01-24 18:25:00
BTU	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
BUCY	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CAT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CELG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CLF	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CMI	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
COF	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
COP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
COST	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CREE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CRM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CSX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CTSH	2011-01-04 14:30:00	  1187 2011-01-26 15:50:00
CVS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
CVX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DD	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DIA	2009-10-28 18:10:00	 26061 2011-01-24 18:00:00
DIS	2009-10-28 18:10:00	 25770 2011-01-21 20:55:00
DNDN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DTV	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
DVN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
EBAY	2009-10-28 18:10:00	 25476 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
EOG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
ESRX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
EWZ	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FCX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FDX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FFIV	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FLS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
FSLR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
GDX	2011-01-04 14:30:00	  1054 2011-01-24 17:45:00
GG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
GILD	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
GLD	2011-01-04 14:30:00	  1063 2011-01-24 18:30:00
GOOG	2009-10-28 18:10:00	 26108 2011-01-24 20:05:00
GS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
HD	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
HES	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
HON	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
HPQ	2009-10-28 18:10:00	 25935 2011-01-21 20:55:00
IBM	2009-10-28 18:10:00	 25983 2011-01-24 20:30:00
IOC	2011-01-04 14:30:00	  1050 2011-01-24 17:25:00
IWM	2011-01-04 14:30:00	  1190 2011-01-26 16:05:00
JNJ	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
JOYG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
JPM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
JWN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
KO	2011-01-04 14:30:00	  1071 2011-01-24 19:10:00
LFT	2011-01-04 14:30:00	  1042 2011-01-24 16:45:00
MAR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MCD	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MDT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MDY	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MEE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MET	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MJN	2011-01-04 14:30:00	  1042 2011-01-24 16:45:00
MMM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MON	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MOS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MRK	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
MT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
NEM	2011-01-04 14:30:00	  1053 2011-01-24 17:40:00
NFLX	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
NUE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
OIH	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
OXY	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
PBR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
PEP	2011-01-04 14:30:00	  1186 2011-01-26 15:45:00
PG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
PM	2011-01-04 14:30:00	  1049 2011-01-24 17:20:00
PNC	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
POT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
PRU	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
QCOM	2011-01-04 14:30:00	  1077 2011-01-24 19:40:00
QQQQ	2009-10-28 18:10:00	 26159 2011-01-24 17:10:00
RIG	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
RIMM	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SINA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SJM	2011-01-04 14:30:00	  1051 2011-01-24 17:30:00
SKX	2011-01-04 14:30:00	  1060 2011-01-24 18:15:00
SLB	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SLV	2011-01-04 14:30:00	  1074 2011-01-24 19:25:00
SNDK	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SPY	2009-10-28 18:10:00	 22369 2011-01-21 20:55:00
STT	2011-01-04 14:30:00	  1188 2011-01-26 15:55:00
SUN	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
SWC	2011-01-19 14:30:00	   407 2011-01-26 15:50:00
TEVA	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
TGT	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
TKR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
TLT	2011-01-04 14:30:00	  1046 2011-01-24 17:05:00
UNH	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
UNP	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
UPS	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
V	2011-01-04 14:30:00	  1043 2011-01-24 16:50:00
VECO	2011-01-04 14:30:00	  1065 2011-01-24 18:40:00
VMW	2011-01-04 14:30:00	  1045 2011-01-24 17:00:00
WDC	2011-01-04 14:30:00	  1069 2011-01-24 19:00:00
WFMI	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
WHR	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
WMT	2009-10-28 18:10:00	 25892 2011-01-21 20:55:00
WYNN	2011-01-04 14:30:00	  1189 2011-01-26 16:00:00
X	2011-01-04 12:40:00	  1524 2011-01-21 20:55:00
XLB	2011-01-04 14:30:00	  1044 2011-01-24 16:55:00
XLE	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
XLU	2011-01-04 14:30:00	  1014 2011-01-21 20:55:00
XOM	2009-10-28 18:10:00	 26066 2011-01-21 20:55:00

134 rows selected.

Elapsed: 00:00:00.15
16:12:21 SQL> 
16:12:21 SQL> CREATE TABLE di5min_stk COMPRESS AS
16:12:21   2  SELECT
16:12:21   3  tkrdate
16:12:21   4  ,tkr
16:12:21   5  ,ydate
16:12:21   6  ,AVG(clse)clse
16:12:21   7  FROM di5min_stk0
16:12:21   8  -- I want weekdays:
16:12:21   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
16:12:21  10  GROUP BY
16:12:21  11  tkrdate
16:12:21  12  ,tkr
16:12:21  13  ,ydate
16:12:21  14  /

Table created.

Elapsed: 00:00:01.59
16:12:23 SQL> 
16:12:23 SQL> -- rpt
16:12:23 SQL> SELECT
16:12:23   2  TO_CHAR(ydate,'dy')
16:12:23   3  ,COUNT(ydate)
16:12:23   4  FROM di5min_stk
16:12:23   5  GROUP BY TO_CHAR(ydate,'dy')
16:12:23   6  /

TO_ COUNT(YDATE)
--- ------------
fri	   80567
tue	   80479
wed	   79772
thu	   80645
mon	   61634

Elapsed: 00:00:00.33
16:12:23 SQL> 
16:12:23 SQL> -- I need to shave a second off of some of the dates:
16:12:23 SQL> --
16:12:23 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
16:12:23 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
16:12:23 SQL> -- /
16:12:23 SQL> --
16:12:23 SQL> -- SELECT COUNT(*)FROM di5min_stk;
16:12:23 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
16:12:23 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
16:12:23 SQL> --
16:12:23 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
16:12:23 SQL> 
16:12:23 SQL> -- Add a column to help join with future dates
16:12:23 SQL> -- and then calculate 1 day gain:
16:12:23 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:00.29
16:12:24 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
16:12:24   2  SELECT
16:12:24   3  tkrdate
16:12:24   4  ,tkr
16:12:24   5  ,ydate
16:12:24   6  ,clse
16:12:24   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
16:12:24   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
16:12:24   9  	    ELSE NULL END selldate
16:12:24  10  FROM di5min_stk
16:12:24  11  /

Table created.

Elapsed: 00:00:01.06
16:12:25 SQL> 
16:12:25 SQL> -- Join with the future
16:12:25 SQL> 
16:12:25 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.33
16:12:25 SQL> 
16:12:25 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
16:12:25   2  SELECT
16:12:25   3  p.tkrdate
16:12:25   4  ,p.tkr
16:12:25   5  ,p.ydate
16:12:25   6  ,p.clse
16:12:25   7  ,p.selldate
16:12:25   8  ,f.clse clse2
16:12:25   9  ,f.clse - p.clse gain1day
16:12:25  10  FROM di5min_stk_fd p, di5min_stk f
16:12:25  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
16:12:25  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
16:12:25  13  /

Table created.

Elapsed: 00:00:02.14
16:12:27 SQL> 
16:12:27 SQL> -- rpt
16:12:27 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 80567
tue	 80479
wed	 79772
thu	 80645
mon	 61634

Elapsed: 00:00:00.24
16:12:27 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 80567
tue	 80479
wed	 79772
thu	 80645
mon	 61634

Elapsed: 00:00:00.49
16:12:28 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-01-26 16:05:00

Elapsed: 00:00:00.03
16:12:28 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-01-26 16:05:00

Elapsed: 00:00:00.03
16:12:28 SQL> 
16:12:28 SQL> -- rpt
16:12:28 SQL> SELECT
16:12:28   2  tkr
16:12:28   3  ,MIN(ydate)
16:12:28   4  ,COUNT(ydate)
16:12:28   5  ,MAX(ydate)
16:12:28   6  ,MIN(clse)
16:12:28   7  ,AVG(clse)
16:12:28   8  ,MAX(clse)
16:12:28   9  ,MAX(gain1day)
16:12:28  10  FROM di5min_stk_c2
16:12:28  11  GROUP BY tkr
16:12:28  12  ORDER BY tkr
16:12:28  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 326.72 338.012165     348.46	      13.64
ABT	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  46.65 47.7736538	48.76		.91
ABX	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  45.81 48.7420168	52.33	       1.67
ADBE	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	   31.3 32.9015976	34.27	       1.15
AEM	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  67.27 70.6424655	72.79	       2.78
AFL	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  54.89  56.737574	58.44	       1.84
AIG	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  41.83 55.3821154	62.47		4.8
AKAM	2011-01-04 14:30:00	    1075 2011-01-24 19:30:00	  46.85 49.4806326	52.47	       2.39
ALL	2011-01-04 14:30:00	    1067 2011-01-24 18:50:00	  30.47 31.1919541	32.18		.83
AMGN	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  55.99 56.7721499	57.63		.89
AMT	2011-01-04 14:30:00	    1055 2011-01-24 17:50:00	  48.78 50.5177725	52.16	       1.73
AMX	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	   57.5 58.5086193	59.58	       1.19
AMZN	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 176.93 185.299975     191.55	       3.43
APA	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  119.6 124.259443     127.55	       4.04
APC	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	   73.1 76.5176726	79.78	       3.94
ARG	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  63.18 63.5770907	63.97		.61
AXP	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  43.29 45.1012179	 46.7	       1.52
BA	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  66.51 69.7716667	72.63		2.6
BBT	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	     26 27.0809615	 28.4		1.3
BBY	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  34.65 35.3695661	36.18	       1.29
BEN	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 109.71 115.786529     121.41	       5.04
BHP	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  87.11 89.8088412	 92.7		2.4
BIDU	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  99.53 105.656681     108.96	       4.15
BP	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	   45.2  47.187288	49.38	       1.83
BRCM	2011-01-04 14:30:00	    1062 2011-01-24 18:25:00	  42.11 45.3592702	47.32	       2.09
BTU	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  57.99 61.7952268	65.57	       2.87
BUCY	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  89.67 90.1162426	90.47		.24
CAT	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  92.37 94.1224507	96.67	       2.25
CELG	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  55.88   57.72964	59.69	       1.56
CLF	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  80.23 85.3881164	91.04	       5.53
CMI	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 104.23 111.313521     114.74	       4.34
COF	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  43.23 46.4522189	49.64		2.8
COP	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  66.58 67.5361686	68.97	       1.35
COST	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  70.07 71.6422633	72.94	       1.04
CREE	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  51.16 63.5198126	69.19	       2.11
CRM	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 129.15 140.293619     146.42	       8.23
CSX	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  64.81 67.7205917	69.46	       1.63
CTSH	2011-01-04 14:30:00	    1187 2011-01-26 15:50:00	  72.61 74.6726074	76.42	       2.16
CVS	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  34.24 35.0768245	35.94	       1.17
CVX	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  90.21 92.0018688	93.91	       1.84
DD	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  47.28  49.296356	50.53	       1.82
DE	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  81.82 86.9745759	91.58	       2.68
DIA	2009-10-28 18:10:00	   26049 2011-01-24 18:00:00	  96.34 107.085546     119.39	       4.35
DIS	2009-10-28 18:10:00	   25758 2011-01-21 20:55:00	  27.06  33.964493	   40		2.1
DNDN	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  34.93 36.5054882	38.85	       2.92
DTV	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  40.79 41.8418047	42.78		  1
DVN	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  77.06 80.5562032	84.15	       2.75
EBAY	2009-10-28 18:10:00	   25464 2011-01-14 20:55:00	  19.17  24.648826	31.48	       2.55
EFA	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  56.77 58.5481262	60.04	       1.37
EOG	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  91.02 97.0644773     103.13	       3.53
ESRX	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  55.52 57.1439398	58.74	       1.35
EWZ	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  74.99 76.9944083	78.95	       1.94
FCX	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 108.33 117.056622     122.49	       4.32
FDX	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  92.12 94.0704438	96.98		2.4
FFIV	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 106.37 135.370587     145.75	       5.69
FLS	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  112.9 117.038235     121.04	       4.68
FSLR	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 130.64 139.115764     148.51	       7.23
GDX	2011-01-04 14:30:00	    1054 2011-01-24 17:45:00	  53.47 56.4448482	60.06	       1.54
GG	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  39.85 42.4165286	44.84	       1.26
GILD	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  36.51 37.7530325	38.92	       1.14
GLD	2011-01-04 14:30:00	    1063 2011-01-24 18:30:00	 130.71 133.559492     136.18	       1.14
GOOG	2009-10-28 18:10:00	   26084 2011-01-24 20:05:00	  434.6 549.382349     641.65	      63.83
GS	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 164.12 170.888476	  175	       3.74
HD	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  34.09 35.2306361	36.91	       1.01
HES	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  77.11 79.6388706	 82.6	       3.75
HON	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  53.03 54.3684961	55.72	       1.54
HPQ	2009-10-28 18:10:00	   25923 2011-01-21 20:55:00	  37.45 46.6248503	 54.7		3.4
IBM	2009-10-28 18:10:00	   25971 2011-01-24 20:30:00	 119.59  132.60798     159.51	       5.73
IOC	2011-01-04 14:30:00	    1050 2011-01-24 17:25:00	  68.38  74.984619	77.99	       1.89
IWM	2011-01-04 14:30:00	    1190 2011-01-26 16:05:00	  77.04 78.8611639	80.62	       1.95
JNJ	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  62.01 62.6658925	63.49		.89
JOYG	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  84.65  88.552002	93.42	       3.14
JPM	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  42.77 44.3810552	45.91		1.4
JWN	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  40.87 42.0468146	43.69	       1.14
KO	2011-01-04 14:30:00	    1071 2011-01-24 19:10:00	   62.6 63.2168487	65.04	       1.01
LFT	2011-01-04 14:30:00	    1042 2011-01-24 16:45:00	  32.05 34.2625912	   37	       1.43
MAR	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  39.62 40.9615335	42.01		.92
MCD	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  72.15 74.3688116	75.64	       1.64
MDT	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  36.18  37.054073	38.93	       1.36
MDY	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 163.62   166.8693     170.37		3.4
MEE	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  52.03  55.582574	58.46	       2.64
MET	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  44.78 45.9998274	46.95	       1.38
MJN	2011-01-04 14:30:00	    1042 2011-01-24 16:45:00	  60.37   61.93119	63.29	       1.16
MMM	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  85.68 87.6028797	89.36	       1.85
MON	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  68.27 71.8274556	75.24	       4.04
MOS	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  71.87 77.7815976	85.45	       4.05
MRK	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  33.52 35.5927071	 37.6		.72
MT	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  34.22 36.0327811	 38.2	       2.13
NEM	2011-01-04 14:30:00	    1053 2011-01-24 17:40:00	  54.42 56.9443827	60.22	       1.22
NFLX	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  176.3  185.21462     194.46	       9.82
NUE	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  42.81 44.2995513	45.23	       1.62
OIH	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 135.78 141.406972     147.27	       5.23
OXY	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  94.33 96.8430079	 98.9	       2.52
PBR	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  35.88 36.9298471	38.46	       1.58
PEP	2011-01-04 14:30:00	    1186 2011-01-26 15:45:00	  65.18 66.3046332	67.46	       1.56
PG	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  63.75 64.9952811	65.92	       1.12
PM	2011-01-04 14:30:00	    1049 2011-01-24 17:20:00	  55.88 56.8598522	58.93		 .6
PNC	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  60.02 61.8315138	64.25	       3.13
POT	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	 153.56  165.88962     174.19	       7.96
PRU	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  59.41 60.8909517	62.32	       1.47
QCOM	2011-01-04 14:30:00	    1077 2011-01-24 19:40:00	   49.9 51.8665552	53.06		2.3
QQQQ	2009-10-28 18:10:00	   26147 2011-01-24 17:10:00	   40.7 48.0078555	57.22		2.5
RIG	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  69.12 76.0274901	82.97	       5.25
RIMM	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  58.31 62.4959024	66.33		  3
SINA	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  72.55  80.475646	89.97	       6.68
SJM	2011-01-04 14:30:00	    1051 2011-01-24 17:30:00	   62.2 63.4142626	64.64	       1.07
SKX	2011-01-04 14:30:00	    1060 2011-01-24 18:15:00	   19.3 20.8409387	21.97	       1.07
SLB	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  79.84 83.4120464	87.53	       3.61
SLV	2011-01-04 14:30:00	    1074 2011-01-24 19:25:00	   26.6 28.1264804	29.59		.63
SNDK	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  49.16 51.8009763	53.47		2.7
SPY	2009-10-28 18:10:00	   22345 2011-01-21 20:55:00	 103.18 115.865794	129.6		5.1
STT	2011-01-04 14:30:00	    1188 2011-01-26 15:55:00	  45.94 47.6802399	50.22		2.1
SUN	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  38.49 40.2568738	41.82	       1.45
SWC	2011-01-19 14:30:00	     407 2011-01-26 15:50:00	  20.51 21.6564619	 23.4		.95
TEVA	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  52.03 53.6370513	54.64		1.8
TGT	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	   53.9 55.8781854	60.37	       1.67
TKR	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  48.64 50.2189398	51.98	       1.78
TLT	2011-01-04 14:30:00	    1046 2011-01-24 17:05:00	  90.43 91.9146511	93.74	       1.77
UNH	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  36.95 39.1508728	40.99	       1.47
UNP	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	     92 95.9880227	99.44	       3.77

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
UPS	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  71.37  72.422145	73.16		.96
V	2011-01-04 14:30:00	    1043 2011-01-24 16:50:00 63.3185584 71.7388342     79.272	 6.64033565
VECO	2011-01-04 14:30:00	    1065 2011-01-24 18:40:00	  42.99 46.5350986	49.65	       2.41
VMW	2011-01-04 14:30:00	    1045 2011-01-24 17:00:00	 86.585 90.6227162	95.94	       3.83
WDC	2011-01-04 14:30:00	    1069 2011-01-24 19:00:00	  31.39 32.7872732	34.22		  1
WFMI	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  47.85 50.5957249	53.35	       2.66
WHR	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  85.27 87.9310404	90.71	       3.56
WMT	2009-10-28 18:10:00	   25868 2011-01-21 20:55:00	  47.76 53.1685027	56.23	       2.22
WYNN	2011-01-04 14:30:00	    1189 2011-01-26 16:00:00	 109.66 116.337355     120.95		5.2
X	2011-01-04 12:40:00	    1512 2011-01-21 20:55:00	 42.815 61.1277781	75.74	 4.10144995
XLB	2011-01-04 14:30:00	    1044 2011-01-24 16:55:00	  37.25 38.3988266     39.085		 .8
XLE	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  67.54 69.2219329	71.16	       1.56
XLU	2011-01-04 14:30:00	    1014 2011-01-21 20:55:00	  31.23 31.6142308	32.06		.33
XOM	2009-10-28 18:10:00	   26042 2011-01-21 20:55:00	  56.05 66.9009287	79.07	       2.55

134 rows selected.

Elapsed: 00:00:00.32
16:12:28 SQL> 
16:12:28 SQL> COLUMN clse FORMAT 999.9999
16:12:28 SQL> SELECT
16:12:28   2  tkr
16:12:28   3  ,ROUND(clse,4)clse
16:12:28   4  -- Should be NULL:
16:12:28   5  ,ROUND(clse2,4)clse2
16:12:28   6  ,ydate
16:12:28   7  FROM di5min_stk_c2
16:12:28   8  WHERE ydate > sysdate - 0.5/24
16:12:28   9  ORDER BY tkr,ydate
16:12:28  10  /

TKR	     CLSE      CLSE2 YDATE
------- --------- ---------- -------------------
CTSH	  73.3300	     2011-01-26 15:45:00
CTSH	  73.2600	     2011-01-26 15:50:00
IWM	  79.2900	     2011-01-26 15:45:00
IWM	  79.1900	     2011-01-26 15:50:00
IWM	  78.9700	     2011-01-26 15:55:00
IWM	  78.9800	     2011-01-26 16:00:00
IWM	  78.9800	     2011-01-26 16:05:00
PEP	  65.7800	     2011-01-26 15:45:00
STT	  47.6900	     2011-01-26 15:45:00
STT	  47.6200	     2011-01-26 15:50:00
STT	  47.6300	     2011-01-26 15:55:00
SWC	  21.6400	     2011-01-26 15:45:00
SWC	  21.7000	     2011-01-26 15:50:00
WYNN	 117.8000	     2011-01-26 15:45:00
WYNN	 117.8400	     2011-01-26 15:50:00
WYNN	 117.5600	     2011-01-26 15:55:00
WYNN	 117.5900	     2011-01-26 16:00:00

17 rows selected.

Elapsed: 00:00:00.07
16:12:28 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
