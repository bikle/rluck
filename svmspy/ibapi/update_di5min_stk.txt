
SQL*Plus: Release 11.2.0.1.0 Production on Fri Jan 14 03:59:23 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

03:59:23 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
03:59:23 SQL> 03:59:23 SQL> --
03:59:23 SQL> -- update_di5min_stk.sql
03:59:23 SQL> --
03:59:23 SQL> 
03:59:23 SQL> -- I use this script to keep di5min_stk up to date.
03:59:23 SQL> 
03:59:23 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
03:59:23 SQL> -- After that date, it holds data from IB.
03:59:23 SQL> 
03:59:23 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
03:59:23 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
03:59:23 SQL> 
03:59:23 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.37
03:59:23 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.08
03:59:23 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:01.42
03:59:25 SQL> 
03:59:25 SQL> -- Copy in data from ibs5min:
03:59:25 SQL> 
03:59:25 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
03:59:25   2  SELECT	     tkr||ydate,tkr,ydate,clse
03:59:25   3  FROM ibs5min
03:59:25   4  WHERE ydate >= '2010-12-27 09:00:00'
03:59:25   5  /

82418 rows created.

Elapsed: 00:00:00.21
03:59:25 SQL> 
03:59:25 SQL> -- rpt
03:59:25 SQL> SELECT
03:59:25   2  tkr
03:59:25   3  ,MIN(ydate)
03:59:25   4  ,COUNT(tkr)
03:59:25   5  ,MAX(ydate)
03:59:25   6  FROM di5min_stk0
03:59:25   7  GROUP BY tkr
03:59:25   8  ORDER BY tkr
03:59:25   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
ABT	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ABX	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ADBE	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AEM	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AFL	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AIG	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AKAM	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ALL	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMGN	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMT	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMX	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMZN	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
APA	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
APC	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
ARG	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
AXP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BA	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BBT	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BBY	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BEN	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BHP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BIDU	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BRCM	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BTU	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BUCY	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CAT	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CELG	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CLF	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CMI	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
COF	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
COP	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
COST	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CREE	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CRM	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CSX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CTSH	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CVS	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CVX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DD	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DE	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DIA	2010-12-27 09:00:00	  2027 2011-01-12 20:55:00
DIS	2010-12-27 09:00:00	  1818 2011-01-12 20:55:00
DNDN	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DTV	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DVN	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EBAY	2010-12-27 09:00:00	  1840 2011-01-12 20:55:00
EFA	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EOG	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
ESRX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EWZ	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
FCX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
FDX	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FFIV	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FLS	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FSLR	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GDX	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GG	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GILD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GLD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GOOG	2010-12-27 09:00:00	  2176 2011-01-13 17:10:00
GS	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HES	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HON	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HPQ	2010-12-27 09:00:00	  1997 2011-01-13 20:55:00
IBM	2010-12-27 09:00:00	  1992 2011-01-13 20:55:00
IOC	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
IWM	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JNJ	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JOYG	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JPM	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JWN	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
KO	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
LFT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MAR	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MCD	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MDT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MDY	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MEE	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MET	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MJN	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MMM	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MON	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MOS	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MRK	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NEM	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NFLX	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NUE	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
OIH	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
OXY	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
PBR	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
PEP	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PG	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PNC	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
POT	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PRU	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
QCOM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
QQQQ	2010-12-27 09:00:00	  2036 2011-01-12 16:50:00
RIG	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
RIMM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
SINA	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SJM	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SKX	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SLB	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SLV	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SNDK	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SPY	2010-12-27 09:00:00	  2379 2011-01-12 20:55:00
STT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SUN	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TEVA	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TGT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TKR	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TLT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
UNH	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
UNP	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
UPS	2011-01-04 14:30:00	   498 2011-01-12 16:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
VECO	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
VMW	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WDC	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WFMI	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WHR	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WMT	2010-12-27 09:00:00	  1947 2011-01-12 16:55:00
WYNN	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
X	2011-01-04 12:40:00	  1008 2011-01-12 16:55:00
XLB	2011-01-04 14:30:00	   507 2011-01-12 17:40:00
XLE	2011-01-04 14:30:00	   507 2011-01-12 17:40:00
XLU	2011-01-04 14:30:00	   510 2011-01-12 17:55:00
XOM	2010-12-27 09:00:00	  2128 2011-01-12 18:15:00

133 rows selected.

Elapsed: 00:00:00.05
03:59:25 SQL> 
03:59:25 SQL> -- Next, copy in data from dukas.
03:59:25 SQL> -- dukas5min_stk depends on:
03:59:25 SQL> -- - dukas10min_stk
03:59:25 SQL> -- - svmspy/dukas/fake5.sql
03:59:25 SQL> 
03:59:25 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
03:59:25   2  SELECT	     tkr||ydate,tkr,ydate,clse
03:59:25   3  FROM dukas5min_stk
03:59:25   4  WHERE ydate < '2010-12-27 09:00:00'
03:59:25   5  /

230382 rows created.

Elapsed: 00:00:00.74
03:59:26 SQL> 
03:59:26 SQL> -- rpt
03:59:26 SQL> SELECT
03:59:26   2  tkr
03:59:26   3  ,MIN(ydate)
03:59:26   4  ,COUNT(tkr)
03:59:26   5  ,MAX(ydate)
03:59:26   6  FROM dukas5min_stk
03:59:26   7  WHERE ydate < '2010-12-27 09:00:00'
03:59:26   8  GROUP BY tkr
03:59:26   9  ORDER BY tkr
03:59:26  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
DIS	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
EBAY	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
GOOG	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
HPQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
IBM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
QQQQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
SPY	 2009-10-28 18:10:01	  19521 2010-12-24 20:50:01
WMT	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
XOM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01

10 rows selected.

Elapsed: 00:00:00.09
03:59:26 SQL> 
03:59:26 SQL> -- rpt
03:59:26 SQL> SELECT
03:59:26   2  tkr
03:59:26   3  ,MIN(ydate)
03:59:26   4  ,COUNT(tkr)
03:59:26   5  ,MAX(ydate)
03:59:26   6  FROM di5min_stk0
03:59:26   7  GROUP BY tkr
03:59:26   8  ORDER BY tkr
03:59:26   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
ABT	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ABX	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ADBE	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AEM	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AFL	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AIG	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AKAM	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ALL	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMGN	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMT	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMX	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMZN	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
APA	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
APC	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
ARG	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
AXP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BA	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BBT	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BBY	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BEN	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BHP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BIDU	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BRCM	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BTU	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BUCY	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CAT	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CELG	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CLF	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CMI	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
COF	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
COP	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
COST	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CREE	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CRM	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CSX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CTSH	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CVS	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CVX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DD	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DE	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DIA	2009-10-28 18:10:01	 25456 2011-01-12 20:55:00
DIS	2009-10-28 18:10:01	 25247 2011-01-12 20:55:00
DNDN	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DTV	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DVN	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EBAY	2009-10-28 18:10:01	 25269 2011-01-12 20:55:00
EFA	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EOG	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
ESRX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EWZ	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
FCX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
FDX	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FFIV	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FLS	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FSLR	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GDX	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GG	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GILD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GLD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GOOG	2009-10-28 18:10:01	 25605 2011-01-13 17:10:00
GS	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HES	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HON	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HPQ	2009-10-28 18:10:01	 25426 2011-01-13 20:55:00
IBM	2009-10-28 18:10:01	 25421 2011-01-13 20:55:00
IOC	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
IWM	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JNJ	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JOYG	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JPM	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JWN	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
KO	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
LFT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MAR	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MCD	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MDT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MDY	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MEE	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MET	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MJN	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MMM	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MON	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MOS	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MRK	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NEM	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NFLX	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NUE	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
OIH	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
OXY	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
PBR	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
PEP	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PG	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PNC	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
POT	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PRU	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
QCOM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
QQQQ	2009-10-28 18:10:01	 25465 2011-01-12 16:50:00
RIG	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
RIMM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
SINA	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SJM	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SKX	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SLB	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SLV	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SNDK	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SPY	2009-10-28 18:10:01	 21900 2011-01-12 20:55:00
STT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SUN	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TEVA	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TGT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TKR	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TLT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
UNH	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
UNP	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
UPS	2011-01-04 14:30:00	   498 2011-01-12 16:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
VECO	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
VMW	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WDC	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WFMI	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WHR	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WMT	2009-10-28 18:10:01	 25376 2011-01-12 16:55:00
WYNN	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
X	2011-01-04 12:40:00	  1008 2011-01-12 16:55:00
XLB	2011-01-04 14:30:00	   507 2011-01-12 17:40:00
XLE	2011-01-04 14:30:00	   507 2011-01-12 17:40:00
XLU	2011-01-04 14:30:00	   510 2011-01-12 17:55:00
XOM	2009-10-28 18:10:01	 25557 2011-01-12 18:15:00

133 rows selected.

Elapsed: 00:00:00.13
03:59:26 SQL> 
03:59:26 SQL> CREATE TABLE di5min_stk COMPRESS AS
03:59:26   2  SELECT
03:59:26   3  tkrdate
03:59:26   4  ,tkr
03:59:26   5  ,ydate
03:59:26   6  ,AVG(clse)clse
03:59:26   7  FROM di5min_stk0
03:59:26   8  GROUP BY
03:59:26   9  tkrdate
03:59:26  10  ,tkr
03:59:26  11  ,ydate
03:59:26  12  /

Table created.

Elapsed: 00:00:01.18
03:59:27 SQL> 
03:59:27 SQL> -- I need to shave a second off of some of the dates:
03:59:27 SQL> 
03:59:27 SQL> UPDATE di5min_stk SET ydate = ydate - 1/24/3600
03:59:27   2  WHERE TO_CHAR(ydate,'SS')='01'
03:59:27   3  /

230382 rows updated.

Elapsed: 00:00:05.58
03:59:33 SQL> 
03:59:33 SQL> SELECT COUNT(*)FROM di5min_stk;

  COUNT(*)
----------
    312800

Elapsed: 00:00:00.02
03:59:33 SQL> SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    312800

Elapsed: 00:00:00.09
03:59:33 SQL> SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.09
03:59:33 SQL> 
03:59:33 SQL> UPDATE di5min_stk SET tkrdate = tkr||ydate;

312800 rows updated.

Elapsed: 00:00:06.13
03:59:39 SQL> 
03:59:39 SQL> -- rpt
03:59:39 SQL> SELECT
03:59:39   2  tkr
03:59:39   3  ,MIN(ydate)
03:59:39   4  ,COUNT(ydate)
03:59:39   5  ,MAX(ydate)
03:59:39   6  ,MIN(clse)
03:59:39   7  ,AVG(clse)
03:59:39   8  ,MAX(clse)
03:59:39   9  FROM di5min_stk
03:59:39  10  GROUP BY tkr
03:59:39  11  ORDER BY tkr
03:59:39  12  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE)
------- ------------------- ------------ ------------------- ---------- ---------- ----------
AAPL	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	 328.28  336.81239     344.42
ABT	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  47.62 48.1227033	48.76
ABX	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  48.74 49.8340041	52.33
ADBE	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	   31.3 32.1806301	33.43
AEM	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  68.98 71.2691463	72.67
AFL	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  54.89 56.1022764	57.51
AIG	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  56.13 59.4867276	62.47
AKAM	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  46.85  48.406565	49.52
ALL	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	   30.7 31.4721341	32.18
AMGN	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  55.99 56.6660976	57.18
AMT	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	   50.1 50.8061585	52.16
AMX	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	   57.5 58.6197154	59.58
AMZN	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	 182.72 185.185152	188.4
APA	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  119.6 123.240243     126.76
APC	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	   73.1 75.2969168	 78.4
ARG	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  63.18  63.589716	63.92
AXP	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  43.29 44.6054361	 45.7
BA	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  66.51 68.4897566	   70
BBT	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	     26  26.762069	27.67
BBY	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  34.65 35.3933063	36.18
BEN	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	 109.71 112.480406     117.81
BHP	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  87.68 89.5581744	 92.7
BIDU	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  99.53  104.48856     107.21
BP	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	   45.2 46.2832049	47.58
BRCM	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  42.11  44.621643	46.18
BTU	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	     61 62.4165517	65.57
BUCY	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  89.67 89.9349493	90.18
CAT	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  92.37 93.8201217	94.67
CELG	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	   56.3 58.5657606	59.69
CLF	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  80.23 83.6195132	89.05
CMI	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	 109.01  111.35712     113.59
COF	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  43.23 45.2137525	 47.3
COP	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  66.58 67.4037854	68.83
COST	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  70.07 71.0901417	72.43
CREE	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  65.69 67.5410931	 68.7
CRM	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	 133.57 140.562551     144.69
CSX	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  64.81 66.8443927	68.76
CTSH	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	   73.6  75.203664	76.34
CVS	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  34.41 35.1669636	35.94
CVX	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  90.21 91.1999393	92.68
DD	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  47.28 49.4751417	50.53
DE	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  81.82 84.4147368	87.68
DIA	2009-10-28 18:10:00	   25456 2011-01-12 20:55:00	  96.34 106.836608     117.63
DIS	2009-10-28 18:10:00	   25247 2011-01-12 20:55:00	  27.06 33.8548576	   40
DNDN	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  34.93 36.5573077	38.85
DTV	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  40.79 41.4681984	42.15
DVN	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  77.06 78.5388462	81.55
EBAY	2009-10-28 18:10:00	   25269 2011-01-12 20:55:00	  19.17 24.6180593	31.48
EFA	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  56.77 57.7751619	 58.9
EOG	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  91.02 93.7637045	98.42
ESRX	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  55.52 56.4063968	57.34
EWZ	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  75.21 76.9155668	78.61
FCX	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  115.2 118.118239     122.49
FDX	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  92.12 93.4466465	94.96
FFIV	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  131.7 138.271192     143.35
FLS	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  114.8 117.412525     121.04
FSLR	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	 130.64 134.477232     139.82
GDX	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  56.39 57.6105859	60.06
GG	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  42.59 43.5820404	44.84
GILD	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  36.51 37.2862828	37.78
GLD	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  133.2 134.218727     136.18
GOOG	2009-10-28 18:10:00	   25605 2011-01-13 17:10:00	  434.6  547.94675     629.82
GS	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	 168.42 171.563616     174.44
HD	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  34.09 34.6028081	35.55
HES	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  77.11 78.9071919	81.58
HON	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  53.03 54.0334141	54.75
HPQ	2009-10-28 18:10:00	   25426 2011-01-13 20:55:00	  37.45 46.6325741	 54.7
IBM	2009-10-28 18:10:00	   25421 2011-01-13 20:55:00	 119.59 132.165285     150.76
IOC	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  75.02 76.4193333	77.99
IWM	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  77.55 78.8835758	80.11
JNJ	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  62.01 62.7407677	63.49
JOYG	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  84.65 87.3982424	89.12
JPM	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  42.77 43.9445859	44.93
JWN	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  41.44 42.4267339	43.69
KO	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	   62.6 63.2427016	65.04
LFT	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  34.15 35.2667742	   37
MAR	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  40.17 41.0109677	   42
MCD	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  73.53 74.3432661	75.64
MDT	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  36.18 36.5802016	37.34
MDY	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	 163.62 165.844355     168.19
MEE	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  53.71 55.9048387	57.88
MET	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  45.07 45.9727823	46.84
MJN	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  60.37 61.4904234	62.43
MMM	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  85.68 86.9618548	88.58
MON	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  68.27 70.8098387	74.97
MOS	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  73.65  76.359879	78.64
MRK	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  35.88 36.8222177	 37.6
MT	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  34.22 35.8901815	 38.2
NEM	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	   56.4 57.8595363	60.22
NFLX	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  176.3 181.994597     190.78
NUE	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  42.81 44.0185081	45.18
OIH	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	 135.78 138.526794     144.21
OXY	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  94.33 96.3764315	 98.4
PBR	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  36.01 36.7145161	37.84
PEP	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  65.18 66.2751107	67.04
PG	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  63.75 64.4740241	65.05
PM	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  55.88 57.2521328	58.93
PNC	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  60.16 61.6100805	63.11
POT	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	 153.56 163.537304     169.45
PRU	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  59.41  60.673662	61.48
QCOM	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	   49.9 51.8405433	52.97
QQQQ	2009-10-28 18:10:00	   25465 2011-01-12 16:50:00	   40.7 47.7827562	 56.5
RIG	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  69.12 73.2655332	77.73
RIMM	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  58.31 61.0147284	63.61
SINA	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  72.55 77.4544048	83.63
SJM	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	   62.2 63.2082051	64.54
SKX	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	   19.3 20.3014377	21.17
SLB	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  79.84  81.790348	84.47
SLV	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  27.95 28.6104121	29.59
SNDK	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  49.78  52.164652	53.47
SPY	2009-10-28 18:10:00	   21900 2011-01-12 20:55:00	 103.18 115.604822	128.7
STT	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  45.94 46.9809615	48.06
SUN	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  38.49 39.9692674	 41.6
TEVA	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  52.03 53.4694231	54.56
TGT	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  54.39 56.4292582	60.37
TKR	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  48.64  49.980293	51.72
TLT	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  91.05 92.2156685	93.74
UNH	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  36.95 38.1360643	39.19
UNP	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	     92 94.7317269	98.53
UPS	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  71.37 72.3531526	73.06

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE)
------- ------------------- ------------ ------------------- ---------- ---------- ----------
V	2011-01-04 14:30:00	     498 2011-01-12 16:55:00 68.2966667 70.8742102	72.45
VECO	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  43.62 46.1702811	 49.1
VMW	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  90.62 94.3516466	96.23
WDC	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  31.83 32.8940562	34.22
WFMI	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  47.85 48.8464056	 50.7
WHR	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	   86.1     88.345	90.71
WMT	2009-10-28 18:10:00	   25376 2011-01-12 16:55:00	  47.76 53.1273563	56.15
WYNN	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	 109.66 115.579357     119.37
X	2011-01-04 12:40:00	    1008 2011-01-12 16:55:00	 47.735 64.7891964	75.74
XLB	2011-01-04 14:30:00	     507 2011-01-12 17:40:00	  37.74 38.4344872     39.085
XLE	2011-01-04 14:30:00	     507 2011-01-12 17:40:00	  67.54 68.3010552	70.12
XLU	2011-01-04 14:30:00	     510 2011-01-12 17:55:00	  31.23 31.4534412	31.76
XOM	2009-10-28 18:10:00	   25557 2011-01-12 18:15:00	  56.05 66.6931322	 76.5

133 rows selected.

Elapsed: 00:00:00.25
03:59:39 SQL> 
03:59:39 SQL> COLUMN clse FORMAT 999.9999
03:59:39 SQL> SELECT
03:59:39   2  tkr
03:59:39   3  ,ROUND(clse,4)clse
03:59:39   4  ,ydate
03:59:39   5  FROM di5min_stk
03:59:39   6  WHERE ydate > sysdate - 0.5/24
03:59:39   7  ORDER BY tkr,ydate
03:59:39   8  /

no rows selected

Elapsed: 00:00:00.04
03:59:39 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
