
SQL*Plus: Release 11.2.0.1.0 Production on Fri Jan 21 06:05:21 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

06:05:21 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
06:05:21 SQL> 
06:05:21 SQL> 06:05:21 SQL> --
06:05:21 SQL> -- update_di5min_stk.sql
06:05:21 SQL> --
06:05:21 SQL> 
06:05:21 SQL> -- I use this script to keep di5min_stk up to date.
06:05:21 SQL> 
06:05:21 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
06:05:21 SQL> -- After that date, it holds data from IB.
06:05:21 SQL> 
06:05:21 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
06:05:21 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
06:05:21 SQL> 
06:05:21 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.50
06:05:21 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.09
06:05:21 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.35
06:05:22 SQL> 
06:05:22 SQL> 
06:05:22 SQL> -- I need to shave a second off of some of the dates:
06:05:22 SQL> 
06:05:22 SQL> UPDATE ibs5min SET ydate = ydate - 1/24/3600
06:05:22   2  WHERE TO_CHAR(ydate,'SS')='01'
06:05:22   3  /

0 rows updated.

Elapsed: 00:00:00.06
06:05:22 SQL> 
06:05:22 SQL> SELECT COUNT(*)FROM ibs5min;

  COUNT(*)
----------
    137471

Elapsed: 00:00:00.01
06:05:22 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    137471

Elapsed: 00:00:00.03
06:05:22 SQL> SELECT COUNT(*)FROM ibs5min WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.04
06:05:22 SQL> 
06:05:22 SQL> -- Copy in data from ibs5min:
06:05:22 SQL> 
06:05:22 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
06:05:22   2  SELECT	     tkr||ydate,tkr,ydate,clse
06:05:22   3  FROM ibs5min
06:05:22   4  WHERE ydate >= '2010-12-27 09:00:00'
06:05:22   5  /

137471 rows created.

Elapsed: 00:00:00.29
06:05:22 SQL> 
06:05:22 SQL> -- rpt
06:05:22 SQL> SELECT
06:05:22   2  tkr
06:05:22   3  ,MIN(ydate)
06:05:22   4  ,COUNT(tkr)
06:05:22   5  ,MAX(ydate)
06:05:22   6  FROM di5min_stk0
06:05:22   7  GROUP BY tkr
06:05:22   8  ORDER BY tkr
06:05:22   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
ABT	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
ABX	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
ADBE	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AEM	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AFL	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AIG	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AKAM	2011-01-04 14:30:00	   928 2011-01-20 20:15:00
ALL	2011-01-04 14:30:00	   925 2011-01-20 20:00:00
AMGN	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AMT	2011-01-04 14:30:00	   921 2011-01-20 19:40:00
AMX	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AMZN	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
APA	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
APC	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
ARG	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AXP	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
BA	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BBT	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BBY	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BEN	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BHP	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BIDU	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
BP	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BRCM	2011-01-04 14:30:00	   923 2011-01-20 19:50:00
BTU	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BUCY	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CAT	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CELG	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CLF	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CMI	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
COF	2011-01-04 14:30:00	   935 2011-01-20 20:50:00
COP	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
COST	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CREE	2011-01-04 14:30:00	   933 2011-01-20 20:40:00
CRM	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
CSX	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
CTSH	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
CVS	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
CVX	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
DD	2011-01-04 14:30:00	   932 2011-01-20 20:35:00
DE	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
DIA	2010-12-27 09:00:00	  2511 2011-01-20 20:55:00
DIS	2010-12-27 09:00:00	  2263 2011-01-20 20:55:00
DNDN	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
DTV	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
DVN	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
EBAY	2010-12-27 09:00:00	  2047 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
EOG	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
ESRX	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
EWZ	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
FCX	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
FDX	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
FFIV	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
FLS	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
FSLR	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
GDX	2011-01-04 14:30:00	   921 2011-01-20 19:40:00
GG	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
GILD	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
GLD	2011-01-04 14:30:00	   924 2011-01-20 19:55:00
GOOG	2010-12-27 09:00:00	  2527 2011-01-20 20:25:00
GS	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
HD	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
HES	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
HON	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
HPQ	2010-12-27 09:00:00	  2398 2011-01-20 18:25:00
IBM	2010-12-27 09:00:00	  2398 2011-01-20 20:30:00
IOC	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
IWM	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
JNJ	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
JOYG	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
JPM	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
JWN	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
KO	2011-01-04 14:30:00	   927 2011-01-20 20:10:00
LFT	2011-01-04 14:30:00	   913 2011-01-20 19:00:00
MAR	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
MCD	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
MDT	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MDY	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MEE	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MET	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
MJN	2011-01-04 14:30:00	   911 2011-01-20 18:50:00
MMM	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MON	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MOS	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MRK	2011-01-04 14:30:00	   934 2011-01-20 20:45:00
MT	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
NEM	2011-01-04 14:30:00	   920 2011-01-20 19:35:00
NFLX	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
NUE	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
OIH	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
OXY	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
PBR	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
PEP	2011-01-04 14:30:00	   929 2011-01-20 20:20:00
PG	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
PM	2011-01-04 14:30:00	   919 2011-01-20 19:30:00
PNC	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
POT	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
PRU	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
QCOM	2011-01-04 14:30:00	   929 2011-01-20 20:20:00
QQQQ	2010-12-27 09:00:00	  2601 2011-01-20 19:25:00
RIG	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
RIMM	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
SINA	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
SJM	2011-01-04 14:30:00	   920 2011-01-20 19:35:00
SKX	2011-01-04 14:30:00	   923 2011-01-20 19:50:00
SLB	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
SLV	2011-01-04 14:30:00	   927 2011-01-20 20:10:00
SNDK	2011-01-04 14:30:00	   934 2011-01-20 20:45:00
SPY	2010-12-27 09:00:00	  2770 2011-01-20 20:55:00
STT	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
SUN	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
TEVA	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
TGT	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
TKR	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
TLT	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
UNH	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
UNP	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
UPS	2011-01-04 14:30:00	   909 2011-01-20 18:40:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
VECO	2011-01-04 14:30:00	   925 2011-01-20 20:00:00
VMW	2011-01-04 14:30:00	   917 2011-01-20 19:20:00
WDC	2011-01-04 14:30:00	   926 2011-01-20 20:05:00
WFMI	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
WHR	2011-01-04 14:30:00	   910 2011-01-20 18:45:00
WMT	2010-12-27 09:00:00	  2385 2011-01-20 20:55:00
WYNN	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
X	2011-01-04 12:40:00	  1420 2011-01-20 18:45:00
XLB	2011-01-04 14:30:00	   916 2011-01-20 19:15:00
XLE	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
XLU	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
XOM	2010-12-27 09:00:00	  2533 2011-01-20 18:45:00

133 rows selected.

Elapsed: 00:00:00.07
06:05:22 SQL> 
06:05:22 SQL> -- Next, copy in data from dukas.
06:05:22 SQL> -- dukas5min_stk depends on:
06:05:22 SQL> -- - dukas10min_stk
06:05:22 SQL> -- - svmspy/dukas/fake5.sql
06:05:22 SQL> 
06:05:22 SQL> 
06:05:22 SQL> -- I need to shave a second off of some of the dates:
06:05:22 SQL> 
06:05:22 SQL> UPDATE dukas5min_stk SET ydate = ydate - 1/24/3600
06:05:22   2  WHERE TO_CHAR(ydate,'SS')='01'
06:05:22   3  /

0 rows updated.

Elapsed: 00:00:00.45
06:05:23 SQL> 
06:05:23 SQL> SELECT COUNT(*)FROM dukas5min_stk;

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.01
06:05:23 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    234282

Elapsed: 00:00:00.07
06:05:23 SQL> SELECT COUNT(*)FROM dukas5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.08
06:05:23 SQL> 
06:05:23 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
06:05:23   2  SELECT	     tkr||ydate,tkr,ydate,clse
06:05:23   3  FROM dukas5min_stk
06:05:23   4  WHERE ydate < '2010-12-27 09:00:00'
06:05:23   5  /

230382 rows created.

Elapsed: 00:00:00.45
06:05:23 SQL> 
06:05:23 SQL> -- rpt
06:05:23 SQL> SELECT
06:05:23   2  tkr
06:05:23   3  ,MIN(ydate)
06:05:23   4  ,COUNT(tkr)
06:05:23   5  ,MAX(ydate)
06:05:23   6  FROM dukas5min_stk
06:05:23   7  WHERE ydate < '2010-12-27 09:00:00'
06:05:23   8  GROUP BY tkr
06:05:23   9  ORDER BY tkr
06:05:23  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
DIS	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
EBAY	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
GOOG	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
HPQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
IBM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
QQQQ	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
SPY	 2009-10-28 18:10:00	  19521 2010-12-24 20:50:00
WMT	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00
XOM	 2009-10-28 18:10:00	  23429 2010-12-24 20:50:00

10 rows selected.

Elapsed: 00:00:00.08
06:05:23 SQL> 
06:05:23 SQL> -- rpt
06:05:23 SQL> SELECT
06:05:23   2  tkr
06:05:23   3  ,MIN(ydate)
06:05:23   4  ,COUNT(tkr)
06:05:23   5  ,MAX(ydate)
06:05:23   6  FROM di5min_stk0
06:05:23   7  GROUP BY tkr
06:05:23   8  ORDER BY tkr
06:05:23   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
ABT	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
ABX	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
ADBE	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AEM	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AFL	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AIG	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AKAM	2011-01-04 14:30:00	   928 2011-01-20 20:15:00
ALL	2011-01-04 14:30:00	   925 2011-01-20 20:00:00
AMGN	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AMT	2011-01-04 14:30:00	   921 2011-01-20 19:40:00
AMX	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AMZN	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
APA	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
APC	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
ARG	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
AXP	2011-01-04 14:30:00	   903 2011-01-20 18:10:00
BA	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BBT	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BBY	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BEN	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BHP	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BIDU	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
BP	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BRCM	2011-01-04 14:30:00	   923 2011-01-20 19:50:00
BTU	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
BUCY	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CAT	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CELG	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CLF	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CMI	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
COF	2011-01-04 14:30:00	   935 2011-01-20 20:50:00
COP	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
COST	2011-01-04 14:30:00	   904 2011-01-20 18:15:00
CREE	2011-01-04 14:30:00	   933 2011-01-20 20:40:00
CRM	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
CSX	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
CTSH	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
CVS	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
CVX	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
DD	2011-01-04 14:30:00	   932 2011-01-20 20:35:00
DE	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
DIA	2009-10-28 18:10:00	 25940 2011-01-20 20:55:00
DIS	2009-10-28 18:10:00	 25692 2011-01-20 20:55:00
DNDN	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
DTV	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
DVN	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
EBAY	2009-10-28 18:10:00	 25476 2011-01-14 20:55:00
EFA	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
EOG	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
ESRX	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
EWZ	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
FCX	2011-01-04 14:30:00	   905 2011-01-20 18:20:00
FDX	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
FFIV	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
FLS	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
FSLR	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
GDX	2011-01-04 14:30:00	   921 2011-01-20 19:40:00
GG	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
GILD	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
GLD	2011-01-04 14:30:00	   924 2011-01-20 19:55:00
GOOG	2009-10-28 18:10:00	 25956 2011-01-20 20:25:00
GS	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
HD	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
HES	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
HON	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
HPQ	2009-10-28 18:10:00	 25827 2011-01-20 18:25:00
IBM	2009-10-28 18:10:00	 25827 2011-01-20 20:30:00
IOC	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
IWM	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
JNJ	2011-01-04 14:30:00	   906 2011-01-20 18:25:00
JOYG	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
JPM	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
JWN	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
KO	2011-01-04 14:30:00	   927 2011-01-20 20:10:00
LFT	2011-01-04 14:30:00	   913 2011-01-20 19:00:00
MAR	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
MCD	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
MDT	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MDY	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MEE	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MET	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
MJN	2011-01-04 14:30:00	   911 2011-01-20 18:50:00
MMM	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MON	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MOS	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
MRK	2011-01-04 14:30:00	   934 2011-01-20 20:45:00
MT	2011-01-04 14:30:00	   907 2011-01-20 18:30:00
NEM	2011-01-04 14:30:00	   920 2011-01-20 19:35:00
NFLX	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
NUE	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
OIH	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
OXY	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
PBR	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
PEP	2011-01-04 14:30:00	   929 2011-01-20 20:20:00
PG	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
PM	2011-01-04 14:30:00	   919 2011-01-20 19:30:00
PNC	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
POT	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
PRU	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
QCOM	2011-01-04 14:30:00	   929 2011-01-20 20:20:00
QQQQ	2009-10-28 18:10:00	 26030 2011-01-20 19:25:00
RIG	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
RIMM	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
SINA	2011-01-04 14:30:00	   908 2011-01-20 18:35:00
SJM	2011-01-04 14:30:00	   920 2011-01-20 19:35:00
SKX	2011-01-04 14:30:00	   923 2011-01-20 19:50:00
SLB	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
SLV	2011-01-04 14:30:00	   927 2011-01-20 20:10:00
SNDK	2011-01-04 14:30:00	   934 2011-01-20 20:45:00
SPY	2009-10-28 18:10:00	 22291 2011-01-20 20:55:00
STT	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
SUN	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
TEVA	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
TGT	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
TKR	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
TLT	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
UNH	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
UNP	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
UPS	2011-01-04 14:30:00	   909 2011-01-20 18:40:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
VECO	2011-01-04 14:30:00	   925 2011-01-20 20:00:00
VMW	2011-01-04 14:30:00	   917 2011-01-20 19:20:00
WDC	2011-01-04 14:30:00	   926 2011-01-20 20:05:00
WFMI	2011-01-04 14:30:00	   909 2011-01-20 18:40:00
WHR	2011-01-04 14:30:00	   910 2011-01-20 18:45:00
WMT	2009-10-28 18:10:00	 25814 2011-01-20 20:55:00
WYNN	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
X	2011-01-04 12:40:00	  1420 2011-01-20 18:45:00
XLB	2011-01-04 14:30:00	   916 2011-01-20 19:15:00
XLE	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
XLU	2011-01-04 14:30:00	   936 2011-01-20 20:55:00
XOM	2009-10-28 18:10:00	 25962 2011-01-20 18:45:00

133 rows selected.

Elapsed: 00:00:00.14
06:05:24 SQL> 
06:05:24 SQL> CREATE TABLE di5min_stk COMPRESS AS
06:05:24   2  SELECT
06:05:24   3  tkrdate
06:05:24   4  ,tkr
06:05:24   5  ,ydate
06:05:24   6  ,AVG(clse)clse
06:05:24   7  FROM di5min_stk0
06:05:24   8  -- I want weekdays:
06:05:24   9  WHERE TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu','fri')
06:05:24  10  GROUP BY
06:05:24  11  tkrdate
06:05:24  12  ,tkr
06:05:24  13  ,ydate
06:05:24  14  /

Table created.

Elapsed: 00:00:01.70
06:05:25 SQL> 
06:05:25 SQL> -- rpt
06:05:25 SQL> SELECT
06:05:25   2  TO_CHAR(ydate,'dy')
06:05:25   3  ,COUNT(ydate)
06:05:25   4  FROM di5min_stk
06:05:25   5  GROUP BY TO_CHAR(ydate,'dy')
06:05:25   6  /

TO_ COUNT(YDATE)
--- ------------
fri	   70193
tue	   80011
thu	   77882
wed	   79587
mon	   60000

Elapsed: 00:00:00.41
06:05:26 SQL> 
06:05:26 SQL> -- I need to shave a second off of some of the dates:
06:05:26 SQL> --
06:05:26 SQL> -- UPDATE di5min_stk SET ydate = ydate - 1/24/3600
06:05:26 SQL> -- WHERE TO_CHAR(ydate,'SS')='01'
06:05:26 SQL> -- /
06:05:26 SQL> --
06:05:26 SQL> -- SELECT COUNT(*)FROM di5min_stk;
06:05:26 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';
06:05:26 SQL> -- SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';
06:05:26 SQL> --
06:05:26 SQL> -- UPDATE di5min_stk SET tkrdate = tkr||ydate;
06:05:26 SQL> 
06:05:26 SQL> -- Add a column to help join with future dates
06:05:26 SQL> -- and then calculate 1 day gain:
06:05:26 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:00.03
06:05:26 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
06:05:26   2  SELECT
06:05:26   3  tkrdate
06:05:26   4  ,tkr
06:05:26   5  ,ydate
06:05:26   6  ,clse
06:05:26   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
06:05:26   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
06:05:26   9  	    ELSE NULL END selldate
06:05:26  10  FROM di5min_stk
06:05:26  11  /

Table created.

Elapsed: 00:00:00.95
06:05:27 SQL> 
06:05:27 SQL> -- Join with the future
06:05:27 SQL> 
06:05:27 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:00.09
06:05:27 SQL> 
06:05:27 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
06:05:27   2  SELECT
06:05:27   3  p.tkrdate
06:05:27   4  ,p.tkr
06:05:27   5  ,p.ydate
06:05:27   6  ,p.clse
06:05:27   7  ,p.selldate
06:05:27   8  ,f.clse clse2
06:05:27   9  ,f.clse - p.clse gain1day
06:05:27  10  FROM di5min_stk_fd p, di5min_stk f
06:05:27  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
06:05:27  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
06:05:27  13  /

Table created.

Elapsed: 00:00:01.73
06:05:29 SQL> 
06:05:29 SQL> -- rpt
06:05:29 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 70193
tue	 80011
thu	 77882
wed	 79587
mon	 60000

Elapsed: 00:00:00.22
06:05:29 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 70193
tue	 80011
thu	 77882
wed	 79587
mon	 60000

Elapsed: 00:00:00.26
06:05:29 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-01-20 20:55:00

Elapsed: 00:00:00.03
06:05:29 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-01-20 20:55:00

Elapsed: 00:00:00.04
06:05:29 SQL> 
06:05:29 SQL> -- rpt
06:05:29 SQL> SELECT
06:05:29   2  tkr
06:05:29   3  ,MIN(ydate)
06:05:29   4  ,COUNT(ydate)
06:05:29   5  ,MAX(ydate)
06:05:29   6  ,MIN(clse)
06:05:29   7  ,AVG(clse)
06:05:29   8  ,MAX(clse)
06:05:29   9  ,MAX(gain1day)
06:05:29  10  FROM di5min_stk_c2
06:05:29  11  GROUP BY tkr
06:05:29  12  ORDER BY tkr
06:05:29  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	 328.28 338.672099     348.46	      13.64
ABT	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  46.65 47.7587874	48.76		.91
ABX	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  45.81 48.8738194	52.33		1.2
ADBE	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	   31.3 32.8430122	34.27	       1.15
AEM	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	  67.27 70.8155648	72.79	       2.78
AFL	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	  54.89 56.6196844	58.44	       1.84
AIG	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	  43.79 56.9115725	62.47		4.8
AKAM	2011-01-04 14:30:00	     928 2011-01-20 20:15:00	  46.85 49.4861153	52.47	       2.39
ALL	2011-01-04 14:30:00	     925 2011-01-20 20:00:00	  30.47 31.1718486	32.18		 .8
AMGN	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	  55.99 56.7383333	57.55		.89
AMT	2011-01-04 14:30:00	     921 2011-01-20 19:40:00	  48.78 50.4965147	52.16	       1.51
AMX	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	   57.5 58.5119491	59.58	       1.19
AMZN	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	 181.11 185.764071     191.55	       3.43
APA	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	  119.6 124.212243     127.55	       4.04
APC	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	   73.1 76.4798117	79.78	       3.94
ARG	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	  63.18  63.557907	63.92		.51
AXP	2011-01-04 14:30:00	     903 2011-01-20 18:10:00	  43.29 45.0270487	 46.7	       1.52
BA	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  66.51 69.5643031	72.63		2.6
BBT	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	     26 26.9853872	27.85		.97
BBY	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  34.65 35.3813274	36.18	       1.29
BEN	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	 109.71  115.45641     121.41	       5.04
BHP	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  87.11 90.0141206	 92.7		2.4
BIDU	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  99.53 105.623002     108.96	       4.15
BP	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	   45.2 47.1167146	49.38	       1.83
BRCM	2011-01-04 14:30:00	     923 2011-01-20 19:50:00	  42.11 45.4075135	47.32	       2.09
BTU	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  58.26 62.1262611	65.57	       2.87
BUCY	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  89.67 90.0827876	90.42		.24
CAT	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  92.37 94.1906858	96.67	       2.25
CELG	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  55.88 57.8916925	59.69	       1.56
CLF	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  80.23 85.5631527	91.04	       5.53
CMI	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	 108.65 111.800747     114.74	       4.34
COF	2011-01-04 14:30:00	     935 2011-01-20 20:50:00	  43.23 46.2309465	48.56	       1.95
COP	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  66.58 67.5443031	68.97	       1.35
COST	2011-01-04 14:30:00	     904 2011-01-20 18:15:00	  70.07 71.5116538	72.87	       1.04
CREE	2011-01-04 14:30:00	     933 2011-01-20 20:40:00	  51.87 64.5099303	69.19	       2.11
CRM	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	 129.15 140.871132     146.42	       8.23
CSX	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  64.81 67.7232099	69.46	       1.63
CTSH	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	   73.3  75.039884	76.42	       2.16
CVS	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  34.24 35.0321713	35.94		.75
CVX	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  90.21 91.8495691	 93.7	       1.64
DD	2011-01-04 14:30:00	     932 2011-01-20 20:35:00	  47.28 49.3616792	50.53	       1.82
DE	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  81.82  86.689326	91.58	       2.68
DIA	2009-10-28 18:10:00	   25928 2011-01-20 20:55:00	  96.34 107.031334     118.47	       4.35
DIS	2009-10-28 18:10:00	   25680 2011-01-20 20:55:00	  27.06 33.9468398	   40		2.1
DNDN	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  34.93 36.6409669	38.85	       2.92
DTV	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  40.79 41.8055304	42.78		  1
DVN	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  77.06 80.2814972	84.15	       2.75
EBAY	2009-10-28 18:10:00	   25464 2011-01-14 20:55:00	  19.17  24.648826	31.48	       2.55
EFA	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  56.77 58.4886752	60.04	       1.37
EOG	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  91.02 96.5510884     103.13	       3.53
ESRX	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	  55.52 57.0152818	58.74	       1.32
EWZ	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	   75.2 77.1538343	78.95	       1.94
FCX	2011-01-04 14:30:00	     905 2011-01-20 18:20:00	 109.25 117.955398     122.49	       4.32
FDX	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	  92.12 94.1463962	96.98		2.4
FFIV	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	 106.37 138.311264     145.75	       5.47
FLS	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	  112.9 117.251032     121.04	       4.68
FSLR	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	 130.64 138.475956     148.51	       7.23
GDX	2011-01-04 14:30:00	     921 2011-01-20 19:40:00	  53.47 56.7520195	60.06	       1.54
GG	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	  39.85   42.64117	44.84	       1.26
GILD	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	  36.51 37.7015232	38.92	       1.14
GLD	2011-01-04 14:30:00	     924 2011-01-20 19:55:00	 131.11 133.917841     136.18	       1.14
GOOG	2009-10-28 18:10:00	   25932 2011-01-20 20:25:00	  434.6 548.977013     641.65	      63.83
GS	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	 164.12 171.297537	  175	       3.74
HD	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	  34.09 35.0638033	36.47		.99
HES	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	  77.11 79.7155841	 82.6	       3.75
HON	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	  53.03 54.3204415	55.65	       1.54
HPQ	2009-10-28 18:10:00	   25815 2011-01-20 18:25:00	  37.45 46.6235303	 54.7		3.4
IBM	2009-10-28 18:10:00	   25815 2011-01-20 20:30:00	 119.59 132.461056     155.95	       5.73
IOC	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	   68.9 75.7225748	77.99	       1.89
IWM	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  77.39 79.1977244	80.62	       1.65
JNJ	2011-01-04 14:30:00	     906 2011-01-20 18:25:00	  62.01 62.6424834	63.49		.89
JOYG	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  84.65 88.7377949	93.42	       3.14
JPM	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  42.77 44.3012348	45.91	       1.36
JWN	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  40.87 42.1059427	43.69	       1.14
KO	2011-01-04 14:30:00	     927 2011-01-20 20:10:00	   62.6 63.2653182	65.04	       1.01
LFT	2011-01-04 14:30:00	     913 2011-01-20 19:00:00	   32.5 34.4868565	   37	       1.43
MAR	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  39.97 41.0467842	42.01		.92
MCD	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  72.15 74.3243376	75.64	       1.64
MDT	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  36.18 36.8900937	37.76		.58
MDY	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	 163.62 166.912343     170.37		3.4
MEE	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  52.03 55.8617861	58.46	       2.64
MET	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  44.78 45.9890491	46.95	       1.25
MJN	2011-01-04 14:30:00	     911 2011-01-20 18:50:00	  60.37 61.9722503	63.29	       1.16
MMM	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  85.68 87.4730044	88.75	       1.85
MON	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  68.27 72.0056119	75.24	       4.04
MOS	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  71.87 78.2149835	85.45	       4.05
MRK	2011-01-04 14:30:00	     934 2011-01-20 20:45:00	  33.52 35.7339507	 37.6		.72
MT	2011-01-04 14:30:00	     907 2011-01-20 18:30:00	  34.22 35.9624201	 38.2	       1.57
NEM	2011-01-04 14:30:00	     920 2011-01-20 19:35:00	  54.42 57.1307446	60.22	       1.22
NFLX	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  176.3 185.444427     194.46	       9.82
NUE	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  42.81 44.2515363	45.23	       1.62
OIH	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	 135.78 141.248851     147.27	       4.76
OXY	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  94.33 96.8007599	 98.9	       2.52
PBR	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  35.88 36.9949449	38.46	       1.58
PEP	2011-01-04 14:30:00	     929 2011-01-20 20:20:00	  65.18 66.3980732	67.46	       1.56
PG	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  63.75 64.9268536	65.91	       1.12
PM	2011-01-04 14:30:00	     919 2011-01-20 19:30:00	  55.88 56.8812894	58.93		 .6
PNC	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  60.02 61.9634526	64.25	       3.13
POT	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	 153.56 166.241608     174.19	       7.96
PRU	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  59.41 60.8657985	62.32	       1.37
QCOM	2011-01-04 14:30:00	     929 2011-01-20 20:20:00	   49.9 51.9515554	53.06		2.3
QQQQ	2009-10-28 18:10:00	   26018 2011-01-20 19:25:00	   40.7 47.9680411	57.22		2.5
RIG	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  69.12 75.7472852	82.97	       5.25
RIMM	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  58.31 62.5465419	66.33		  3
SINA	2011-01-04 14:30:00	     908 2011-01-20 18:35:00	  72.55 80.5589923	89.97	       6.68
SJM	2011-01-04 14:30:00	     920 2011-01-20 19:35:00	   62.2 63.3944457	64.64	       1.07
SKX	2011-01-04 14:30:00	     923 2011-01-20 19:50:00	   19.3 20.7710997	21.97	       1.07
SLB	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	  79.84 83.2939714	87.53	       2.65
SLV	2011-01-04 14:30:00	     927 2011-01-20 20:10:00	  26.83 28.3399407	29.59		.63
SNDK	2011-01-04 14:30:00	     934 2011-01-20 20:45:00	  49.16 51.9391274	53.47		2.7
SPY	2009-10-28 18:10:00	   22267 2011-01-20 20:55:00	 103.18 115.821232	129.6		5.1
STT	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	  45.94  47.665374	50.22		2.1
SUN	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	  38.49 40.1949505	41.82	       1.29
TEVA	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	  52.03 53.6936249	54.64		1.8
TGT	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	   53.9 55.8775853	60.37	       1.67
TKR	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	  48.64  50.309637	51.98	       1.78
TLT	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  90.43 91.9899359	93.74	       1.77
UNH	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	  36.95 39.0205116	40.99	       1.47
UNP	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	     92 96.1123982	99.44	       3.77
UPS	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	  71.37 72.3851925	73.16		.96

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
V	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  58.75 71.9809817 79.2712693	 3.50373549
VECO	2011-01-04 14:30:00	     925 2011-01-20 20:00:00	  43.62 46.7931297	49.65	       2.41
VMW	2011-01-04 14:30:00	     917 2011-01-20 19:20:00	 86.585 90.7620719	95.94	       3.83
WDC	2011-01-04 14:30:00	     926 2011-01-20 20:05:00	  31.39 32.9316253	34.22		  1
WFMI	2011-01-04 14:30:00	     909 2011-01-20 18:40:00	  47.85 50.4365567	53.35	       2.66
WHR	2011-01-04 14:30:00	     910 2011-01-20 18:45:00	  85.27 87.8977253	90.71	       2.42
WMT	2009-10-28 18:10:00	   25790 2011-01-20 20:55:00	  47.76 53.1606796	56.23	       2.22
WYNN	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	 109.66 116.588515     120.95		5.2
X	2011-01-04 12:40:00	    1408 2011-01-20 18:45:00	 50.062 61.5957016	75.74	 3.94525055
XLB	2011-01-04 14:30:00	     916 2011-01-20 19:15:00	  37.25  38.497702     39.085		 .8
XLE	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  67.54 69.1465011	71.16	       1.56
XLU	2011-01-04 14:30:00	     936 2011-01-20 20:55:00	  31.23 31.5858814	32.06		.33
XOM	2009-10-28 18:10:00	   25938 2011-01-20 18:45:00	  56.05 66.8545548	78.92	       2.55

133 rows selected.

Elapsed: 00:00:00.31
06:05:29 SQL> 
06:05:29 SQL> COLUMN clse FORMAT 999.9999
06:05:29 SQL> SELECT
06:05:29   2  tkr
06:05:29   3  ,ROUND(clse,4)clse
06:05:29   4  -- Should be NULL:
06:05:29   5  ,ROUND(clse2,4)clse2
06:05:29   6  ,ydate
06:05:29   7  FROM di5min_stk_c2
06:05:29   8  WHERE ydate > sysdate - 0.5/24
06:05:29   9  ORDER BY tkr,ydate
06:05:29  10  /

no rows selected

Elapsed: 00:00:00.05
06:05:29 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
