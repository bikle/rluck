
SQL*Plus: Release 11.2.0.1.0 Production on Fri Jan 14 14:25:37 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

14:25:37 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
14:25:37 SQL> 14:25:37 SQL> --
14:25:37 SQL> -- update_di5min_stk.sql
14:25:37 SQL> --
14:25:37 SQL> 
14:25:37 SQL> -- I use this script to keep di5min_stk up to date.
14:25:37 SQL> 
14:25:37 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
14:25:37 SQL> -- After that date, it holds data from IB.
14:25:37 SQL> 
14:25:37 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
14:25:37 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
14:25:37 SQL> 
14:25:37 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.40
14:25:37 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.06
14:25:38 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.42
14:25:38 SQL> 
14:25:38 SQL> -- Copy in data from ibs5min:
14:25:38 SQL> 
14:25:38 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
14:25:38   2  SELECT	     tkr||ydate,tkr,ydate,clse
14:25:38   3  FROM ibs5min
14:25:38   4  WHERE ydate >= '2010-12-27 09:00:00'
14:25:38   5  /

82418 rows created.

Elapsed: 00:00:00.26
14:25:38 SQL> 
14:25:38 SQL> -- rpt
14:25:38 SQL> SELECT
14:25:38   2  tkr
14:25:38   3  ,MIN(ydate)
14:25:38   4  ,COUNT(tkr)
14:25:38   5  ,MAX(ydate)
14:25:38   6  FROM di5min_stk0
14:25:38   7  GROUP BY tkr
14:25:38   8  ORDER BY tkr
14:25:38   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
ABT	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ABX	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ADBE	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AEM	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AFL	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AIG	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AKAM	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ALL	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMGN	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMT	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMX	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMZN	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
APA	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
APC	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
ARG	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
AXP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BA	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BBT	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BBY	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BEN	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BHP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BIDU	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BRCM	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BTU	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BUCY	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CAT	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CELG	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CLF	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CMI	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
COF	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
COP	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
COST	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CREE	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CRM	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CSX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CTSH	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CVS	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CVX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DD	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DE	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DIA	2010-12-27 09:00:00	  2027 2011-01-12 20:55:00
DIS	2010-12-27 09:00:00	  1818 2011-01-12 20:55:00
DNDN	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DTV	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DVN	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EBAY	2010-12-27 09:00:00	  1840 2011-01-12 20:55:00
EFA	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EOG	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
ESRX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EWZ	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
FCX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
FDX	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FFIV	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FLS	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FSLR	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GDX	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GG	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GILD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GLD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GOOG	2010-12-27 09:00:00	  2176 2011-01-13 17:10:00
GS	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HES	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HON	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HPQ	2010-12-27 09:00:00	  1997 2011-01-13 20:55:00
IBM	2010-12-27 09:00:00	  1992 2011-01-13 20:55:00
IOC	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
IWM	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JNJ	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JOYG	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JPM	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JWN	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
KO	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
LFT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MAR	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MCD	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MDT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MDY	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MEE	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MET	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MJN	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MMM	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MON	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MOS	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MRK	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NEM	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NFLX	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NUE	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
OIH	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
OXY	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
PBR	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
PEP	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PG	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PNC	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
POT	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PRU	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
QCOM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
QQQQ	2010-12-27 09:00:00	  2036 2011-01-12 16:50:00
RIG	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
RIMM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
SINA	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SJM	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SKX	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SLB	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SLV	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SNDK	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SPY	2010-12-27 09:00:00	  2379 2011-01-12 20:55:00
STT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SUN	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TEVA	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TGT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TKR	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TLT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
UNH	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
UNP	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
UPS	2011-01-04 14:30:00	   498 2011-01-12 16:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
VECO	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
VMW	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WDC	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WFMI	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WHR	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WMT	2010-12-27 09:00:00	  1947 2011-01-12 16:55:00
WYNN	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
X	2011-01-04 12:40:00	  1008 2011-01-12 16:55:00
XLB	2011-01-04 14:30:00	   507 2011-01-12 17:40:00
XLE	2011-01-04 14:30:00	   507 2011-01-12 17:40:00
XLU	2011-01-04 14:30:00	   510 2011-01-12 17:55:00
XOM	2010-12-27 09:00:00	  2128 2011-01-12 18:15:00

133 rows selected.

Elapsed: 00:00:00.05
14:25:38 SQL> 
14:25:38 SQL> -- Next, copy in data from dukas.
14:25:38 SQL> -- dukas5min_stk depends on:
14:25:38 SQL> -- - dukas10min_stk
14:25:38 SQL> -- - svmspy/dukas/fake5.sql
14:25:38 SQL> 
14:25:38 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
14:25:38   2  SELECT	     tkr||ydate,tkr,ydate,clse
14:25:38   3  FROM dukas5min_stk
14:25:38   4  WHERE ydate < '2010-12-27 09:00:00'
14:25:38   5  /

230382 rows created.

Elapsed: 00:00:00.83
14:25:39 SQL> 
14:25:39 SQL> -- rpt
14:25:39 SQL> SELECT
14:25:39   2  tkr
14:25:39   3  ,MIN(ydate)
14:25:39   4  ,COUNT(tkr)
14:25:39   5  ,MAX(ydate)
14:25:39   6  FROM dukas5min_stk
14:25:39   7  WHERE ydate < '2010-12-27 09:00:00'
14:25:39   8  GROUP BY tkr
14:25:39   9  ORDER BY tkr
14:25:39  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
DIS	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
EBAY	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
GOOG	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
HPQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
IBM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
QQQQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
SPY	 2009-10-28 18:10:01	  19521 2010-12-24 20:50:01
WMT	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
XOM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01

10 rows selected.

Elapsed: 00:00:00.08
14:25:39 SQL> 
14:25:39 SQL> -- rpt
14:25:39 SQL> SELECT
14:25:39   2  tkr
14:25:39   3  ,MIN(ydate)
14:25:39   4  ,COUNT(tkr)
14:25:39   5  ,MAX(ydate)
14:25:39   6  FROM di5min_stk0
14:25:39   7  GROUP BY tkr
14:25:39   8  ORDER BY tkr
14:25:39   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
AAPL	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
ABT	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ABX	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ADBE	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AEM	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AFL	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AIG	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AKAM	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
ALL	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMGN	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMT	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMX	2011-01-04 14:30:00	   492 2011-01-12 16:25:00
AMZN	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
APA	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
APC	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
ARG	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
AXP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BA	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BBT	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BBY	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BEN	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BHP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BIDU	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BP	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BRCM	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BTU	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
BUCY	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CAT	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CELG	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CLF	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
CMI	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
COF	2011-01-04 14:30:00	   493 2011-01-12 16:30:00
COP	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
COST	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CREE	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CRM	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CSX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CTSH	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CVS	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
CVX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DD	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DE	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DIA	2009-10-28 18:10:01	 25456 2011-01-12 20:55:00
DIS	2009-10-28 18:10:01	 25247 2011-01-12 20:55:00
DNDN	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DTV	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
DVN	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EBAY	2009-10-28 18:10:01	 25269 2011-01-12 20:55:00
EFA	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EOG	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
ESRX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
EWZ	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
FCX	2011-01-04 14:30:00	   494 2011-01-12 16:35:00
FDX	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FFIV	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FLS	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
FSLR	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GDX	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GG	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GILD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GLD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
GOOG	2009-10-28 18:10:01	 25605 2011-01-13 17:10:00
GS	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HD	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HES	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HON	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
HPQ	2009-10-28 18:10:01	 25426 2011-01-13 20:55:00
IBM	2009-10-28 18:10:01	 25421 2011-01-13 20:55:00
IOC	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
IWM	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JNJ	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JOYG	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JPM	2011-01-04 14:30:00	   495 2011-01-12 16:40:00
JWN	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
KO	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
LFT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MAR	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MCD	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MDT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MDY	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MEE	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MET	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MJN	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MMM	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MON	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MOS	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MRK	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
MT	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NEM	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NFLX	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
NUE	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
OIH	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
OXY	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
PBR	2011-01-04 14:30:00	   496 2011-01-12 16:45:00
PEP	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PG	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PNC	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
POT	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
PRU	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
QCOM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
QQQQ	2009-10-28 18:10:01	 25465 2011-01-12 16:50:00
RIG	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
RIMM	2011-01-04 14:30:00	   497 2011-01-12 16:50:00
SINA	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SJM	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SKX	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SLB	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SLV	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SNDK	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SPY	2009-10-28 18:10:01	 21900 2011-01-12 20:55:00
STT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
SUN	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TEVA	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TGT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TKR	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
TLT	2011-01-04 14:30:00	   546 2011-01-12 20:55:00
UNH	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
UNP	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
UPS	2011-01-04 14:30:00	   498 2011-01-12 16:55:00

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
V	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
VECO	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
VMW	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WDC	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WFMI	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WHR	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
WMT	2009-10-28 18:10:01	 25376 2011-01-12 16:55:00
WYNN	2011-01-04 14:30:00	   498 2011-01-12 16:55:00
X	2011-01-04 12:40:00	  1008 2011-01-12 16:55:00
XLB	2011-01-04 14:30:00	   507 2011-01-12 17:40:00
XLE	2011-01-04 14:30:00	   507 2011-01-12 17:40:00
XLU	2011-01-04 14:30:00	   510 2011-01-12 17:55:00
XOM	2009-10-28 18:10:01	 25557 2011-01-12 18:15:00

133 rows selected.

Elapsed: 00:00:00.13
14:25:39 SQL> 
14:25:39 SQL> CREATE TABLE di5min_stk COMPRESS AS
14:25:39   2  SELECT
14:25:39   3  tkrdate
14:25:39   4  ,tkr
14:25:39   5  ,ydate
14:25:39   6  ,AVG(clse)clse
14:25:39   7  FROM di5min_stk0
14:25:39   8  -- I want weekdays:
14:25:39   9  WHERE 0+TO_CHAR(ydate,'D')IN(2,3,4,5,6)
14:25:39  10  GROUP BY
14:25:39  11  tkrdate
14:25:39  12  ,tkr
14:25:39  13  ,ydate
14:25:39  14  /

Table created.

Elapsed: 00:00:01.47
14:25:41 SQL> 
14:25:41 SQL> -- I need to shave a second off of some of the dates:
14:25:41 SQL> 
14:25:41 SQL> UPDATE di5min_stk SET ydate = ydate - 1/24/3600
14:25:41   2  WHERE TO_CHAR(ydate,'SS')='01'
14:25:41   3  /

230382 rows updated.

Elapsed: 00:00:07.09
14:25:48 SQL> 
14:25:48 SQL> SELECT COUNT(*)FROM di5min_stk;

  COUNT(*)
----------
    312620

Elapsed: 00:00:00.02
14:25:48 SQL> SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='00';

  COUNT(*)
----------
    312620

Elapsed: 00:00:00.09
14:25:48 SQL> SELECT COUNT(*)FROM di5min_stk WHERE TO_CHAR(ydate,'SS')='01';

  COUNT(*)
----------
	 0

Elapsed: 00:00:00.09
14:25:48 SQL> 
14:25:48 SQL> UPDATE di5min_stk SET tkrdate = tkr||ydate;

312620 rows updated.

Elapsed: 00:00:09.82
14:25:58 SQL> 
14:25:58 SQL> -- Add a column to help join with future dates
14:25:58 SQL> -- and then calculate 1 day gain:
14:25:58 SQL> DROP TABLE   di5min_stk_fd;

Table dropped.

Elapsed: 00:00:19.33
14:26:17 SQL> CREATE TABLE di5min_stk_fd COMPRESS AS
14:26:17   2  SELECT
14:26:17   3  tkrdate
14:26:17   4  ,tkr
14:26:17   5  ,ydate
14:26:17   6  ,clse
14:26:17   7  ,CASE WHEN TO_CHAR(ydate,'dy')IN('mon','tue','wed','thu')THEN ydate+1
14:26:17   8  	    WHEN TO_CHAR(ydate,'dy')IN('fri')THEN ydate+3
14:26:17   9  	    ELSE NULL END selldate
14:26:17  10  FROM di5min_stk
14:26:17  11  /

Table created.

Elapsed: 00:00:00.84
14:26:18 SQL> 
14:26:18 SQL> -- Join with the future
14:26:18 SQL> 
14:26:18 SQL> DROP   TABLE di5min_stk_c2;

Table dropped.

Elapsed: 00:00:12.54
14:26:31 SQL> 
14:26:31 SQL> CREATE TABLE di5min_stk_c2 COMPRESS AS
14:26:31   2  SELECT
14:26:31   3  p.tkrdate
14:26:31   4  ,p.tkr
14:26:31   5  ,p.ydate
14:26:31   6  ,p.clse
14:26:31   7  ,p.selldate
14:26:31   8  ,f.clse clse2
14:26:31   9  ,f.clse - p.clse gain1day
14:26:31  10  FROM di5min_stk_fd p, di5min_stk f
14:26:31  11  -- Use a left-outer-join so I get recent rows in di5min_stk_fd:
14:26:31  12  WHERE p.tkr || p.selldate = f.tkrdate(+)
14:26:31  13  /

Table created.

Elapsed: 00:00:01.52
14:26:32 SQL> 
14:26:32 SQL> -- rpt
14:26:32 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_fd group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 59819
tue	 69447
thu	 60086
wed	 63572
mon	 59696

Elapsed: 00:00:00.20
14:26:32 SQL> SELECT TO_CHAR(ydate,'dy')dday,COUNT(tkr) FROM di5min_stk_c2 group by TO_CHAR(ydate,'dy');

DDA COUNT(TKR)
--- ----------
fri	 59819
tue	 69447
thu	 60086
wed	 63572
mon	 59696

Elapsed: 00:00:00.23
14:26:33 SQL> SELECT MAX(ydate)FROM di5min_stk;

MAX(YDATE)
-------------------
2011-01-13 20:55:00

Elapsed: 00:00:00.03
14:26:33 SQL> SELECT MAX(ydate)FROM di5min_stk_c2;

MAX(YDATE)
-------------------
2011-01-13 20:55:00

Elapsed: 00:00:00.02
14:26:33 SQL> 
14:26:33 SQL> -- rpt
14:26:33 SQL> SELECT
14:26:33   2  tkr
14:26:33   3  ,MIN(ydate)
14:26:33   4  ,COUNT(ydate)
14:26:33   5  ,MAX(ydate)
14:26:33   6  ,MIN(clse)
14:26:33   7  ,AVG(clse)
14:26:33   8  ,MAX(clse)
14:26:33   9  ,MAX(gain1day)
14:26:33  10  FROM di5min_stk_c2
14:26:33  11  GROUP BY tkr
14:26:33  12  ORDER BY tkr
14:26:33  13  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
AAPL	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	 328.28  336.81239     344.42	       9.63
ABT	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  47.62 48.1227033	48.76		.91
ABX	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  48.74 49.8340041	52.33		1.2
ADBE	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	   31.3 32.1806301	33.43	       1.15
AEM	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  68.98 71.2691463	72.67	       2.78
AFL	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  54.89 56.1022764	57.51	       1.84
AIG	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  56.13 59.4867276	62.47		4.8
AKAM	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  46.85  48.406565	49.52	       2.39
ALL	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	   30.7 31.4721341	32.18		 .6
AMGN	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	  55.99 56.6660976	57.18		.89
AMT	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	   50.1 50.8061585	52.16		.48
AMX	2011-01-04 14:30:00	     492 2011-01-12 16:25:00	   57.5 58.6197154	59.58	       1.19
AMZN	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	 182.72 185.185152	188.4		2.7
APA	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  119.6 123.240243     126.76	       4.04
APC	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	   73.1 75.2969168	 78.4	       3.94
ARG	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  63.18  63.589716	63.92		.51
AXP	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  43.29 44.6054361	 45.7	       1.52
BA	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  66.51 68.4897566	   70		2.6
BBT	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	     26  26.762069	27.67		.97
BBY	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  34.65 35.3933063	36.18	       1.29
BEN	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	 109.71 112.480406     117.81	       5.04
BHP	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  87.68 89.5581744	 92.7	       1.58
BIDU	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  99.53  104.48856     107.21	       4.15
BP	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	   45.2 46.2832049	47.58	       1.51
BRCM	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  42.11  44.621643	46.18	       2.09
BTU	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	     61 62.4165517	65.57	       2.87
BUCY	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  89.67 89.9349493	90.18		.24
CAT	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  92.37 93.8201217	94.67	       2.25
CELG	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	   56.3 58.5657606	59.69	       1.56
CLF	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  80.23 83.6195132	89.05	       5.53
CMI	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	 109.01  111.35712     113.59	       4.34
COF	2011-01-04 14:30:00	     493 2011-01-12 16:30:00	  43.23 45.2137525	 47.3	       1.95
COP	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  66.58 67.4037854	68.83	       1.35
COST	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  70.07 71.0901417	72.43		.91
CREE	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  65.69 67.5410931	 68.7	       2.11
CRM	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	 133.57 140.562551     144.69	       8.23
CSX	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  64.81 66.8443927	68.76	       1.63
CTSH	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	   73.6  75.203664	76.34	       2.16
CVS	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  34.41 35.1669636	35.94		.59
CVX	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  90.21 91.1999393	92.68	       1.64
DD	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  47.28 49.4751417	50.53	       1.82
DE	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  81.82 84.4147368	87.68	       2.37
DIA	2009-10-28 18:10:00	   25444 2011-01-12 20:55:00	  96.34 106.832413     117.63	       4.35
DIS	2009-10-28 18:10:00	   25235 2011-01-12 20:55:00	  27.06 33.8531192	   40		2.1
DNDN	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  34.93 36.5573077	38.85	       2.92
DTV	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  40.79 41.4681984	42.15		  1
DVN	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  77.06 78.5388462	81.55	       2.75
EBAY	2009-10-28 18:10:00	   25257 2011-01-12 20:55:00	  19.17 24.6165226	31.48	       2.55
EFA	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  56.77 57.7751619	 58.9	       1.05
EOG	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  91.02 93.7637045	98.42	       3.04
ESRX	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  55.52 56.4063968	57.34	       1.32
EWZ	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  75.21 76.9155668	78.61	       1.84
FCX	2011-01-04 14:30:00	     494 2011-01-12 16:35:00	  115.2 118.118239     122.49	       4.32
FDX	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  92.12 93.4466465	94.96	       2.17
FFIV	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  131.7 138.271192     143.35	       5.47
FLS	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  114.8 117.412525     121.04	       4.68
FSLR	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	 130.64 134.477232     139.82	       3.75
GDX	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  56.39 57.6105859	60.06	       1.54
GG	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  42.59 43.5820404	44.84	       1.26
GILD	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  36.51 37.2862828	37.78		.91
GLD	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  133.2 134.218727     136.18	       1.14
GOOG	2009-10-28 18:10:00	   25581 2011-01-13 17:10:00	  434.6 547.892989     629.82	      63.83
GS	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	 168.42 171.563616     174.44	       2.12
HD	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  34.09 34.6028081	35.55		.99
HES	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  77.11 78.9071919	81.58	       3.75
HON	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  53.03 54.0334141	54.75	       1.54
HPQ	2009-10-28 18:10:00	   25414 2011-01-13 20:55:00	  37.45 46.6347008	 54.7		3.4
IBM	2009-10-28 18:10:00	   25409 2011-01-13 20:55:00	 119.59 132.158356     150.76	       5.73
IOC	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  75.02 76.4193333	77.99	       1.89
IWM	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  77.55 78.8835758	80.11	       1.65
JNJ	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  62.01 62.7407677	63.49		.69
JOYG	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  84.65 87.3982424	89.12	       3.14
JPM	2011-01-04 14:30:00	     495 2011-01-12 16:40:00	  42.77 43.9445859	44.93	       1.36
JWN	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  41.44 42.4267339	43.69	       1.14
KO	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	   62.6 63.2427016	65.04		 .7
LFT	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  34.15 35.2667742	   37	       1.43
MAR	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  40.17 41.0109677	   42		.73
MCD	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  73.53 74.3432661	75.64		.72
MDT	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  36.18 36.5802016	37.34		.35
MDY	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	 163.62 165.844355     168.19		3.4
MEE	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  53.71 55.9048387	57.88	       2.64
MET	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  45.07 45.9727823	46.84	       1.25
MJN	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  60.37 61.4904234	62.43	       1.16
MMM	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  85.68 86.9618548	88.58	       1.85
MON	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  68.27 70.8098387	74.97	       4.04
MOS	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  73.65  76.359879	78.64	       3.45
MRK	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  35.88 36.8222177	 37.6		.72
MT	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  34.22 35.8901815	 38.2	       1.41
NEM	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	   56.4 57.8595363	60.22	       1.22
NFLX	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  176.3 181.994597     190.78	       9.82
NUE	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  42.81 44.0185081	45.18	       1.62
OIH	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	 135.78 138.526794     144.21	       4.76
OXY	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  94.33 96.3764315	 98.4	       2.52
PBR	2011-01-04 14:30:00	     496 2011-01-12 16:45:00	  36.01 36.7145161	37.84	       1.13
PEP	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  65.18 66.2751107	67.04	       1.56
PG	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  63.75 64.4740241	65.05		.75
PM	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  55.88 57.2521328	58.93		.52
PNC	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  60.16 61.6100805	63.11	       2.13
POT	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	 153.56 163.537304     169.45	       7.96
PRU	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  59.41  60.673662	61.48	       1.07
QCOM	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	   49.9 51.8405433	52.97		2.3
QQQQ	2009-10-28 18:10:00	   25453 2011-01-12 16:50:00	   40.7 47.7795792	 56.5		2.5
RIG	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  69.12 73.2655332	77.73	       5.25
RIMM	2011-01-04 14:30:00	     497 2011-01-12 16:50:00	  58.31 61.0147284	63.61		  3
SINA	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  72.55 77.4544048	83.63	       6.68
SJM	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	   62.2 63.2082051	64.54	       1.07
SKX	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	   19.3 20.3014377	21.17		.96
SLB	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  79.84  81.790348	84.47	       2.65
SLV	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  27.95 28.6104121	29.59		.63
SNDK	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  49.78  52.164652	53.47		2.7
SPY	2009-10-28 18:10:00	   21876 2011-01-12 20:55:00	 103.18 115.592737	128.7		5.1
STT	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  45.94 46.9809615	48.06	       1.18
SUN	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  38.49 39.9692674	 41.6	       1.27
TEVA	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  52.03 53.4694231	54.56		1.8
TGT	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  54.39 56.4292582	60.37		.72
TKR	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  48.64  49.980293	51.72	       1.78
TLT	2011-01-04 14:30:00	     546 2011-01-12 20:55:00	  91.05 92.2156685	93.74	       1.77
UNH	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  36.95 38.1360643	39.19		.89
UNP	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	     92 94.7317269	98.53	       3.77
UPS	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  71.37 72.3531526	73.06		.78

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE) MAX(GAIN1DAY)
------- ------------------- ------------ ------------------- ---------- ---------- ---------- -------------
V	2011-01-04 14:30:00	     498 2011-01-12 16:55:00 68.2966667 70.8742102	72.45	 2.05333333
VECO	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  43.62 46.1702811	 49.1	       2.41
VMW	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  90.62 94.3516466	96.23	       3.83
WDC	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  31.83 32.8940562	34.22		  1
WFMI	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	  47.85 48.8464056	 50.7	       2.15
WHR	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	   86.1     88.345	90.71	       2.42
WMT	2009-10-28 18:10:00	   25352 2011-01-12 16:55:00	  47.76 53.1264887	56.15	       2.22
WYNN	2011-01-04 14:30:00	     498 2011-01-12 16:55:00	 109.66 115.579357     119.37		5.2
X	2011-01-04 12:40:00	     996 2011-01-12 16:55:00	 47.735 64.6581325	75.74	       3.95
XLB	2011-01-04 14:30:00	     507 2011-01-12 17:40:00	  37.74 38.4344872     39.085		 .8
XLE	2011-01-04 14:30:00	     507 2011-01-12 17:40:00	  67.54 68.3010552	70.12	       1.56
XLU	2011-01-04 14:30:00	     510 2011-01-12 17:55:00	  31.23 31.4534412	31.76		.29
XOM	2009-10-28 18:10:00	   25533 2011-01-12 18:15:00	  56.05 66.6858747	 76.5	       2.55

133 rows selected.

Elapsed: 00:00:00.24
14:26:33 SQL> 
14:26:33 SQL> COLUMN clse FORMAT 999.9999
14:26:33 SQL> SELECT
14:26:33   2  tkr
14:26:33   3  ,ROUND(clse,4)clse
14:26:33   4  -- Should be NULL:
14:26:33   5  ,ROUND(clse2,4)clse2
14:26:33   6  ,ydate
14:26:33   7  FROM di5min_stk_c2
14:26:33   8  WHERE ydate > sysdate - 0.5/24
14:26:33   9  ORDER BY tkr,ydate
14:26:33  10  /

no rows selected

Elapsed: 00:00:00.05
14:26:33 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
