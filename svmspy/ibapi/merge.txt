
SQL*Plus: Release 11.2.0.1.0 Production on Fri Feb 11 23:17:14 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

23:17:14 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
23:17:14 SQL> 
23:17:14 SQL> 23:17:14 SQL> --
23:17:14 SQL> -- merge.sql
23:17:14 SQL> --
23:17:14 SQL> 
23:17:14 SQL> -- I use this script to merge data from ibs_stage into ibs5min.
23:17:14 SQL> 
23:17:14 SQL> 
23:17:14 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
23:17:14 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
23:17:14 SQL> 
23:17:14 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.06
23:17:14 SQL> RENAME ibs5min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.03
23:17:14 SQL> 
23:17:14 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.09
23:17:14 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.04
23:17:14 SQL> 
23:17:14 SQL> CREATE TABLE ibs_dups COMPRESS AS
23:17:14   2  SELECT
23:17:14   3  tkr
23:17:14   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
23:17:14   5  ,clse
23:17:14   6  FROM ibs_stage
23:17:14   7  UNION
23:17:14   8  SELECT tkr,ydate,clse
23:17:14   9  FROM ibs_old
23:17:14  10  /

Table created.

Elapsed: 00:00:01.11
23:17:16 SQL> 
23:17:16 SQL> CREATE TABLE ibs5min COMPRESS AS
23:17:16   2  SELECT
23:17:16   3  tkr
23:17:16   4  ,ydate
23:17:16   5  ,AVG(clse)clse
23:17:16   6  FROM ibs_dups
23:17:16   7  GROUP BY tkr,ydate
23:17:16   8  /

Table created.

Elapsed: 00:00:00.83
23:17:16 SQL> 
23:17:16 SQL> ANALYZE TABLE ibs5min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:01.68
23:17:18 SQL> 
23:17:18 SQL> -- I should see less than 60 min:
23:17:18 SQL> SELECT
23:17:18   2  tkr
23:17:18   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
23:17:18   4  ,MIN(ydate)
23:17:18   5  ,COUNT(ydate)
23:17:18   6  ,MAX(ydate)FROM
23:17:18   7  ibs5min
23:17:18   8  GROUP BY tkr
23:17:18   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
AKAM	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
APA	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
APC	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
AXP	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
BP	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
BTU	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
CAT	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
CVS	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
GD	       142.3 2011-01-28 14:30:00	  858 2011-02-11 20:55:00
HL	       142.3 2011-01-18 12:30:00	 1584 2011-02-11 20:55:00
MAR	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MDT	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
QQQQ	       142.3 2010-12-27 09:00:00	 3867 2011-02-11 20:55:00
SINA	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
SLW	       142.3 2011-01-21 14:30:00	 1248 2011-02-11 20:55:00
SPY	       142.3 2010-12-27 09:00:00	 4018 2011-02-11 20:55:00
SVM	       142.3 2011-01-21 14:30:00	 1609 2011-02-11 20:55:00
V	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
VECO	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
WDC	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
XOM	      1582.3 2010-12-27 09:00:00	 4076 2011-02-10 20:55:00
AFL	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
AMT	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
AXU	      1582.3 2011-01-21 14:30:00	 1170 2011-02-10 20:55:00
CTSH	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
GFI	       142.3 2011-01-28 14:30:00	  858 2011-02-11 20:55:00
IOC	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
JPM	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
SKX	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
SLB	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
STT	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
UNH	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
UNP	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
AIG	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
BBY	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
CDE	       142.3 2011-01-21 14:30:00	 1248 2011-02-11 20:55:00
CSX	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
CVX	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
DD	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
EOG	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
FCX	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
FSLR	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
HD	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
HON	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
IBM	       142.3 2010-12-27 09:00:00	 3651 2011-02-11 20:55:00
IWM	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MEE	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
NFLX	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
PRU	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
UPS	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
WHR	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
XLB	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
XLE	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
BEN	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
CHK	       142.3 2011-01-24 14:30:00	 1170 2011-02-11 20:55:00
CMI	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
COST	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
DTV	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
ESRX	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
GG	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
HPQ	       142.3 2010-12-27 09:00:00	 3676 2011-02-11 20:55:00
KO	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MDY	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MET	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MVG	      1582.3 2011-01-21 14:30:00	 1169 2011-02-10 20:55:00
NOC	      1582.3 2011-01-28 14:30:00	  780 2011-02-10 20:55:00
PAAS	       142.3 2011-01-21 14:30:00	 1248 2011-02-11 20:55:00
PALL	       142.3 2011-01-21 14:30:00	 1248 2011-02-11 20:55:00
PNC	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
SJM	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
SNDK	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
SUN	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
SWC	       142.3 2011-01-19 14:30:00	 1404 2011-02-11 20:55:00
TGT	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
TKR	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
XLU	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
ABT	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
AMGN	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
AMZN	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
BHP	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
COF	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
DNDN	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
EBAY	       142.3 2010-12-27 09:00:00	 3548 2011-02-11 20:55:00
EXK	       142.3 2011-01-21 14:30:00	 1248 2011-02-11 20:55:00
FDX	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
GLD	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
JNJ	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
LFT	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MOS	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
NEM	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
OXY	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
PEP	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
PG	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
RIG	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
AGU	       142.3 2011-01-24 14:30:00	 1170 2011-02-11 20:55:00
BA	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
BBT	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
BIDU	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
BRCM	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
CELG	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
CREE	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
DE	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
DIS	      1582.3 2010-12-27 09:00:00	 3433 2011-02-10 20:55:00
EWZ	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
FFIV	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
GDX	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
GILD	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
GOOG	      1582.3 2010-12-27 09:00:00	 3703 2011-02-10 20:55:00
GS	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
HES	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MMM	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MON	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MT	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
PBR	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
PM	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
POT	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
RDY	      1582.3 2011-01-24 14:30:00	 1092 2011-02-10 20:55:00
SCCO	       142.3 2011-01-24 14:30:00	 1170 2011-02-11 20:55:00
TEVA	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
TLT	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
VMW	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
WFMI	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
X	       142.3 2011-01-04 12:40:00	 2694 2011-02-11 20:55:00
AAPL	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
ALL	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
BUCY	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
CEO	      1582.3 2011-01-24 14:30:00	 1092 2011-02-10 20:55:00
CRM	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
DVN	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
FLS	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
JOYG	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
LMT	      1582.3 2011-01-28 14:30:00	  780 2011-02-10 20:55:00
NUE	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
PPLT	       142.3 2011-01-21 14:30:00	 1245 2011-02-11 20:55:00
QCOM	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
SLV	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
SOHU	       142.3 2011-01-24 14:30:00	 1170 2011-02-11 20:55:00
VALE	       142.3 2011-01-24 14:30:00	 1170 2011-02-11 20:55:00
ABX	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
AEM	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
AMX	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
ARG	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
CLF	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
COP	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
DIA	       142.3 2010-12-27 09:00:00	 3759 2011-02-11 20:55:00
EFA	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
JWN	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
MCD	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
MJN	      1582.3 2011-01-04 14:30:00	 2106 2011-02-10 20:55:00
MRK	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
OIH	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
RIMM	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00
RTN	       142.3 2011-01-28 14:30:00	  858 2011-02-11 20:55:00
WMT	       142.3 2010-12-27 09:00:00	 3633 2011-02-11 20:55:00
WYNN	       142.3 2011-01-04 14:30:00	 2184 2011-02-11 20:55:00

156 rows selected.

Elapsed: 00:00:00.12
23:17:18 SQL> 
23:17:18 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
