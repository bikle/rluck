
SQL*Plus: Release 11.2.0.1.0 Production on Thu Jan 6 15:40:46 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

15:40:46 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
15:40:46 SQL> 15:40:46 SQL> --
15:40:46 SQL> -- update_di5min_stk.sql
15:40:46 SQL> --
15:40:46 SQL> 
15:40:46 SQL> -- I use this script to keep di5min_stk up to date.
15:40:46 SQL> 
15:40:46 SQL> -- The table, di5min_stk, contains data from duakas before '2010-12-27 09:00:00'
15:40:46 SQL> -- After that date, it holds data from IB.
15:40:46 SQL> 
15:40:46 SQL> -- CREATE TABLE di5min_stk0(tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
15:40:46 SQL> -- CREATE TABLE di5min_stk (tkrdate VARCHAR2(26),tkr VARCHAR2(7),ydate DATE,clse NUMBER);
15:40:46 SQL> 
15:40:46 SQL> TRUNCATE TABLE di5min_stk0;

Table truncated.

Elapsed: 00:00:00.21
15:40:47 SQL> DROP TABLE di5min_stk;

Table dropped.

Elapsed: 00:00:00.05
15:40:47 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.44
15:40:47 SQL> 
15:40:47 SQL> -- Copy in data from ibs5min:
15:40:47 SQL> 
15:40:47 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
15:40:47   2  SELECT	     tkr||ydate,tkr,ydate,clse
15:40:47   3  FROM ibs5min
15:40:47   4  WHERE ydate >= '2010-12-27 09:00:00'
15:40:47   5  /

12673 rows created.

Elapsed: 00:00:00.07
15:40:47 SQL> 
15:40:47 SQL> -- rpt
15:40:47 SQL> SELECT
15:40:47   2  tkr
15:40:47   3  ,MIN(ydate)
15:40:47   4  ,COUNT(tkr)
15:40:47   5  ,MAX(ydate)
15:40:47   6  FROM di5min_stk0
15:40:47   7  GROUP BY tkr
15:40:47   8  ORDER BY tkr
15:40:47   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
DIA	2010-12-27 09:00:00	  1400 2011-01-05 21:25:00
DIS	2010-12-27 09:00:00	  1018 2011-01-03 20:50:00
EBAY	2010-12-27 09:00:00	  1044 2011-01-03 20:55:00
GOOG	2010-12-27 09:00:00	  1409 2011-01-06 15:35:00
HPQ	2010-12-27 09:00:00	  1059 2011-01-03 21:00:00
IBM	2010-12-27 09:00:00	  1347 2011-01-06 15:30:00
QQQQ	2010-12-27 09:00:00	  1101 2011-01-03 20:45:00
SPY	2010-12-27 09:00:00	  1617 2011-01-06 15:40:00
WMT	2010-12-27 09:00:00	  1305 2011-01-06 15:20:00
XOM	2010-12-27 09:00:00	  1373 2011-01-06 15:25:00

10 rows selected.

Elapsed: 00:00:00.02
15:40:47 SQL> 
15:40:47 SQL> -- Next, copy in data from dukas.
15:40:47 SQL> -- dukas5min_stk depends on:
15:40:47 SQL> -- - dukas10min_stk
15:40:47 SQL> -- - svmspy/dukas/fake5.sql
15:40:47 SQL> 
15:40:47 SQL> INSERT INTO di5min_stk0(tkrdate,tkr,ydate,clse)
15:40:47   2  SELECT	     tkr||ydate,tkr,ydate,clse
15:40:47   3  FROM dukas5min_stk
15:40:47   4  WHERE ydate < '2010-12-27 09:00:00'
15:40:47   5  /

230382 rows created.

Elapsed: 00:00:01.57
15:40:49 SQL> 
15:40:49 SQL> -- rpt
15:40:49 SQL> SELECT
15:40:49   2  tkr
15:40:49   3  ,MIN(ydate)
15:40:49   4  ,COUNT(tkr)
15:40:49   5  ,MAX(ydate)
15:40:49   6  FROM dukas5min_stk
15:40:49   7  WHERE ydate < '2010-12-27 09:00:00'
15:40:49   8  GROUP BY tkr
15:40:49   9  ORDER BY tkr
15:40:49  10  /

TKR	 MIN(YDATE)	     COUNT(TKR) MAX(YDATE)
-------- ------------------- ---------- -------------------
DIA	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
DIS	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
EBAY	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
GOOG	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
HPQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
IBM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
QQQQ	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
SPY	 2009-10-28 18:10:01	  19521 2010-12-24 20:50:01
WMT	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01
XOM	 2009-10-28 18:10:01	  23429 2010-12-24 20:50:01

10 rows selected.

Elapsed: 00:00:00.19
15:40:49 SQL> 
15:40:49 SQL> -- rpt
15:40:49 SQL> SELECT
15:40:49   2  tkr
15:40:49   3  ,MIN(ydate)
15:40:49   4  ,COUNT(tkr)
15:40:49   5  ,MAX(ydate)
15:40:49   6  FROM di5min_stk0
15:40:49   7  GROUP BY tkr
15:40:49   8  ORDER BY tkr
15:40:49   9  /

TKR	MIN(YDATE)	    COUNT(TKR) MAX(YDATE)
------- ------------------- ---------- -------------------
DIA	2009-10-28 18:10:01	 24829 2011-01-05 21:25:00
DIS	2009-10-28 18:10:01	 24447 2011-01-03 20:50:00
EBAY	2009-10-28 18:10:01	 24473 2011-01-03 20:55:00
GOOG	2009-10-28 18:10:01	 24838 2011-01-06 15:35:00
HPQ	2009-10-28 18:10:01	 24488 2011-01-03 21:00:00
IBM	2009-10-28 18:10:01	 24776 2011-01-06 15:30:00
QQQQ	2009-10-28 18:10:01	 24530 2011-01-03 20:45:00
SPY	2009-10-28 18:10:01	 21138 2011-01-06 15:40:00
WMT	2009-10-28 18:10:01	 24734 2011-01-06 15:20:00
XOM	2009-10-28 18:10:01	 24802 2011-01-06 15:25:00

10 rows selected.

Elapsed: 00:00:00.16
15:40:49 SQL> 
15:40:49 SQL> CREATE TABLE di5min_stk COMPRESS AS
15:40:49   2  SELECT
15:40:49   3  tkrdate
15:40:49   4  ,tkr
15:40:49   5  ,ydate
15:40:49   6  ,AVG(clse)clse
15:40:49   7  FROM di5min_stk0
15:40:49   8  GROUP BY
15:40:49   9  tkrdate
15:40:49  10  ,tkr
15:40:49  11  ,ydate
15:40:49  12  /

Table created.

Elapsed: 00:00:03.58
15:40:53 SQL> 
15:40:53 SQL> -- rpt
15:40:53 SQL> SELECT
15:40:53   2  tkr
15:40:53   3  ,MIN(ydate)
15:40:53   4  ,COUNT(ydate)
15:40:53   5  ,MAX(ydate)
15:40:53   6  ,MIN(clse)
15:40:53   7  ,AVG(clse)
15:40:53   8  ,MAX(clse)
15:40:53   9  FROM di5min_stk
15:40:53  10  GROUP BY tkr
15:40:53  11  ORDER BY tkr
15:40:53  12  /

TKR	MIN(YDATE)	    COUNT(YDATE) MAX(YDATE)	      MIN(CLSE)  AVG(CLSE)  MAX(CLSE)
------- ------------------- ------------ ------------------- ---------- ---------- ----------
DIA	2009-10-28 18:10:01	   24829 2011-01-05 21:25:00	  96.34 106.587212     117.16
DIS	2009-10-28 18:10:01	   24447 2011-01-03 20:50:00	  27.06 33.6776755	37.99
EBAY	2009-10-28 18:10:01	   24473 2011-01-03 20:55:00	  19.17 24.4945111	31.48
GOOG	2009-10-28 18:10:01	   24838 2011-01-06 15:35:00	  434.6 545.906521     629.82
HPQ	2009-10-28 18:10:01	   24488 2011-01-03 21:00:00	  37.45 46.7125715	 54.7
IBM	2009-10-28 18:10:01	   24776 2011-01-06 15:30:00	 119.59 131.752109     150.76
QQQQ	2009-10-28 18:10:01	   24530 2011-01-03 20:45:00	   40.7 47.4824999	55.66
SPY	2009-10-28 18:10:01	   21138 2011-01-06 15:40:00	 103.18  115.18487     128.04
WMT	2009-10-28 18:10:01	   24734 2011-01-06 15:20:00	  47.76 53.1032377	56.15
XOM	2009-10-28 18:10:01	   24802 2011-01-06 15:25:00	  56.05 66.4314381	 76.5

10 rows selected.

Elapsed: 00:00:04.07
15:40:57 SQL> 
15:40:57 SQL> COLUMN clse FORMAT 999.9999
15:40:57 SQL> SELECT
15:40:57   2  tkr
15:40:57   3  ,ROUND(clse,4)clse
15:40:57   4  ,ydate
15:40:57   5  FROM di5min_stk
15:40:57   6  WHERE ydate > sysdate - 0.5/24
15:40:57   7  ORDER BY tkr,ydate
15:40:57   8  /

TKR	     CLSE YDATE
------- --------- -------------------
GOOG	 617.4300 2011-01-06 15:15:00
GOOG	 617.8100 2011-01-06 15:20:00
GOOG	 617.6200 2011-01-06 15:25:00
GOOG	 617.1900 2011-01-06 15:30:00
GOOG	 617.0100 2011-01-06 15:35:00
IBM	 148.0800 2011-01-06 15:15:00
IBM	 148.2800 2011-01-06 15:20:00
IBM	 148.3000 2011-01-06 15:25:00
IBM	 148.3000 2011-01-06 15:30:00
SPY	 127.5400 2011-01-06 15:15:00
SPY	 127.6700 2011-01-06 15:20:00
SPY	 127.6800 2011-01-06 15:25:00
SPY	 127.7400 2011-01-06 15:30:00
SPY	 127.8200 2011-01-06 15:35:00
SPY	 127.7800 2011-01-06 15:40:00
WMT	  53.9000 2011-01-06 15:15:00
WMT	  53.9200 2011-01-06 15:20:00
XOM	  75.1600 2011-01-06 15:15:00
XOM	  75.2300 2011-01-06 15:20:00
XOM	  75.2500 2011-01-06 15:25:00

20 rows selected.

Elapsed: 00:00:00.05
15:40:57 SQL> Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
