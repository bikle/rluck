
SQL*Plus: Release 11.2.0.1.0 Production on Wed Mar 9 02:34:33 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

02:34:33 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
02:34:33 SQL> 02:34:33 SQL> --
02:34:33 SQL> -- merge.sql
02:34:33 SQL> --
02:34:33 SQL> 
02:34:33 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
02:34:33 SQL> 
02:34:33 SQL> 
02:34:33 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
02:34:33 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
02:34:33 SQL> 
02:34:33 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.15
02:34:33 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.10
02:34:33 SQL> 
02:34:33 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.11
02:34:33 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.09
02:34:33 SQL> 
02:34:33 SQL> CREATE TABLE ibs_dups COMPRESS AS
02:34:33   2  SELECT
02:34:33   3  tkr
02:34:33   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
02:34:33   5  ,clse
02:34:33   6  FROM ibs_stage
02:34:33   7  UNION
02:34:33   8  SELECT tkr,ydate,clse
02:34:33   9  FROM ibs_old
02:34:33  10  /

Table created.

Elapsed: 00:00:02.02
02:34:35 SQL> 
02:34:35 SQL> CREATE TABLE ibs15min COMPRESS AS
02:34:35   2  SELECT
02:34:35   3  tkr
02:34:35   4  ,ydate
02:34:35   5  ,AVG(clse)clse
02:34:35   6  FROM ibs_dups
02:34:35   7  GROUP BY tkr,ydate
02:34:35   8  /

Table created.

Elapsed: 00:00:00.88
02:34:36 SQL> 
02:34:36 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:02.13
02:34:38 SQL> 
02:34:38 SQL> -- rpt
02:34:38 SQL> 
02:34:38 SQL> SELECT
02:34:38   2  tkr
02:34:38   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
02:34:38   4  ,MIN(ydate)
02:34:38   5  ,COUNT(ydate)
02:34:38   6  ,MAX(ydate)FROM
02:34:38   7  ibs15min
02:34:38   8  GROUP BY tkr
02:34:38   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	  5929.63333 2010-12-27 13:00:00	 2183 2011-03-04 23:45:00
AKAM	  5929.63333 2010-12-27 12:45:00	 2303 2011-03-04 23:45:00
APA	  5929.63333 2010-12-27 12:45:00	 2269 2011-03-04 23:45:00
APC	  5929.63333 2010-12-27 14:15:00	 2297 2011-03-04 23:45:00
AXP	  5929.63333 2010-12-27 13:00:00	 2328 2011-03-04 23:45:00
BP	  5929.63333 2010-12-27 13:00:00	 2956 2011-03-04 23:45:00
BTU	  5914.63333 2010-12-27 12:45:00	 2332 2011-03-05 00:00:00
CAT	  5914.63333 2010-12-27 12:45:00	 2396 2011-03-05 00:00:00
CVS	  5914.63333 2010-12-27 14:30:00	 2168 2011-03-05 00:00:00
GD	  5914.63333 2010-12-27 13:00:00	 2474 2011-03-05 00:00:00
HL	  5899.63333 2011-01-18 12:30:00	 1749 2011-03-05 00:15:00
MAR	  5884.63333 2010-12-27 14:30:00	 2073 2011-03-05 00:30:00
MDT	  5884.63333 2010-12-27 13:45:00	 2206 2011-03-05 00:30:00
QQQQ	  5869.63333 2010-12-27 09:00:00	 2952 2011-03-05 00:45:00
SINA	  5869.63333 2010-12-27 14:15:00	 2253 2011-03-05 00:45:00
SLW	  5869.63333 2011-01-18 09:15:00	 1879 2011-03-05 00:45:00
SPY	  5869.63333 2010-12-27 09:00:00	 3069 2011-03-05 00:45:00
SVM	  5869.63333 2011-01-18 13:00:00	 1585 2011-03-05 00:45:00
V	  5869.63333 2010-12-27 12:30:00	 2529 2011-03-05 00:45:00
VECO	  5869.63333 2010-12-27 14:30:00	 2292 2011-03-05 00:45:00
WDC	  5869.63333 2010-12-27 09:15:00	 2184 2011-03-05 00:45:00
XOM	  5869.63333 2010-12-27 13:00:00	 2637 2011-03-05 00:45:00
AFL	  5929.63333 2010-12-27 14:30:00	 2091 2011-03-04 23:45:00
AMT	  5929.63333 2010-12-27 13:00:00	 2143 2011-03-04 23:45:00
AXU	  5929.63333 2011-01-18 13:00:00	 1508 2011-03-04 23:45:00
CTSH	  5914.63333 2010-12-27 14:30:00	 2204 2011-03-05 00:00:00
GFI	  5914.63333 2011-01-24 09:15:00	 1577 2011-03-05 00:00:00
IOC	  5884.63333 2010-12-27 14:30:00	 2035 2011-03-05 00:30:00
JPM	  5884.63333 2010-12-27 13:00:00	 2544 2011-03-05 00:30:00
ORCL	  1549.63333 2011-02-22 12:00:00	  499 2011-03-08 00:45:00
SKX	  5869.63333 2010-12-27 12:00:00	 2153 2011-03-05 00:45:00
SLB	  5869.63333 2010-12-27 09:15:00	 2572 2011-03-05 00:45:00
STT	  5869.63333 2010-12-27 14:30:00	 2097 2011-03-05 00:45:00
SU	  5869.63333 2010-12-27 14:30:00	 2254 2011-03-05 00:45:00
TSO	  5869.63333 2011-02-07 12:15:00	  917 2011-03-05 00:45:00
UNH	  5869.63333 2010-12-27 13:00:00	 2226 2011-03-05 00:45:00
UNP	  5869.63333 2010-12-27 14:30:00	 2150 2011-03-05 00:45:00
AIG	  5929.63333 2010-12-27 13:30:00	 2521 2011-03-04 23:45:00
BBY	  5929.63333 2010-12-27 12:00:00	 2349 2011-03-04 23:45:00
CDE	  5914.63333 2011-01-18 11:45:00	 1639 2011-03-05 00:00:00
CSX	  5914.63333 2010-12-27 14:30:00	 2189 2011-03-05 00:00:00
CVX	  5914.63333 2010-12-27 13:00:00	 2369 2011-03-05 00:00:00
DD	  5914.63333 2010-12-27 11:30:00	 2302 2011-03-05 00:00:00
EOG	  5914.63333 2010-12-27 14:30:00	 2141 2011-03-05 00:00:00
FCX	  5914.63333 2010-12-27 12:45:00	 2609 2011-03-05 00:00:00
FSLR	  5914.63333 2010-12-27 13:00:00	 2260 2011-03-05 00:00:00
HD	  5899.63333 2010-12-27 12:30:00	 2263 2011-03-05 00:15:00
HON	  5899.63333 2010-12-27 14:15:00	 2166 2011-03-05 00:15:00
IBM	  5884.63333 2010-12-27 12:45:00	 2600 2011-03-05 00:30:00
IWM	  5884.63333 2010-12-27 11:00:00	 2856 2011-03-05 00:30:00
MEE	  5884.63333 2010-12-27 13:15:00	 2275 2011-03-05 00:30:00
NFLX	  5884.63333 2010-12-27 12:30:00	 2437 2011-03-05 00:30:00
PRU	  5869.63333 2010-12-27 13:45:00	 2159 2011-03-05 00:45:00
UPS	  5869.63333 2010-12-27 14:30:00	 2150 2011-03-05 00:45:00
WHR	  5869.63333 2010-12-27 14:30:00	 2111 2011-03-05 00:45:00
XLB	  5869.63333 2010-12-27 13:30:00	 2105 2011-03-05 00:45:00
XLE	  5869.63333 2010-12-27 13:00:00	 2326 2011-03-05 00:45:00
BEN	  5929.63333 2010-12-27 13:00:00	 2088 2011-03-04 23:45:00
CHK	  5914.63333 2011-01-18 13:00:00	 1681 2011-03-05 00:00:00
CMI	  5914.63333 2010-12-27 12:30:00	 2278 2011-03-05 00:00:00
COST	  5914.63333 2010-12-27 14:30:00	 2165 2011-03-05 00:00:00
DTV	  5914.63333 2010-12-27 14:30:00	 2092 2011-03-05 00:00:00
ESRX	  5914.63333 2010-12-27 14:30:00	 2105 2011-03-05 00:00:00
GG	  5899.63333 2010-12-27 13:15:00	 2368 2011-03-05 00:15:00
HPQ	  5899.63333 2010-12-27 12:15:00	 2564 2011-03-05 00:15:00
KO	  5884.63333 2010-12-27 12:30:00	 2595 2011-03-05 00:30:00
MDY	  5884.63333 2010-12-27 13:15:00	 2284 2011-03-05 00:30:00
MET	  5884.63333 2010-12-27 14:30:00	 2155 2011-03-05 00:30:00
MVG	  5884.63333 2011-01-18 14:15:00	 1411 2011-03-05 00:30:00
NOC	  5884.63333 2011-01-24 13:30:00	 1256 2011-03-05 00:30:00
PAAS	  5884.63333 2011-01-18 14:00:00	 1643 2011-03-05 00:30:00
PALL	  5884.63333 2011-01-18 14:00:00	 1485 2011-03-05 00:30:00
PNC	  5884.63333 2010-12-27 14:15:00	 2207 2011-03-05 00:30:00
SJM	  5869.63333 2010-12-27 14:30:00	 2042 2011-03-05 00:45:00
SNDK	  5869.63333 2010-12-27 13:00:00	 2355 2011-03-05 00:45:00
SUN	  5869.63333 2010-12-27 14:30:00	 2116 2011-03-05 00:45:00
SWC	  5869.63333 2011-01-18 13:00:00	 1571 2011-03-05 00:45:00
TGT	  5869.63333 2010-12-27 14:15:00	 2240 2011-03-05 00:45:00
TKR	  5869.63333 2011-01-24 14:30:00	 1228 2011-03-05 00:45:00
XLU	  5869.63333 2010-12-27 14:30:00	 2068 2011-03-05 00:45:00
ABT	  5929.63333 2010-12-27 12:30:00	 2373 2011-03-04 23:45:00
AMGN	  5929.63333 2010-12-27 14:00:00	 2146 2011-03-04 23:45:00
AMZN	  5929.63333 2010-12-27 11:15:00	 2649 2011-03-04 23:45:00
BHP	  5929.63333 2010-12-27 12:15:00	 2961 2011-03-04 23:45:00
COF	  5914.63333 2010-12-27 14:30:00	 2126 2011-03-05 00:00:00
DNDN	  5914.63333 2010-12-27 14:15:00	 2207 2011-03-05 00:00:00
EBAY	  5914.63333 2011-01-18 13:00:00	 1567 2011-03-05 00:00:00
EXK	  5914.63333 2011-01-18 13:00:00	 1588 2011-03-05 00:00:00
FDX	  5914.63333 2010-12-27 12:30:00	 2223 2011-03-05 00:00:00
GLD	  5899.63333 2010-12-27 11:00:00	 2969 2011-03-05 00:15:00
JNJ	  5884.63333 2010-12-27 11:15:00	 2670 2011-03-05 00:30:00
LFT	  5884.63333 2010-12-27 14:00:00	 2048 2011-03-05 00:30:00
MOS	  5884.63333 2010-12-27 13:30:00	 2444 2011-03-05 00:30:00
NEM	  5884.63333 2010-12-27 14:15:00	 2446 2011-03-05 00:30:00
OXY	  5884.63333 2010-12-27 14:30:00	 2236 2011-03-05 00:30:00
PEP	  5884.63333 2010-12-27 14:15:00	 2215 2011-03-05 00:30:00
PG	  5884.63333 2010-12-27 11:30:00	 2470 2011-03-05 00:30:00
RIG	  5869.63333 2010-12-27 12:00:00	 2850 2011-03-05 00:45:00
VLO	  5869.63333 2011-01-31 13:00:00	 1203 2011-03-05 00:45:00
AGU	  5929.63333 2011-01-18 13:00:00	 1572 2011-03-04 23:45:00
BA	  5929.63333 2010-12-27 13:00:00	 2324 2011-03-04 23:45:00
BBT	  5929.63333 2010-12-27 14:15:00	 2165 2011-03-04 23:45:00
BIDU	  5929.63333 2010-12-27 12:15:00	 2506 2011-03-04 23:45:00
BRCM	  5929.63333 2010-12-27 14:30:00	 2344 2011-03-04 23:45:00
CELG	  5914.63333 2010-12-27 14:30:00	 2125 2011-03-05 00:00:00
CREE	  5914.63333 2010-12-27 14:00:00	 2298 2011-03-05 00:00:00
CVE	  5914.63333 2011-01-31 13:00:00	 1077 2011-03-05 00:00:00
DE	  5914.63333 2010-12-27 13:00:00	 2359 2011-03-05 00:00:00
DIS	  5914.63333 2010-12-27 13:00:00	 2267 2011-03-05 00:00:00
EWZ	  5914.63333 2010-12-27 09:00:00	 2788 2011-03-05 00:00:00
FFIV	  5914.63333 2010-12-27 12:30:00	 2324 2011-03-05 00:00:00
GDX	  5914.63333 2010-12-27 13:00:00	 2523 2011-03-05 00:00:00
GILD	  5899.63333 2010-12-27 13:30:00	 2201 2011-03-05 00:15:00
GOOG	  5899.63333 2010-12-27 09:15:00	 2562 2011-03-05 00:15:00
GS	  5899.63333 2010-12-27 13:00:00	 2389 2011-03-05 00:15:00
HES	  5899.63333 2010-12-27 14:30:00	 2286 2011-03-05 00:15:00
HOC	  5899.63333 2011-02-14 14:00:00	  639 2011-03-05 00:15:00
MMM	  5884.63333 2010-12-27 13:30:00	 2267 2011-03-05 00:30:00
MON	  5884.63333 2010-12-27 13:30:00	 2350 2011-03-05 00:30:00
MT	  5884.63333 2010-12-27 12:45:00	 2854 2011-03-05 00:30:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
PBR	  5884.63333 2010-12-27 13:00:00	 2498 2011-03-05 00:30:00
PM	  5884.63333 2010-12-27 13:30:00	 2159 2011-03-05 00:30:00
POT	  5869.63333 2010-12-27 12:15:00	 2467 2011-03-05 00:45:00
RDY	  5869.63333 2011-01-18 13:30:00	 1477 2011-03-05 00:45:00
SCCO	  5869.63333 2011-01-18 13:30:00	 1552 2011-03-05 00:45:00
T	  109.633333 2010-12-27 12:30:00	 2719 2011-03-09 00:45:00
TEVA	  5869.63333 2010-12-27 13:00:00	 2497 2011-03-05 00:45:00
TLT	  5869.63333 2010-12-27 12:30:00	 2499 2011-03-05 00:45:00
VMW	  5869.63333 2010-12-27 14:30:00	 2240 2011-03-05 00:45:00
WFMI	  5869.63333 2010-12-27 14:30:00	 2180 2011-03-05 00:45:00
X	  5869.63333 2010-12-27 13:00:00	 2653 2011-03-05 00:45:00
AAPL	  5929.63333 2010-12-27 09:00:00	 2983 2011-03-04 23:45:00
ALL	  5929.63333 2010-12-27 14:30:00	 2107 2011-03-04 23:45:00
BUCY	  5914.63333 2010-12-27 14:15:00	 2102 2011-03-05 00:00:00
CEO	  5914.63333 2011-01-18 14:15:00	 1488 2011-03-05 00:00:00
CRM	  5914.63333 2010-12-27 13:00:00	 2335 2011-03-05 00:00:00
DVN	  5914.63333 2010-12-27 13:00:00	 2226 2011-03-05 00:00:00
FLS	  5914.63333 2010-12-27 14:30:00	 2063 2011-03-05 00:00:00
JOYG	  5884.63333 2010-12-27 14:30:00	 2230 2011-03-05 00:30:00
LMT	  5884.63333 2011-01-24 14:15:00	 1273 2011-03-05 00:30:00
NUE	  5884.63333 2010-12-27 13:45:00	 2167 2011-03-05 00:30:00
PPLT	  5869.63333 2011-01-18 14:30:00	 1440 2011-03-05 00:45:00
QCOM	  5869.63333 2010-12-27 13:00:00	 2332 2011-03-05 00:45:00
SLV	  5869.63333 2010-12-27 09:30:00	 2912 2011-03-05 00:45:00
SOHU	  5869.63333 2011-01-18 14:30:00	 1502 2011-03-05 00:45:00
VALE	  5869.63333 2011-01-18 13:00:00	 1669 2011-03-05 00:45:00
ABX	  5929.63333 2010-12-27 14:30:00	 2505 2011-03-04 23:45:00
AEM	  5929.63333 2010-12-27 14:30:00	 2272 2011-03-04 23:45:00
AMX	  5929.63333 2010-12-27 14:30:00	 2041 2011-03-04 23:45:00
ARG	  5929.63333 2010-12-27 14:00:00	 2130 2011-03-04 23:45:00
CLF	  5914.63333 2010-12-27 12:30:00	 2315 2011-03-05 00:00:00
COP	  5914.63333 2010-12-27 13:00:00	 2357 2011-03-05 00:00:00
DIA	  5914.63333 2010-12-27 12:00:00	 2664 2011-03-05 00:00:00
EFA	  5914.63333 2010-12-27 14:00:00	 2330 2011-03-05 00:00:00
JWN	  5884.63333 2010-12-27 13:45:00	 2096 2011-03-05 00:30:00
MCD	  5884.63333 2010-12-27 10:30:00	 2647 2011-03-05 00:30:00
MJN	  5884.63333 2010-12-27 14:30:00	 2082 2011-03-05 00:30:00
MRK	  5884.63333 2010-12-27 13:30:00	 2344 2011-03-05 00:30:00
OIH	  5884.63333 2010-12-27 14:30:00	 2298 2011-03-05 00:30:00
RIMM	  5869.63333 2010-12-27 12:45:00	 2420 2011-03-05 00:45:00
RTN	  5869.63333 2011-01-24 14:30:00	 1277 2011-03-05 00:45:00
WMT	  5869.63333 2010-12-27 13:30:00	 2322 2011-03-05 00:45:00
WYNN	  5869.63333 2010-12-27 13:45:00	 2293 2011-03-05 00:45:00

163 rows selected.

Elapsed: 00:00:00.12
02:34:38 SQL> 
02:34:38 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
