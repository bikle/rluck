
SQL*Plus: Release 11.2.0.1.0 Production on Sat Mar 5 01:14:16 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

01:14:17 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
01:14:17 SQL> 01:14:17 SQL> --
01:14:17 SQL> -- merge.sql
01:14:17 SQL> --
01:14:17 SQL> 
01:14:17 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
01:14:17 SQL> 
01:14:17 SQL> 
01:14:17 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
01:14:17 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
01:14:17 SQL> 
01:14:17 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.30
01:14:17 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.08
01:14:17 SQL> 
01:14:17 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.26
01:14:17 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.04
01:14:17 SQL> 
01:14:17 SQL> CREATE TABLE ibs_dups COMPRESS AS
01:14:17   2  SELECT
01:14:17   3  tkr
01:14:17   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
01:14:17   5  ,clse
01:14:17   6  FROM ibs_stage
01:14:17   7  UNION
01:14:17   8  SELECT tkr,ydate,clse
01:14:17   9  FROM ibs_old
01:14:17  10  /

Table created.

Elapsed: 00:00:01.16
01:14:18 SQL> 
01:14:18 SQL> CREATE TABLE ibs15min COMPRESS AS
01:14:18   2  SELECT
01:14:18   3  tkr
01:14:18   4  ,ydate
01:14:18   5  ,AVG(clse)clse
01:14:18   6  FROM ibs_dups
01:14:18   7  GROUP BY tkr,ydate
01:14:18   8  /

Table created.

Elapsed: 00:00:01.13
01:14:19 SQL> 
01:14:19 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:01.82
01:14:21 SQL> 
01:14:21 SQL> -- rpt
01:14:21 SQL> 
01:14:21 SQL> SELECT
01:14:21   2  tkr
01:14:21   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
01:14:21   4  ,MIN(ydate)
01:14:21   5  ,COUNT(ydate)
01:14:21   6  ,MAX(ydate)FROM
01:14:21   7  ibs15min
01:14:21   8  GROUP BY tkr
01:14:21   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	       89.35 2010-12-27 13:00:00	 2183 2011-03-04 23:45:00
AKAM	       89.35 2010-12-27 12:45:00	 2303 2011-03-04 23:45:00
APA	       89.35 2010-12-27 12:45:00	 2269 2011-03-04 23:45:00
APC	       89.35 2010-12-27 14:15:00	 2297 2011-03-04 23:45:00
AXP	       89.35 2010-12-27 13:00:00	 2328 2011-03-04 23:45:00
BP	       89.35 2010-12-27 13:00:00	 2956 2011-03-04 23:45:00
BTU	       74.35 2010-12-27 12:45:00	 2332 2011-03-05 00:00:00
CAT	       74.35 2010-12-27 12:45:00	 2396 2011-03-05 00:00:00
CVS	       74.35 2010-12-27 14:30:00	 2168 2011-03-05 00:00:00
GD	       74.35 2010-12-27 13:00:00	 2474 2011-03-05 00:00:00
HL	       59.35 2011-01-18 12:30:00	 1749 2011-03-05 00:15:00
MAR	       44.35 2010-12-27 14:30:00	 2073 2011-03-05 00:30:00
MDT	       44.35 2010-12-27 13:45:00	 2206 2011-03-05 00:30:00
QQQQ	       29.35 2010-12-27 09:00:00	 2952 2011-03-05 00:45:00
SINA	       29.35 2010-12-27 14:15:00	 2253 2011-03-05 00:45:00
SLW	       29.35 2011-01-18 09:15:00	 1879 2011-03-05 00:45:00
SPY	       29.35 2010-12-27 09:00:00	 3069 2011-03-05 00:45:00
SVM	       29.35 2011-01-18 13:00:00	 1585 2011-03-05 00:45:00
V	       29.35 2010-12-27 12:30:00	 2529 2011-03-05 00:45:00
VECO	       29.35 2010-12-27 14:30:00	 2292 2011-03-05 00:45:00
WDC	       29.35 2010-12-27 09:15:00	 2184 2011-03-05 00:45:00
XOM	       29.35 2010-12-27 13:00:00	 2637 2011-03-05 00:45:00
AFL	       89.35 2010-12-27 14:30:00	 2091 2011-03-04 23:45:00
AMT	       89.35 2010-12-27 13:00:00	 2143 2011-03-04 23:45:00
AXU	       89.35 2011-01-18 13:00:00	 1508 2011-03-04 23:45:00
CTSH	       74.35 2010-12-27 14:30:00	 2204 2011-03-05 00:00:00
GFI	       74.35 2011-01-24 09:15:00	 1577 2011-03-05 00:00:00
IOC	       44.35 2010-12-27 14:30:00	 2035 2011-03-05 00:30:00
JPM	       44.35 2010-12-27 13:00:00	 2544 2011-03-05 00:30:00
SKX	       29.35 2010-12-27 12:00:00	 2153 2011-03-05 00:45:00
SLB	       29.35 2010-12-27 09:15:00	 2572 2011-03-05 00:45:00
STT	       29.35 2010-12-27 14:30:00	 2097 2011-03-05 00:45:00
SU	       29.35 2010-12-27 14:30:00	 2254 2011-03-05 00:45:00
TSO	       29.35 2011-02-07 12:15:00	  917 2011-03-05 00:45:00
UNH	       29.35 2010-12-27 13:00:00	 2226 2011-03-05 00:45:00
UNP	       29.35 2010-12-27 14:30:00	 2150 2011-03-05 00:45:00
AIG	       89.35 2010-12-27 13:30:00	 2521 2011-03-04 23:45:00
BBY	       89.35 2010-12-27 12:00:00	 2349 2011-03-04 23:45:00
CDE	       74.35 2011-01-18 11:45:00	 1639 2011-03-05 00:00:00
CSX	       74.35 2010-12-27 14:30:00	 2189 2011-03-05 00:00:00
CVX	       74.35 2010-12-27 13:00:00	 2369 2011-03-05 00:00:00
DD	       74.35 2010-12-27 11:30:00	 2302 2011-03-05 00:00:00
EOG	       74.35 2010-12-27 14:30:00	 2141 2011-03-05 00:00:00
FCX	       74.35 2010-12-27 12:45:00	 2609 2011-03-05 00:00:00
FSLR	       74.35 2010-12-27 13:00:00	 2260 2011-03-05 00:00:00
HD	       59.35 2010-12-27 12:30:00	 2263 2011-03-05 00:15:00
HON	       59.35 2010-12-27 14:15:00	 2166 2011-03-05 00:15:00
IBM	       44.35 2010-12-27 12:45:00	 2600 2011-03-05 00:30:00
IWM	       44.35 2010-12-27 11:00:00	 2856 2011-03-05 00:30:00
MEE	       44.35 2010-12-27 13:15:00	 2275 2011-03-05 00:30:00
NFLX	       44.35 2010-12-27 12:30:00	 2437 2011-03-05 00:30:00
PRU	       29.35 2010-12-27 13:45:00	 2159 2011-03-05 00:45:00
UPS	       29.35 2010-12-27 14:30:00	 2150 2011-03-05 00:45:00
WHR	       29.35 2010-12-27 14:30:00	 2111 2011-03-05 00:45:00
XLB	       29.35 2010-12-27 13:30:00	 2105 2011-03-05 00:45:00
XLE	       29.35 2010-12-27 13:00:00	 2326 2011-03-05 00:45:00
BEN	       89.35 2010-12-27 13:00:00	 2088 2011-03-04 23:45:00
CHK	       74.35 2011-01-18 13:00:00	 1681 2011-03-05 00:00:00
CMI	       74.35 2010-12-27 12:30:00	 2278 2011-03-05 00:00:00
COST	       74.35 2010-12-27 14:30:00	 2165 2011-03-05 00:00:00
DTV	       74.35 2010-12-27 14:30:00	 2092 2011-03-05 00:00:00
ESRX	       74.35 2010-12-27 14:30:00	 2105 2011-03-05 00:00:00
GG	       59.35 2010-12-27 13:15:00	 2368 2011-03-05 00:15:00
HPQ	       59.35 2010-12-27 12:15:00	 2564 2011-03-05 00:15:00
KO	       44.35 2010-12-27 12:30:00	 2595 2011-03-05 00:30:00
MDY	       44.35 2010-12-27 13:15:00	 2284 2011-03-05 00:30:00
MET	       44.35 2010-12-27 14:30:00	 2155 2011-03-05 00:30:00
MVG	       44.35 2011-01-18 14:15:00	 1411 2011-03-05 00:30:00
NOC	       44.35 2011-01-24 13:30:00	 1256 2011-03-05 00:30:00
PAAS	       44.35 2011-01-18 14:00:00	 1643 2011-03-05 00:30:00
PALL	       44.35 2011-01-18 14:00:00	 1485 2011-03-05 00:30:00
PNC	       44.35 2010-12-27 14:15:00	 2207 2011-03-05 00:30:00
SJM	       29.35 2010-12-27 14:30:00	 2042 2011-03-05 00:45:00
SNDK	       29.35 2010-12-27 13:00:00	 2355 2011-03-05 00:45:00
SUN	       29.35 2010-12-27 14:30:00	 2116 2011-03-05 00:45:00
SWC	       29.35 2011-01-18 13:00:00	 1571 2011-03-05 00:45:00
TGT	       29.35 2010-12-27 14:15:00	 2240 2011-03-05 00:45:00
TKR	       29.35 2011-01-24 14:30:00	 1228 2011-03-05 00:45:00
XLU	       29.35 2010-12-27 14:30:00	 2068 2011-03-05 00:45:00
ABT	       89.35 2010-12-27 12:30:00	 2373 2011-03-04 23:45:00
AMGN	       89.35 2010-12-27 14:00:00	 2146 2011-03-04 23:45:00
AMZN	       89.35 2010-12-27 11:15:00	 2649 2011-03-04 23:45:00
BHP	       89.35 2010-12-27 12:15:00	 2961 2011-03-04 23:45:00
COF	       74.35 2010-12-27 14:30:00	 2126 2011-03-05 00:00:00
DNDN	       74.35 2010-12-27 14:15:00	 2207 2011-03-05 00:00:00
EBAY	       74.35 2011-01-18 13:00:00	 1567 2011-03-05 00:00:00
EXK	       74.35 2011-01-18 13:00:00	 1588 2011-03-05 00:00:00
FDX	       74.35 2010-12-27 12:30:00	 2223 2011-03-05 00:00:00
GLD	       59.35 2010-12-27 11:00:00	 2969 2011-03-05 00:15:00
JNJ	       44.35 2010-12-27 11:15:00	 2670 2011-03-05 00:30:00
LFT	       44.35 2010-12-27 14:00:00	 2048 2011-03-05 00:30:00
MOS	       44.35 2010-12-27 13:30:00	 2444 2011-03-05 00:30:00
NEM	       44.35 2010-12-27 14:15:00	 2446 2011-03-05 00:30:00
OXY	       44.35 2010-12-27 14:30:00	 2236 2011-03-05 00:30:00
PEP	       44.35 2010-12-27 14:15:00	 2215 2011-03-05 00:30:00
PG	       44.35 2010-12-27 11:30:00	 2470 2011-03-05 00:30:00
RIG	       29.35 2010-12-27 12:00:00	 2850 2011-03-05 00:45:00
VLO	       29.35 2011-01-31 13:00:00	 1203 2011-03-05 00:45:00
AGU	       89.35 2011-01-18 13:00:00	 1572 2011-03-04 23:45:00
BA	       89.35 2010-12-27 13:00:00	 2324 2011-03-04 23:45:00
BBT	       89.35 2010-12-27 14:15:00	 2165 2011-03-04 23:45:00
BIDU	       89.35 2010-12-27 12:15:00	 2506 2011-03-04 23:45:00
BRCM	       89.35 2010-12-27 14:30:00	 2344 2011-03-04 23:45:00
CELG	       74.35 2010-12-27 14:30:00	 2125 2011-03-05 00:00:00
CREE	       74.35 2010-12-27 14:00:00	 2298 2011-03-05 00:00:00
CVE	       74.35 2011-01-31 13:00:00	 1077 2011-03-05 00:00:00
DE	       74.35 2010-12-27 13:00:00	 2359 2011-03-05 00:00:00
DIS	       74.35 2010-12-27 13:00:00	 2267 2011-03-05 00:00:00
EWZ	       74.35 2010-12-27 09:00:00	 2788 2011-03-05 00:00:00
FFIV	       74.35 2010-12-27 12:30:00	 2324 2011-03-05 00:00:00
GDX	       74.35 2010-12-27 13:00:00	 2523 2011-03-05 00:00:00
GILD	       59.35 2010-12-27 13:30:00	 2201 2011-03-05 00:15:00
GOOG	       59.35 2010-12-27 09:15:00	 2562 2011-03-05 00:15:00
GS	       59.35 2010-12-27 13:00:00	 2389 2011-03-05 00:15:00
HES	       59.35 2010-12-27 14:30:00	 2286 2011-03-05 00:15:00
HOC	       59.35 2011-02-14 14:00:00	  639 2011-03-05 00:15:00
MMM	       44.35 2010-12-27 13:30:00	 2267 2011-03-05 00:30:00
MON	       44.35 2010-12-27 13:30:00	 2350 2011-03-05 00:30:00
MT	       44.35 2010-12-27 12:45:00	 2854 2011-03-05 00:30:00
PBR	       44.35 2010-12-27 13:00:00	 2498 2011-03-05 00:30:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
PM	       44.35 2010-12-27 13:30:00	 2159 2011-03-05 00:30:00
POT	       29.35 2010-12-27 12:15:00	 2467 2011-03-05 00:45:00
RDY	       29.35 2011-01-18 13:30:00	 1477 2011-03-05 00:45:00
SCCO	       29.35 2011-01-18 13:30:00	 1552 2011-03-05 00:45:00
TEVA	       29.35 2010-12-27 13:00:00	 2497 2011-03-05 00:45:00
TLT	       29.35 2010-12-27 12:30:00	 2499 2011-03-05 00:45:00
VMW	       29.35 2010-12-27 14:30:00	 2240 2011-03-05 00:45:00
WFMI	       29.35 2010-12-27 14:30:00	 2180 2011-03-05 00:45:00
X	       29.35 2010-12-27 13:00:00	 2653 2011-03-05 00:45:00
AAPL	       89.35 2010-12-27 09:00:00	 2983 2011-03-04 23:45:00
ALL	       89.35 2010-12-27 14:30:00	 2107 2011-03-04 23:45:00
BUCY	       74.35 2010-12-27 14:15:00	 2102 2011-03-05 00:00:00
CEO	       74.35 2011-01-18 14:15:00	 1488 2011-03-05 00:00:00
CRM	       74.35 2010-12-27 13:00:00	 2335 2011-03-05 00:00:00
DVN	       74.35 2010-12-27 13:00:00	 2226 2011-03-05 00:00:00
FLS	       74.35 2010-12-27 14:30:00	 2063 2011-03-05 00:00:00
JOYG	       44.35 2010-12-27 14:30:00	 2230 2011-03-05 00:30:00
LMT	       44.35 2011-01-24 14:15:00	 1273 2011-03-05 00:30:00
NUE	       44.35 2010-12-27 13:45:00	 2167 2011-03-05 00:30:00
PPLT	       29.35 2011-01-18 14:30:00	 1440 2011-03-05 00:45:00
QCOM	       29.35 2010-12-27 13:00:00	 2332 2011-03-05 00:45:00
SLV	       29.35 2010-12-27 09:30:00	 2912 2011-03-05 00:45:00
SOHU	       29.35 2011-01-18 14:30:00	 1502 2011-03-05 00:45:00
VALE	       29.35 2011-01-18 13:00:00	 1669 2011-03-05 00:45:00
ABX	       89.35 2010-12-27 14:30:00	 2505 2011-03-04 23:45:00
AEM	       89.35 2010-12-27 14:30:00	 2272 2011-03-04 23:45:00
AMX	       89.35 2010-12-27 14:30:00	 2041 2011-03-04 23:45:00
ARG	       89.35 2010-12-27 14:00:00	 2130 2011-03-04 23:45:00
CLF	       74.35 2010-12-27 12:30:00	 2315 2011-03-05 00:00:00
COP	       74.35 2010-12-27 13:00:00	 2357 2011-03-05 00:00:00
DIA	       74.35 2010-12-27 12:00:00	 2664 2011-03-05 00:00:00
EFA	       74.35 2010-12-27 14:00:00	 2330 2011-03-05 00:00:00
JWN	       44.35 2010-12-27 13:45:00	 2096 2011-03-05 00:30:00
MCD	       44.35 2010-12-27 10:30:00	 2647 2011-03-05 00:30:00
MJN	       44.35 2010-12-27 14:30:00	 2082 2011-03-05 00:30:00
MRK	       44.35 2010-12-27 13:30:00	 2344 2011-03-05 00:30:00
OIH	       44.35 2010-12-27 14:30:00	 2298 2011-03-05 00:30:00
RIMM	       29.35 2010-12-27 12:45:00	 2420 2011-03-05 00:45:00
RTN	       29.35 2011-01-24 14:30:00	 1277 2011-03-05 00:45:00
WMT	       29.35 2010-12-27 13:30:00	 2322 2011-03-05 00:45:00
WYNN	       29.35 2010-12-27 13:45:00	 2293 2011-03-05 00:45:00

161 rows selected.

Elapsed: 00:00:00.12
01:14:21 SQL> 
01:14:21 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
