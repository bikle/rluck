
SQL*Plus: Release 11.2.0.1.0 Production on Mon Mar 28 00:59:53 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

00:59:53 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
00:59:53 SQL> 00:59:53 SQL> --
00:59:53 SQL> -- merge.sql
00:59:53 SQL> --
00:59:53 SQL> 
00:59:53 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
00:59:53 SQL> 
00:59:53 SQL> 
00:59:53 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
00:59:53 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
00:59:53 SQL> 
00:59:53 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.25
00:59:53 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.04
00:59:53 SQL> 
00:59:53 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.27
00:59:53 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.08
00:59:53 SQL> 
00:59:53 SQL> CREATE TABLE ibs_dups COMPRESS AS
00:59:53   2  SELECT
00:59:53   3  tkr
00:59:53   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
00:59:53   5  ,clse
00:59:53   6  FROM ibs_stage
00:59:53   7  UNION
00:59:53   8  SELECT tkr,ydate,clse
00:59:53   9  FROM ibs_old
00:59:53  10  /

Table created.

Elapsed: 00:00:02.17
00:59:56 SQL> 
00:59:56 SQL> CREATE TABLE ibs15min COMPRESS AS
00:59:56   2  SELECT
00:59:56   3  tkr
00:59:56   4  ,ydate
00:59:56   5  ,AVG(clse)clse
00:59:56   6  FROM ibs_dups
00:59:56   7  GROUP BY tkr,ydate
00:59:56   8  /

Table created.

Elapsed: 00:00:02.15
00:59:58 SQL> 
00:59:58 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:02.87
01:00:01 SQL> 
01:00:01 SQL> -- rpt
01:00:01 SQL> 
01:00:01 SQL> SELECT
01:00:01   2  tkr
01:00:01   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
01:00:01   4  ,MIN(ydate)
01:00:01   5  ,COUNT(ydate)
01:00:01   6  ,MAX(ydate)FROM
01:00:01   7  ibs15min
01:00:01   8  GROUP BY tkr
01:00:01   9  ORDER BY tkr
01:00:01  10  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
AAPL	  2955.01667 2010-12-27 09:00:00	 3932 2011-03-25 23:45:00
ABT	  2955.01667 2010-12-27 12:30:00	 3093 2011-03-25 23:45:00
ABX	  2955.01667 2010-12-27 14:30:00	 3305 2011-03-25 23:45:00
ADBE	  2955.01667 2010-12-27 13:00:00	 2875 2011-03-25 23:45:00
AEM	  2955.01667 2010-12-27 14:30:00	 2992 2011-03-25 23:45:00
AFL	  2955.01667 2010-12-27 14:30:00	 2812 2011-03-25 23:45:00
AGU	  2955.01667 2011-01-18 13:00:00	 2306 2011-03-25 23:45:00
AIG	  2955.01667 2010-12-27 13:30:00	 3309 2011-03-25 23:45:00
AKAM	  2955.01667 2010-12-27 12:45:00	 3068 2011-03-25 23:45:00
ALL	  2955.01667 2010-12-27 14:30:00	 2758 2011-03-25 23:45:00
AMGN	  2955.01667 2010-12-27 14:00:00	 2826 2011-03-25 23:45:00
AMT	  2955.01667 2010-12-27 13:00:00	 2852 2011-03-25 23:45:00
AMX	  2955.01667 2010-12-27 14:30:00	 2697 2011-03-25 23:45:00
AMZN	  2955.01667 2010-12-27 11:15:00	 3452 2011-03-25 23:45:00
APA	  2955.01667 2010-12-27 12:45:00	 2989 2011-03-25 23:45:00
APC	  2955.01667 2010-12-27 14:15:00	 2988 2011-03-25 23:45:00
ARG	  2955.01667 2010-12-27 14:00:00	 2778 2011-03-25 23:45:00
AXP	  2955.01667 2010-12-27 13:00:00	 3071 2011-03-25 23:45:00
AXU	  2955.01667 2011-01-18 13:00:00	 2216 2011-03-25 23:45:00
BA	  2955.01667 2010-12-27 13:00:00	 3046 2011-03-25 23:45:00
BBT	  2955.01667 2010-12-27 14:15:00	 2862 2011-03-25 23:45:00
BBY	  2955.01667 2010-12-27 12:00:00	 3103 2011-03-25 23:45:00
BEN	  2955.01667 2010-12-27 13:00:00	 2744 2011-03-25 23:45:00
BHP	  2955.01667 2010-12-27 12:15:00	 3900 2011-03-25 23:45:00
BIDU	  2955.01667 2010-12-27 12:15:00	 3298 2011-03-25 23:45:00
BP	  2955.01667 2010-12-27 13:00:00	 3901 2011-03-25 23:45:00
BRCM	  2955.01667 2010-12-27 14:30:00	 3082 2011-03-25 23:45:00
BTU	  2955.01667 2010-12-27 12:45:00	 3072 2011-03-25 23:45:00
BUCY	  2955.01667 2010-12-27 14:15:00	 2748 2011-03-25 23:45:00
CAT	  2955.01667 2010-12-27 12:45:00	 3163 2011-03-25 23:45:00
CDE	  2955.01667 2011-01-18 11:45:00	 2395 2011-03-25 23:45:00
CELG	  2955.01667 2010-12-27 14:30:00	 2803 2011-03-25 23:45:00
CEO	  2955.01667 2011-01-18 14:15:00	 2143 2011-03-25 23:45:00
CHK	  2955.01667 2011-01-18 13:00:00	 2452 2011-03-25 23:45:00
CLF	  2955.01667 2010-12-27 12:30:00	 3054 2011-03-25 23:45:00
CMI	  2955.01667 2010-12-27 12:30:00	 3013 2011-03-25 23:45:00
COF	  2955.01667 2010-12-27 14:30:00	 2808 2011-03-25 23:45:00
COP	  2955.01667 2010-12-27 13:00:00	 3094 2011-03-25 23:45:00
COST	  2955.01667 2010-12-27 14:30:00	 2837 2011-03-25 23:45:00
CREE	  2955.01667 2010-12-27 14:00:00	 3075 2011-03-25 23:45:00
CRM	  2955.01667 2010-12-27 13:00:00	 3068 2011-03-25 23:45:00
CSX	  2955.01667 2010-12-27 14:30:00	 2888 2011-03-25 23:45:00
CTSH	  2955.01667 2010-12-27 14:30:00	 2895 2011-03-25 23:45:00
CVE	  2955.01667 2011-01-31 13:00:00	 1743 2011-03-25 23:45:00
CVS	  2955.01667 2010-12-27 14:30:00	 2856 2011-03-25 23:45:00
CVX	  2955.01667 2010-12-27 13:00:00	 3113 2011-03-25 23:45:00
DD	  2955.01667 2010-12-27 11:30:00	 3019 2011-03-25 23:45:00
DE	  2955.01667 2010-12-27 13:00:00	 3101 2011-03-25 23:45:00
DIA	  2955.01667 2010-12-27 12:00:00	 3542 2011-03-25 23:45:00
DIS	  2955.01667 2010-12-27 13:00:00	 3009 2011-03-25 23:45:00
DNDN	  2955.01667 2010-12-27 14:15:00	 2914 2011-03-25 23:45:00
DTV	  2955.01667 2010-12-27 14:30:00	 2773 2011-03-25 23:45:00
DVN	  2955.01667 2010-12-27 13:00:00	 2924 2011-03-25 23:45:00
EBAY	  2955.01667 2011-01-18 13:00:00	 2259 2011-03-25 23:45:00
EFA	  2955.01667 2010-12-27 14:00:00	 3146 2011-03-25 23:45:00
EOG	  2955.01667 2010-12-27 14:30:00	 2815 2011-03-25 23:45:00
ESRX	  2955.01667 2010-12-27 14:30:00	 2791 2011-03-25 23:45:00
EWZ	  2955.01667 2010-12-27 09:00:00	 3656 2011-03-25 23:45:00
EXK	  2955.01667 2011-01-18 13:00:00	 2344 2011-03-25 23:45:00
FCX	  2955.01667 2010-12-27 12:45:00	 3454 2011-03-25 23:45:00
FDX	  2955.01667 2010-12-27 12:30:00	 2922 2011-03-25 23:45:00
FFIV	  2955.01667 2010-12-27 12:30:00	 3090 2011-03-25 23:45:00
FLS	  2955.01667 2010-12-27 14:30:00	 2697 2011-03-25 23:45:00
FSLR	  2955.01667 2010-12-27 13:00:00	 3002 2011-03-25 23:45:00
GD	  2955.01667 2010-12-27 13:00:00	 3299 2011-03-25 23:45:00
GDX	  2955.01667 2010-12-27 13:00:00	 3344 2011-03-25 23:45:00
GFI	  2955.01667 2011-01-24 09:15:00	 2356 2011-03-25 23:45:00
GG	  2955.01667 2010-12-27 13:15:00	 3156 2011-03-25 23:45:00
GILD	  2955.01667 2010-12-27 13:30:00	 2880 2011-03-25 23:45:00
GLD	  2955.01667 2010-12-27 11:00:00	 3865 2011-03-25 23:45:00
GOOG	  2955.01667 2010-12-27 09:15:00	 3362 2011-03-25 23:45:00
GS	  2955.01667 2010-12-27 13:00:00	 3153 2011-03-25 23:45:00
HD	  2955.01667 2010-12-27 12:30:00	 2976 2011-03-25 23:45:00
HES	  2955.01667 2010-12-27 14:30:00	 2973 2011-03-25 23:45:00
HL	  2955.01667 2011-01-18 12:30:00	 2546 2011-03-25 23:45:00
HOC	  2955.01667 2011-02-14 14:00:00	 1295 2011-03-25 23:45:00
HON	  2955.01667 2010-12-27 14:15:00	 2844 2011-03-25 23:45:00
HPQ	  2955.01667 2010-12-27 12:15:00	 3360 2011-03-25 23:45:00
IBM	  2955.01667 2010-12-27 12:45:00	 3460 2011-03-25 23:45:00
IOC	  2955.01667 2010-12-27 14:30:00	 2717 2011-03-25 23:45:00
IWM	  2955.01667 2010-12-27 11:00:00	 3794 2011-03-25 23:45:00
JNJ	  2955.01667 2010-12-27 11:15:00	 3485 2011-03-25 23:45:00
JOYG	  2955.01667 2010-12-27 14:30:00	 2927 2011-03-25 23:45:00
JPM	  2955.01667 2010-12-27 13:00:00	 3339 2011-03-25 23:45:00
JWN	  2955.01667 2010-12-27 13:45:00	 2758 2011-03-25 23:45:00
KO	  2955.01667 2010-12-27 12:30:00	 3382 2011-03-25 23:45:00
LFT	  2955.01667 2010-12-27 14:00:00	 2686 2011-03-25 23:45:00
LMT	  2955.01667 2011-01-24 14:15:00	 1923 2011-03-25 23:45:00
MAR	  2955.01667 2010-12-27 14:30:00	 2731 2011-03-25 23:45:00
MCD	  2955.01667 2010-12-27 10:30:00	 3446 2011-03-25 23:45:00
MDT	  2955.01667 2010-12-27 13:45:00	 2888 2011-03-25 23:45:00
MDY	  2955.01667 2010-12-27 13:15:00	 3044 2011-03-25 23:45:00
MEE	  2955.01667 2010-12-27 13:15:00	 2986 2011-03-25 23:45:00
MET	  2955.01667 2010-12-27 14:30:00	 2882 2011-03-25 23:45:00
MJN	  2955.01667 2010-12-27 14:30:00	 2717 2011-03-25 23:45:00
MMM	  2955.01667 2010-12-27 13:30:00	 2994 2011-03-25 23:45:00
MON	  2955.01667 2010-12-27 13:30:00	 3088 2011-03-25 23:45:00
MOS	  2955.01667 2010-12-27 13:30:00	 3193 2011-03-25 23:45:00
MRK	  2955.01667 2010-12-27 13:30:00	 3107 2011-03-25 23:45:00
MT	  2955.01667 2010-12-27 12:45:00	 3746 2011-03-25 23:45:00
MVG	  2955.01667 2011-01-18 14:15:00	 2065 2011-03-25 23:45:00
NEM	  2955.01667 2010-12-27 14:15:00	 3190 2011-03-25 23:45:00
NFLX	  2955.01667 2010-12-27 12:30:00	 3233 2011-03-25 23:45:00
NOC	  2955.01667 2011-01-24 13:30:00	 1915 2011-03-25 23:45:00
NUE	  2955.01667 2010-12-27 13:45:00	 2874 2011-03-25 23:45:00
OIH	  2955.01667 2010-12-27 14:30:00	 2991 2011-03-25 23:45:00
ORCL	  2955.01667 2011-02-22 12:00:00	 1298 2011-03-25 23:45:00
OXY	  2955.01667 2010-12-27 14:30:00	 2931 2011-03-25 23:45:00
PAAS	  2955.01667 2011-01-18 14:00:00	 2386 2011-03-25 23:45:00
PALL	  2955.01667 2011-01-18 14:00:00	 2174 2011-03-25 23:45:00
PBR	  2955.01667 2010-12-27 13:00:00	 3266 2011-03-25 23:45:00
PEP	  2955.01667 2010-12-27 14:15:00	 2911 2011-03-25 23:45:00
PG	  2955.01667 2010-12-27 11:30:00	 3274 2011-03-25 23:45:00
PM	  2955.01667 2010-12-27 13:30:00	 2865 2011-03-25 23:45:00
PNC	  2955.01667 2010-12-27 14:15:00	 2887 2011-03-25 23:45:00
POT	  2955.01667 2010-12-27 12:15:00	 3256 2011-03-25 23:45:00
PPLT	  2955.01667 2011-01-18 14:30:00	 2108 2011-03-25 23:45:00
PRU	  2955.01667 2010-12-27 13:45:00	 2863 2011-03-25 23:45:00
QCOM	  2955.01667 2010-12-27 13:00:00	 3105 2011-03-25 23:45:00
QQQ	  2955.01667 2010-12-27 09:00:00	 3884 2011-03-25 23:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
QQQQ	  13080.0167 2010-12-27 09:00:00	 3571 2011-03-18 23:00:00
RDY	  2955.01667 2011-01-18 13:30:00	 2134 2011-03-25 23:45:00
RIG	  2955.01667 2010-12-27 12:00:00	 3735 2011-03-25 23:45:00
RIMM	  2955.01667 2010-12-27 12:45:00	 3188 2011-03-25 23:45:00
RTN	  2955.01667 2011-01-24 14:30:00	 1937 2011-03-25 23:45:00
SCCO	  2955.01667 2011-01-18 13:30:00	 2263 2011-03-25 23:45:00
SINA	  2955.01667 2010-12-27 14:15:00	 2963 2011-03-25 23:45:00
SJM	  2955.01667 2010-12-27 14:30:00	 2673 2011-03-25 23:45:00
SKX	  2955.01667 2010-12-27 12:00:00	 2807 2011-03-25 23:45:00
SLB	  2955.01667 2010-12-27 09:15:00	 3360 2011-03-25 23:45:00
SLV	  2955.01667 2010-12-27 09:30:00	 3819 2011-03-25 23:45:00
SLW	  2955.01667 2011-01-18 09:15:00	 2729 2011-03-25 23:45:00
SNDK	  2955.01667 2010-12-27 13:00:00	 3101 2011-03-25 23:45:00
SOHU	  2955.01667 2011-01-18 14:30:00	 2179 2011-03-25 23:45:00
SPY	  2955.01667 2010-12-27 09:00:00	 4017 2011-03-25 23:45:00
STT	  2955.01667 2010-12-27 14:30:00	 2751 2011-03-25 23:45:00
SU	  2955.01667 2010-12-27 14:30:00	 2989 2011-03-25 23:45:00
SUN	  2955.01667 2010-12-27 14:30:00	 2774 2011-03-25 23:45:00
SVM	  2955.01667 2011-01-18 13:00:00	 2338 2011-03-25 23:45:00
SWC	  2955.01667 2011-01-18 13:00:00	 2277 2011-03-25 23:45:00
T	  2955.01667 2010-12-27 12:30:00	 3437 2011-03-25 23:45:00
TEVA	  2955.01667 2010-12-27 13:00:00	 3293 2011-03-25 23:45:00
TGT	  2955.01667 2010-12-27 14:15:00	 2969 2011-03-25 23:45:00
TKR	  2955.01667 2011-01-24 14:30:00	 1868 2011-03-25 23:45:00
TLT	  2955.01667 2010-12-27 12:30:00	 3273 2011-03-25 23:45:00
TSO	  2955.01667 2011-02-07 12:15:00	 1640 2011-03-25 23:45:00
UNH	  2955.01667 2010-12-27 13:00:00	 2893 2011-03-25 23:45:00
UNP	  2955.01667 2010-12-27 14:30:00	 2846 2011-03-25 23:45:00
UPS	  2955.01667 2010-12-27 14:30:00	 2832 2011-03-25 23:45:00
V	  2955.01667 2010-12-27 12:30:00	 3316 2011-03-25 23:45:00
VALE	  2955.01667 2011-01-18 13:00:00	 2436 2011-03-25 23:45:00
VECO	  2955.01667 2010-12-27 14:30:00	 2995 2011-03-25 23:45:00
VLO	  2955.01667 2011-01-31 13:00:00	 1938 2011-03-25 23:45:00
VMW	  2955.01667 2010-12-27 14:30:00	 2940 2011-03-25 23:45:00
WDC	  2955.01667 2010-12-27 09:15:00	 2859 2011-03-25 23:45:00
WFMI	  2955.01667 2010-12-27 14:30:00	 2850 2011-03-25 23:45:00
WHR	  2955.01667 2010-12-27 14:30:00	 2781 2011-03-25 23:45:00
WMT	  2955.01667 2010-12-27 13:30:00	 3096 2011-03-25 23:45:00
WYNN	  2955.01667 2010-12-27 13:45:00	 3021 2011-03-25 23:45:00
X	  2955.01667 2010-12-27 13:00:00	 3521 2011-03-25 23:45:00
XLB	  2955.01667 2010-12-27 13:30:00	 2763 2011-03-25 23:45:00
XLE	  2955.01667 2010-12-27 13:00:00	 3073 2011-03-25 23:45:00
XLU	  2955.01667 2010-12-27 14:30:00	 2734 2011-03-25 23:45:00
XOM	  2955.01667 2010-12-27 13:00:00	 3482 2011-03-25 23:45:00

164 rows selected.

Elapsed: 00:00:00.20
01:00:01 SQL> 
01:00:01 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
