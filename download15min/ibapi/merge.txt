
SQL*Plus: Release 11.2.0.1.0 Production on Tue Mar 8 07:25:19 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

07:25:19 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
07:25:19 SQL> 07:25:19 SQL> --
07:25:19 SQL> -- merge.sql
07:25:19 SQL> --
07:25:19 SQL> 
07:25:19 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
07:25:19 SQL> 
07:25:19 SQL> 
07:25:19 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
07:25:19 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
07:25:19 SQL> 
07:25:19 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:01.12
07:25:20 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.17
07:25:20 SQL> 
07:25:20 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.22
07:25:21 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.06
07:25:21 SQL> 
07:25:21 SQL> CREATE TABLE ibs_dups COMPRESS AS
07:25:21   2  SELECT
07:25:21   3  tkr
07:25:21   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
07:25:21   5  ,clse
07:25:21   6  FROM ibs_stage
07:25:21   7  UNION
07:25:21   8  SELECT tkr,ydate,clse
07:25:21   9  FROM ibs_old
07:25:21  10  /

Table created.

Elapsed: 00:00:02.08
07:25:23 SQL> 
07:25:23 SQL> CREATE TABLE ibs15min COMPRESS AS
07:25:23   2  SELECT
07:25:23   3  tkr
07:25:23   4  ,ydate
07:25:23   5  ,AVG(clse)clse
07:25:23   6  FROM ibs_dups
07:25:23   7  GROUP BY tkr,ydate
07:25:23   8  /

Table created.

Elapsed: 00:00:01.26
07:25:24 SQL> 
07:25:24 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:02.46
07:25:26 SQL> 
07:25:26 SQL> -- rpt
07:25:26 SQL> 
07:25:26 SQL> SELECT
07:25:26   2  tkr
07:25:26   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
07:25:26   4  ,MIN(ydate)
07:25:26   5  ,COUNT(ydate)
07:25:26   6  ,MAX(ydate)FROM
07:25:26   7  ibs15min
07:25:26   8  GROUP BY tkr
07:25:26   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	  4780.43333 2010-12-27 13:00:00	 2183 2011-03-04 23:45:00
AKAM	  4780.43333 2010-12-27 12:45:00	 2303 2011-03-04 23:45:00
APA	  4780.43333 2010-12-27 12:45:00	 2269 2011-03-04 23:45:00
APC	  4780.43333 2010-12-27 14:15:00	 2297 2011-03-04 23:45:00
AXP	  4780.43333 2010-12-27 13:00:00	 2328 2011-03-04 23:45:00
BP	  4780.43333 2010-12-27 13:00:00	 2956 2011-03-04 23:45:00
BTU	  4765.43333 2010-12-27 12:45:00	 2332 2011-03-05 00:00:00
CAT	  4765.43333 2010-12-27 12:45:00	 2396 2011-03-05 00:00:00
CVS	  4765.43333 2010-12-27 14:30:00	 2168 2011-03-05 00:00:00
GD	  4765.43333 2010-12-27 13:00:00	 2474 2011-03-05 00:00:00
HL	  4750.43333 2011-01-18 12:30:00	 1749 2011-03-05 00:15:00
MAR	  4735.43333 2010-12-27 14:30:00	 2073 2011-03-05 00:30:00
MDT	  4735.43333 2010-12-27 13:45:00	 2206 2011-03-05 00:30:00
QQQQ	  4720.43333 2010-12-27 09:00:00	 2952 2011-03-05 00:45:00
SINA	  4720.43333 2010-12-27 14:15:00	 2253 2011-03-05 00:45:00
SLW	  4720.43333 2011-01-18 09:15:00	 1879 2011-03-05 00:45:00
SPY	  4720.43333 2010-12-27 09:00:00	 3069 2011-03-05 00:45:00
SVM	  4720.43333 2011-01-18 13:00:00	 1585 2011-03-05 00:45:00
V	  4720.43333 2010-12-27 12:30:00	 2529 2011-03-05 00:45:00
VECO	  4720.43333 2010-12-27 14:30:00	 2292 2011-03-05 00:45:00
WDC	  4720.43333 2010-12-27 09:15:00	 2184 2011-03-05 00:45:00
XOM	  4720.43333 2010-12-27 13:00:00	 2637 2011-03-05 00:45:00
AFL	  4780.43333 2010-12-27 14:30:00	 2091 2011-03-04 23:45:00
AMT	  4780.43333 2010-12-27 13:00:00	 2143 2011-03-04 23:45:00
AXU	  4780.43333 2011-01-18 13:00:00	 1508 2011-03-04 23:45:00
CTSH	  4765.43333 2010-12-27 14:30:00	 2204 2011-03-05 00:00:00
GFI	  4765.43333 2011-01-24 09:15:00	 1577 2011-03-05 00:00:00
IOC	  4735.43333 2010-12-27 14:30:00	 2035 2011-03-05 00:30:00
JPM	  4735.43333 2010-12-27 13:00:00	 2544 2011-03-05 00:30:00
ORCL	  400.433333 2011-02-22 12:00:00	  499 2011-03-08 00:45:00
SKX	  4720.43333 2010-12-27 12:00:00	 2153 2011-03-05 00:45:00
SLB	  4720.43333 2010-12-27 09:15:00	 2572 2011-03-05 00:45:00
STT	  4720.43333 2010-12-27 14:30:00	 2097 2011-03-05 00:45:00
SU	  4720.43333 2010-12-27 14:30:00	 2254 2011-03-05 00:45:00
TSO	  4720.43333 2011-02-07 12:15:00	  917 2011-03-05 00:45:00
UNH	  4720.43333 2010-12-27 13:00:00	 2226 2011-03-05 00:45:00
UNP	  4720.43333 2010-12-27 14:30:00	 2150 2011-03-05 00:45:00
AIG	  4780.43333 2010-12-27 13:30:00	 2521 2011-03-04 23:45:00
BBY	  4780.43333 2010-12-27 12:00:00	 2349 2011-03-04 23:45:00
CDE	  4765.43333 2011-01-18 11:45:00	 1639 2011-03-05 00:00:00
CSX	  4765.43333 2010-12-27 14:30:00	 2189 2011-03-05 00:00:00
CVX	  4765.43333 2010-12-27 13:00:00	 2369 2011-03-05 00:00:00
DD	  4765.43333 2010-12-27 11:30:00	 2302 2011-03-05 00:00:00
EOG	  4765.43333 2010-12-27 14:30:00	 2141 2011-03-05 00:00:00
FCX	  4765.43333 2010-12-27 12:45:00	 2609 2011-03-05 00:00:00
FSLR	  4765.43333 2010-12-27 13:00:00	 2260 2011-03-05 00:00:00
HD	  4750.43333 2010-12-27 12:30:00	 2263 2011-03-05 00:15:00
HON	  4750.43333 2010-12-27 14:15:00	 2166 2011-03-05 00:15:00
IBM	  4735.43333 2010-12-27 12:45:00	 2600 2011-03-05 00:30:00
IWM	  4735.43333 2010-12-27 11:00:00	 2856 2011-03-05 00:30:00
MEE	  4735.43333 2010-12-27 13:15:00	 2275 2011-03-05 00:30:00
NFLX	  4735.43333 2010-12-27 12:30:00	 2437 2011-03-05 00:30:00
PRU	  4720.43333 2010-12-27 13:45:00	 2159 2011-03-05 00:45:00
UPS	  4720.43333 2010-12-27 14:30:00	 2150 2011-03-05 00:45:00
WHR	  4720.43333 2010-12-27 14:30:00	 2111 2011-03-05 00:45:00
XLB	  4720.43333 2010-12-27 13:30:00	 2105 2011-03-05 00:45:00
XLE	  4720.43333 2010-12-27 13:00:00	 2326 2011-03-05 00:45:00
BEN	  4780.43333 2010-12-27 13:00:00	 2088 2011-03-04 23:45:00
CHK	  4765.43333 2011-01-18 13:00:00	 1681 2011-03-05 00:00:00
CMI	  4765.43333 2010-12-27 12:30:00	 2278 2011-03-05 00:00:00
COST	  4765.43333 2010-12-27 14:30:00	 2165 2011-03-05 00:00:00
DTV	  4765.43333 2010-12-27 14:30:00	 2092 2011-03-05 00:00:00
ESRX	  4765.43333 2010-12-27 14:30:00	 2105 2011-03-05 00:00:00
GG	  4750.43333 2010-12-27 13:15:00	 2368 2011-03-05 00:15:00
HPQ	  4750.43333 2010-12-27 12:15:00	 2564 2011-03-05 00:15:00
KO	  4735.43333 2010-12-27 12:30:00	 2595 2011-03-05 00:30:00
MDY	  4735.43333 2010-12-27 13:15:00	 2284 2011-03-05 00:30:00
MET	  4735.43333 2010-12-27 14:30:00	 2155 2011-03-05 00:30:00
MVG	  4735.43333 2011-01-18 14:15:00	 1411 2011-03-05 00:30:00
NOC	  4735.43333 2011-01-24 13:30:00	 1256 2011-03-05 00:30:00
PAAS	  4735.43333 2011-01-18 14:00:00	 1643 2011-03-05 00:30:00
PALL	  4735.43333 2011-01-18 14:00:00	 1485 2011-03-05 00:30:00
PNC	  4735.43333 2010-12-27 14:15:00	 2207 2011-03-05 00:30:00
SJM	  4720.43333 2010-12-27 14:30:00	 2042 2011-03-05 00:45:00
SNDK	  4720.43333 2010-12-27 13:00:00	 2355 2011-03-05 00:45:00
SUN	  4720.43333 2010-12-27 14:30:00	 2116 2011-03-05 00:45:00
SWC	  4720.43333 2011-01-18 13:00:00	 1571 2011-03-05 00:45:00
TGT	  4720.43333 2010-12-27 14:15:00	 2240 2011-03-05 00:45:00
TKR	  4720.43333 2011-01-24 14:30:00	 1228 2011-03-05 00:45:00
XLU	  4720.43333 2010-12-27 14:30:00	 2068 2011-03-05 00:45:00
ABT	  4780.43333 2010-12-27 12:30:00	 2373 2011-03-04 23:45:00
AMGN	  4780.43333 2010-12-27 14:00:00	 2146 2011-03-04 23:45:00
AMZN	  4780.43333 2010-12-27 11:15:00	 2649 2011-03-04 23:45:00
BHP	  4780.43333 2010-12-27 12:15:00	 2961 2011-03-04 23:45:00
COF	  4765.43333 2010-12-27 14:30:00	 2126 2011-03-05 00:00:00
DNDN	  4765.43333 2010-12-27 14:15:00	 2207 2011-03-05 00:00:00
EBAY	  4765.43333 2011-01-18 13:00:00	 1567 2011-03-05 00:00:00
EXK	  4765.43333 2011-01-18 13:00:00	 1588 2011-03-05 00:00:00
FDX	  4765.43333 2010-12-27 12:30:00	 2223 2011-03-05 00:00:00
GLD	  4750.43333 2010-12-27 11:00:00	 2969 2011-03-05 00:15:00
JNJ	  4735.43333 2010-12-27 11:15:00	 2670 2011-03-05 00:30:00
LFT	  4735.43333 2010-12-27 14:00:00	 2048 2011-03-05 00:30:00
MOS	  4735.43333 2010-12-27 13:30:00	 2444 2011-03-05 00:30:00
NEM	  4735.43333 2010-12-27 14:15:00	 2446 2011-03-05 00:30:00
OXY	  4735.43333 2010-12-27 14:30:00	 2236 2011-03-05 00:30:00
PEP	  4735.43333 2010-12-27 14:15:00	 2215 2011-03-05 00:30:00
PG	  4735.43333 2010-12-27 11:30:00	 2470 2011-03-05 00:30:00
RIG	  4720.43333 2010-12-27 12:00:00	 2850 2011-03-05 00:45:00
VLO	  4720.43333 2011-01-31 13:00:00	 1203 2011-03-05 00:45:00
AGU	  4780.43333 2011-01-18 13:00:00	 1572 2011-03-04 23:45:00
BA	  4780.43333 2010-12-27 13:00:00	 2324 2011-03-04 23:45:00
BBT	  4780.43333 2010-12-27 14:15:00	 2165 2011-03-04 23:45:00
BIDU	  4780.43333 2010-12-27 12:15:00	 2506 2011-03-04 23:45:00
BRCM	  4780.43333 2010-12-27 14:30:00	 2344 2011-03-04 23:45:00
CELG	  4765.43333 2010-12-27 14:30:00	 2125 2011-03-05 00:00:00
CREE	  4765.43333 2010-12-27 14:00:00	 2298 2011-03-05 00:00:00
CVE	  4765.43333 2011-01-31 13:00:00	 1077 2011-03-05 00:00:00
DE	  4765.43333 2010-12-27 13:00:00	 2359 2011-03-05 00:00:00
DIS	  4765.43333 2010-12-27 13:00:00	 2267 2011-03-05 00:00:00
EWZ	  4765.43333 2010-12-27 09:00:00	 2788 2011-03-05 00:00:00
FFIV	  4765.43333 2010-12-27 12:30:00	 2324 2011-03-05 00:00:00
GDX	  4765.43333 2010-12-27 13:00:00	 2523 2011-03-05 00:00:00
GILD	  4750.43333 2010-12-27 13:30:00	 2201 2011-03-05 00:15:00
GOOG	  4750.43333 2010-12-27 09:15:00	 2562 2011-03-05 00:15:00
GS	  4750.43333 2010-12-27 13:00:00	 2389 2011-03-05 00:15:00
HES	  4750.43333 2010-12-27 14:30:00	 2286 2011-03-05 00:15:00
HOC	  4750.43333 2011-02-14 14:00:00	  639 2011-03-05 00:15:00
MMM	  4735.43333 2010-12-27 13:30:00	 2267 2011-03-05 00:30:00
MON	  4735.43333 2010-12-27 13:30:00	 2350 2011-03-05 00:30:00
MT	  4735.43333 2010-12-27 12:45:00	 2854 2011-03-05 00:30:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
PBR	  4735.43333 2010-12-27 13:00:00	 2498 2011-03-05 00:30:00
PM	  4735.43333 2010-12-27 13:30:00	 2159 2011-03-05 00:30:00
POT	  4720.43333 2010-12-27 12:15:00	 2467 2011-03-05 00:45:00
RDY	  4720.43333 2011-01-18 13:30:00	 1477 2011-03-05 00:45:00
SCCO	  4720.43333 2011-01-18 13:30:00	 1552 2011-03-05 00:45:00
TEVA	  4720.43333 2010-12-27 13:00:00	 2497 2011-03-05 00:45:00
TLT	  4720.43333 2010-12-27 12:30:00	 2499 2011-03-05 00:45:00
VMW	  4720.43333 2010-12-27 14:30:00	 2240 2011-03-05 00:45:00
WFMI	  4720.43333 2010-12-27 14:30:00	 2180 2011-03-05 00:45:00
X	  4720.43333 2010-12-27 13:00:00	 2653 2011-03-05 00:45:00
AAPL	  4780.43333 2010-12-27 09:00:00	 2983 2011-03-04 23:45:00
ALL	  4780.43333 2010-12-27 14:30:00	 2107 2011-03-04 23:45:00
BUCY	  4765.43333 2010-12-27 14:15:00	 2102 2011-03-05 00:00:00
CEO	  4765.43333 2011-01-18 14:15:00	 1488 2011-03-05 00:00:00
CRM	  4765.43333 2010-12-27 13:00:00	 2335 2011-03-05 00:00:00
DVN	  4765.43333 2010-12-27 13:00:00	 2226 2011-03-05 00:00:00
FLS	  4765.43333 2010-12-27 14:30:00	 2063 2011-03-05 00:00:00
JOYG	  4735.43333 2010-12-27 14:30:00	 2230 2011-03-05 00:30:00
LMT	  4735.43333 2011-01-24 14:15:00	 1273 2011-03-05 00:30:00
NUE	  4735.43333 2010-12-27 13:45:00	 2167 2011-03-05 00:30:00
PPLT	  4720.43333 2011-01-18 14:30:00	 1440 2011-03-05 00:45:00
QCOM	  4720.43333 2010-12-27 13:00:00	 2332 2011-03-05 00:45:00
SLV	  4720.43333 2010-12-27 09:30:00	 2912 2011-03-05 00:45:00
SOHU	  4720.43333 2011-01-18 14:30:00	 1502 2011-03-05 00:45:00
VALE	  4720.43333 2011-01-18 13:00:00	 1669 2011-03-05 00:45:00
ABX	  4780.43333 2010-12-27 14:30:00	 2505 2011-03-04 23:45:00
AEM	  4780.43333 2010-12-27 14:30:00	 2272 2011-03-04 23:45:00
AMX	  4780.43333 2010-12-27 14:30:00	 2041 2011-03-04 23:45:00
ARG	  4780.43333 2010-12-27 14:00:00	 2130 2011-03-04 23:45:00
CLF	  4765.43333 2010-12-27 12:30:00	 2315 2011-03-05 00:00:00
COP	  4765.43333 2010-12-27 13:00:00	 2357 2011-03-05 00:00:00
DIA	  4765.43333 2010-12-27 12:00:00	 2664 2011-03-05 00:00:00
EFA	  4765.43333 2010-12-27 14:00:00	 2330 2011-03-05 00:00:00
JWN	  4735.43333 2010-12-27 13:45:00	 2096 2011-03-05 00:30:00
MCD	  4735.43333 2010-12-27 10:30:00	 2647 2011-03-05 00:30:00
MJN	  4735.43333 2010-12-27 14:30:00	 2082 2011-03-05 00:30:00
MRK	  4735.43333 2010-12-27 13:30:00	 2344 2011-03-05 00:30:00
OIH	  4735.43333 2010-12-27 14:30:00	 2298 2011-03-05 00:30:00
RIMM	  4720.43333 2010-12-27 12:45:00	 2420 2011-03-05 00:45:00
RTN	  4720.43333 2011-01-24 14:30:00	 1277 2011-03-05 00:45:00
WMT	  4720.43333 2010-12-27 13:30:00	 2322 2011-03-05 00:45:00
WYNN	  4720.43333 2010-12-27 13:45:00	 2293 2011-03-05 00:45:00

162 rows selected.

Elapsed: 00:00:00.13
07:25:27 SQL> 
07:25:27 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
