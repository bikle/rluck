
SQL*Plus: Release 11.2.0.1.0 Production on Sat Jan 15 07:11:07 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

07:11:07 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.01
07:11:07 SQL> 07:11:07 SQL> --
07:11:07 SQL> -- merge.sql
07:11:07 SQL> --
07:11:07 SQL> 
07:11:07 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
07:11:07 SQL> 
07:11:07 SQL> 
07:11:07 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
07:11:07 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
07:11:07 SQL> 
07:11:07 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.19
07:11:07 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.04
07:11:07 SQL> 
07:11:07 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.21
07:11:08 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.04
07:11:08 SQL> 
07:11:08 SQL> CREATE TABLE ibs_dups COMPRESS AS
07:11:08   2  SELECT
07:11:08   3  tkr
07:11:08   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
07:11:08   5  ,clse
07:11:08   6  FROM ibs_stage
07:11:08   7  UNION
07:11:08   8  SELECT tkr,ydate,clse
07:11:08   9  FROM ibs_old
07:11:08  10  /

Table created.

Elapsed: 00:00:00.43
07:11:08 SQL> 
07:11:08 SQL> CREATE TABLE ibs15min COMPRESS AS
07:11:08   2  SELECT
07:11:08   3  tkr
07:11:08   4  ,ydate
07:11:08   5  ,AVG(clse)clse
07:11:08   6  FROM ibs_dups
07:11:08   7  GROUP BY tkr,ydate
07:11:08   8  /

Table created.

Elapsed: 00:00:00.41
07:11:08 SQL> 
07:11:08 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:00.77
07:11:09 SQL> 
07:11:09 SQL> -- rpt
07:11:09 SQL> 
07:11:09 SQL> SELECT
07:11:09   2  tkr
07:11:09   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
07:11:09   4  ,MIN(ydate)
07:11:09   5  ,COUNT(ydate)
07:11:09   6  ,MAX(ydate)FROM
07:11:09   7  ibs15min
07:11:09   8  GROUP BY tkr
07:11:09   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	      386.15 2010-12-27 13:00:00	  696 2011-01-15 00:45:00
AKAM	      386.15 2010-12-27 12:45:00	  704 2011-01-15 00:45:00
APA	      386.15 2010-12-27 12:45:00	  695 2011-01-15 00:45:00
APC	      386.15 2010-12-27 14:15:00	  727 2011-01-15 00:45:00
AXP	      386.15 2010-12-27 13:00:00	  721 2011-01-15 00:45:00
BP	      386.15 2010-12-27 13:00:00	  912 2011-01-15 00:45:00
BTU	      386.15 2010-12-27 12:45:00	  723 2011-01-15 00:45:00
CAT	      386.15 2010-12-27 12:45:00	  734 2011-01-15 00:45:00
CVS	      386.15 2010-12-27 14:30:00	  657 2011-01-15 00:45:00
MAR	      386.15 2010-12-27 14:30:00	  639 2011-01-15 00:45:00
MDT	      386.15 2010-12-27 13:45:00	  689 2011-01-15 00:45:00
QQQQ	      386.15 2010-12-27 09:00:00	  939 2011-01-15 00:45:00
SINA	      386.15 2010-12-27 14:15:00	  688 2011-01-15 00:45:00
SPY	      386.15 2010-12-27 09:00:00	  957 2011-01-15 00:45:00
V	      386.15 2010-12-27 12:30:00	  755 2011-01-15 00:45:00
VECO	      386.15 2010-12-27 14:30:00	  691 2011-01-15 00:45:00
WDC	    10466.15 2010-12-27 09:15:00	  481 2011-01-08 00:45:00
XOM	    10466.15 2010-12-27 13:00:00	  517 2011-01-08 00:45:00
AFL	      386.15 2010-12-27 14:30:00	  652 2011-01-15 00:45:00
AMT	      386.15 2010-12-27 13:00:00	  673 2011-01-15 00:45:00
CTSH	      386.15 2010-12-27 14:30:00	  699 2011-01-15 00:45:00
IOC	      386.15 2010-12-27 14:30:00	  639 2011-01-15 00:45:00
JPM	      386.15 2010-12-27 13:00:00	  768 2011-01-15 00:45:00
SKX	      386.15 2010-12-27 12:00:00	  703 2011-01-15 00:45:00
SLB	      386.15 2010-12-27 09:15:00	  786 2011-01-15 00:45:00
STT	      386.15 2010-12-27 14:30:00	  658 2011-01-15 00:45:00
UNH	      386.15 2010-12-27 13:00:00	  689 2011-01-15 00:45:00
UNP	      386.15 2010-12-27 14:30:00	  685 2011-01-15 00:45:00
AIG	      386.15 2010-12-27 13:30:00	  796 2011-01-15 00:45:00
BBY	      386.15 2010-12-27 12:00:00	  752 2011-01-15 00:45:00
CSX	      386.15 2010-12-27 14:30:00	  681 2011-01-15 00:45:00
CVX	      386.15 2010-12-27 13:00:00	  732 2011-01-15 00:45:00
DD	      386.15 2010-12-27 11:30:00	  710 2011-01-15 00:45:00
EOG	      386.15 2010-12-27 14:30:00	  663 2011-01-15 00:45:00
FCX	      386.15 2010-12-27 12:45:00	  812 2011-01-15 00:45:00
FSLR	      386.15 2010-12-27 13:00:00	  668 2011-01-15 00:45:00
HD	      386.15 2010-12-27 12:30:00	  718 2011-01-15 00:45:00
HON	      386.15 2010-12-27 14:15:00	  657 2011-01-15 00:45:00
IBM	      386.15 2010-12-27 12:45:00	  783 2011-01-15 00:45:00
IWM	      386.15 2010-12-27 11:00:00	  884 2011-01-15 00:45:00
MEE	      386.15 2010-12-27 13:15:00	  704 2011-01-15 00:45:00
NFLX	      386.15 2010-12-27 12:30:00	  757 2011-01-15 00:45:00
PRU	      386.15 2010-12-27 13:45:00	  673 2011-01-15 00:45:00
UPS	      386.15 2010-12-27 14:30:00	  662 2011-01-15 00:45:00
WHR	    10466.15 2010-12-27 14:30:00	  425 2011-01-08 00:45:00
XLB	    10466.15 2010-12-27 13:30:00	  452 2011-01-08 00:45:00
XLE	    10466.15 2010-12-27 13:00:00	  481 2011-01-08 00:45:00
BEN	      386.15 2010-12-27 13:00:00	  676 2011-01-15 00:45:00
CMI	      386.15 2010-12-27 12:30:00	  695 2011-01-15 00:45:00
COST	      386.15 2010-12-27 14:30:00	  692 2011-01-15 00:45:00
DTV	      386.15 2010-12-27 14:30:00	  666 2011-01-15 00:45:00
ESRX	      386.15 2010-12-27 14:30:00	  660 2011-01-15 00:45:00
GG	      386.15 2010-12-27 13:15:00	  747 2011-01-15 00:45:00
HPQ	      386.15 2010-12-27 12:15:00	  806 2011-01-15 00:45:00
KO	      386.15 2010-12-27 12:30:00	  786 2011-01-15 00:45:00
MDY	      386.15 2010-12-27 13:15:00	  734 2011-01-15 00:45:00
MET	      386.15 2010-12-27 14:30:00	  654 2011-01-15 00:45:00
PNC	      386.15 2010-12-27 14:15:00	  700 2011-01-15 00:45:00
SJM	      386.15 2010-12-27 14:30:00	  642 2011-01-15 00:45:00
SNDK	      386.15 2010-12-27 13:00:00	  753 2011-01-15 00:45:00
SUN	      386.15 2010-12-27 14:30:00	  637 2011-01-15 00:45:00
TGT	      386.15 2010-12-27 14:15:00	  722 2011-01-15 00:45:00
XLU	    10466.15 2010-12-27 14:30:00	  428 2011-01-08 00:45:00
ABT	      386.15 2010-12-27 12:30:00	  775 2011-01-15 00:45:00
AMGN	      386.15 2010-12-27 14:00:00	  672 2011-01-15 00:45:00
AMZN	      386.15 2010-12-27 11:15:00	  850 2011-01-15 00:45:00
BHP	      386.15 2010-12-27 12:15:00	  896 2011-01-15 00:45:00
COF	      386.15 2010-12-27 14:30:00	  667 2011-01-15 00:45:00
DNDN	      386.15 2010-12-27 14:15:00	  692 2011-01-15 00:45:00
FDX	      386.15 2010-12-27 12:30:00	  681 2011-01-15 00:45:00
GLD	      386.15 2010-12-27 11:00:00	  916 2011-01-15 00:45:00
JNJ	      386.15 2010-12-27 11:15:00	  803 2011-01-15 00:45:00
LFT	      386.15 2010-12-27 14:00:00	  641 2011-01-15 00:45:00
MOS	      386.15 2010-12-27 13:30:00	  758 2011-01-15 00:45:00
NEM	      386.15 2010-12-27 14:15:00	  771 2011-01-15 00:45:00
OXY	      386.15 2010-12-27 14:30:00	  703 2011-01-15 00:45:00
PEP	      386.15 2010-12-27 14:15:00	  689 2011-01-15 00:45:00
PG	      386.15 2010-12-27 11:30:00	  763 2011-01-15 00:45:00
RIG	      386.15 2010-12-27 12:00:00	  875 2011-01-15 00:45:00
BA	      386.15 2010-12-27 13:00:00	  718 2011-01-15 00:45:00
BBT	      386.15 2010-12-27 14:15:00	  692 2011-01-15 00:45:00
BIDU	      386.15 2010-12-27 12:15:00	  781 2011-01-15 00:45:00
BRCM	      386.15 2010-12-27 14:30:00	  723 2011-01-15 00:45:00
CELG	      386.15 2010-12-27 14:30:00	  654 2011-01-15 00:45:00
CREE	      386.15 2010-12-27 14:00:00	  693 2011-01-15 00:45:00
DE	      386.15 2010-12-27 13:00:00	  720 2011-01-15 00:45:00
DIS	      386.15 2010-12-27 13:00:00	  688 2011-01-15 00:45:00
EWZ	      386.15 2010-12-27 09:00:00	  900 2011-01-15 00:45:00
FFIV	      386.15 2010-12-27 12:30:00	  702 2011-01-15 00:45:00
GDX	      386.15 2010-12-27 13:00:00	  787 2011-01-15 00:45:00
GILD	      386.15 2010-12-27 13:30:00	  687 2011-01-15 00:45:00
GOOG	      386.15 2010-12-27 09:15:00	  804 2011-01-15 00:45:00
GS	      386.15 2010-12-27 13:00:00	  763 2011-01-15 00:45:00
HES	      386.15 2010-12-27 14:30:00	  723 2011-01-15 00:45:00
MMM	      386.15 2010-12-27 13:30:00	  714 2011-01-15 00:45:00
MON	      386.15 2010-12-27 13:30:00	  729 2011-01-15 00:45:00
MT	      386.15 2010-12-27 12:45:00	  898 2011-01-15 00:45:00
PBR	      386.15 2010-12-27 13:00:00	  789 2011-01-15 00:45:00
PM	      386.15 2010-12-27 13:30:00	  693 2011-01-15 00:45:00
POT	      386.15 2010-12-27 12:15:00	  785 2011-01-15 00:45:00
TEVA	      386.15 2010-12-27 13:00:00	  750 2011-01-15 00:45:00
TLT	      386.15 2010-12-27 12:30:00	  766 2011-01-15 00:45:00
VMW	    10466.15 2010-12-27 14:30:00	  457 2011-01-08 00:45:00
WFMI	    10466.15 2010-12-27 14:30:00	  451 2011-01-08 00:45:00
X	    10466.15 2010-12-27 13:00:00	  537 2011-01-08 00:45:00
AAPL	      386.15 2010-12-27 09:00:00	  927 2011-01-15 00:45:00
ALL	      386.15 2010-12-27 14:30:00	  658 2011-01-15 00:45:00
BUCY	      386.15 2010-12-27 14:15:00	  668 2011-01-15 00:45:00
CRM	      386.15 2010-12-27 13:00:00	  730 2011-01-15 00:45:00
DVN	      386.15 2010-12-27 13:00:00	  692 2011-01-15 00:45:00
FLS	      386.15 2010-12-27 14:30:00	  645 2011-01-15 00:45:00
JOYG	      386.15 2010-12-27 14:30:00	  686 2011-01-15 00:45:00
NUE	      386.15 2010-12-27 13:45:00	  680 2011-01-15 00:45:00
QCOM	      386.15 2010-12-27 13:00:00	  717 2011-01-15 00:45:00
SLV	      386.15 2010-12-27 09:30:00	  917 2011-01-15 00:45:00
ABX	      386.15 2010-12-27 14:30:00	  749 2011-01-15 00:45:00
AEM	      386.15 2010-12-27 14:30:00	  700 2011-01-15 00:45:00
AMX	      386.15 2010-12-27 14:30:00	  637 2011-01-15 00:45:00
ARG	      386.15 2010-12-27 14:00:00	  670 2011-01-15 00:45:00
CLF	      386.15 2010-12-27 12:30:00	  722 2011-01-15 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
COP	      386.15 2010-12-27 13:00:00	  737 2011-01-15 00:45:00
DIA	      386.15 2010-12-27 12:00:00	  832 2011-01-15 00:45:00
EFA	      386.15 2010-12-27 14:00:00	  720 2011-01-15 00:45:00
JWN	      386.15 2010-12-27 13:45:00	  651 2011-01-15 00:45:00
MCD	      386.15 2010-12-27 10:30:00	  812 2011-01-15 00:45:00
MJN	      386.15 2010-12-27 14:30:00	  642 2011-01-15 00:45:00
MRK	      386.15 2010-12-27 13:30:00	  709 2011-01-15 00:45:00
OIH	      386.15 2010-12-27 14:30:00	  712 2011-01-15 00:45:00
RIMM	      386.15 2010-12-27 12:45:00	  751 2011-01-15 00:45:00
WMT	    10466.15 2010-12-27 13:30:00	  450 2011-01-08 00:45:00
WYNN	    10466.15 2010-12-27 13:45:00	  458 2011-01-08 00:45:00

131 rows selected.

Elapsed: 00:00:00.05
07:11:09 SQL> 
07:11:09 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
