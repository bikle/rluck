
SQL*Plus: Release 11.2.0.1.0 Production on Wed May 11 01:16:08 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

01:16:08 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
01:16:08 SQL> 01:16:08 SQL> --
01:16:08 SQL> -- merge.sql
01:16:08 SQL> --
01:16:08 SQL> 
01:16:08 SQL> -- I use this script to merge data from ibs15min_stage into ibs15min.
01:16:08 SQL> 
01:16:08 SQL> -- Useful syntax for when things go haywire:
01:16:08 SQL> -- CREATE TABLE ibs15min	       (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
01:16:08 SQL> -- CREATE TABLE ibs15min_old	 (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
01:16:08 SQL> -- CREATE TABLE ibs15min_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
01:16:08 SQL> 
01:16:08 SQL> DROP TABLE ibs15min_old;

Table dropped.

Elapsed: 00:00:00.42
01:16:08 SQL> RENAME ibs15min TO ibs15min_old;

Table renamed.

Elapsed: 00:00:00.04
01:16:08 SQL> 
01:16:08 SQL> DROP TABLE ibs15min_dups_old;

Table dropped.

Elapsed: 00:00:00.28
01:16:09 SQL> RENAME ibs15min_dups TO ibs15min_dups_old;

Table renamed.

Elapsed: 00:00:00.04
01:16:09 SQL> 
01:16:09 SQL> CREATE TABLE ibs15min_dups COMPRESS AS
01:16:09   2  SELECT
01:16:09   3  tkr
01:16:09   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
01:16:09   5  ,clse
01:16:09   6  FROM ibs15min_stage
01:16:09   7  UNION
01:16:09   8  SELECT tkr,ydate,clse
01:16:09   9  FROM ibs15min_old
01:16:09  10  /
