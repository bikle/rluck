
SQL*Plus: Release 11.2.0.1.0 Production on Sat Feb 26 01:47:35 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

01:47:35 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
01:47:35 SQL> 01:47:35 SQL> --
01:47:35 SQL> -- merge.sql
01:47:35 SQL> --
01:47:35 SQL> 
01:47:35 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
01:47:35 SQL> 
01:47:35 SQL> 
01:47:35 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
01:47:35 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
01:47:35 SQL> 
01:47:35 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.23
01:47:35 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.03
01:47:35 SQL> 
01:47:35 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.21
01:47:36 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.03
01:47:36 SQL> 
01:47:36 SQL> CREATE TABLE ibs_dups COMPRESS AS
01:47:36   2  SELECT
01:47:36   3  tkr
01:47:36   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
01:47:36   5  ,clse
01:47:36   6  FROM ibs_stage
01:47:36   7  UNION
01:47:36   8  SELECT tkr,ydate,clse
01:47:36   9  FROM ibs_old
01:47:36  10  /

Table created.

Elapsed: 00:00:00.90
01:47:37 SQL> 
01:47:37 SQL> CREATE TABLE ibs15min COMPRESS AS
01:47:37   2  SELECT
01:47:37   3  tkr
01:47:37   4  ,ydate
01:47:37   5  ,AVG(clse)clse
01:47:37   6  FROM ibs_dups
01:47:37   7  GROUP BY tkr,ydate
01:47:37   8  /

Table created.

Elapsed: 00:00:00.59
01:47:37 SQL> 
01:47:37 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:01.47
01:47:39 SQL> 
01:47:39 SQL> -- rpt
01:47:39 SQL> 
01:47:39 SQL> SELECT
01:47:39   2  tkr
01:47:39   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
01:47:39   4  ,MIN(ydate)
01:47:39   5  ,COUNT(ydate)
01:47:39   6  ,MAX(ydate)FROM
01:47:39   7  ibs15min
01:47:39   8  GROUP BY tkr
01:47:39   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	       62.65 2010-12-27 13:00:00	 1962 2011-02-26 00:45:00
AKAM	       62.65 2010-12-27 12:45:00	 2058 2011-02-26 00:45:00
APA	       62.65 2010-12-27 12:45:00	 2039 2011-02-26 00:45:00
APC	       62.65 2010-12-27 14:15:00	 2073 2011-02-26 00:45:00
AXP	       62.65 2010-12-27 13:00:00	 2093 2011-02-26 00:45:00
BP	       62.65 2010-12-27 13:00:00	 2662 2011-02-26 00:45:00
BTU	       62.65 2010-12-27 12:45:00	 2087 2011-02-26 00:45:00
CAT	       62.65 2010-12-27 12:45:00	 2144 2011-02-26 00:45:00
CVS	    10142.65 2010-12-27 14:30:00	 1763 2011-02-19 00:45:00
GD	    10142.65 2010-12-27 13:00:00	 1982 2011-02-19 00:45:00
HL	    10142.65 2011-01-18 12:30:00	 1240 2011-02-19 00:45:00
MAR	    10142.65 2010-12-27 14:30:00	 1682 2011-02-19 00:45:00
MDT	    10142.65 2010-12-27 13:45:00	 1791 2011-02-19 00:45:00
QQQQ	    10142.65 2010-12-27 09:00:00	 2388 2011-02-19 00:45:00
SINA	    10142.65 2010-12-27 14:15:00	 1805 2011-02-19 00:45:00
SLW	    10142.65 2011-01-18 09:15:00	 1373 2011-02-19 00:45:00
SPY	    10142.65 2010-12-27 09:00:00	 2493 2011-02-19 00:45:00
SVM	    10142.65 2011-01-18 13:00:00	 1137 2011-02-19 00:45:00
V	    10142.65 2010-12-27 12:30:00	 2023 2011-02-19 00:45:00
VECO	    10142.65 2010-12-27 14:30:00	 1875 2011-02-19 00:45:00
WDC	    10142.65 2010-12-27 09:15:00	 1766 2011-02-19 00:45:00
XOM	    10142.65 2010-12-27 13:00:00	 2105 2011-02-19 00:45:00
AFL	       62.65 2010-12-27 14:30:00	 1875 2011-02-26 00:45:00
AMT	       62.65 2010-12-27 13:00:00	 1928 2011-02-26 00:45:00
AXU	       62.65 2011-01-18 13:00:00	 1275 2011-02-26 00:45:00
CTSH	    10142.65 2010-12-27 14:30:00	 1794 2011-02-19 00:45:00
GFI	    10142.65 2011-01-24 09:15:00	 1095 2011-02-19 00:45:00
IOC	    10142.65 2010-12-27 14:30:00	 1655 2011-02-19 00:45:00
JPM	    10142.65 2010-12-27 13:00:00	 2070 2011-02-19 00:45:00
SKX	    10142.65 2010-12-27 12:00:00	 1759 2011-02-19 00:45:00
SLB	    10142.65 2010-12-27 09:15:00	 2080 2011-02-19 00:45:00
STT	    10142.65 2010-12-27 14:30:00	 1695 2011-02-19 00:45:00
SU	    10142.65 2010-12-27 14:30:00	 1791 2011-02-19 00:45:00
TSO	    10142.65 2011-02-07 12:15:00	  479 2011-02-19 00:45:00
UNH	    10142.65 2010-12-27 13:00:00	 1802 2011-02-19 00:45:00
UNP	    10142.65 2010-12-27 14:30:00	 1747 2011-02-19 00:45:00
AIG	       62.65 2010-12-27 13:30:00	 2276 2011-02-26 00:45:00
BBY	       62.65 2010-12-27 12:00:00	 2107 2011-02-26 00:45:00
CDE	    10142.65 2011-01-18 11:45:00	 1188 2011-02-19 00:45:00
CSX	    10142.65 2010-12-27 14:30:00	 1768 2011-02-19 00:45:00
CVX	    10142.65 2010-12-27 13:00:00	 1901 2011-02-19 00:45:00
DD	    10142.65 2010-12-27 11:30:00	 1869 2011-02-19 00:45:00
EOG	    10142.65 2010-12-27 14:30:00	 1727 2011-02-19 00:45:00
FCX	    10142.65 2010-12-27 12:45:00	 2113 2011-02-19 00:45:00
FSLR	    10142.65 2010-12-27 13:00:00	 1788 2011-02-19 00:45:00
HD	    10142.65 2010-12-27 12:30:00	 1837 2011-02-19 00:45:00
HON	    10142.65 2010-12-27 14:15:00	 1737 2011-02-19 00:45:00
IBM	    10142.65 2010-12-27 12:45:00	 2084 2011-02-19 00:45:00
IWM	    10142.65 2010-12-27 11:00:00	 2314 2011-02-19 00:45:00
MEE	    10142.65 2010-12-27 13:15:00	 1853 2011-02-19 00:45:00
NFLX	    10142.65 2010-12-27 12:30:00	 1988 2011-02-19 00:45:00
PRU	    10142.65 2010-12-27 13:45:00	 1736 2011-02-19 00:45:00
UPS	    10142.65 2010-12-27 14:30:00	 1738 2011-02-19 00:45:00
WHR	    10142.65 2010-12-27 14:30:00	 1704 2011-02-19 00:45:00
XLB	    10142.65 2010-12-27 13:30:00	 1709 2011-02-19 00:45:00
XLE	    10142.65 2010-12-27 13:00:00	 1878 2011-02-19 00:45:00
BEN	       62.65 2010-12-27 13:00:00	 1880 2011-02-26 00:45:00
CHK	    10142.65 2011-01-18 13:00:00	 1200 2011-02-19 00:45:00
CMI	    10142.65 2010-12-27 12:30:00	 1838 2011-02-19 00:45:00
COST	    10142.65 2010-12-27 14:30:00	 1759 2011-02-19 00:45:00
DTV	    10142.65 2010-12-27 14:30:00	 1701 2011-02-19 00:45:00
ESRX	    10142.65 2010-12-27 14:30:00	 1717 2011-02-19 00:45:00
GG	    10142.65 2010-12-27 13:15:00	 1902 2011-02-19 00:45:00
HPQ	    10142.65 2010-12-27 12:15:00	 2064 2011-02-19 00:45:00
KO	    10142.65 2010-12-27 12:30:00	 2142 2011-02-19 00:45:00
MDY	    10142.65 2010-12-27 13:15:00	 1854 2011-02-19 00:45:00
MET	    10142.65 2010-12-27 14:30:00	 1730 2011-02-19 00:45:00
MVG	    10142.65 2011-01-18 14:15:00	 1024 2011-02-19 00:45:00
NOC	    10142.65 2011-01-24 13:30:00	  861 2011-02-19 00:45:00
PAAS	    10142.65 2011-01-18 14:00:00	 1195 2011-02-19 00:45:00
PALL	    10142.65 2011-01-18 14:00:00	 1068 2011-02-19 00:45:00
PNC	    10142.65 2010-12-27 14:15:00	 1783 2011-02-19 00:45:00
SJM	    10142.65 2010-12-27 14:30:00	 1661 2011-02-19 00:45:00
SNDK	    10142.65 2010-12-27 13:00:00	 1917 2011-02-19 00:45:00
SUN	    10142.65 2010-12-27 14:30:00	 1716 2011-02-19 00:45:00
SWC	    10142.65 2011-01-18 13:00:00	 1138 2011-02-19 00:45:00
TGT	    10142.65 2010-12-27 14:15:00	 1808 2011-02-19 00:45:00
TKR	    10142.65 2011-01-24 14:30:00	  850 2011-02-19 00:45:00
XLU	    10142.65 2010-12-27 14:30:00	 1668 2011-02-19 00:45:00
ABT	       62.65 2010-12-27 12:30:00	 2149 2011-02-26 00:45:00
AMGN	       62.65 2010-12-27 14:00:00	 1930 2011-02-26 00:45:00
AMZN	       62.65 2010-12-27 11:15:00	 2390 2011-02-26 00:45:00
BHP	       62.65 2010-12-27 12:15:00	 2645 2011-02-26 00:45:00
COF	    10142.65 2010-12-27 14:30:00	 1715 2011-02-19 00:45:00
DNDN	    10142.65 2010-12-27 14:15:00	 1779 2011-02-19 00:45:00
EBAY	    10142.65 2011-01-18 13:00:00	 1141 2011-02-19 00:45:00
EXK	    10142.65 2011-01-18 13:00:00	 1154 2011-02-19 00:45:00
FDX	    10142.65 2010-12-27 12:30:00	 1798 2011-02-19 00:45:00
GLD	    10142.65 2010-12-27 11:00:00	 2424 2011-02-19 00:45:00
JNJ	    10142.65 2010-12-27 11:15:00	 2160 2011-02-19 00:45:00
LFT	    10142.65 2010-12-27 14:00:00	 1663 2011-02-19 00:45:00
MOS	    10142.65 2010-12-27 13:30:00	 1981 2011-02-19 00:45:00
NEM	    10142.65 2010-12-27 14:15:00	 1992 2011-02-19 00:45:00
OXY	    10142.65 2010-12-27 14:30:00	 1827 2011-02-19 00:45:00
PEP	    10142.65 2010-12-27 14:15:00	 1801 2011-02-19 00:45:00
PG	    10142.65 2010-12-27 11:30:00	 2009 2011-02-19 00:45:00
RIG	    10142.65 2010-12-27 12:00:00	 2327 2011-02-19 00:45:00
VLO	    10142.65 2011-01-31 13:00:00	  753 2011-02-19 00:45:00
AGU	       62.65 2011-01-18 13:00:00	 1348 2011-02-26 00:45:00
BA	       62.65 2010-12-27 13:00:00	 2080 2011-02-26 00:45:00
BBT	       62.65 2010-12-27 14:15:00	 1940 2011-02-26 00:45:00
BIDU	       62.65 2010-12-27 12:15:00	 2249 2011-02-26 00:45:00
BRCM	       62.65 2010-12-27 14:30:00	 2099 2011-02-26 00:45:00
CELG	    10142.65 2010-12-27 14:30:00	 1720 2011-02-19 00:45:00
CREE	    10142.65 2010-12-27 14:00:00	 1878 2011-02-19 00:45:00
CVE	    10142.65 2011-01-31 13:00:00	  666 2011-02-19 00:45:00
DE	    10142.65 2010-12-27 13:00:00	 1899 2011-02-19 00:45:00
DIS	    10142.65 2010-12-27 13:00:00	 1812 2011-02-19 00:45:00
EWZ	    10142.65 2010-12-27 09:00:00	 2290 2011-02-19 00:45:00
FFIV	    10142.65 2010-12-27 12:30:00	 1886 2011-02-19 00:45:00
GDX	    10142.65 2010-12-27 13:00:00	 2033 2011-02-19 00:45:00
GILD	    10142.65 2010-12-27 13:30:00	 1795 2011-02-19 00:45:00
GOOG	    10142.65 2010-12-27 09:15:00	 2076 2011-02-19 00:45:00
GS	    10142.65 2010-12-27 13:00:00	 1949 2011-02-19 00:45:00
HES	    10142.65 2010-12-27 14:30:00	 1867 2011-02-19 00:45:00
MMM	    10142.65 2010-12-27 13:30:00	 1817 2011-02-19 00:45:00
MON	    10142.65 2010-12-27 13:30:00	 1911 2011-02-19 00:45:00
MT	    10142.65 2010-12-27 12:45:00	 2324 2011-02-19 00:45:00
PBR	    10142.65 2010-12-27 13:00:00	 2014 2011-02-19 00:45:00
PM	    10142.65 2010-12-27 13:30:00	 1748 2011-02-19 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
POT	    10142.65 2010-12-27 12:15:00	 2006 2011-02-19 00:45:00
RDY	    10142.65 2011-01-18 13:30:00	 1083 2011-02-19 00:45:00
SCCO	    10142.65 2011-01-18 13:30:00	 1135 2011-02-19 00:45:00
TEVA	    10142.65 2010-12-27 13:00:00	 2019 2011-02-19 00:45:00
TLT	    10142.65 2010-12-27 12:30:00	 2025 2011-02-19 00:45:00
VMW	    10142.65 2010-12-27 14:30:00	 1819 2011-02-19 00:45:00
WFMI	    10142.65 2010-12-27 14:30:00	 1773 2011-02-19 00:45:00
X	    10142.65 2010-12-27 13:00:00	 2151 2011-02-19 00:45:00
AAPL	       62.65 2010-12-27 09:00:00	 2667 2011-02-26 00:45:00
ALL	       62.65 2010-12-27 14:30:00	 1891 2011-02-26 00:45:00
BUCY	       62.65 2010-12-27 14:15:00	 1890 2011-02-26 00:45:00
CEO	    10142.65 2011-01-18 14:15:00	 1076 2011-02-19 00:45:00
CRM	    10142.65 2010-12-27 13:00:00	 1879 2011-02-19 00:45:00
DVN	    10142.65 2010-12-27 13:00:00	 1815 2011-02-19 00:45:00
FLS	    10142.65 2010-12-27 14:30:00	 1684 2011-02-19 00:45:00
JOYG	    10142.65 2010-12-27 14:30:00	 1778 2011-02-19 00:45:00
LMT	    10142.65 2011-01-24 14:15:00	  868 2011-02-19 00:45:00
NUE	    10142.65 2010-12-27 13:45:00	 1761 2011-02-19 00:45:00
PPLT	    10142.65 2011-01-18 14:30:00	 1045 2011-02-19 00:45:00
QCOM	    10142.65 2010-12-27 13:00:00	 1885 2011-02-19 00:45:00
SLV	    10142.65 2010-12-27 09:30:00	 2371 2011-02-19 00:45:00
SOHU	    10142.65 2011-01-18 14:30:00	 1086 2011-02-19 00:45:00
VALE	    10142.65 2011-01-18 13:00:00	 1218 2011-02-19 00:45:00
ABX	       62.65 2010-12-27 14:30:00	 2249 2011-02-26 00:45:00
AEM	       62.65 2010-12-27 14:30:00	 2040 2011-02-26 00:45:00
AMX	       62.65 2010-12-27 14:30:00	 1834 2011-02-26 00:45:00
ARG	       62.65 2010-12-27 14:00:00	 1920 2011-02-26 00:45:00
CLF	    10142.65 2010-12-27 12:30:00	 1874 2011-02-19 00:45:00
COP	    10142.65 2010-12-27 13:00:00	 1906 2011-02-19 00:45:00
DIA	    10142.65 2010-12-27 12:00:00	 2168 2011-02-19 00:45:00
EFA	    10142.65 2010-12-27 14:00:00	 1886 2011-02-19 00:45:00
JWN	    10142.65 2010-12-27 13:45:00	 1703 2011-02-19 00:45:00
MCD	    10142.65 2010-12-27 10:30:00	 2171 2011-02-19 00:45:00
MJN	    10142.65 2010-12-27 14:30:00	 1690 2011-02-19 00:45:00
MRK	    10142.65 2010-12-27 13:30:00	 1902 2011-02-19 00:45:00
OIH	    10142.65 2010-12-27 14:30:00	 1852 2011-02-19 00:45:00
RIMM	    10142.65 2010-12-27 12:45:00	 1952 2011-02-19 00:45:00
RTN	    10142.65 2011-01-24 14:30:00	  888 2011-02-19 00:45:00
WMT	    10142.65 2010-12-27 13:30:00	 1858 2011-02-19 00:45:00
WYNN	    10142.65 2010-12-27 13:45:00	 1862 2011-02-19 00:45:00

160 rows selected.

Elapsed: 00:00:00.11
01:47:39 SQL> 
01:47:39 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
