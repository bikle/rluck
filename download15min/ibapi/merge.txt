
SQL*Plus: Release 11.2.0.1.0 Production on Fri Mar 18 23:25:32 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

23:25:32 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
23:25:32 SQL> 23:25:32 SQL> --
23:25:32 SQL> -- merge.sql
23:25:32 SQL> --
23:25:32 SQL> 
23:25:32 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
23:25:32 SQL> 
23:25:32 SQL> 
23:25:32 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
23:25:32 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
23:25:32 SQL> 
23:25:32 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.21
23:25:32 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.03
23:25:32 SQL> 
23:25:32 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.27
23:25:32 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.04
23:25:32 SQL> 
23:25:32 SQL> CREATE TABLE ibs_dups COMPRESS AS
23:25:32   2  SELECT
23:25:32   3  tkr
23:25:32   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
23:25:32   5  ,clse
23:25:32   6  FROM ibs_stage
23:25:32   7  UNION
23:25:32   8  SELECT tkr,ydate,clse
23:25:32   9  FROM ibs_old
23:25:32  10  /

Table created.

Elapsed: 00:00:01.91
23:25:34 SQL> 
23:25:34 SQL> CREATE TABLE ibs15min COMPRESS AS
23:25:34   2  SELECT
23:25:34   3  tkr
23:25:34   4  ,ydate
23:25:34   5  ,AVG(clse)clse
23:25:34   6  FROM ibs_dups
23:25:34   7  GROUP BY tkr,ydate
23:25:34   8  /

Table created.

Elapsed: 00:00:02.07
23:25:36 SQL> 
23:25:36 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:02.36
23:25:39 SQL> 
23:25:39 SQL> -- rpt
23:25:39 SQL> 
23:25:39 SQL> SELECT
23:25:39   2  tkr
23:25:39   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
23:25:39   4  ,MIN(ydate)
23:25:39   5  ,COUNT(ydate)
23:25:39   6  ,MAX(ydate)FROM
23:25:39   7  ibs15min
23:25:39   8  GROUP BY tkr
23:25:39   9  ORDER BY tkr
23:25:39  10  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
AAPL	       70.65 2010-12-27 09:00:00	 3607 2011-03-18 22:15:00
ABT	       70.65 2010-12-27 12:30:00	 2855 2011-03-18 22:15:00
ABX	       70.65 2010-12-27 14:30:00	 3042 2011-03-18 22:15:00
ADBE	       70.65 2010-12-27 13:00:00	 2632 2011-03-18 22:15:00
AEM	       70.65 2010-12-27 14:30:00	 2753 2011-03-18 22:15:00
AFL	       70.65 2010-12-27 14:30:00	 2565 2011-03-18 22:15:00
AGU	       70.65 2011-01-18 13:00:00	 2059 2011-03-18 22:15:00
AIG	       70.65 2010-12-27 13:30:00	 3046 2011-03-18 22:15:00
AKAM	       70.65 2010-12-27 12:45:00	 2811 2011-03-18 22:15:00
ALL	       70.65 2010-12-27 14:30:00	 2534 2011-03-18 22:15:00
AMGN	       70.65 2010-12-27 14:00:00	 2593 2011-03-18 22:15:00
AMT	       70.65 2010-12-27 13:00:00	 2595 2011-03-18 22:15:00
AMX	       70.65 2010-12-27 14:30:00	 2477 2011-03-18 22:15:00
AMZN	       70.65 2010-12-27 11:15:00	 3203 2011-03-18 22:15:00
APA	       70.65 2010-12-27 12:45:00	 2749 2011-03-18 22:15:00
APC	       70.65 2010-12-27 14:15:00	 2749 2011-03-18 22:15:00
ARG	       70.65 2010-12-27 14:00:00	 2558 2011-03-18 22:15:00
AXP	       70.65 2010-12-27 13:00:00	 2821 2011-03-18 22:15:00
AXU	       70.65 2011-01-18 13:00:00	 1976 2011-03-18 22:15:00
BA	       70.65 2010-12-27 13:00:00	 2803 2011-03-18 22:15:00
BBT	       70.65 2010-12-27 14:15:00	 2635 2011-03-18 22:15:00
BBY	       70.65 2010-12-27 12:00:00	 2841 2011-03-18 22:15:00
BEN	       70.65 2010-12-27 13:00:00	 2528 2011-03-18 22:15:00
BHP	       70.65 2010-12-27 12:15:00	 3585 2011-03-18 22:15:00
BIDU	       70.65 2010-12-27 12:15:00	 3032 2011-03-18 22:15:00
BP	       70.65 2010-12-27 13:00:00	 3578 2011-03-18 22:15:00
BRCM	       70.65 2010-12-27 14:30:00	 2837 2011-03-18 22:15:00
BTU	       70.65 2010-12-27 12:45:00	 2826 2011-03-18 22:15:00
BUCY	       70.65 2010-12-27 14:15:00	 2528 2011-03-18 22:15:00
CAT	       70.65 2010-12-27 12:45:00	 2903 2011-03-18 22:15:00
CDE	       70.65 2011-01-18 11:45:00	 2129 2011-03-18 22:15:00
CELG	       70.65 2010-12-27 14:30:00	 2576 2011-03-18 22:15:00
CEO	       70.65 2011-01-18 14:15:00	 1925 2011-03-18 22:15:00
CHK	       70.65 2011-01-18 13:00:00	 2196 2011-03-18 22:15:00
CLF	       55.65 2010-12-27 12:30:00	 2813 2011-03-18 22:30:00
CMI	       55.65 2010-12-27 12:30:00	 2762 2011-03-18 22:30:00
COF	       55.65 2010-12-27 14:30:00	 2578 2011-03-18 22:30:00
COP	       55.65 2010-12-27 13:00:00	 2853 2011-03-18 22:30:00
COST	       55.65 2010-12-27 14:30:00	 2618 2011-03-18 22:30:00
CREE	       55.65 2010-12-27 14:00:00	 2816 2011-03-18 22:30:00
CRM	       55.65 2010-12-27 13:00:00	 2824 2011-03-18 22:30:00
CSX	       55.65 2010-12-27 14:30:00	 2642 2011-03-18 22:30:00
CTSH	       55.65 2010-12-27 14:30:00	 2667 2011-03-18 22:30:00
CVE	       55.65 2011-01-31 13:00:00	 1519 2011-03-18 22:30:00
CVS	       55.65 2010-12-27 14:30:00	 2621 2011-03-18 22:30:00
CVX	       55.65 2010-12-27 13:00:00	 2867 2011-03-18 22:30:00
DD	       55.65 2010-12-27 11:30:00	 2777 2011-03-18 22:30:00
DE	       55.65 2010-12-27 13:00:00	 2853 2011-03-18 22:30:00
DIA	       55.65 2010-12-27 12:00:00	 3246 2011-03-18 22:30:00
DIS	       55.65 2010-12-27 13:00:00	 2770 2011-03-18 22:30:00
DNDN	       55.65 2010-12-27 14:15:00	 2679 2011-03-18 22:30:00
DTV	       55.65 2010-12-27 14:30:00	 2539 2011-03-18 22:30:00
DVN	       55.65 2010-12-27 13:00:00	 2690 2011-03-18 22:30:00
EBAY	       55.65 2011-01-18 13:00:00	 2021 2011-03-18 22:30:00
EFA	       55.65 2010-12-27 14:00:00	 2870 2011-03-18 22:30:00
EOG	       55.65 2010-12-27 14:30:00	 2576 2011-03-18 22:30:00
ESRX	       55.65 2010-12-27 14:30:00	 2553 2011-03-18 22:30:00
EWZ	       55.65 2010-12-27 09:00:00	 3376 2011-03-18 22:30:00
EXK	       55.65 2011-01-18 13:00:00	 2089 2011-03-18 22:30:00
FCX	       55.65 2010-12-27 12:45:00	 3179 2011-03-18 22:30:00
FDX	       55.65 2010-12-27 12:30:00	 2691 2011-03-18 22:30:00
FFIV	       55.65 2010-12-27 12:30:00	 2822 2011-03-18 22:30:00
FLS	       55.65 2010-12-27 14:30:00	 2482 2011-03-18 22:30:00
FSLR	       55.65 2010-12-27 13:00:00	 2759 2011-03-18 22:30:00
GD	       55.65 2010-12-27 13:00:00	 3008 2011-03-18 22:30:00
GDX	       55.65 2010-12-27 13:00:00	 3083 2011-03-18 22:30:00
GFI	       55.65 2011-01-24 09:15:00	 2097 2011-03-18 22:30:00
GG	       55.65 2010-12-27 13:15:00	 2881 2011-03-18 22:30:00
GILD	       55.65 2010-12-27 13:30:00	 2645 2011-03-18 22:30:00
GLD	       40.65 2010-12-27 11:00:00	 3573 2011-03-18 22:45:00
GOOG	       40.65 2010-12-27 09:15:00	 3095 2011-03-18 22:45:00
GS	       40.65 2010-12-27 13:00:00	 2901 2011-03-18 22:45:00
HD	       40.65 2010-12-27 12:30:00	 2740 2011-03-18 22:45:00
HES	       40.65 2010-12-27 14:30:00	 2737 2011-03-18 22:45:00
HL	       40.65 2011-01-18 12:30:00	 2276 2011-03-18 22:45:00
HOC	       40.65 2011-02-14 14:00:00	 1073 2011-03-18 22:45:00
HON	       40.65 2010-12-27 14:15:00	 2623 2011-03-18 22:45:00
HPQ	       40.65 2010-12-27 12:15:00	 3100 2011-03-18 22:45:00
IBM	       40.65 2010-12-27 12:45:00	 3190 2011-03-18 22:45:00
IOC	       40.65 2010-12-27 14:30:00	 2481 2011-03-18 22:45:00
IWM	       40.65 2010-12-27 11:00:00	 3470 2011-03-18 22:45:00
JNJ	       40.65 2010-12-27 11:15:00	 3197 2011-03-18 22:45:00
JOYG	       40.65 2010-12-27 14:30:00	 2690 2011-03-18 22:45:00
JPM	       40.65 2010-12-27 13:00:00	 3073 2011-03-18 22:45:00
JWN	       40.65 2010-12-27 13:45:00	 2529 2011-03-18 22:45:00
KO	       40.65 2010-12-27 12:30:00	 3134 2011-03-18 22:45:00
LFT	       40.65 2010-12-27 14:00:00	 2471 2011-03-18 22:45:00
LMT	       40.65 2011-01-24 14:15:00	 1709 2011-03-18 22:45:00
MAR	       40.65 2010-12-27 14:30:00	 2510 2011-03-18 22:45:00
MCD	       40.65 2010-12-27 10:30:00	 3181 2011-03-18 22:45:00
MDT	       40.65 2010-12-27 13:45:00	 2663 2011-03-18 22:45:00
MDY	       40.65 2010-12-27 13:15:00	 2781 2011-03-18 22:45:00
MEE	       40.65 2010-12-27 13:15:00	 2748 2011-03-18 22:45:00
MET	       40.65 2010-12-27 14:30:00	 2633 2011-03-18 22:45:00
MJN	       40.65 2010-12-27 14:30:00	 2503 2011-03-18 22:45:00
MMM	       40.65 2010-12-27 13:30:00	 2764 2011-03-18 22:45:00
MON	       40.65 2010-12-27 13:30:00	 2853 2011-03-18 22:45:00
MOS	       40.65 2010-12-27 13:30:00	 2949 2011-03-18 22:45:00
MRK	       40.65 2010-12-27 13:30:00	 2875 2011-03-18 22:45:00
MT	       40.65 2010-12-27 12:45:00	 3443 2011-03-18 22:45:00
MVG	       40.65 2011-01-18 14:15:00	 1850 2011-03-18 22:45:00
NEM	       40.65 2010-12-27 14:15:00	 2939 2011-03-18 22:45:00
NFLX	       40.65 2010-12-27 12:30:00	 2968 2011-03-18 22:45:00
NOC	       40.65 2011-01-24 13:30:00	 1689 2011-03-18 22:45:00
NUE	       25.65 2010-12-27 13:45:00	 2648 2011-03-18 23:00:00
OIH	       25.65 2010-12-27 14:30:00	 2760 2011-03-18 23:00:00
ORCL	       85.65 2011-02-22 12:00:00	 1005 2011-03-18 22:00:00
OXY	       25.65 2010-12-27 14:30:00	 2695 2011-03-18 23:00:00
PAAS	       25.65 2011-01-18 14:00:00	 2131 2011-03-18 23:00:00
PALL	       25.65 2011-01-18 14:00:00	 1949 2011-03-18 23:00:00
PBR	       25.65 2010-12-27 13:00:00	 3008 2011-03-18 23:00:00
PEP	       25.65 2010-12-27 14:15:00	 2683 2011-03-18 23:00:00
PG	       25.65 2010-12-27 11:30:00	 3016 2011-03-18 23:00:00
PM	       25.65 2010-12-27 13:30:00	 2612 2011-03-18 23:00:00
PNC	       25.65 2010-12-27 14:15:00	 2667 2011-03-18 23:00:00
POT	       25.65 2010-12-27 12:15:00	 2978 2011-03-18 23:00:00
PPLT	       25.65 2011-01-18 14:30:00	 1886 2011-03-18 23:00:00
PRU	       25.65 2010-12-27 13:45:00	 2640 2011-03-18 23:00:00
QCOM	       25.65 2010-12-27 13:00:00	 2856 2011-03-18 23:00:00
QQQQ	       25.65 2010-12-27 09:00:00	 3571 2011-03-18 23:00:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
RDY	       25.65 2011-01-18 13:30:00	 1911 2011-03-18 23:00:00
RIG	       25.65 2010-12-27 12:00:00	 3444 2011-03-18 23:00:00
RIMM	       25.65 2010-12-27 12:45:00	 2924 2011-03-18 23:00:00
RTN	       25.65 2011-01-24 14:30:00	 1714 2011-03-18 23:00:00
SCCO	       25.65 2011-01-18 13:30:00	 2030 2011-03-18 23:00:00
SINA	       25.65 2010-12-27 14:15:00	 2722 2011-03-18 23:00:00
SJM	       25.65 2010-12-27 14:30:00	 2460 2011-03-18 23:00:00
SKX	       25.65 2010-12-27 12:00:00	 2588 2011-03-18 23:00:00
SLB	       25.65 2010-12-27 09:15:00	 3113 2011-03-18 23:00:00
SLV	       25.65 2010-12-27 09:30:00	 3521 2011-03-18 23:00:00
SLW	       25.65 2011-01-18 09:15:00	 2453 2011-03-18 23:00:00
SNDK	       25.65 2010-12-27 13:00:00	 2863 2011-03-18 23:00:00
SOHU	       25.65 2011-01-18 14:30:00	 1952 2011-03-18 23:00:00
SPY	       25.65 2010-12-27 09:00:00	 3694 2011-03-18 23:00:00
STT	       25.65 2010-12-27 14:30:00	 2531 2011-03-18 23:00:00
SU	       25.65 2010-12-27 14:30:00	 2741 2011-03-18 23:00:00
SUN	       25.65 2010-12-27 14:30:00	 2555 2011-03-18 23:00:00
SVM	       25.65 2011-01-18 13:00:00	 2076 2011-03-18 23:00:00
SWC	       25.65 2011-01-18 13:00:00	 2039 2011-03-18 23:00:00
T	       85.65 2010-12-27 12:30:00	 3134 2011-03-18 22:00:00
TEVA	       25.65 2010-12-27 13:00:00	 3014 2011-03-18 23:00:00
TGT	       10.65 2010-12-27 14:15:00	 2730 2011-03-18 23:15:00
TKR	       10.65 2011-01-24 14:30:00	 1656 2011-03-18 23:15:00
TLT	       10.65 2010-12-27 12:30:00	 3019 2011-03-18 23:15:00
TSO	       10.65 2011-02-07 12:15:00	 1412 2011-03-18 23:15:00
UNH	       10.65 2010-12-27 13:00:00	 2667 2011-03-18 23:15:00
UNP	       10.65 2010-12-27 14:30:00	 2618 2011-03-18 23:15:00
UPS	       10.65 2010-12-27 14:30:00	 2601 2011-03-18 23:15:00
V	       10.65 2010-12-27 12:30:00	 3049 2011-03-18 23:15:00
VALE	       10.65 2011-01-18 13:00:00	 2177 2011-03-18 23:15:00
VECO	       10.65 2010-12-27 14:30:00	 2771 2011-03-18 23:15:00
VLO	       10.65 2011-01-31 13:00:00	 1695 2011-03-18 23:15:00
VMW	       10.65 2010-12-27 14:30:00	 2692 2011-03-18 23:15:00
WDC	       10.65 2010-12-27 09:15:00	 2637 2011-03-18 23:15:00
WFMI	       10.65 2010-12-27 14:30:00	 2635 2011-03-18 23:15:00
WHR	       10.65 2010-12-27 14:30:00	 2552 2011-03-18 23:15:00
WMT	       10.65 2010-12-27 13:30:00	 2841 2011-03-18 23:15:00
WYNN	       10.65 2010-12-27 13:45:00	 2773 2011-03-18 23:15:00
X	       10.65 2010-12-27 13:00:00	 3224 2011-03-18 23:15:00
XLB	       10.65 2010-12-27 13:30:00	 2547 2011-03-18 23:15:00
XLE	       10.65 2010-12-27 13:00:00	 2835 2011-03-18 23:15:00
XLU	       10.65 2010-12-27 14:30:00	 2520 2011-03-18 23:15:00
XOM	       10.65 2010-12-27 13:00:00	 3199 2011-03-18 23:15:00

163 rows selected.

Elapsed: 00:00:00.19
23:25:39 SQL> 
23:25:39 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
