
SQL*Plus: Release 11.2.0.1.0 Production on Sat Mar 5 00:28:25 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

00:28:25 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
00:28:25 SQL> 00:28:25 SQL> --
00:28:25 SQL> -- merge.sql
00:28:25 SQL> --
00:28:25 SQL> 
00:28:25 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
00:28:25 SQL> 
00:28:25 SQL> 
00:28:25 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
00:28:25 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
00:28:25 SQL> 
00:28:25 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.24
00:28:25 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.06
00:28:26 SQL> 
00:28:26 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.21
00:28:26 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.03
00:28:26 SQL> 
00:28:26 SQL> CREATE TABLE ibs_dups COMPRESS AS
00:28:26   2  SELECT
00:28:26   3  tkr
00:28:26   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
00:28:26   5  ,clse
00:28:26   6  FROM ibs_stage
00:28:26   7  UNION
00:28:26   8  SELECT tkr,ydate,clse
00:28:26   9  FROM ibs_old
00:28:26  10  /

Table created.

Elapsed: 00:00:01.15
00:28:27 SQL> 
00:28:27 SQL> CREATE TABLE ibs15min COMPRESS AS
00:28:27   2  SELECT
00:28:27   3  tkr
00:28:27   4  ,ydate
00:28:27   5  ,AVG(clse)clse
00:28:27   6  FROM ibs_dups
00:28:27   7  GROUP BY tkr,ydate
00:28:27   8  /

Table created.

Elapsed: 00:00:01.09
00:28:28 SQL> 
00:28:28 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:02.23
00:28:30 SQL> 
00:28:30 SQL> -- rpt
00:28:30 SQL> 
00:28:30 SQL> SELECT
00:28:30   2  tkr
00:28:30   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
00:28:30   4  ,MIN(ydate)
00:28:30   5  ,COUNT(ydate)
00:28:30   6  ,MAX(ydate)FROM
00:28:30   7  ibs15min
00:28:30   8  GROUP BY tkr
00:28:30   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE		43.5 2010-12-27 13:00:00	 2183 2011-03-04 23:45:00
AKAM		43.5 2010-12-27 12:45:00	 2303 2011-03-04 23:45:00
APA		43.5 2010-12-27 12:45:00	 2269 2011-03-04 23:45:00
APC		43.5 2010-12-27 14:15:00	 2297 2011-03-04 23:45:00
AXP		43.5 2010-12-27 13:00:00	 2328 2011-03-04 23:45:00
BP		43.5 2010-12-27 13:00:00	 2956 2011-03-04 23:45:00
BTU		28.5 2010-12-27 12:45:00	 2332 2011-03-05 00:00:00
CAT		28.5 2010-12-27 12:45:00	 2396 2011-03-05 00:00:00
CVS		28.5 2010-12-27 14:30:00	 2168 2011-03-05 00:00:00
GD		28.5 2010-12-27 13:00:00	 2474 2011-03-05 00:00:00
HL	     10063.5 2011-01-18 12:30:00	 1476 2011-02-26 00:45:00
MAR	     10063.5 2010-12-27 14:30:00	 1861 2011-02-26 00:45:00
MDT	     10063.5 2010-12-27 13:45:00	 1983 2011-02-26 00:45:00
QQQQ	     10063.5 2010-12-27 09:00:00	 2635 2011-02-26 00:45:00
SINA	     10063.5 2010-12-27 14:15:00	 2001 2011-02-26 00:45:00
SLW	     10063.5 2011-01-18 09:15:00	 1603 2011-02-26 00:45:00
SPY	     10063.5 2010-12-27 09:00:00	 2749 2011-02-26 00:45:00
SVM	     10063.5 2011-01-18 13:00:00	 1342 2011-02-26 00:45:00
V	     10063.5 2010-12-27 12:30:00	 2268 2011-02-26 00:45:00
VECO	     10063.5 2010-12-27 14:30:00	 2069 2011-02-26 00:45:00
WDC	     10063.5 2010-12-27 09:15:00	 1950 2011-02-26 00:45:00
XOM	     10063.5 2010-12-27 13:00:00	 2357 2011-02-26 00:45:00
AFL		43.5 2010-12-27 14:30:00	 2091 2011-03-04 23:45:00
AMT		43.5 2010-12-27 13:00:00	 2143 2011-03-04 23:45:00
AXU		43.5 2011-01-18 13:00:00	 1508 2011-03-04 23:45:00
CTSH		28.5 2010-12-27 14:30:00	 2204 2011-03-05 00:00:00
GFI		28.5 2011-01-24 09:15:00	 1577 2011-03-05 00:00:00
IOC	     10063.5 2010-12-27 14:30:00	 1826 2011-02-26 00:45:00
JPM	     10063.5 2010-12-27 13:00:00	 2291 2011-02-26 00:45:00
SKX	     10063.5 2010-12-27 12:00:00	 1939 2011-02-26 00:45:00
SLB	     10063.5 2010-12-27 09:15:00	 2289 2011-02-26 00:45:00
STT	     10063.5 2010-12-27 14:30:00	 1882 2011-02-26 00:45:00
SU	     10063.5 2010-12-27 14:30:00	 1995 2011-02-26 00:45:00
TSO	     10063.5 2011-02-07 12:15:00	  675 2011-02-26 00:45:00
UNH	     10063.5 2010-12-27 13:00:00	 2004 2011-02-26 00:45:00
UNP	     10063.5 2010-12-27 14:30:00	 1936 2011-02-26 00:45:00
AIG		43.5 2010-12-27 13:30:00	 2521 2011-03-04 23:45:00
BBY		43.5 2010-12-27 12:00:00	 2349 2011-03-04 23:45:00
CDE		28.5 2011-01-18 11:45:00	 1639 2011-03-05 00:00:00
CSX		28.5 2010-12-27 14:30:00	 2189 2011-03-05 00:00:00
CVX		28.5 2010-12-27 13:00:00	 2369 2011-03-05 00:00:00
DD		28.5 2010-12-27 11:30:00	 2302 2011-03-05 00:00:00
EOG		28.5 2010-12-27 14:30:00	 2141 2011-03-05 00:00:00
FCX		28.5 2010-12-27 12:45:00	 2609 2011-03-05 00:00:00
FSLR		28.5 2010-12-27 13:00:00	 2260 2011-03-05 00:00:00
HD		13.5 2010-12-27 12:30:00	 2263 2011-03-05 00:15:00
HON	     10063.5 2010-12-27 14:15:00	 1933 2011-02-26 00:45:00
IBM	     10063.5 2010-12-27 12:45:00	 2327 2011-02-26 00:45:00
IWM	     10063.5 2010-12-27 11:00:00	 2562 2011-02-26 00:45:00
MEE	     10063.5 2010-12-27 13:15:00	 2034 2011-02-26 00:45:00
NFLX	     10063.5 2010-12-27 12:30:00	 2192 2011-02-26 00:45:00
PRU	     10063.5 2010-12-27 13:45:00	 1923 2011-02-26 00:45:00
UPS	     10063.5 2010-12-27 14:30:00	 1920 2011-02-26 00:45:00
WHR	     10063.5 2010-12-27 14:30:00	 1886 2011-02-26 00:45:00
XLB	     10063.5 2010-12-27 13:30:00	 1880 2011-02-26 00:45:00
XLE	     10063.5 2010-12-27 13:00:00	 2084 2011-02-26 00:45:00
BEN		43.5 2010-12-27 13:00:00	 2088 2011-03-04 23:45:00
CHK		28.5 2011-01-18 13:00:00	 1681 2011-03-05 00:00:00
CMI		28.5 2010-12-27 12:30:00	 2278 2011-03-05 00:00:00
COST		28.5 2010-12-27 14:30:00	 2165 2011-03-05 00:00:00
DTV		28.5 2010-12-27 14:30:00	 2092 2011-03-05 00:00:00
ESRX		28.5 2010-12-27 14:30:00	 2105 2011-03-05 00:00:00
GG		13.5 2010-12-27 13:15:00	 2368 2011-03-05 00:15:00
HPQ	     10063.5 2010-12-27 12:15:00	 2305 2011-02-26 00:45:00
KO	     10063.5 2010-12-27 12:30:00	 2350 2011-02-26 00:45:00
MDY	     10063.5 2010-12-27 13:15:00	 2046 2011-02-26 00:45:00
MET	     10063.5 2010-12-27 14:30:00	 1901 2011-02-26 00:45:00
MVG	     10063.5 2011-01-18 14:15:00	 1197 2011-02-26 00:45:00
NOC	     10063.5 2011-01-24 13:30:00	 1044 2011-02-26 00:45:00
PAAS	     10063.5 2011-01-18 14:00:00	 1400 2011-02-26 00:45:00
PALL	     10063.5 2011-01-18 14:00:00	 1258 2011-02-26 00:45:00
PNC	     10063.5 2010-12-27 14:15:00	 1972 2011-02-26 00:45:00
SJM	     10063.5 2010-12-27 14:30:00	 1830 2011-02-26 00:45:00
SNDK	     10063.5 2010-12-27 13:00:00	 2111 2011-02-26 00:45:00
SUN	     10063.5 2010-12-27 14:30:00	 1891 2011-02-26 00:45:00
SWC	     10063.5 2011-01-18 13:00:00	 1335 2011-02-26 00:45:00
TGT	     10063.5 2010-12-27 14:15:00	 1997 2011-02-26 00:45:00
TKR	     10063.5 2011-01-24 14:30:00	 1018 2011-02-26 00:45:00
XLU	     10063.5 2010-12-27 14:30:00	 1848 2011-02-26 00:45:00
ABT		43.5 2010-12-27 12:30:00	 2373 2011-03-04 23:45:00
AMGN		43.5 2010-12-27 14:00:00	 2146 2011-03-04 23:45:00
AMZN		43.5 2010-12-27 11:15:00	 2649 2011-03-04 23:45:00
BHP		43.5 2010-12-27 12:15:00	 2961 2011-03-04 23:45:00
COF		28.5 2010-12-27 14:30:00	 2126 2011-03-05 00:00:00
DNDN		28.5 2010-12-27 14:15:00	 2207 2011-03-05 00:00:00
EBAY		28.5 2011-01-18 13:00:00	 1567 2011-03-05 00:00:00
EXK		28.5 2011-01-18 13:00:00	 1588 2011-03-05 00:00:00
FDX		28.5 2010-12-27 12:30:00	 2223 2011-03-05 00:00:00
GLD		13.5 2010-12-27 11:00:00	 2969 2011-03-05 00:15:00
JNJ	     10063.5 2010-12-27 11:15:00	 2399 2011-02-26 00:45:00
LFT	     10063.5 2010-12-27 14:00:00	 1831 2011-02-26 00:45:00
MOS	     10063.5 2010-12-27 13:30:00	 2191 2011-02-26 00:45:00
NEM	     10063.5 2010-12-27 14:15:00	 2193 2011-02-26 00:45:00
OXY	     10063.5 2010-12-27 14:30:00	 2020 2011-02-26 00:45:00
PEP	     10063.5 2010-12-27 14:15:00	 1988 2011-02-26 00:45:00
PG	     10063.5 2010-12-27 11:30:00	 2212 2011-02-26 00:45:00
RIG	     10063.5 2010-12-27 12:00:00	 2554 2011-02-26 00:45:00
VLO	     10063.5 2011-01-31 13:00:00	  955 2011-02-26 00:45:00
AGU		43.5 2011-01-18 13:00:00	 1572 2011-03-04 23:45:00
BA		43.5 2010-12-27 13:00:00	 2324 2011-03-04 23:45:00
BBT		43.5 2010-12-27 14:15:00	 2165 2011-03-04 23:45:00
BIDU		43.5 2010-12-27 12:15:00	 2506 2011-03-04 23:45:00
BRCM		43.5 2010-12-27 14:30:00	 2344 2011-03-04 23:45:00
CELG		28.5 2010-12-27 14:30:00	 2125 2011-03-05 00:00:00
CREE		28.5 2010-12-27 14:00:00	 2298 2011-03-05 00:00:00
CVE		28.5 2011-01-31 13:00:00	 1077 2011-03-05 00:00:00
DE		28.5 2010-12-27 13:00:00	 2359 2011-03-05 00:00:00
DIS		28.5 2010-12-27 13:00:00	 2267 2011-03-05 00:00:00
EWZ		28.5 2010-12-27 09:00:00	 2788 2011-03-05 00:00:00
FFIV		28.5 2010-12-27 12:30:00	 2324 2011-03-05 00:00:00
GDX		28.5 2010-12-27 13:00:00	 2523 2011-03-05 00:00:00
GILD		13.5 2010-12-27 13:30:00	 2201 2011-03-05 00:15:00
GOOG		13.5 2010-12-27 09:15:00	 2562 2011-03-05 00:15:00
GS		13.5 2010-12-27 13:00:00	 2389 2011-03-05 00:15:00
HES	     10063.5 2010-12-27 14:30:00	 2055 2011-02-26 00:45:00
HOC	     10063.5 2011-02-14 14:00:00	  417 2011-02-26 00:45:00
MMM	     10063.5 2010-12-27 13:30:00	 2012 2011-02-26 00:45:00
MON	     10063.5 2010-12-27 13:30:00	 2109 2011-02-26 00:45:00
MT	     10063.5 2010-12-27 12:45:00	 2559 2011-02-26 00:45:00
PBR	     10063.5 2010-12-27 13:00:00	 2238 2011-02-26 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
PM	     10063.5 2010-12-27 13:30:00	 1933 2011-02-26 00:45:00
POT	     10063.5 2010-12-27 12:15:00	 2210 2011-02-26 00:45:00
RDY	     10063.5 2011-01-18 13:30:00	 1263 2011-02-26 00:45:00
SCCO	     10063.5 2011-01-18 13:30:00	 1331 2011-02-26 00:45:00
TEVA	     10063.5 2010-12-27 13:00:00	 2236 2011-02-26 00:45:00
TLT	     10063.5 2010-12-27 12:30:00	 2242 2011-02-26 00:45:00
VMW	     10063.5 2010-12-27 14:30:00	 2014 2011-02-26 00:45:00
WFMI	     10063.5 2010-12-27 14:30:00	 1962 2011-02-26 00:45:00
X	     10063.5 2010-12-27 13:00:00	 2361 2011-02-26 00:45:00
AAPL		43.5 2010-12-27 09:00:00	 2983 2011-03-04 23:45:00
ALL		43.5 2010-12-27 14:30:00	 2107 2011-03-04 23:45:00
BUCY		28.5 2010-12-27 14:15:00	 2102 2011-03-05 00:00:00
CEO		28.5 2011-01-18 14:15:00	 1488 2011-03-05 00:00:00
CRM		28.5 2010-12-27 13:00:00	 2335 2011-03-05 00:00:00
DVN		28.5 2010-12-27 13:00:00	 2226 2011-03-05 00:00:00
FLS		28.5 2010-12-27 14:30:00	 2063 2011-03-05 00:00:00
JOYG	     10063.5 2010-12-27 14:30:00	 1981 2011-02-26 00:45:00
LMT	     10063.5 2011-01-24 14:15:00	 1052 2011-02-26 00:45:00
NUE	     10063.5 2010-12-27 13:45:00	 1941 2011-02-26 00:45:00
PPLT	     10063.5 2011-01-18 14:30:00	 1224 2011-02-26 00:45:00
QCOM	     10063.5 2010-12-27 13:00:00	 2085 2011-02-26 00:45:00
SLV	     10063.5 2010-12-27 09:30:00	 2622 2011-02-26 00:45:00
SOHU	     10063.5 2011-01-18 14:30:00	 1277 2011-02-26 00:45:00
VALE	     10063.5 2011-01-18 13:00:00	 1421 2011-02-26 00:45:00
ABX		43.5 2010-12-27 14:30:00	 2505 2011-03-04 23:45:00
AEM		43.5 2010-12-27 14:30:00	 2272 2011-03-04 23:45:00
AMX		43.5 2010-12-27 14:30:00	 2041 2011-03-04 23:45:00
ARG		43.5 2010-12-27 14:00:00	 2130 2011-03-04 23:45:00
CLF		28.5 2010-12-27 12:30:00	 2315 2011-03-05 00:00:00
COP		28.5 2010-12-27 13:00:00	 2357 2011-03-05 00:00:00
DIA		28.5 2010-12-27 12:00:00	 2664 2011-03-05 00:00:00
EFA		28.5 2010-12-27 14:00:00	 2330 2011-03-05 00:00:00
JWN	     10063.5 2010-12-27 13:45:00	 1880 2011-02-26 00:45:00
MCD	     10063.5 2010-12-27 10:30:00	 2390 2011-02-26 00:45:00
MJN	     10063.5 2010-12-27 14:30:00	 1871 2011-02-26 00:45:00
MRK	     10063.5 2010-12-27 13:30:00	 2105 2011-02-26 00:45:00
OIH	     10063.5 2010-12-27 14:30:00	 2056 2011-02-26 00:45:00
RIMM	     10063.5 2010-12-27 12:45:00	 2170 2011-02-26 00:45:00
RTN	     10063.5 2011-01-24 14:30:00	 1060 2011-02-26 00:45:00
WMT	     10063.5 2010-12-27 13:30:00	 2056 2011-02-26 00:45:00
WYNN	     10063.5 2010-12-27 13:45:00	 2054 2011-02-26 00:45:00

161 rows selected.

Elapsed: 00:00:00.14
00:28:30 SQL> 
00:28:30 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
