
SQL*Plus: Release 11.2.0.1.0 Production on Sat Jan 8 11:31:55 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

11:31:56 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
11:31:56 SQL> 11:31:56 SQL> --
11:31:56 SQL> -- merge.sql
11:31:56 SQL> --
11:31:56 SQL> 
11:31:56 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
11:31:56 SQL> 
11:31:56 SQL> 
11:31:56 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
11:31:56 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
11:31:56 SQL> 
11:31:56 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.23
11:31:56 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.06
11:31:56 SQL> 
11:31:56 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.27
11:31:56 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.04
11:31:56 SQL> 
11:31:56 SQL> CREATE TABLE ibs_dups COMPRESS AS
11:31:56   2  SELECT
11:31:56   3  tkr
11:31:56   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
11:31:56   5  ,clse
11:31:56   6  FROM ibs_stage
11:31:56   7  UNION
11:31:56   8  SELECT tkr,ydate,clse
11:31:56   9  FROM ibs_old
11:31:56  10  /

Table created.

Elapsed: 00:00:00.44
11:31:57 SQL> 
11:31:57 SQL> CREATE TABLE ibs15min COMPRESS AS
11:31:57   2  SELECT
11:31:57   3  tkr
11:31:57   4  ,ydate
11:31:57   5  ,AVG(clse)clse
11:31:57   6  FROM ibs_dups
11:31:57   7  GROUP BY tkr,ydate
11:31:57   8  /

Table created.

Elapsed: 00:00:00.39
11:31:57 SQL> 
11:31:57 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:00.39
11:31:57 SQL> 
11:31:57 SQL> -- rpt
11:31:57 SQL> 
11:31:57 SQL> SELECT
11:31:57   2  tkr
11:31:57   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
11:31:57   4  ,MIN(ydate)
11:31:57   5  ,COUNT(ydate)
11:31:57   6  ,MAX(ydate)FROM
11:31:57   7  ibs15min
11:31:57   8  GROUP BY tkr
11:31:57   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	      646.95 2010-12-27 13:00:00	  459 2011-01-08 00:45:00
AKAM	      646.95 2010-12-27 12:45:00	  475 2011-01-08 00:45:00
APA	      646.95 2010-12-27 12:45:00	  461 2011-01-08 00:45:00
APC	      646.95 2010-12-27 14:15:00	  489 2011-01-08 00:45:00
AXP	      646.95 2010-12-27 13:00:00	  481 2011-01-08 00:45:00
BP	      646.95 2010-12-27 13:00:00	  597 2011-01-08 00:45:00
BTU	      646.95 2010-12-27 12:45:00	  472 2011-01-08 00:45:00
CAT	      646.95 2010-12-27 12:45:00	  480 2011-01-08 00:45:00
CVS	      646.95 2010-12-27 14:30:00	  439 2011-01-08 00:45:00
MAR	      646.95 2010-12-27 14:30:00	  428 2011-01-08 00:45:00
MDT	      646.95 2010-12-27 13:45:00	  466 2011-01-08 00:45:00
QQQQ	      646.95 2010-12-27 09:00:00	  633 2011-01-08 00:45:00
SINA	      646.95 2010-12-27 14:15:00	  458 2011-01-08 00:45:00
SPY	      646.95 2010-12-27 09:00:00	  640 2011-01-08 00:45:00
V	      646.95 2010-12-27 12:30:00	  502 2011-01-08 00:45:00
VECO	      646.95 2010-12-27 14:30:00	  452 2011-01-08 00:45:00
WDC	      646.95 2010-12-27 09:15:00	  481 2011-01-08 00:45:00
XOM	      646.95 2010-12-27 13:00:00	  517 2011-01-08 00:45:00
AFL	      646.95 2010-12-27 14:30:00	  430 2011-01-08 00:45:00
AMT	      646.95 2010-12-27 13:00:00	  445 2011-01-08 00:45:00
CTSH	      646.95 2010-12-27 14:30:00	  457 2011-01-08 00:45:00
IOC	      646.95 2010-12-27 14:30:00	  428 2011-01-08 00:45:00
JPM	      646.95 2010-12-27 13:00:00	  495 2011-01-08 00:45:00
SKX	      646.95 2010-12-27 12:00:00	  473 2011-01-08 00:45:00
SLB	      646.95 2010-12-27 09:15:00	  516 2011-01-08 00:45:00
STT	      646.95 2010-12-27 14:30:00	  447 2011-01-08 00:45:00
UNH	      646.95 2010-12-27 13:00:00	  460 2011-01-08 00:45:00
UNP	      646.95 2010-12-27 14:30:00	  439 2011-01-08 00:45:00
AIG	      646.95 2010-12-27 13:30:00	  519 2011-01-08 00:45:00
BBY	      646.95 2010-12-27 12:00:00	  510 2011-01-08 00:45:00
CSX	      646.95 2010-12-27 14:30:00	  455 2011-01-08 00:45:00
CVX	      646.95 2010-12-27 13:00:00	  483 2011-01-08 00:45:00
DD	      646.95 2010-12-27 11:30:00	  480 2011-01-08 00:45:00
EOG	      646.95 2010-12-27 14:30:00	  445 2011-01-08 00:45:00
FCX	      646.95 2010-12-27 12:45:00	  535 2011-01-08 00:45:00
FSLR	      646.95 2010-12-27 13:00:00	  446 2011-01-08 00:45:00
HD	      646.95 2010-12-27 12:30:00	  477 2011-01-08 00:45:00
HON	      646.95 2010-12-27 14:15:00	  443 2011-01-08 00:45:00
IBM	      646.95 2010-12-27 12:45:00	  509 2011-01-08 00:45:00
IWM	      646.95 2010-12-27 11:00:00	  586 2011-01-08 00:45:00
MEE	      646.95 2010-12-27 13:15:00	  460 2011-01-08 00:45:00
NFLX	      646.95 2010-12-27 12:30:00	  494 2011-01-08 00:45:00
PRU	      646.95 2010-12-27 13:45:00	  445 2011-01-08 00:45:00
UPS	      646.95 2010-12-27 14:30:00	  441 2011-01-08 00:45:00
WHR	      646.95 2010-12-27 14:30:00	  425 2011-01-08 00:45:00
XLB	      646.95 2010-12-27 13:30:00	  452 2011-01-08 00:45:00
XLE	      646.95 2010-12-27 13:00:00	  481 2011-01-08 00:45:00
BEN	      646.95 2010-12-27 13:00:00	  454 2011-01-08 00:45:00
CMI	      646.95 2010-12-27 12:30:00	  462 2011-01-08 00:45:00
COST	      646.95 2010-12-27 14:30:00	  471 2011-01-08 00:45:00
DTV	      646.95 2010-12-27 14:30:00	  447 2011-01-08 00:45:00
ESRX	      646.95 2010-12-27 14:30:00	  447 2011-01-08 00:45:00
GG	      646.95 2010-12-27 13:15:00	  492 2011-01-08 00:45:00
HPQ	      646.95 2010-12-27 12:15:00	  538 2011-01-08 00:45:00
KO	      646.95 2010-12-27 12:30:00	  513 2011-01-08 00:45:00
MDY	      646.95 2010-12-27 13:15:00	  472 2011-01-08 00:45:00
MET	      646.95 2010-12-27 14:30:00	  444 2011-01-08 00:45:00
PNC	      646.95 2010-12-27 14:15:00	  466 2011-01-08 00:45:00
SJM	      646.95 2010-12-27 14:30:00	  431 2011-01-08 00:45:00
SNDK	      646.95 2010-12-27 13:00:00	  481 2011-01-08 00:45:00
SUN	      646.95 2010-12-27 14:30:00	  420 2011-01-08 00:45:00
TGT	      646.95 2010-12-27 14:15:00	  460 2011-01-08 00:45:00
XLU	      646.95 2010-12-27 14:30:00	  428 2011-01-08 00:45:00
ABT	      646.95 2010-12-27 12:30:00	  512 2011-01-08 00:45:00
AMGN	      646.95 2010-12-27 14:00:00	  446 2011-01-08 00:45:00
AMZN	      646.95 2010-12-27 11:15:00	  561 2011-01-08 00:45:00
BHP	      646.95 2010-12-27 12:15:00	  576 2011-01-08 00:45:00
COF	      646.95 2010-12-27 14:30:00	  439 2011-01-08 00:45:00
DNDN	      646.95 2010-12-27 14:15:00	  455 2011-01-08 00:45:00
FDX	      646.95 2010-12-27 12:30:00	  444 2011-01-08 00:45:00
GLD	      646.95 2010-12-27 11:00:00	  604 2011-01-08 00:45:00
JNJ	      646.95 2010-12-27 11:15:00	  529 2011-01-08 00:45:00
LFT	      646.95 2010-12-27 14:00:00	  430 2011-01-08 00:45:00
MOS	      646.95 2010-12-27 13:30:00	  496 2011-01-08 00:45:00
NEM	      646.95 2010-12-27 14:15:00	  505 2011-01-08 00:45:00
OXY	      646.95 2010-12-27 14:30:00	  476 2011-01-08 00:45:00
PEP	      646.95 2010-12-27 14:15:00	  463 2011-01-08 00:45:00
PG	      646.95 2010-12-27 11:30:00	  496 2011-01-08 00:45:00
RIG	      646.95 2010-12-27 12:00:00	  586 2011-01-08 00:45:00
BA	      646.95 2010-12-27 13:00:00	  477 2011-01-08 00:45:00
BBT	      646.95 2010-12-27 14:15:00	  459 2011-01-08 00:45:00
BIDU	      646.95 2010-12-27 12:15:00	  519 2011-01-08 00:45:00
BRCM	      646.95 2010-12-27 14:30:00	  477 2011-01-08 00:45:00
CELG	      646.95 2010-12-27 14:30:00	  429 2011-01-08 00:45:00
CREE	      646.95 2010-12-27 14:00:00	  453 2011-01-08 00:45:00
DE	      646.95 2010-12-27 13:00:00	  466 2011-01-08 00:45:00
DIS	      646.95 2010-12-27 13:00:00	  455 2011-01-08 00:45:00
EWZ	      646.95 2010-12-27 09:00:00	  594 2011-01-08 00:45:00
FFIV	      646.95 2010-12-27 12:30:00	  466 2011-01-08 00:45:00
GDX	      646.95 2010-12-27 13:00:00	  516 2011-01-08 00:45:00
GILD	      646.95 2010-12-27 13:30:00	  452 2011-01-08 00:45:00
GOOG	      646.95 2010-12-27 09:15:00	  545 2011-01-08 00:45:00
GS	      646.95 2010-12-27 13:00:00	  497 2011-01-08 00:45:00
HES	      646.95 2010-12-27 14:30:00	  483 2011-01-08 00:45:00
MMM	      646.95 2010-12-27 13:30:00	  487 2011-01-08 00:45:00
MON	      646.95 2010-12-27 13:30:00	  475 2011-01-08 00:45:00
MT	      646.95 2010-12-27 12:45:00	  590 2011-01-08 00:45:00
PBR	      646.95 2010-12-27 13:00:00	  516 2011-01-08 00:45:00
PM	      646.95 2010-12-27 13:30:00	  461 2011-01-08 00:45:00
POT	      646.95 2010-12-27 12:15:00	  524 2011-01-08 00:45:00
TEVA	      646.95 2010-12-27 13:00:00	  488 2011-01-08 00:45:00
TLT	      646.95 2010-12-27 12:30:00	  512 2011-01-08 00:45:00
VMW	      646.95 2010-12-27 14:30:00	  457 2011-01-08 00:45:00
WFMI	      646.95 2010-12-27 14:30:00	  451 2011-01-08 00:45:00
X	      646.95 2010-12-27 13:00:00	  514 2011-01-08 00:45:00
AAPL	      646.95 2010-12-27 09:00:00	  613 2011-01-08 00:45:00
ALL	      646.95 2010-12-27 14:30:00	  433 2011-01-08 00:45:00
BUCY	      646.95 2010-12-27 14:15:00	  444 2011-01-08 00:45:00
CRM	      646.95 2010-12-27 13:00:00	  484 2011-01-08 00:45:00
DVN	      646.95 2010-12-27 13:00:00	  465 2011-01-08 00:45:00
FLS	      646.95 2010-12-27 14:30:00	  421 2011-01-08 00:45:00
JOYG	      646.95 2010-12-27 14:30:00	  457 2011-01-08 00:45:00
NUE	      646.95 2010-12-27 13:45:00	  452 2011-01-08 00:45:00
QCOM	      646.95 2010-12-27 13:00:00	  476 2011-01-08 00:45:00
SLV	      646.95 2010-12-27 09:30:00	  602 2011-01-08 00:45:00
ABX	      646.95 2010-12-27 14:30:00	  497 2011-01-08 00:45:00
AEM	      646.95 2010-12-27 14:30:00	  466 2011-01-08 00:45:00
AMX	      646.95 2010-12-27 14:30:00	  427 2011-01-08 00:45:00
ARG	      646.95 2010-12-27 14:00:00	  441 2011-01-08 00:45:00
CLF	      646.95 2010-12-27 12:30:00	  477 2011-01-08 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
COP	      646.95 2010-12-27 13:00:00	  487 2011-01-08 00:45:00
DIA	      646.95 2010-12-27 12:00:00	  542 2011-01-08 00:45:00
EFA	      646.95 2010-12-27 14:00:00	  454 2011-01-08 00:45:00
JWN	      646.95 2010-12-27 13:45:00	  438 2011-01-08 00:45:00
MCD	      646.95 2010-12-27 10:30:00	  528 2011-01-08 00:45:00
MJN	      646.95 2010-12-27 14:30:00	  432 2011-01-08 00:45:00
MRK	      646.95 2010-12-27 13:30:00	  458 2011-01-08 00:45:00
OIH	      646.95 2010-12-27 14:30:00	  471 2011-01-08 00:45:00
RIMM	      646.95 2010-12-27 12:45:00	  490 2011-01-08 00:45:00
WMT	      646.95 2010-12-27 13:30:00	  450 2011-01-08 00:45:00
WYNN	      646.95 2010-12-27 13:45:00	  458 2011-01-08 00:45:00

131 rows selected.

Elapsed: 00:00:00.03
11:31:57 SQL> 
11:31:57 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
