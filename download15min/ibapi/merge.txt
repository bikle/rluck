
SQL*Plus: Release 11.2.0.1.0 Production on Sat Feb 19 03:28:39 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

03:28:39 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
03:28:39 SQL> 03:28:39 SQL> --
03:28:39 SQL> -- merge.sql
03:28:39 SQL> --
03:28:39 SQL> 
03:28:39 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
03:28:39 SQL> 
03:28:39 SQL> 
03:28:39 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
03:28:39 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
03:28:39 SQL> 
03:28:39 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.11
03:28:39 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.04
03:28:39 SQL> 
03:28:39 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.06
03:28:39 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.03
03:28:39 SQL> 
03:28:39 SQL> CREATE TABLE ibs_dups COMPRESS AS
03:28:39   2  SELECT
03:28:39   3  tkr
03:28:39   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
03:28:39   5  ,clse
03:28:39   6  FROM ibs_stage
03:28:39   7  UNION
03:28:39   8  SELECT tkr,ydate,clse
03:28:39   9  FROM ibs_old
03:28:39  10  /

Table created.

Elapsed: 00:00:00.89
03:28:40 SQL> 
03:28:40 SQL> CREATE TABLE ibs15min COMPRESS AS
03:28:40   2  SELECT
03:28:40   3  tkr
03:28:40   4  ,ydate
03:28:40   5  ,AVG(clse)clse
03:28:40   6  FROM ibs_dups
03:28:40   7  GROUP BY tkr,ydate
03:28:40   8  /

Table created.

Elapsed: 00:00:00.68
03:28:41 SQL> 
03:28:41 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:01.31
03:28:42 SQL> 
03:28:42 SQL> -- rpt
03:28:42 SQL> 
03:28:42 SQL> SELECT
03:28:42   2  tkr
03:28:42   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
03:28:42   4  ,MIN(ydate)
03:28:42   5  ,COUNT(ydate)
03:28:42   6  ,MAX(ydate)FROM
03:28:42   7  ibs15min
03:28:42   8  GROUP BY tkr
03:28:42   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	     10243.7 2010-12-27 13:00:00	 1555 2011-02-12 00:45:00
AKAM	     10243.7 2010-12-27 12:45:00	 1617 2011-02-12 00:45:00
APA	     10243.7 2010-12-27 12:45:00	 1594 2011-02-12 00:45:00
APC	     10243.7 2010-12-27 14:15:00	 1650 2011-02-12 00:45:00
AXP	     10243.7 2010-12-27 13:00:00	 1637 2011-02-12 00:45:00
BP	     10243.7 2010-12-27 13:00:00	 2098 2011-02-12 00:45:00
BTU	     10243.7 2010-12-27 12:45:00	 1656 2011-02-12 00:45:00
CAT	     10243.7 2010-12-27 12:45:00	 1691 2011-02-12 00:45:00
CVS	     20323.7 2010-12-27 14:30:00	 1313 2011-02-05 00:45:00
GD	     10243.7 2010-12-27 13:00:00	 1729 2011-02-12 00:45:00
HL	     10243.7 2011-01-18 12:30:00	  978 2011-02-12 00:45:00
MAR	     10243.7 2010-12-27 14:30:00	 1454 2011-02-12 00:45:00
MDT	     10243.7 2010-12-27 13:45:00	 1568 2011-02-12 00:45:00
QQQQ	     10243.7 2010-12-27 09:00:00	 2099 2011-02-12 00:45:00
SINA	     10243.7 2010-12-27 14:15:00	 1574 2011-02-12 00:45:00
SLW	     10243.7 2011-01-18 09:15:00	 1096 2011-02-12 00:45:00
SPY	     10243.7 2010-12-27 09:00:00	 2173 2011-02-12 00:45:00
SVM	     10243.7 2011-01-18 13:00:00	  901 2011-02-12 00:45:00
V	     10243.7 2010-12-27 12:30:00	 1756 2011-02-12 00:45:00
VECO	     10243.7 2010-12-27 14:30:00	 1613 2011-02-12 00:45:00
WDC	     10243.7 2010-12-27 09:15:00	 1553 2011-02-12 00:45:00
XOM	     10243.7 2010-12-27 13:00:00	 1844 2011-02-12 00:45:00
AFL	     10243.7 2010-12-27 14:30:00	 1488 2011-02-12 00:45:00
AMT	     10243.7 2010-12-27 13:00:00	 1508 2011-02-12 00:45:00
AXU	     10243.7 2011-01-18 13:00:00	  833 2011-02-12 00:45:00
CTSH	     10243.7 2010-12-27 14:30:00	 1565 2011-02-12 00:45:00
GFI	     10243.7 2011-01-24 09:15:00	  834 2011-02-12 00:45:00
IOC	     10243.7 2010-12-27 14:30:00	 1445 2011-02-12 00:45:00
JPM	     10243.7 2010-12-27 13:00:00	 1795 2011-02-12 00:45:00
SKX	     10243.7 2010-12-27 12:00:00	 1540 2011-02-12 00:45:00
SLB	     10243.7 2010-12-27 09:15:00	 1812 2011-02-12 00:45:00
STT	     10243.7 2010-12-27 14:30:00	 1476 2011-02-12 00:45:00
SU	     10243.7 2010-12-27 14:30:00	 1552 2011-02-12 00:45:00
TSO	      1603.7 2011-02-07 12:15:00	  427 2011-02-18 00:45:00
UNH	     10243.7 2010-12-27 13:00:00	 1582 2011-02-12 00:45:00
UNP	     10243.7 2010-12-27 14:30:00	 1536 2011-02-12 00:45:00
AIG	     10243.7 2010-12-27 13:30:00	 1822 2011-02-12 00:45:00
BBY	     10243.7 2010-12-27 12:00:00	 1660 2011-02-12 00:45:00
CDE	     10243.7 2011-01-18 11:45:00	  926 2011-02-12 00:45:00
CSX	     10243.7 2010-12-27 14:30:00	 1549 2011-02-12 00:45:00
CVX	     10243.7 2010-12-27 13:00:00	 1662 2011-02-12 00:45:00
DD	     10243.7 2010-12-27 11:30:00	 1637 2011-02-12 00:45:00
EOG	     10243.7 2010-12-27 14:30:00	 1506 2011-02-12 00:45:00
FCX	     10243.7 2010-12-27 12:45:00	 1843 2011-02-12 00:45:00
FSLR	     10243.7 2010-12-27 13:00:00	 1553 2011-02-12 00:45:00
HD	     10243.7 2010-12-27 12:30:00	 1611 2011-02-12 00:45:00
HON	     10243.7 2010-12-27 14:15:00	 1516 2011-02-12 00:45:00
IBM	     10243.7 2010-12-27 12:45:00	 1823 2011-02-12 00:45:00
IWM	     10243.7 2010-12-27 11:00:00	 2024 2011-02-12 00:45:00
MEE	     10243.7 2010-12-27 13:15:00	 1623 2011-02-12 00:45:00
NFLX	     10243.7 2010-12-27 12:30:00	 1725 2011-02-12 00:45:00
PRU	     10243.7 2010-12-27 13:45:00	 1519 2011-02-12 00:45:00
UPS	     10243.7 2010-12-27 14:30:00	 1519 2011-02-12 00:45:00
WHR	     10243.7 2010-12-27 14:30:00	 1487 2011-02-12 00:45:00
XLB	     10243.7 2010-12-27 13:30:00	 1492 2011-02-12 00:45:00
XLE	     10243.7 2010-12-27 13:00:00	 1635 2011-02-12 00:45:00
BEN	     10243.7 2010-12-27 13:00:00	 1486 2011-02-12 00:45:00
CHK	     10243.7 2011-01-18 13:00:00	  961 2011-02-12 00:45:00
CMI	     10243.7 2010-12-27 12:30:00	 1590 2011-02-12 00:45:00
COST	     10243.7 2010-12-27 14:30:00	 1532 2011-02-12 00:45:00
DTV	     10243.7 2010-12-27 14:30:00	 1486 2011-02-12 00:45:00
ESRX	     10243.7 2010-12-27 14:30:00	 1497 2011-02-12 00:45:00
GG	     10243.7 2010-12-27 13:15:00	 1667 2011-02-12 00:45:00
HPQ	     10243.7 2010-12-27 12:15:00	 1806 2011-02-12 00:45:00
KO	     10243.7 2010-12-27 12:30:00	 1885 2011-02-12 00:45:00
MDY	     10243.7 2010-12-27 13:15:00	 1625 2011-02-12 00:45:00
MET	     10243.7 2010-12-27 14:30:00	 1520 2011-02-12 00:45:00
MVG	     10243.7 2011-01-18 14:15:00	  807 2011-02-12 00:45:00
NOC	     10243.7 2011-01-24 13:30:00	  648 2011-02-12 00:45:00
PAAS	     10243.7 2011-01-18 14:00:00	  940 2011-02-12 00:45:00
PALL	     10243.7 2011-01-18 14:00:00	  848 2011-02-12 00:45:00
PNC	     10243.7 2010-12-27 14:15:00	 1565 2011-02-12 00:45:00
SJM	     10243.7 2010-12-27 14:30:00	 1443 2011-02-12 00:45:00
SNDK	     10243.7 2010-12-27 13:00:00	 1689 2011-02-12 00:45:00
SUN	     10243.7 2010-12-27 14:30:00	 1500 2011-02-12 00:45:00
SWC	     10243.7 2011-01-18 13:00:00	  910 2011-02-12 00:45:00
TGT	     10243.7 2010-12-27 14:15:00	 1590 2011-02-12 00:45:00
TKR	     10243.7 2011-01-24 14:30:00	  639 2011-02-12 00:45:00
XLU	     10243.7 2010-12-27 14:30:00	 1448 2011-02-12 00:45:00
ABT	     10243.7 2010-12-27 12:30:00	 1707 2011-02-12 00:45:00
AMGN	     10243.7 2010-12-27 14:00:00	 1522 2011-02-12 00:45:00
AMZN	     10243.7 2010-12-27 11:15:00	 1888 2011-02-12 00:45:00
BHP	     10243.7 2010-12-27 12:15:00	 2085 2011-02-12 00:45:00
COF	     10243.7 2010-12-27 14:30:00	 1496 2011-02-12 00:45:00
DNDN	     10243.7 2010-12-27 14:15:00	 1545 2011-02-12 00:45:00
EBAY	     10243.7 2011-01-18 13:00:00	  908 2011-02-12 00:45:00
EXK	     10243.7 2011-01-18 13:00:00	  915 2011-02-12 00:45:00
FDX	     10243.7 2010-12-27 12:30:00	 1567 2011-02-12 00:45:00
GLD	     10243.7 2010-12-27 11:00:00	 2108 2011-02-12 00:45:00
JNJ	     10243.7 2010-12-27 11:15:00	 1878 2011-02-12 00:45:00
LFT	     10243.7 2010-12-27 14:00:00	 1449 2011-02-12 00:45:00
MOS	     10243.7 2010-12-27 13:30:00	 1736 2011-02-12 00:45:00
NEM	     10243.7 2010-12-27 14:15:00	 1751 2011-02-12 00:45:00
OXY	     10243.7 2010-12-27 14:30:00	 1594 2011-02-12 00:45:00
PEP	     10243.7 2010-12-27 14:15:00	 1577 2011-02-12 00:45:00
PG	     10243.7 2010-12-27 11:30:00	 1764 2011-02-12 00:45:00
RIG	     10243.7 2010-12-27 12:00:00	 2028 2011-02-12 00:45:00
VLO	     10243.7 2011-01-31 13:00:00	  501 2011-02-12 00:45:00
AGU	     10243.7 2011-01-18 13:00:00	  916 2011-02-12 00:45:00
BA	     10243.7 2010-12-27 13:00:00	 1633 2011-02-12 00:45:00
BBT	     10243.7 2010-12-27 14:15:00	 1532 2011-02-12 00:45:00
BIDU	     10243.7 2010-12-27 12:15:00	 1778 2011-02-12 00:45:00
BRCM	     10243.7 2010-12-27 14:30:00	 1636 2011-02-12 00:45:00
CELG	     10243.7 2010-12-27 14:30:00	 1487 2011-02-12 00:45:00
CREE	     10243.7 2010-12-27 14:00:00	 1646 2011-02-12 00:45:00
CVE	     10243.7 2011-01-31 13:00:00	  444 2011-02-12 00:45:00
DE	     10243.7 2010-12-27 13:00:00	 1648 2011-02-12 00:45:00
DIS	     10243.7 2010-12-27 13:00:00	 1582 2011-02-12 00:45:00
EWZ	     10243.7 2010-12-27 09:00:00	 2020 2011-02-12 00:45:00
FFIV	     10243.7 2010-12-27 12:30:00	 1633 2011-02-12 00:45:00
GDX	     10243.7 2010-12-27 13:00:00	 1770 2011-02-12 00:45:00
GILD	     10243.7 2010-12-27 13:30:00	 1570 2011-02-12 00:45:00
GOOG	     10243.7 2010-12-27 09:15:00	 1823 2011-02-12 00:45:00
GS	     10243.7 2010-12-27 13:00:00	 1711 2011-02-12 00:45:00
HES	     10243.7 2010-12-27 14:30:00	 1630 2011-02-12 00:45:00
MMM	     10243.7 2010-12-27 13:30:00	 1593 2011-02-12 00:45:00
MON	     10243.7 2010-12-27 13:30:00	 1663 2011-02-12 00:45:00
MT	     10243.7 2010-12-27 12:45:00	 2041 2011-02-12 00:45:00
PBR	     10243.7 2010-12-27 13:00:00	 1765 2011-02-12 00:45:00
PM	     10243.7 2010-12-27 13:30:00	 1520 2011-02-12 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
POT	     10243.7 2010-12-27 12:15:00	 1732 2011-02-12 00:45:00
RDY	     10243.7 2011-01-18 13:30:00	  864 2011-02-12 00:45:00
SCCO	     10243.7 2011-01-18 13:30:00	  892 2011-02-12 00:45:00
TEVA	     10243.7 2010-12-27 13:00:00	 1745 2011-02-12 00:45:00
TLT	     10243.7 2010-12-27 12:30:00	 1773 2011-02-12 00:45:00
VMW	     10243.7 2010-12-27 14:30:00	 1599 2011-02-12 00:45:00
WFMI	     10243.7 2010-12-27 14:30:00	 1534 2011-02-12 00:45:00
X	     10243.7 2010-12-27 13:00:00	 1836 2011-02-12 00:45:00
AAPL	     10243.7 2010-12-27 09:00:00	 2098 2011-02-12 00:45:00
ALL	     10243.7 2010-12-27 14:30:00	 1493 2011-02-12 00:45:00
BUCY	     10243.7 2010-12-27 14:15:00	 1504 2011-02-12 00:45:00
CEO	     10243.7 2011-01-18 14:15:00	  849 2011-02-12 00:45:00
CRM	     10243.7 2010-12-27 13:00:00	 1644 2011-02-12 00:45:00
DVN	     10243.7 2010-12-27 13:00:00	 1578 2011-02-12 00:45:00
FLS	     10243.7 2010-12-27 14:30:00	 1474 2011-02-12 00:45:00
JOYG	     10243.7 2010-12-27 14:30:00	 1542 2011-02-12 00:45:00
LMT	     10243.7 2011-01-24 14:15:00	  652 2011-02-12 00:45:00
NUE	     10243.7 2010-12-27 13:45:00	 1539 2011-02-12 00:45:00
PPLT	     10243.7 2011-01-18 14:30:00	  825 2011-02-12 00:45:00
QCOM	     10243.7 2010-12-27 13:00:00	 1638 2011-02-12 00:45:00
SLV	     10243.7 2010-12-27 09:30:00	 2062 2011-02-12 00:45:00
SOHU	     10243.7 2011-01-18 14:30:00	  865 2011-02-12 00:45:00
VALE	     10243.7 2011-01-18 13:00:00	  958 2011-02-12 00:45:00
ABX	     10243.7 2010-12-27 14:30:00	 1767 2011-02-12 00:45:00
AEM	     10243.7 2010-12-27 14:30:00	 1607 2011-02-12 00:45:00
AMX	     10243.7 2010-12-27 14:30:00	 1452 2011-02-12 00:45:00
ARG	     10243.7 2010-12-27 14:00:00	 1513 2011-02-12 00:45:00
CLF	     10243.7 2010-12-27 12:30:00	 1627 2011-02-12 00:45:00
COP	     10243.7 2010-12-27 13:00:00	 1660 2011-02-12 00:45:00
DIA	     10243.7 2010-12-27 12:00:00	 1902 2011-02-12 00:45:00
EFA	     10243.7 2010-12-27 14:00:00	 1660 2011-02-12 00:45:00
JWN	     10243.7 2010-12-27 13:45:00	 1470 2011-02-12 00:45:00
MCD	     10243.7 2010-12-27 10:30:00	 1884 2011-02-12 00:45:00
MJN	     10243.7 2010-12-27 14:30:00	 1477 2011-02-12 00:45:00
MRK	     10243.7 2010-12-27 13:30:00	 1663 2011-02-12 00:45:00
OIH	     10243.7 2010-12-27 14:30:00	 1617 2011-02-12 00:45:00
RIMM	     10243.7 2010-12-27 12:45:00	 1697 2011-02-12 00:45:00
RTN	     10243.7 2011-01-24 14:30:00	  663 2011-02-12 00:45:00
WMT	     10243.7 2010-12-27 13:30:00	 1606 2011-02-12 00:45:00
WYNN	     10243.7 2010-12-27 13:45:00	 1627 2011-02-12 00:45:00

160 rows selected.

Elapsed: 00:00:00.10
03:28:42 SQL> 
03:28:42 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
