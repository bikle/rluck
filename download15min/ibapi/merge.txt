
SQL*Plus: Release 11.2.0.1.0 Production on Sat Feb 19 23:24:23 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

23:24:23 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
23:24:23 SQL> 23:24:23 SQL> --
23:24:23 SQL> -- merge.sql
23:24:23 SQL> --
23:24:23 SQL> 
23:24:23 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
23:24:23 SQL> 
23:24:23 SQL> 
23:24:23 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
23:24:23 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
23:24:23 SQL> 
23:24:23 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.28
23:24:24 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.03
23:24:24 SQL> 
23:24:24 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.26
23:24:24 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.03
23:24:24 SQL> 
23:24:24 SQL> CREATE TABLE ibs_dups COMPRESS AS
23:24:24   2  SELECT
23:24:24   3  tkr
23:24:24   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
23:24:24   5  ,clse
23:24:24   6  FROM ibs_stage
23:24:24   7  UNION
23:24:24   8  SELECT tkr,ydate,clse
23:24:24   9  FROM ibs_old
23:24:24  10  /

Table created.

Elapsed: 00:00:00.93
23:24:25 SQL> 
23:24:25 SQL> CREATE TABLE ibs15min COMPRESS AS
23:24:25   2  SELECT
23:24:25   3  tkr
23:24:25   4  ,ydate
23:24:25   5  ,AVG(clse)clse
23:24:25   6  FROM ibs_dups
23:24:25   7  GROUP BY tkr,ydate
23:24:25   8  /

Table created.

Elapsed: 00:00:00.78
23:24:26 SQL> 
23:24:26 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:01.55
23:24:27 SQL> 
23:24:27 SQL> -- rpt
23:24:27 SQL> 
23:24:27 SQL> SELECT
23:24:27   2  tkr
23:24:27   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
23:24:27   4  ,MIN(ydate)
23:24:27   5  ,COUNT(ydate)
23:24:27   6  ,MAX(ydate)FROM
23:24:27   7  ibs15min
23:24:27   8  GROUP BY tkr
23:24:27   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	     1359.45 2010-12-27 13:00:00	 1777 2011-02-19 00:45:00
AKAM	     1359.45 2010-12-27 12:45:00	 1862 2011-02-19 00:45:00
APA	     1359.45 2010-12-27 12:45:00	 1845 2011-02-19 00:45:00
APC	     1359.45 2010-12-27 14:15:00	 1880 2011-02-19 00:45:00
AXP	     1359.45 2010-12-27 13:00:00	 1882 2011-02-19 00:45:00
BP	     1359.45 2010-12-27 13:00:00	 2414 2011-02-19 00:45:00
BTU	     1359.45 2010-12-27 12:45:00	 1889 2011-02-19 00:45:00
CAT	     1359.45 2010-12-27 12:45:00	 1935 2011-02-19 00:45:00
CVS	     1359.45 2010-12-27 14:30:00	 1763 2011-02-19 00:45:00
GD	     1359.45 2010-12-27 13:00:00	 1982 2011-02-19 00:45:00
HL	     1359.45 2011-01-18 12:30:00	 1240 2011-02-19 00:45:00
MAR	     1359.45 2010-12-27 14:30:00	 1682 2011-02-19 00:45:00
MDT	     1359.45 2010-12-27 13:45:00	 1791 2011-02-19 00:45:00
QQQQ	     1359.45 2010-12-27 09:00:00	 2388 2011-02-19 00:45:00
SINA	     1359.45 2010-12-27 14:15:00	 1805 2011-02-19 00:45:00
SLW	     1359.45 2011-01-18 09:15:00	 1373 2011-02-19 00:45:00
SPY	     1359.45 2010-12-27 09:00:00	 2493 2011-02-19 00:45:00
SVM	    11439.45 2011-01-18 13:00:00	  901 2011-02-12 00:45:00
V	    11439.45 2010-12-27 12:30:00	 1756 2011-02-12 00:45:00
VECO	    11439.45 2010-12-27 14:30:00	 1613 2011-02-12 00:45:00
WDC	    11439.45 2010-12-27 09:15:00	 1553 2011-02-12 00:45:00
XOM	    11439.45 2010-12-27 13:00:00	 1844 2011-02-12 00:45:00
AFL	     1359.45 2010-12-27 14:30:00	 1706 2011-02-19 00:45:00
AMT	     1359.45 2010-12-27 13:00:00	 1738 2011-02-19 00:45:00
AXU	     1359.45 2011-01-18 13:00:00	 1068 2011-02-19 00:45:00
CTSH	     1359.45 2010-12-27 14:30:00	 1794 2011-02-19 00:45:00
GFI	     1359.45 2011-01-24 09:15:00	 1095 2011-02-19 00:45:00
IOC	     1359.45 2010-12-27 14:30:00	 1655 2011-02-19 00:45:00
JPM	     1359.45 2010-12-27 13:00:00	 2070 2011-02-19 00:45:00
SKX	     1359.45 2010-12-27 12:00:00	 1759 2011-02-19 00:45:00
SLB	     1359.45 2010-12-27 09:15:00	 2080 2011-02-19 00:45:00
STT	     1359.45 2010-12-27 14:30:00	 1695 2011-02-19 00:45:00
SU	    11439.45 2010-12-27 14:30:00	 1552 2011-02-12 00:45:00
TSO	     2799.45 2011-02-07 12:15:00	  427 2011-02-18 00:45:00
UNH	    11439.45 2010-12-27 13:00:00	 1582 2011-02-12 00:45:00
UNP	    11439.45 2010-12-27 14:30:00	 1536 2011-02-12 00:45:00
AIG	     1359.45 2010-12-27 13:30:00	 2072 2011-02-19 00:45:00
BBY	     1359.45 2010-12-27 12:00:00	 1910 2011-02-19 00:45:00
CDE	     1359.45 2011-01-18 11:45:00	 1188 2011-02-19 00:45:00
CSX	     1359.45 2010-12-27 14:30:00	 1768 2011-02-19 00:45:00
CVX	     1359.45 2010-12-27 13:00:00	 1901 2011-02-19 00:45:00
DD	     1359.45 2010-12-27 11:30:00	 1869 2011-02-19 00:45:00
EOG	     1359.45 2010-12-27 14:30:00	 1727 2011-02-19 00:45:00
FCX	     1359.45 2010-12-27 12:45:00	 2113 2011-02-19 00:45:00
FSLR	     1359.45 2010-12-27 13:00:00	 1788 2011-02-19 00:45:00
HD	     1359.45 2010-12-27 12:30:00	 1837 2011-02-19 00:45:00
HON	     1359.45 2010-12-27 14:15:00	 1737 2011-02-19 00:45:00
IBM	     1359.45 2010-12-27 12:45:00	 2084 2011-02-19 00:45:00
IWM	     1359.45 2010-12-27 11:00:00	 2314 2011-02-19 00:45:00
MEE	     1359.45 2010-12-27 13:15:00	 1853 2011-02-19 00:45:00
NFLX	     1359.45 2010-12-27 12:30:00	 1988 2011-02-19 00:45:00
PRU	     1359.45 2010-12-27 13:45:00	 1736 2011-02-19 00:45:00
UPS	    11439.45 2010-12-27 14:30:00	 1519 2011-02-12 00:45:00
WHR	    11439.45 2010-12-27 14:30:00	 1487 2011-02-12 00:45:00
XLB	    11439.45 2010-12-27 13:30:00	 1492 2011-02-12 00:45:00
XLE	    11439.45 2010-12-27 13:00:00	 1635 2011-02-12 00:45:00
BEN	     1359.45 2010-12-27 13:00:00	 1697 2011-02-19 00:45:00
CHK	     1359.45 2011-01-18 13:00:00	 1200 2011-02-19 00:45:00
CMI	     1359.45 2010-12-27 12:30:00	 1838 2011-02-19 00:45:00
COST	     1359.45 2010-12-27 14:30:00	 1759 2011-02-19 00:45:00
DTV	     1359.45 2010-12-27 14:30:00	 1701 2011-02-19 00:45:00
ESRX	     1359.45 2010-12-27 14:30:00	 1717 2011-02-19 00:45:00
GG	     1359.45 2010-12-27 13:15:00	 1902 2011-02-19 00:45:00
HPQ	     1359.45 2010-12-27 12:15:00	 2064 2011-02-19 00:45:00
KO	     1359.45 2010-12-27 12:30:00	 2142 2011-02-19 00:45:00
MDY	     1359.45 2010-12-27 13:15:00	 1854 2011-02-19 00:45:00
MET	     1359.45 2010-12-27 14:30:00	 1730 2011-02-19 00:45:00
MVG	     1359.45 2011-01-18 14:15:00	 1024 2011-02-19 00:45:00
NOC	     1359.45 2011-01-24 13:30:00	  861 2011-02-19 00:45:00
PAAS	     1359.45 2011-01-18 14:00:00	 1195 2011-02-19 00:45:00
PALL	     1359.45 2011-01-18 14:00:00	 1068 2011-02-19 00:45:00
PNC	     1359.45 2010-12-27 14:15:00	 1783 2011-02-19 00:45:00
SJM	     1359.45 2010-12-27 14:30:00	 1661 2011-02-19 00:45:00
SNDK	     1359.45 2010-12-27 13:00:00	 1917 2011-02-19 00:45:00
SUN	    11439.45 2010-12-27 14:30:00	 1500 2011-02-12 00:45:00
SWC	    11439.45 2011-01-18 13:00:00	  910 2011-02-12 00:45:00
TGT	    11439.45 2010-12-27 14:15:00	 1590 2011-02-12 00:45:00
TKR	    11439.45 2011-01-24 14:30:00	  639 2011-02-12 00:45:00
XLU	    11439.45 2010-12-27 14:30:00	 1448 2011-02-12 00:45:00
ABT	     1359.45 2010-12-27 12:30:00	 1953 2011-02-19 00:45:00
AMGN	     1359.45 2010-12-27 14:00:00	 1753 2011-02-19 00:45:00
AMZN	     1359.45 2010-12-27 11:15:00	 2162 2011-02-19 00:45:00
BHP	     1359.45 2010-12-27 12:15:00	 2397 2011-02-19 00:45:00
COF	     1359.45 2010-12-27 14:30:00	 1715 2011-02-19 00:45:00
DNDN	     1359.45 2010-12-27 14:15:00	 1779 2011-02-19 00:45:00
EBAY	     1359.45 2011-01-18 13:00:00	 1141 2011-02-19 00:45:00
EXK	     1359.45 2011-01-18 13:00:00	 1154 2011-02-19 00:45:00
FDX	     1359.45 2010-12-27 12:30:00	 1798 2011-02-19 00:45:00
GLD	     1359.45 2010-12-27 11:00:00	 2424 2011-02-19 00:45:00
JNJ	     1359.45 2010-12-27 11:15:00	 2160 2011-02-19 00:45:00
LFT	     1359.45 2010-12-27 14:00:00	 1663 2011-02-19 00:45:00
MOS	     1359.45 2010-12-27 13:30:00	 1981 2011-02-19 00:45:00
NEM	     1359.45 2010-12-27 14:15:00	 1992 2011-02-19 00:45:00
OXY	     1359.45 2010-12-27 14:30:00	 1827 2011-02-19 00:45:00
PEP	     1359.45 2010-12-27 14:15:00	 1801 2011-02-19 00:45:00
PG	     1359.45 2010-12-27 11:30:00	 2009 2011-02-19 00:45:00
RIG	     1359.45 2010-12-27 12:00:00	 2327 2011-02-19 00:45:00
VLO	    11439.45 2011-01-31 13:00:00	  501 2011-02-12 00:45:00
AGU	     1359.45 2011-01-18 13:00:00	 1164 2011-02-19 00:45:00
BA	     1359.45 2010-12-27 13:00:00	 1870 2011-02-19 00:45:00
BBT	     1359.45 2010-12-27 14:15:00	 1759 2011-02-19 00:45:00
BIDU	     1359.45 2010-12-27 12:15:00	 2035 2011-02-19 00:45:00
BRCM	     1359.45 2010-12-27 14:30:00	 1898 2011-02-19 00:45:00
CELG	     1359.45 2010-12-27 14:30:00	 1720 2011-02-19 00:45:00
CREE	     1359.45 2010-12-27 14:00:00	 1878 2011-02-19 00:45:00
CVE	     1359.45 2011-01-31 13:00:00	  666 2011-02-19 00:45:00
DE	     1359.45 2010-12-27 13:00:00	 1899 2011-02-19 00:45:00
DIS	     1359.45 2010-12-27 13:00:00	 1812 2011-02-19 00:45:00
EWZ	     1359.45 2010-12-27 09:00:00	 2290 2011-02-19 00:45:00
FFIV	     1359.45 2010-12-27 12:30:00	 1886 2011-02-19 00:45:00
GDX	     1359.45 2010-12-27 13:00:00	 2033 2011-02-19 00:45:00
GILD	     1359.45 2010-12-27 13:30:00	 1795 2011-02-19 00:45:00
GOOG	     1359.45 2010-12-27 09:15:00	 2076 2011-02-19 00:45:00
GS	     1359.45 2010-12-27 13:00:00	 1949 2011-02-19 00:45:00
HES	     1359.45 2010-12-27 14:30:00	 1867 2011-02-19 00:45:00
MMM	     1359.45 2010-12-27 13:30:00	 1817 2011-02-19 00:45:00
MON	     1359.45 2010-12-27 13:30:00	 1911 2011-02-19 00:45:00
MT	     1359.45 2010-12-27 12:45:00	 2324 2011-02-19 00:45:00
PBR	     1359.45 2010-12-27 13:00:00	 2014 2011-02-19 00:45:00
PM	     1359.45 2010-12-27 13:30:00	 1748 2011-02-19 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
POT	     1359.45 2010-12-27 12:15:00	 2006 2011-02-19 00:45:00
RDY	     1359.45 2011-01-18 13:30:00	 1083 2011-02-19 00:45:00
SCCO	     1359.45 2011-01-18 13:30:00	 1135 2011-02-19 00:45:00
TEVA	    11439.45 2010-12-27 13:00:00	 1745 2011-02-12 00:45:00
TLT	    11439.45 2010-12-27 12:30:00	 1773 2011-02-12 00:45:00
VMW	    11439.45 2010-12-27 14:30:00	 1599 2011-02-12 00:45:00
WFMI	    11439.45 2010-12-27 14:30:00	 1534 2011-02-12 00:45:00
X	    11439.45 2010-12-27 13:00:00	 1836 2011-02-12 00:45:00
AAPL	     1359.45 2010-12-27 09:00:00	 2414 2011-02-19 00:45:00
ALL	     1359.45 2010-12-27 14:30:00	 1719 2011-02-19 00:45:00
BUCY	     1359.45 2010-12-27 14:15:00	 1722 2011-02-19 00:45:00
CEO	     1359.45 2011-01-18 14:15:00	 1076 2011-02-19 00:45:00
CRM	     1359.45 2010-12-27 13:00:00	 1879 2011-02-19 00:45:00
DVN	     1359.45 2010-12-27 13:00:00	 1815 2011-02-19 00:45:00
FLS	     1359.45 2010-12-27 14:30:00	 1684 2011-02-19 00:45:00
JOYG	     1359.45 2010-12-27 14:30:00	 1778 2011-02-19 00:45:00
LMT	     1359.45 2011-01-24 14:15:00	  868 2011-02-19 00:45:00
NUE	     1359.45 2010-12-27 13:45:00	 1761 2011-02-19 00:45:00
PPLT	     1359.45 2011-01-18 14:30:00	 1045 2011-02-19 00:45:00
QCOM	     1359.45 2010-12-27 13:00:00	 1885 2011-02-19 00:45:00
SLV	     1359.45 2010-12-27 09:30:00	 2371 2011-02-19 00:45:00
SOHU	     1359.45 2011-01-18 14:30:00	 1086 2011-02-19 00:45:00
VALE	    11439.45 2011-01-18 13:00:00	  958 2011-02-12 00:45:00
ABX	     1359.45 2010-12-27 14:30:00	 2021 2011-02-19 00:45:00
AEM	     1359.45 2010-12-27 14:30:00	 1850 2011-02-19 00:45:00
AMX	     1359.45 2010-12-27 14:30:00	 1665 2011-02-19 00:45:00
ARG	     1359.45 2010-12-27 14:00:00	 1749 2011-02-19 00:45:00
CLF	     1359.45 2010-12-27 12:30:00	 1874 2011-02-19 00:45:00
COP	     1359.45 2010-12-27 13:00:00	 1906 2011-02-19 00:45:00
DIA	     1359.45 2010-12-27 12:00:00	 2168 2011-02-19 00:45:00
EFA	     1359.45 2010-12-27 14:00:00	 1886 2011-02-19 00:45:00
JWN	     1359.45 2010-12-27 13:45:00	 1703 2011-02-19 00:45:00
MCD	     1359.45 2010-12-27 10:30:00	 2171 2011-02-19 00:45:00
MJN	     1359.45 2010-12-27 14:30:00	 1690 2011-02-19 00:45:00
MRK	     1359.45 2010-12-27 13:30:00	 1902 2011-02-19 00:45:00
OIH	     1359.45 2010-12-27 14:30:00	 1852 2011-02-19 00:45:00
RIMM	     1359.45 2010-12-27 12:45:00	 1952 2011-02-19 00:45:00
RTN	     1359.45 2011-01-24 14:30:00	  888 2011-02-19 00:45:00
WMT	    11439.45 2010-12-27 13:30:00	 1606 2011-02-12 00:45:00
WYNN	    11439.45 2010-12-27 13:45:00	 1627 2011-02-12 00:45:00

160 rows selected.

Elapsed: 00:00:00.09
23:24:27 SQL> 
23:24:27 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
