
SQL*Plus: Release 11.2.0.1.0 Production on Fri Feb 18 09:50:43 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

09:50:43 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
09:50:43 SQL> 09:50:43 SQL> --
09:50:43 SQL> -- merge.sql
09:50:43 SQL> --
09:50:43 SQL> 
09:50:43 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
09:50:43 SQL> 
09:50:43 SQL> 
09:50:43 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
09:50:43 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
09:50:43 SQL> 
09:50:43 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.11
09:50:43 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.16
09:50:44 SQL> 
09:50:44 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.06
09:50:44 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.08
09:50:44 SQL> 
09:50:44 SQL> CREATE TABLE ibs_dups COMPRESS AS
09:50:44   2  SELECT
09:50:44   3  tkr
09:50:44   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
09:50:44   5  ,clse
09:50:44   6  FROM ibs_stage
09:50:44   7  UNION
09:50:44   8  SELECT tkr,ydate,clse
09:50:44   9  FROM ibs_old
09:50:44  10  /

Table created.

Elapsed: 00:00:00.90
09:50:45 SQL> 
09:50:45 SQL> CREATE TABLE ibs15min COMPRESS AS
09:50:45   2  SELECT
09:50:45   3  tkr
09:50:45   4  ,ydate
09:50:45   5  ,AVG(clse)clse
09:50:45   6  FROM ibs_dups
09:50:45   7  GROUP BY tkr,ydate
09:50:45   8  /

Table created.

Elapsed: 00:00:00.79
09:50:45 SQL> 
09:50:45 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:01.49
09:50:47 SQL> 
09:50:47 SQL> -- rpt
09:50:47 SQL> 
09:50:47 SQL> SELECT
09:50:47   2  tkr
09:50:47   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
09:50:47   4  ,MIN(ydate)
09:50:47   5  ,COUNT(ydate)
09:50:47   6  ,MAX(ydate)FROM
09:50:47   7  ibs15min
09:50:47   8  GROUP BY tkr
09:50:47   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	  9185.78333 2010-12-27 13:00:00	 1555 2011-02-12 00:45:00
AKAM	  9185.78333 2010-12-27 12:45:00	 1617 2011-02-12 00:45:00
APA	  9185.78333 2010-12-27 12:45:00	 1594 2011-02-12 00:45:00
APC	  9185.78333 2010-12-27 14:15:00	 1650 2011-02-12 00:45:00
AXP	  9185.78333 2010-12-27 13:00:00	 1637 2011-02-12 00:45:00
BP	  9185.78333 2010-12-27 13:00:00	 2098 2011-02-12 00:45:00
BTU	  9185.78333 2010-12-27 12:45:00	 1656 2011-02-12 00:45:00
CAT	  9185.78333 2010-12-27 12:45:00	 1691 2011-02-12 00:45:00
CVS	  19265.7833 2010-12-27 14:30:00	 1313 2011-02-05 00:45:00
GD	  9185.78333 2010-12-27 13:00:00	 1729 2011-02-12 00:45:00
HL	  9185.78333 2011-01-18 12:30:00	  978 2011-02-12 00:45:00
MAR	  9185.78333 2010-12-27 14:30:00	 1454 2011-02-12 00:45:00
MDT	  9185.78333 2010-12-27 13:45:00	 1568 2011-02-12 00:45:00
QQQQ	  9185.78333 2010-12-27 09:00:00	 2099 2011-02-12 00:45:00
SINA	  9185.78333 2010-12-27 14:15:00	 1574 2011-02-12 00:45:00
SLW	  9185.78333 2011-01-18 09:15:00	 1096 2011-02-12 00:45:00
SPY	  9185.78333 2010-12-27 09:00:00	 2173 2011-02-12 00:45:00
SVM	  9185.78333 2011-01-18 13:00:00	  901 2011-02-12 00:45:00
V	  9185.78333 2010-12-27 12:30:00	 1756 2011-02-12 00:45:00
VECO	  9185.78333 2010-12-27 14:30:00	 1613 2011-02-12 00:45:00
WDC	  9185.78333 2010-12-27 09:15:00	 1553 2011-02-12 00:45:00
XOM	  9185.78333 2010-12-27 13:00:00	 1844 2011-02-12 00:45:00
AFL	  9185.78333 2010-12-27 14:30:00	 1488 2011-02-12 00:45:00
AMT	  9185.78333 2010-12-27 13:00:00	 1508 2011-02-12 00:45:00
AXU	  9185.78333 2011-01-18 13:00:00	  833 2011-02-12 00:45:00
CTSH	  9185.78333 2010-12-27 14:30:00	 1565 2011-02-12 00:45:00
GFI	  9185.78333 2011-01-24 09:15:00	  834 2011-02-12 00:45:00
IOC	  9185.78333 2010-12-27 14:30:00	 1445 2011-02-12 00:45:00
JPM	  9185.78333 2010-12-27 13:00:00	 1795 2011-02-12 00:45:00
SKX	  9185.78333 2010-12-27 12:00:00	 1540 2011-02-12 00:45:00
SLB	  9185.78333 2010-12-27 09:15:00	 1812 2011-02-12 00:45:00
STT	  9185.78333 2010-12-27 14:30:00	 1476 2011-02-12 00:45:00
SU	  9185.78333 2010-12-27 14:30:00	 1552 2011-02-12 00:45:00
TSO	  545.783333 2011-02-07 12:15:00	  427 2011-02-18 00:45:00
UNH	  9185.78333 2010-12-27 13:00:00	 1582 2011-02-12 00:45:00
UNP	  9185.78333 2010-12-27 14:30:00	 1536 2011-02-12 00:45:00
AIG	  9185.78333 2010-12-27 13:30:00	 1822 2011-02-12 00:45:00
BBY	  9185.78333 2010-12-27 12:00:00	 1660 2011-02-12 00:45:00
CDE	  9185.78333 2011-01-18 11:45:00	  926 2011-02-12 00:45:00
CSX	  9185.78333 2010-12-27 14:30:00	 1549 2011-02-12 00:45:00
CVX	  9185.78333 2010-12-27 13:00:00	 1662 2011-02-12 00:45:00
DD	  9185.78333 2010-12-27 11:30:00	 1637 2011-02-12 00:45:00
EOG	  9185.78333 2010-12-27 14:30:00	 1506 2011-02-12 00:45:00
FCX	  9185.78333 2010-12-27 12:45:00	 1843 2011-02-12 00:45:00
FSLR	  9185.78333 2010-12-27 13:00:00	 1553 2011-02-12 00:45:00
HD	  9185.78333 2010-12-27 12:30:00	 1611 2011-02-12 00:45:00
HON	  9185.78333 2010-12-27 14:15:00	 1516 2011-02-12 00:45:00
IBM	  9185.78333 2010-12-27 12:45:00	 1823 2011-02-12 00:45:00
IWM	  9185.78333 2010-12-27 11:00:00	 2024 2011-02-12 00:45:00
MEE	  9185.78333 2010-12-27 13:15:00	 1623 2011-02-12 00:45:00
NFLX	  9185.78333 2010-12-27 12:30:00	 1725 2011-02-12 00:45:00
PRU	  9185.78333 2010-12-27 13:45:00	 1519 2011-02-12 00:45:00
UPS	  9185.78333 2010-12-27 14:30:00	 1519 2011-02-12 00:45:00
WHR	  9185.78333 2010-12-27 14:30:00	 1487 2011-02-12 00:45:00
XLB	  9185.78333 2010-12-27 13:30:00	 1492 2011-02-12 00:45:00
XLE	  9185.78333 2010-12-27 13:00:00	 1635 2011-02-12 00:45:00
BEN	  9185.78333 2010-12-27 13:00:00	 1486 2011-02-12 00:45:00
CHK	  9185.78333 2011-01-18 13:00:00	  961 2011-02-12 00:45:00
CMI	  9185.78333 2010-12-27 12:30:00	 1590 2011-02-12 00:45:00
COST	  9185.78333 2010-12-27 14:30:00	 1532 2011-02-12 00:45:00
DTV	  9185.78333 2010-12-27 14:30:00	 1486 2011-02-12 00:45:00
ESRX	  9185.78333 2010-12-27 14:30:00	 1497 2011-02-12 00:45:00
GG	  9185.78333 2010-12-27 13:15:00	 1667 2011-02-12 00:45:00
HPQ	  9185.78333 2010-12-27 12:15:00	 1806 2011-02-12 00:45:00
KO	  9185.78333 2010-12-27 12:30:00	 1885 2011-02-12 00:45:00
MDY	  9185.78333 2010-12-27 13:15:00	 1625 2011-02-12 00:45:00
MET	  9185.78333 2010-12-27 14:30:00	 1520 2011-02-12 00:45:00
MVG	  9185.78333 2011-01-18 14:15:00	  807 2011-02-12 00:45:00
NOC	  9185.78333 2011-01-24 13:30:00	  648 2011-02-12 00:45:00
PAAS	  9185.78333 2011-01-18 14:00:00	  940 2011-02-12 00:45:00
PALL	  9185.78333 2011-01-18 14:00:00	  848 2011-02-12 00:45:00
PNC	  9185.78333 2010-12-27 14:15:00	 1565 2011-02-12 00:45:00
SJM	  9185.78333 2010-12-27 14:30:00	 1443 2011-02-12 00:45:00
SNDK	  9185.78333 2010-12-27 13:00:00	 1689 2011-02-12 00:45:00
SUN	  9185.78333 2010-12-27 14:30:00	 1500 2011-02-12 00:45:00
SWC	  9185.78333 2011-01-18 13:00:00	  910 2011-02-12 00:45:00
TGT	  9185.78333 2010-12-27 14:15:00	 1590 2011-02-12 00:45:00
TKR	  9185.78333 2011-01-24 14:30:00	  639 2011-02-12 00:45:00
XLU	  9185.78333 2010-12-27 14:30:00	 1448 2011-02-12 00:45:00
ABT	  9185.78333 2010-12-27 12:30:00	 1707 2011-02-12 00:45:00
AMGN	  9185.78333 2010-12-27 14:00:00	 1522 2011-02-12 00:45:00
AMZN	  9185.78333 2010-12-27 11:15:00	 1888 2011-02-12 00:45:00
BHP	  9185.78333 2010-12-27 12:15:00	 2085 2011-02-12 00:45:00
COF	  9185.78333 2010-12-27 14:30:00	 1496 2011-02-12 00:45:00
DNDN	  9185.78333 2010-12-27 14:15:00	 1545 2011-02-12 00:45:00
EBAY	  9185.78333 2011-01-18 13:00:00	  908 2011-02-12 00:45:00
EXK	  9185.78333 2011-01-18 13:00:00	  915 2011-02-12 00:45:00
FDX	  9185.78333 2010-12-27 12:30:00	 1567 2011-02-12 00:45:00
GLD	  9185.78333 2010-12-27 11:00:00	 2108 2011-02-12 00:45:00
JNJ	  9185.78333 2010-12-27 11:15:00	 1878 2011-02-12 00:45:00
LFT	  9185.78333 2010-12-27 14:00:00	 1449 2011-02-12 00:45:00
MOS	  9185.78333 2010-12-27 13:30:00	 1736 2011-02-12 00:45:00
NEM	  9185.78333 2010-12-27 14:15:00	 1751 2011-02-12 00:45:00
OXY	  9185.78333 2010-12-27 14:30:00	 1594 2011-02-12 00:45:00
PEP	  9185.78333 2010-12-27 14:15:00	 1577 2011-02-12 00:45:00
PG	  9185.78333 2010-12-27 11:30:00	 1764 2011-02-12 00:45:00
RIG	  9185.78333 2010-12-27 12:00:00	 2028 2011-02-12 00:45:00
VLO	  9185.78333 2011-01-31 13:00:00	  501 2011-02-12 00:45:00
AGU	  9185.78333 2011-01-18 13:00:00	  916 2011-02-12 00:45:00
BA	  9185.78333 2010-12-27 13:00:00	 1633 2011-02-12 00:45:00
BBT	  9185.78333 2010-12-27 14:15:00	 1532 2011-02-12 00:45:00
BIDU	  9185.78333 2010-12-27 12:15:00	 1778 2011-02-12 00:45:00
BRCM	  9185.78333 2010-12-27 14:30:00	 1636 2011-02-12 00:45:00
CELG	  9185.78333 2010-12-27 14:30:00	 1487 2011-02-12 00:45:00
CREE	  9185.78333 2010-12-27 14:00:00	 1646 2011-02-12 00:45:00
CVE	  9185.78333 2011-01-31 13:00:00	  444 2011-02-12 00:45:00
DE	  9185.78333 2010-12-27 13:00:00	 1648 2011-02-12 00:45:00
DIS	  9185.78333 2010-12-27 13:00:00	 1582 2011-02-12 00:45:00
EWZ	  9185.78333 2010-12-27 09:00:00	 2020 2011-02-12 00:45:00
FFIV	  9185.78333 2010-12-27 12:30:00	 1633 2011-02-12 00:45:00
GDX	  9185.78333 2010-12-27 13:00:00	 1770 2011-02-12 00:45:00
GILD	  9185.78333 2010-12-27 13:30:00	 1570 2011-02-12 00:45:00
GOOG	  9185.78333 2010-12-27 09:15:00	 1823 2011-02-12 00:45:00
GS	  9185.78333 2010-12-27 13:00:00	 1711 2011-02-12 00:45:00
HES	  9185.78333 2010-12-27 14:30:00	 1630 2011-02-12 00:45:00
MMM	  9185.78333 2010-12-27 13:30:00	 1593 2011-02-12 00:45:00
MON	  9185.78333 2010-12-27 13:30:00	 1663 2011-02-12 00:45:00
MT	  9185.78333 2010-12-27 12:45:00	 2041 2011-02-12 00:45:00
PBR	  9185.78333 2010-12-27 13:00:00	 1765 2011-02-12 00:45:00
PM	  9185.78333 2010-12-27 13:30:00	 1520 2011-02-12 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
POT	  9185.78333 2010-12-27 12:15:00	 1732 2011-02-12 00:45:00
RDY	  9185.78333 2011-01-18 13:30:00	  864 2011-02-12 00:45:00
SCCO	  9185.78333 2011-01-18 13:30:00	  892 2011-02-12 00:45:00
TEVA	  9185.78333 2010-12-27 13:00:00	 1745 2011-02-12 00:45:00
TLT	  9185.78333 2010-12-27 12:30:00	 1773 2011-02-12 00:45:00
VMW	  9185.78333 2010-12-27 14:30:00	 1599 2011-02-12 00:45:00
WFMI	  9185.78333 2010-12-27 14:30:00	 1534 2011-02-12 00:45:00
X	  9185.78333 2010-12-27 13:00:00	 1836 2011-02-12 00:45:00
AAPL	  9185.78333 2010-12-27 09:00:00	 2098 2011-02-12 00:45:00
ALL	  9185.78333 2010-12-27 14:30:00	 1493 2011-02-12 00:45:00
BUCY	  9185.78333 2010-12-27 14:15:00	 1504 2011-02-12 00:45:00
CEO	  9185.78333 2011-01-18 14:15:00	  849 2011-02-12 00:45:00
CRM	  9185.78333 2010-12-27 13:00:00	 1644 2011-02-12 00:45:00
DVN	  9185.78333 2010-12-27 13:00:00	 1578 2011-02-12 00:45:00
FLS	  9185.78333 2010-12-27 14:30:00	 1474 2011-02-12 00:45:00
JOYG	  9185.78333 2010-12-27 14:30:00	 1542 2011-02-12 00:45:00
LMT	  9185.78333 2011-01-24 14:15:00	  652 2011-02-12 00:45:00
NUE	  9185.78333 2010-12-27 13:45:00	 1539 2011-02-12 00:45:00
PPLT	  9185.78333 2011-01-18 14:30:00	  825 2011-02-12 00:45:00
QCOM	  9185.78333 2010-12-27 13:00:00	 1638 2011-02-12 00:45:00
SLV	  9185.78333 2010-12-27 09:30:00	 2062 2011-02-12 00:45:00
SOHU	  9185.78333 2011-01-18 14:30:00	  865 2011-02-12 00:45:00
VALE	  9185.78333 2011-01-18 13:00:00	  958 2011-02-12 00:45:00
ABX	  9185.78333 2010-12-27 14:30:00	 1767 2011-02-12 00:45:00
AEM	  9185.78333 2010-12-27 14:30:00	 1607 2011-02-12 00:45:00
AMX	  9185.78333 2010-12-27 14:30:00	 1452 2011-02-12 00:45:00
ARG	  9185.78333 2010-12-27 14:00:00	 1513 2011-02-12 00:45:00
CLF	  9185.78333 2010-12-27 12:30:00	 1627 2011-02-12 00:45:00
COP	  9185.78333 2010-12-27 13:00:00	 1660 2011-02-12 00:45:00
DIA	  9185.78333 2010-12-27 12:00:00	 1902 2011-02-12 00:45:00
EFA	  9185.78333 2010-12-27 14:00:00	 1660 2011-02-12 00:45:00
JWN	  9185.78333 2010-12-27 13:45:00	 1470 2011-02-12 00:45:00
MCD	  9185.78333 2010-12-27 10:30:00	 1884 2011-02-12 00:45:00
MJN	  9185.78333 2010-12-27 14:30:00	 1477 2011-02-12 00:45:00
MRK	  9185.78333 2010-12-27 13:30:00	 1663 2011-02-12 00:45:00
OIH	  9185.78333 2010-12-27 14:30:00	 1617 2011-02-12 00:45:00
RIMM	  9185.78333 2010-12-27 12:45:00	 1697 2011-02-12 00:45:00
RTN	  9185.78333 2011-01-24 14:30:00	  663 2011-02-12 00:45:00
WMT	  9185.78333 2010-12-27 13:30:00	 1606 2011-02-12 00:45:00
WYNN	  9185.78333 2010-12-27 13:45:00	 1627 2011-02-12 00:45:00

160 rows selected.

Elapsed: 00:00:00.09
09:50:47 SQL> 
09:50:47 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
