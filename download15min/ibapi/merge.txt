
SQL*Plus: Release 11.2.0.1.0 Production on Sat Feb 26 02:36:30 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

02:36:30 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
02:36:30 SQL> 02:36:30 SQL> --
02:36:30 SQL> -- merge.sql
02:36:30 SQL> --
02:36:30 SQL> 
02:36:30 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
02:36:30 SQL> 
02:36:30 SQL> 
02:36:30 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
02:36:30 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
02:36:30 SQL> 
02:36:30 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.24
02:36:30 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.03
02:36:30 SQL> 
02:36:30 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.23
02:36:31 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.04
02:36:31 SQL> 
02:36:31 SQL> CREATE TABLE ibs_dups COMPRESS AS
02:36:31   2  SELECT
02:36:31   3  tkr
02:36:31   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
02:36:31   5  ,clse
02:36:31   6  FROM ibs_stage
02:36:31   7  UNION
02:36:31   8  SELECT tkr,ydate,clse
02:36:31   9  FROM ibs_old
02:36:31  10  /

Table created.

Elapsed: 00:00:01.13
02:36:32 SQL> 
02:36:32 SQL> CREATE TABLE ibs15min COMPRESS AS
02:36:32   2  SELECT
02:36:32   3  tkr
02:36:32   4  ,ydate
02:36:32   5  ,AVG(clse)clse
02:36:32   6  FROM ibs_dups
02:36:32   7  GROUP BY tkr,ydate
02:36:32   8  /

Table created.

Elapsed: 00:00:00.94
02:36:33 SQL> 
02:36:33 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:01.59
02:36:34 SQL> 
02:36:34 SQL> -- rpt
02:36:34 SQL> 
02:36:34 SQL> SELECT
02:36:34   2  tkr
02:36:34   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
02:36:34   4  ,MIN(ydate)
02:36:34   5  ,COUNT(ydate)
02:36:34   6  ,MAX(ydate)FROM
02:36:34   7  ibs15min
02:36:34   8  GROUP BY tkr
02:36:34   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	  111.566667 2010-12-27 13:00:00	 1962 2011-02-26 00:45:00
AKAM	  111.566667 2010-12-27 12:45:00	 2058 2011-02-26 00:45:00
APA	  111.566667 2010-12-27 12:45:00	 2039 2011-02-26 00:45:00
APC	  111.566667 2010-12-27 14:15:00	 2073 2011-02-26 00:45:00
AXP	  111.566667 2010-12-27 13:00:00	 2093 2011-02-26 00:45:00
BP	  111.566667 2010-12-27 13:00:00	 2662 2011-02-26 00:45:00
BTU	  111.566667 2010-12-27 12:45:00	 2087 2011-02-26 00:45:00
CAT	  111.566667 2010-12-27 12:45:00	 2144 2011-02-26 00:45:00
CVS	  111.566667 2010-12-27 14:30:00	 1948 2011-02-26 00:45:00
GD	  111.566667 2010-12-27 13:00:00	 2213 2011-02-26 00:45:00
HL	  111.566667 2011-01-18 12:30:00	 1476 2011-02-26 00:45:00
MAR	  111.566667 2010-12-27 14:30:00	 1861 2011-02-26 00:45:00
MDT	  111.566667 2010-12-27 13:45:00	 1983 2011-02-26 00:45:00
QQQQ	  111.566667 2010-12-27 09:00:00	 2635 2011-02-26 00:45:00
SINA	  111.566667 2010-12-27 14:15:00	 2001 2011-02-26 00:45:00
SLW	  111.566667 2011-01-18 09:15:00	 1603 2011-02-26 00:45:00
SPY	  111.566667 2010-12-27 09:00:00	 2749 2011-02-26 00:45:00
SVM	  111.566667 2011-01-18 13:00:00	 1342 2011-02-26 00:45:00
V	  111.566667 2010-12-27 12:30:00	 2268 2011-02-26 00:45:00
VECO	  111.566667 2010-12-27 14:30:00	 2069 2011-02-26 00:45:00
WDC	  111.566667 2010-12-27 09:15:00	 1950 2011-02-26 00:45:00
XOM	  111.566667 2010-12-27 13:00:00	 2357 2011-02-26 00:45:00
AFL	  111.566667 2010-12-27 14:30:00	 1875 2011-02-26 00:45:00
AMT	  111.566667 2010-12-27 13:00:00	 1928 2011-02-26 00:45:00
AXU	  111.566667 2011-01-18 13:00:00	 1275 2011-02-26 00:45:00
CTSH	  111.566667 2010-12-27 14:30:00	 1974 2011-02-26 00:45:00
GFI	  111.566667 2011-01-24 09:15:00	 1316 2011-02-26 00:45:00
IOC	  111.566667 2010-12-27 14:30:00	 1826 2011-02-26 00:45:00
JPM	  111.566667 2010-12-27 13:00:00	 2291 2011-02-26 00:45:00
SKX	  111.566667 2010-12-27 12:00:00	 1939 2011-02-26 00:45:00
SLB	  111.566667 2010-12-27 09:15:00	 2289 2011-02-26 00:45:00
STT	  111.566667 2010-12-27 14:30:00	 1882 2011-02-26 00:45:00
SU	  111.566667 2010-12-27 14:30:00	 1995 2011-02-26 00:45:00
TSO	  111.566667 2011-02-07 12:15:00	  675 2011-02-26 00:45:00
UNH	  111.566667 2010-12-27 13:00:00	 2004 2011-02-26 00:45:00
UNP	  111.566667 2010-12-27 14:30:00	 1936 2011-02-26 00:45:00
AIG	  111.566667 2010-12-27 13:30:00	 2276 2011-02-26 00:45:00
BBY	  111.566667 2010-12-27 12:00:00	 2107 2011-02-26 00:45:00
CDE	  111.566667 2011-01-18 11:45:00	 1389 2011-02-26 00:45:00
CSX	  111.566667 2010-12-27 14:30:00	 1965 2011-02-26 00:45:00
CVX	  111.566667 2010-12-27 13:00:00	 2119 2011-02-26 00:45:00
DD	  111.566667 2010-12-27 11:30:00	 2067 2011-02-26 00:45:00
EOG	  111.566667 2010-12-27 14:30:00	 1897 2011-02-26 00:45:00
FCX	  111.566667 2010-12-27 12:45:00	 2334 2011-02-26 00:45:00
FSLR	  111.566667 2010-12-27 13:00:00	 2001 2011-02-26 00:45:00
HD	  111.566667 2010-12-27 12:30:00	 2038 2011-02-26 00:45:00
HON	  111.566667 2010-12-27 14:15:00	 1933 2011-02-26 00:45:00
IBM	  111.566667 2010-12-27 12:45:00	 2327 2011-02-26 00:45:00
IWM	  111.566667 2010-12-27 11:00:00	 2562 2011-02-26 00:45:00
MEE	  111.566667 2010-12-27 13:15:00	 2034 2011-02-26 00:45:00
NFLX	  111.566667 2010-12-27 12:30:00	 2192 2011-02-26 00:45:00
PRU	  111.566667 2010-12-27 13:45:00	 1923 2011-02-26 00:45:00
UPS	  111.566667 2010-12-27 14:30:00	 1920 2011-02-26 00:45:00
WHR	  111.566667 2010-12-27 14:30:00	 1886 2011-02-26 00:45:00
XLB	  111.566667 2010-12-27 13:30:00	 1880 2011-02-26 00:45:00
XLE	  111.566667 2010-12-27 13:00:00	 2084 2011-02-26 00:45:00
BEN	  111.566667 2010-12-27 13:00:00	 1880 2011-02-26 00:45:00
CHK	  111.566667 2011-01-18 13:00:00	 1417 2011-02-26 00:45:00
CMI	  111.566667 2010-12-27 12:30:00	 2040 2011-02-26 00:45:00
COST	  111.566667 2010-12-27 14:30:00	 1938 2011-02-26 00:45:00
DTV	  111.566667 2010-12-27 14:30:00	 1880 2011-02-26 00:45:00
ESRX	  111.566667 2010-12-27 14:30:00	 1889 2011-02-26 00:45:00
GG	  111.566667 2010-12-27 13:15:00	 2106 2011-02-26 00:45:00
HPQ	  111.566667 2010-12-27 12:15:00	 2305 2011-02-26 00:45:00
KO	  111.566667 2010-12-27 12:30:00	 2350 2011-02-26 00:45:00
MDY	  111.566667 2010-12-27 13:15:00	 2046 2011-02-26 00:45:00
MET	  111.566667 2010-12-27 14:30:00	 1901 2011-02-26 00:45:00
MVG	  111.566667 2011-01-18 14:15:00	 1197 2011-02-26 00:45:00
NOC	  111.566667 2011-01-24 13:30:00	 1044 2011-02-26 00:45:00
PAAS	  111.566667 2011-01-18 14:00:00	 1400 2011-02-26 00:45:00
PALL	  111.566667 2011-01-18 14:00:00	 1258 2011-02-26 00:45:00
PNC	  111.566667 2010-12-27 14:15:00	 1972 2011-02-26 00:45:00
SJM	  111.566667 2010-12-27 14:30:00	 1830 2011-02-26 00:45:00
SNDK	  111.566667 2010-12-27 13:00:00	 2111 2011-02-26 00:45:00
SUN	  111.566667 2010-12-27 14:30:00	 1891 2011-02-26 00:45:00
SWC	  111.566667 2011-01-18 13:00:00	 1335 2011-02-26 00:45:00
TGT	  111.566667 2010-12-27 14:15:00	 1997 2011-02-26 00:45:00
TKR	  111.566667 2011-01-24 14:30:00	 1018 2011-02-26 00:45:00
XLU	  111.566667 2010-12-27 14:30:00	 1848 2011-02-26 00:45:00
ABT	  111.566667 2010-12-27 12:30:00	 2149 2011-02-26 00:45:00
AMGN	  111.566667 2010-12-27 14:00:00	 1930 2011-02-26 00:45:00
AMZN	  111.566667 2010-12-27 11:15:00	 2390 2011-02-26 00:45:00
BHP	  111.566667 2010-12-27 12:15:00	 2645 2011-02-26 00:45:00
COF	  111.566667 2010-12-27 14:30:00	 1891 2011-02-26 00:45:00
DNDN	  111.566667 2010-12-27 14:15:00	 1971 2011-02-26 00:45:00
EBAY	  111.566667 2011-01-18 13:00:00	 1329 2011-02-26 00:45:00
EXK	  111.566667 2011-01-18 13:00:00	 1342 2011-02-26 00:45:00
FDX	  111.566667 2010-12-27 12:30:00	 1983 2011-02-26 00:45:00
GLD	  111.566667 2010-12-27 11:00:00	 2668 2011-02-26 00:45:00
JNJ	  111.566667 2010-12-27 11:15:00	 2399 2011-02-26 00:45:00
LFT	  111.566667 2010-12-27 14:00:00	 1831 2011-02-26 00:45:00
MOS	  111.566667 2010-12-27 13:30:00	 2191 2011-02-26 00:45:00
NEM	  111.566667 2010-12-27 14:15:00	 2193 2011-02-26 00:45:00
OXY	  111.566667 2010-12-27 14:30:00	 2020 2011-02-26 00:45:00
PEP	  111.566667 2010-12-27 14:15:00	 1988 2011-02-26 00:45:00
PG	  111.566667 2010-12-27 11:30:00	 2212 2011-02-26 00:45:00
RIG	  111.566667 2010-12-27 12:00:00	 2554 2011-02-26 00:45:00
VLO	  111.566667 2011-01-31 13:00:00	  955 2011-02-26 00:45:00
AGU	  111.566667 2011-01-18 13:00:00	 1348 2011-02-26 00:45:00
BA	  111.566667 2010-12-27 13:00:00	 2080 2011-02-26 00:45:00
BBT	  111.566667 2010-12-27 14:15:00	 1940 2011-02-26 00:45:00
BIDU	  111.566667 2010-12-27 12:15:00	 2249 2011-02-26 00:45:00
BRCM	  111.566667 2010-12-27 14:30:00	 2099 2011-02-26 00:45:00
CELG	  111.566667 2010-12-27 14:30:00	 1906 2011-02-26 00:45:00
CREE	  111.566667 2010-12-27 14:00:00	 2073 2011-02-26 00:45:00
CVE	  111.566667 2011-01-31 13:00:00	  857 2011-02-26 00:45:00
DE	  111.566667 2010-12-27 13:00:00	 2107 2011-02-26 00:45:00
DIS	  111.566667 2010-12-27 13:00:00	 2019 2011-02-26 00:45:00
EWZ	  111.566667 2010-12-27 09:00:00	 2521 2011-02-26 00:45:00
FFIV	  111.566667 2010-12-27 12:30:00	 2089 2011-02-26 00:45:00
GDX	  111.566667 2010-12-27 13:00:00	 2252 2011-02-26 00:45:00
GILD	  111.566667 2010-12-27 13:30:00	 1983 2011-02-26 00:45:00
GOOG	  111.566667 2010-12-27 09:15:00	 2305 2011-02-26 00:45:00
GS	  111.566667 2010-12-27 13:00:00	 2144 2011-02-26 00:45:00
HES	  111.566667 2010-12-27 14:30:00	 2055 2011-02-26 00:45:00
HOC	  111.566667 2011-02-14 14:00:00	  417 2011-02-26 00:45:00
MMM	  111.566667 2010-12-27 13:30:00	 2012 2011-02-26 00:45:00
MON	  111.566667 2010-12-27 13:30:00	 2109 2011-02-26 00:45:00
MT	  111.566667 2010-12-27 12:45:00	 2559 2011-02-26 00:45:00
PBR	  111.566667 2010-12-27 13:00:00	 2238 2011-02-26 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
PM	  111.566667 2010-12-27 13:30:00	 1933 2011-02-26 00:45:00
POT	  111.566667 2010-12-27 12:15:00	 2210 2011-02-26 00:45:00
RDY	  111.566667 2011-01-18 13:30:00	 1263 2011-02-26 00:45:00
SCCO	  111.566667 2011-01-18 13:30:00	 1331 2011-02-26 00:45:00
TEVA	  111.566667 2010-12-27 13:00:00	 2236 2011-02-26 00:45:00
TLT	  111.566667 2010-12-27 12:30:00	 2242 2011-02-26 00:45:00
VMW	  111.566667 2010-12-27 14:30:00	 2014 2011-02-26 00:45:00
WFMI	  111.566667 2010-12-27 14:30:00	 1962 2011-02-26 00:45:00
X	  111.566667 2010-12-27 13:00:00	 2361 2011-02-26 00:45:00
AAPL	  111.566667 2010-12-27 09:00:00	 2667 2011-02-26 00:45:00
ALL	  111.566667 2010-12-27 14:30:00	 1891 2011-02-26 00:45:00
BUCY	  111.566667 2010-12-27 14:15:00	 1890 2011-02-26 00:45:00
CEO	  111.566667 2011-01-18 14:15:00	 1264 2011-02-26 00:45:00
CRM	  111.566667 2010-12-27 13:00:00	 2078 2011-02-26 00:45:00
DVN	  111.566667 2010-12-27 13:00:00	 2000 2011-02-26 00:45:00
FLS	  111.566667 2010-12-27 14:30:00	 1855 2011-02-26 00:45:00
JOYG	  111.566667 2010-12-27 14:30:00	 1981 2011-02-26 00:45:00
LMT	  111.566667 2011-01-24 14:15:00	 1052 2011-02-26 00:45:00
NUE	  111.566667 2010-12-27 13:45:00	 1941 2011-02-26 00:45:00
PPLT	  111.566667 2011-01-18 14:30:00	 1224 2011-02-26 00:45:00
QCOM	  111.566667 2010-12-27 13:00:00	 2085 2011-02-26 00:45:00
SLV	  111.566667 2010-12-27 09:30:00	 2622 2011-02-26 00:45:00
SOHU	  111.566667 2011-01-18 14:30:00	 1277 2011-02-26 00:45:00
VALE	  111.566667 2011-01-18 13:00:00	 1421 2011-02-26 00:45:00
ABX	  111.566667 2010-12-27 14:30:00	 2249 2011-02-26 00:45:00
AEM	  111.566667 2010-12-27 14:30:00	 2040 2011-02-26 00:45:00
AMX	  111.566667 2010-12-27 14:30:00	 1834 2011-02-26 00:45:00
ARG	  111.566667 2010-12-27 14:00:00	 1920 2011-02-26 00:45:00
CLF	  111.566667 2010-12-27 12:30:00	 2074 2011-02-26 00:45:00
COP	  111.566667 2010-12-27 13:00:00	 2124 2011-02-26 00:45:00
DIA	  111.566667 2010-12-27 12:00:00	 2389 2011-02-26 00:45:00
EFA	  111.566667 2010-12-27 14:00:00	 2088 2011-02-26 00:45:00
JWN	  111.566667 2010-12-27 13:45:00	 1880 2011-02-26 00:45:00
MCD	  111.566667 2010-12-27 10:30:00	 2390 2011-02-26 00:45:00
MJN	  111.566667 2010-12-27 14:30:00	 1871 2011-02-26 00:45:00
MRK	  111.566667 2010-12-27 13:30:00	 2105 2011-02-26 00:45:00
OIH	  111.566667 2010-12-27 14:30:00	 2056 2011-02-26 00:45:00
RIMM	  111.566667 2010-12-27 12:45:00	 2170 2011-02-26 00:45:00
RTN	  111.566667 2011-01-24 14:30:00	 1060 2011-02-26 00:45:00
WMT	  111.566667 2010-12-27 13:30:00	 2056 2011-02-26 00:45:00
WYNN	  111.566667 2010-12-27 13:45:00	 2054 2011-02-26 00:45:00

161 rows selected.

Elapsed: 00:00:00.10
02:36:34 SQL> 
02:36:34 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
