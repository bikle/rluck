
SQL*Plus: Release 11.2.0.1.0 Production on Sat Apr 16 22:44:28 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

22:44:28 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
22:44:28 SQL> 22:44:28 SQL> --
22:44:28 SQL> -- merge.sql
22:44:28 SQL> --
22:44:28 SQL> 
22:44:28 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
22:44:28 SQL> 
22:44:28 SQL> 
22:44:28 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
22:44:28 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
22:44:28 SQL> 
22:44:28 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:00.06
22:44:28 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.04
22:44:28 SQL> 
22:44:28 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:00.03
22:44:28 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.02
22:44:28 SQL> 
22:44:28 SQL> CREATE TABLE ibs_dups COMPRESS AS
22:44:28   2  SELECT
22:44:28   3  tkr
22:44:28   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
22:44:28   5  ,clse
22:44:28   6  FROM ibs_stage
22:44:28   7  UNION
22:44:28   8  SELECT tkr,ydate,clse
22:44:28   9  FROM ibs_old
22:44:28  10  /

Table created.

Elapsed: 00:00:02.41
22:44:30 SQL> 
22:44:30 SQL> CREATE TABLE ibs15min COMPRESS AS
22:44:30   2  SELECT
22:44:30   3  tkr
22:44:30   4  ,ydate
22:44:30   5  ,AVG(clse)clse
22:44:30   6  FROM ibs_dups
22:44:30   7  GROUP BY tkr,ydate
22:44:30   8  /

Table created.

Elapsed: 00:00:02.73
22:44:33 SQL> 
22:44:33 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:03.19
22:44:36 SQL> 
22:44:36 SQL> -- rpt
22:44:36 SQL> 
22:44:36 SQL> SELECT
22:44:36   2  tkr
22:44:36   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
22:44:36   4  ,MIN(ydate)
22:44:36   5  ,COUNT(ydate)
22:44:36   6  ,MAX(ydate)FROM
22:44:36   7  ibs15min
22:44:36   8  GROUP BY tkr
22:44:36   9  ORDER BY tkr
22:44:36  10  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
AAPL	      1424.6 2010-12-27 09:00:00	 4866 2011-04-15 23:00:00
ABT	      1424.6 2010-12-27 12:30:00	 3810 2011-04-15 23:00:00
ABX	      1424.6 2010-12-27 14:30:00	 4067 2011-04-15 23:00:00
ADBE	      1424.6 2010-12-27 13:00:00	 3520 2011-04-15 23:00:00
AEM	      1424.6 2010-12-27 14:30:00	 3699 2011-04-15 23:00:00
AFL	      1424.6 2010-12-27 14:30:00	 3469 2011-04-15 23:00:00
AGU	      1424.6 2011-01-18 13:00:00	 2994 2011-04-15 23:00:00
AIG	      1424.6 2010-12-27 13:30:00	 4071 2011-04-15 23:00:00
AKAM	      1424.6 2010-12-27 12:45:00	 3778 2011-04-15 23:00:00
ALL	      1424.6 2010-12-27 14:30:00	 3404 2011-04-15 23:00:00
AMGN	      1424.6 2010-12-27 14:00:00	 3488 2011-04-15 23:00:00
AMT	      1424.6 2010-12-27 13:00:00	 3543 2011-04-15 23:00:00
AMX	      1424.6 2010-12-27 14:30:00	 3332 2011-04-15 23:00:00
AMZN	      1424.6 2010-12-27 11:15:00	 4277 2011-04-15 23:00:00
APA	      1424.6 2010-12-27 12:45:00	 3666 2011-04-15 23:00:00
APC	      1424.6 2010-12-27 14:15:00	 3670 2011-04-15 23:00:00
ARG	      1424.6 2010-12-27 14:00:00	 3405 2011-04-15 23:00:00
AXP	      1424.6 2010-12-27 13:00:00	 3761 2011-04-15 23:00:00
AXU	      1424.6 2011-01-18 13:00:00	 2880 2011-04-15 23:00:00
BA	      1424.6 2010-12-27 13:00:00	 3753 2011-04-15 23:00:00
BBT	      1424.6 2010-12-27 14:15:00	 3538 2011-04-15 23:00:00
BBY	      1424.6 2010-12-27 12:00:00	 3840 2011-04-15 23:00:00
BEN	      1409.6 2010-12-27 13:00:00	 3379 2011-04-15 23:15:00
BHP	      1409.6 2010-12-27 12:15:00	 4842 2011-04-15 23:15:00
BIDU	      1409.6 2010-12-27 12:15:00	 4103 2011-04-15 23:15:00
BP	      1409.6 2010-12-27 13:00:00	 4834 2011-04-15 23:15:00
BRCM	      1409.6 2010-12-27 14:30:00	 3789 2011-04-15 23:15:00
BTU	      1409.6 2010-12-27 12:45:00	 3806 2011-04-15 23:15:00
BUCY	      1409.6 2010-12-27 14:15:00	 3401 2011-04-15 23:15:00
CAT	      1409.6 2010-12-27 12:45:00	 3924 2011-04-15 23:15:00
CDE	      1409.6 2011-01-18 11:45:00	 3119 2011-04-15 23:15:00
CELG	      1409.6 2010-12-27 14:30:00	 3451 2011-04-15 23:15:00
CEO	      1409.6 2011-01-18 14:15:00	 2825 2011-04-15 23:15:00
CHK	      1409.6 2011-01-18 13:00:00	 3209 2011-04-15 23:15:00
CLF	      1409.6 2010-12-27 12:30:00	 3783 2011-04-15 23:15:00
CMI	      1409.6 2010-12-27 12:30:00	 3712 2011-04-15 23:15:00
COF	      1409.6 2010-12-27 14:30:00	 3450 2011-04-15 23:15:00
COP	      1409.6 2010-12-27 13:00:00	 3824 2011-04-15 23:15:00
COST	      1409.6 2010-12-27 14:30:00	 3510 2011-04-15 23:15:00
CREE	      1409.6 2010-12-27 14:00:00	 3807 2011-04-15 23:15:00
CRM	      1409.6 2010-12-27 13:00:00	 3796 2011-04-15 23:15:00
CSX	      1409.6 2010-12-27 14:30:00	 3615 2011-04-15 23:15:00
CTSH	      1409.6 2010-12-27 14:30:00	 3560 2011-04-15 23:15:00
CVE	      1409.6 2011-01-31 13:00:00	 2400 2011-04-15 23:15:00
CVS	      1409.6 2010-12-27 14:30:00	 3539 2011-04-15 23:15:00
CVX	      1409.6 2010-12-27 13:00:00	 3864 2011-04-15 23:15:00
DD	      1409.6 2010-12-27 11:30:00	 3739 2011-04-15 23:15:00
DE	      1409.6 2010-12-27 13:00:00	 3844 2011-04-15 23:15:00
DIA	      1409.6 2010-12-27 12:00:00	 4387 2011-04-15 23:15:00
DIS	      1409.6 2010-12-27 13:00:00	 3715 2011-04-15 23:15:00
DNDN	      1409.6 2010-12-27 14:15:00	 3631 2011-04-15 23:15:00
DTV	      1409.6 2010-12-27 14:30:00	 3426 2011-04-15 23:15:00
DVN	      1409.6 2010-12-27 13:00:00	 3591 2011-04-15 23:15:00
EBAY	      1409.6 2011-01-18 13:00:00	 2967 2011-04-15 23:15:00
EFA	      1409.6 2010-12-27 14:00:00	 3853 2011-04-15 23:15:00
EOG	      1409.6 2010-12-27 14:30:00	 3499 2011-04-15 23:15:00
ESRX	      1409.6 2010-12-27 14:30:00	 3459 2011-04-15 23:15:00
EWZ	      1394.6 2010-12-27 09:00:00	 4480 2011-04-15 23:30:00
EXK	      1394.6 2011-01-18 13:00:00	 3102 2011-04-15 23:30:00
FCX	      1394.6 2010-12-27 12:45:00	 4269 2011-04-15 23:30:00
FDX	      1394.6 2010-12-27 12:30:00	 3613 2011-04-15 23:30:00
FFIV	      1394.6 2010-12-27 12:30:00	 3830 2011-04-15 23:30:00
FLS	      1394.6 2010-12-27 14:30:00	 3331 2011-04-15 23:30:00
FSLR	      1394.6 2010-12-27 13:00:00	 3705 2011-04-15 23:30:00
FXI	      1424.6 2011-04-04 12:00:00	  514 2011-04-15 23:00:00
GD	      1394.6 2010-12-27 13:00:00	 4085 2011-04-15 23:30:00
GDX	      1394.6 2010-12-27 13:00:00	 4167 2011-04-15 23:30:00
GFI	      1394.6 2011-01-24 09:15:00	 3110 2011-04-15 23:30:00
GG	      1394.6 2010-12-27 13:15:00	 3915 2011-04-15 23:30:00
GILD	      1394.6 2010-12-27 13:30:00	 3581 2011-04-15 23:30:00
GLD	      1394.6 2010-12-27 11:00:00	 4788 2011-04-15 23:30:00
GOOG	      1394.6 2010-12-27 09:15:00	 4162 2011-04-15 23:30:00
GS	      1394.6 2010-12-27 13:00:00	 3890 2011-04-15 23:30:00
HAL	      1379.6 2011-04-04 12:00:00	  494 2011-04-15 23:45:00
HD	      1394.6 2010-12-27 12:30:00	 3672 2011-04-15 23:30:00
HES	      1394.6 2010-12-27 14:30:00	 3656 2011-04-15 23:30:00
HL	      1394.6 2011-01-18 12:30:00	 3332 2011-04-15 23:30:00
HOC	      1394.6 2011-02-14 14:00:00	 1951 2011-04-15 23:30:00
HON	      1394.6 2010-12-27 14:15:00	 3537 2011-04-15 23:30:00
HPQ	      1394.6 2010-12-27 12:15:00	 4165 2011-04-15 23:30:00
IBM	      1394.6 2010-12-27 12:45:00	 4259 2011-04-15 23:30:00
IOC	      1394.6 2010-12-27 14:30:00	 3371 2011-04-15 23:30:00
IWM	      1394.6 2010-12-27 11:00:00	 4715 2011-04-15 23:30:00
JNJ	      1394.6 2010-12-27 11:15:00	 4304 2011-04-15 23:30:00
JOYG	      1394.6 2010-12-27 14:30:00	 3608 2011-04-15 23:30:00
JPM	      1394.6 2010-12-27 13:00:00	 4114 2011-04-15 23:30:00
JWN	      1394.6 2010-12-27 13:45:00	 3399 2011-04-15 23:30:00
KO	      1394.6 2010-12-27 12:30:00	 4131 2011-04-15 23:30:00
LFT	      1394.6 2010-12-27 14:00:00	 3320 2011-04-15 23:30:00
LMT	      1394.6 2011-01-24 14:15:00	 2571 2011-04-15 23:30:00
MAR	      1394.6 2010-12-27 14:30:00	 3403 2011-04-15 23:30:00
MCD	      1394.6 2010-12-27 10:30:00	 4236 2011-04-15 23:30:00
MDT	      1394.6 2010-12-27 13:45:00	 3585 2011-04-15 23:30:00
MDY	      1394.6 2010-12-27 13:15:00	 3765 2011-04-15 23:30:00
MEE	      1379.6 2010-12-27 13:15:00	 3672 2011-04-15 23:45:00
MET	      1379.6 2010-12-27 14:30:00	 3550 2011-04-15 23:45:00
MJN	      1379.6 2010-12-27 14:30:00	 3366 2011-04-15 23:45:00
MMM	      1379.6 2010-12-27 13:30:00	 3668 2011-04-15 23:45:00
MON	      1379.6 2010-12-27 13:30:00	 3831 2011-04-15 23:45:00
MOS	      1379.6 2010-12-27 13:30:00	 3927 2011-04-15 23:45:00
MRK	      1379.6 2010-12-27 13:30:00	 3868 2011-04-15 23:45:00
MT	      1379.6 2010-12-27 12:45:00	 4640 2011-04-15 23:45:00
MVG	      1379.6 2011-01-18 14:15:00	 2708 2011-04-15 23:45:00
NEM	      1379.6 2010-12-27 14:15:00	 3900 2011-04-15 23:45:00
NFLX	      1379.6 2010-12-27 12:30:00	 3996 2011-04-15 23:45:00
NOC	      1379.6 2011-01-24 13:30:00	 2562 2011-04-15 23:45:00
NUE	      1379.6 2010-12-27 13:45:00	 3539 2011-04-15 23:45:00
OIH	      1379.6 2010-12-27 14:30:00	 3720 2011-04-15 23:45:00
ORCL	      1424.6 2011-02-22 12:00:00	 2064 2011-04-15 23:00:00
OXY	      1379.6 2010-12-27 14:30:00	 3621 2011-04-15 23:45:00
PAAS	      1379.6 2011-01-18 14:00:00	 3099 2011-04-15 23:45:00
PALL	      1379.6 2011-01-18 14:00:00	 2847 2011-04-15 23:45:00
PBR	      1379.6 2010-12-27 13:00:00	 4024 2011-04-15 23:45:00
PEP	      1379.6 2010-12-27 14:15:00	 3574 2011-04-15 23:45:00
PG	      1379.6 2010-12-27 11:30:00	 4088 2011-04-15 23:45:00
PM	      1379.6 2010-12-27 13:30:00	 3553 2011-04-15 23:45:00
PNC	      1379.6 2010-12-27 14:15:00	 3586 2011-04-15 23:45:00
POT	      1379.6 2010-12-27 12:15:00	 4032 2011-04-15 23:45:00
PPLT	      1379.6 2011-01-18 14:30:00	 2771 2011-04-15 23:45:00
PRU	      1379.6 2010-12-27 13:45:00	 3521 2011-04-15 23:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
QCOM	      1379.6 2010-12-27 13:00:00	 3833 2011-04-15 23:45:00
QQQ	      1379.6 2010-12-27 09:00:00	 4810 2011-04-15 23:45:00
QQQQ	     41744.6 2010-12-27 09:00:00	 3571 2011-03-18 23:00:00
RDY	      1379.6 2011-01-18 13:30:00	 2803 2011-04-15 23:45:00
RIG	      1379.6 2010-12-27 12:00:00	 4624 2011-04-15 23:45:00
RIMM	      1379.6 2010-12-27 12:45:00	 3954 2011-04-15 23:45:00
RTN	      1379.6 2011-01-24 14:30:00	 2608 2011-04-15 23:45:00
SCCO	      1379.6 2011-01-18 13:30:00	 2976 2011-04-15 23:45:00
SINA	      1379.6 2010-12-27 14:15:00	 3708 2011-04-15 23:45:00
SJM	      1379.6 2010-12-27 14:30:00	 3305 2011-04-15 23:45:00
SKX	      1379.6 2010-12-27 12:00:00	 3456 2011-04-15 23:45:00
SLB	      1379.6 2010-12-27 09:15:00	 4180 2011-04-15 23:45:00
SLV	      1379.6 2010-12-27 09:30:00	 4770 2011-04-15 23:45:00
SLW	      1379.6 2011-01-18 09:15:00	 3552 2011-04-15 23:45:00
SNDK	      1379.6 2010-12-27 13:00:00	 3812 2011-04-15 23:45:00
SOHU	      1379.6 2011-01-18 14:30:00	 2881 2011-04-15 23:45:00
SPY	      1379.6 2010-12-27 09:00:00	 4967 2011-04-15 23:45:00
STT	      1379.6 2010-12-27 14:30:00	 3388 2011-04-15 23:45:00
SU	      1379.6 2010-12-27 14:30:00	 3705 2011-04-15 23:45:00
SUN	      1379.6 2010-12-27 14:30:00	 3442 2011-04-15 23:45:00
SVM	      1379.6 2011-01-18 13:00:00	 3081 2011-04-15 23:45:00
SWC	      1379.6 2011-01-18 13:00:00	 2928 2011-04-15 23:45:00
T	      1424.6 2010-12-27 12:30:00	 4215 2011-04-15 23:00:00
TEVA	      1379.6 2010-12-27 13:00:00	 4058 2011-04-15 23:45:00
TGT	      1379.6 2010-12-27 14:15:00	 3687 2011-04-15 23:45:00
TKR	      1379.6 2011-01-24 14:30:00	 2502 2011-04-15 23:45:00
TLT	      1379.6 2010-12-27 12:30:00	 4012 2011-04-15 23:45:00
TSO	      1379.6 2011-02-07 12:15:00	 2365 2011-04-15 23:45:00
UNH	      1379.6 2010-12-27 13:00:00	 3571 2011-04-15 23:45:00
UNP	      1379.6 2010-12-27 14:30:00	 3504 2011-04-15 23:45:00
UPS	      1379.6 2010-12-27 14:30:00	 3507 2011-04-15 23:45:00
V	      1379.6 2010-12-27 12:30:00	 4106 2011-04-15 23:45:00
VALE	      1379.6 2011-01-18 13:00:00	 3217 2011-04-15 23:45:00
VECO	      1379.6 2010-12-27 14:30:00	 3642 2011-04-15 23:45:00
VLO	      1379.6 2011-01-31 13:00:00	 2669 2011-04-15 23:45:00
VMW	      1379.6 2010-12-27 14:30:00	 3641 2011-04-15 23:45:00
WDC	      1379.6 2010-12-27 09:15:00	 3527 2011-04-15 23:45:00
WFMI	      1379.6 2010-12-27 14:30:00	 3517 2011-04-15 23:45:00
WHR	      1379.6 2010-12-27 14:30:00	 3445 2011-04-15 23:45:00
WMT	      1379.6 2010-12-27 13:30:00	 3820 2011-04-15 23:45:00
WYNN	      1379.6 2010-12-27 13:45:00	 3747 2011-04-15 23:45:00
X	      1379.6 2010-12-27 13:00:00	 4351 2011-04-15 23:45:00
XLB	      1379.6 2010-12-27 13:30:00	 3421 2011-04-15 23:45:00
XLE	      1379.6 2010-12-27 13:00:00	 3782 2011-04-15 23:45:00
XLU	      1379.6 2010-12-27 14:30:00	 3374 2011-04-15 23:45:00
XOM	      1379.6 2010-12-27 13:00:00	 4313 2011-04-15 23:45:00

166 rows selected.

Elapsed: 00:00:00.25
22:44:37 SQL> 
22:44:37 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
