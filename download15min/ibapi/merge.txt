
SQL*Plus: Release 11.2.0.1.0 Production on Sun Feb 13 07:06:18 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

07:06:18 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.01
07:06:18 SQL> 07:06:18 SQL> --
07:06:18 SQL> -- merge.sql
07:06:18 SQL> --
07:06:18 SQL> 
07:06:18 SQL> -- I use this script to merge data from ibs_stage into ibs15min.
07:06:18 SQL> 
07:06:18 SQL> 
07:06:18 SQL> -- CREATE TABLE ibs_old	  (tkr VARCHAR2(8),ydate DATE,clse NUMBER);
07:06:18 SQL> -- CREATE TABLE ibs_dups_old(tkr VARCHAR2(8),ydate DATE,clse NUMBER);
07:06:18 SQL> 
07:06:18 SQL> DROP TABLE ibs_old;

Table dropped.

Elapsed: 00:00:02.10
07:06:20 SQL> RENAME ibs15min TO ibs_old;

Table renamed.

Elapsed: 00:00:00.39
07:06:20 SQL> 
07:06:20 SQL> DROP TABLE ibs_dups_old;

Table dropped.

Elapsed: 00:00:01.81
07:06:22 SQL> RENAME ibs_dups TO ibs_dups_old;

Table renamed.

Elapsed: 00:00:00.35
07:06:23 SQL> 
07:06:23 SQL> CREATE TABLE ibs_dups COMPRESS AS
07:06:23   2  SELECT
07:06:23   3  tkr
07:06:23   4  ,(TO_DATE('1970-01-01','YYYY-MM-DD')+(epochsec/24/3600))ydate
07:06:23   5  ,clse
07:06:23   6  FROM ibs_stage
07:06:23   7  UNION
07:06:23   8  SELECT tkr,ydate,clse
07:06:23   9  FROM ibs_old
07:06:23  10  /

Table created.

Elapsed: 00:00:01.37
07:06:24 SQL> 
07:06:24 SQL> CREATE TABLE ibs15min COMPRESS AS
07:06:24   2  SELECT
07:06:24   3  tkr
07:06:24   4  ,ydate
07:06:24   5  ,AVG(clse)clse
07:06:24   6  FROM ibs_dups
07:06:24   7  GROUP BY tkr,ydate
07:06:24   8  /

Table created.

Elapsed: 00:00:04.74
07:06:29 SQL> 
07:06:29 SQL> ANALYZE TABLE ibs15min COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:02.19
07:06:31 SQL> 
07:06:31 SQL> -- rpt
07:06:31 SQL> 
07:06:31 SQL> SELECT
07:06:31   2  tkr
07:06:31   3  ,(sysdate - MAX(ydate))*24*60 minutes_age
07:06:31   4  ,MIN(ydate)
07:06:31   5  ,COUNT(ydate)
07:06:31   6  ,MAX(ydate)FROM
07:06:31   7  ibs15min
07:06:31   8  GROUP BY tkr
07:06:31   9  /

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
ADBE	  1821.51667 2010-12-27 13:00:00	 1555 2011-02-12 00:45:00
AKAM	  1821.51667 2010-12-27 12:45:00	 1617 2011-02-12 00:45:00
APA	  1821.51667 2010-12-27 12:45:00	 1594 2011-02-12 00:45:00
APC	  1821.51667 2010-12-27 14:15:00	 1650 2011-02-12 00:45:00
AXP	  1821.51667 2010-12-27 13:00:00	 1637 2011-02-12 00:45:00
BP	  1821.51667 2010-12-27 13:00:00	 2098 2011-02-12 00:45:00
BTU	  1821.51667 2010-12-27 12:45:00	 1656 2011-02-12 00:45:00
CAT	  1821.51667 2010-12-27 12:45:00	 1691 2011-02-12 00:45:00
CVS	  11901.5167 2010-12-27 14:30:00	 1313 2011-02-05 00:45:00
GD	  1821.51667 2010-12-27 13:00:00	 1729 2011-02-12 00:45:00
HL	  1821.51667 2011-01-18 12:30:00	  978 2011-02-12 00:45:00
MAR	  1821.51667 2010-12-27 14:30:00	 1454 2011-02-12 00:45:00
MDT	  1821.51667 2010-12-27 13:45:00	 1568 2011-02-12 00:45:00
QQQQ	  1821.51667 2010-12-27 09:00:00	 2099 2011-02-12 00:45:00
SINA	  1821.51667 2010-12-27 14:15:00	 1574 2011-02-12 00:45:00
SLW	  1821.51667 2011-01-18 09:15:00	 1096 2011-02-12 00:45:00
SPY	  1821.51667 2010-12-27 09:00:00	 2173 2011-02-12 00:45:00
SVM	  1821.51667 2011-01-18 13:00:00	  901 2011-02-12 00:45:00
V	  1821.51667 2010-12-27 12:30:00	 1756 2011-02-12 00:45:00
VECO	  1821.51667 2010-12-27 14:30:00	 1613 2011-02-12 00:45:00
WDC	  1821.51667 2010-12-27 09:15:00	 1553 2011-02-12 00:45:00
XOM	  1821.51667 2010-12-27 13:00:00	 1844 2011-02-12 00:45:00
AFL	  1821.51667 2010-12-27 14:30:00	 1488 2011-02-12 00:45:00
AMT	  1821.51667 2010-12-27 13:00:00	 1508 2011-02-12 00:45:00
AXU	  1821.51667 2011-01-18 13:00:00	  833 2011-02-12 00:45:00
CTSH	  1821.51667 2010-12-27 14:30:00	 1565 2011-02-12 00:45:00
GFI	  1821.51667 2011-01-24 09:15:00	  834 2011-02-12 00:45:00
IOC	  1821.51667 2010-12-27 14:30:00	 1445 2011-02-12 00:45:00
JPM	  1821.51667 2010-12-27 13:00:00	 1795 2011-02-12 00:45:00
SKX	  1821.51667 2010-12-27 12:00:00	 1540 2011-02-12 00:45:00
SLB	  1821.51667 2010-12-27 09:15:00	 1812 2011-02-12 00:45:00
STT	  1821.51667 2010-12-27 14:30:00	 1476 2011-02-12 00:45:00
SU	  1821.51667 2010-12-27 14:30:00	 1552 2011-02-12 00:45:00
UNH	  1821.51667 2010-12-27 13:00:00	 1582 2011-02-12 00:45:00
UNP	  1821.51667 2010-12-27 14:30:00	 1536 2011-02-12 00:45:00
AIG	  1821.51667 2010-12-27 13:30:00	 1822 2011-02-12 00:45:00
BBY	  1821.51667 2010-12-27 12:00:00	 1660 2011-02-12 00:45:00
CDE	  1821.51667 2011-01-18 11:45:00	  926 2011-02-12 00:45:00
CSX	  1821.51667 2010-12-27 14:30:00	 1549 2011-02-12 00:45:00
CVX	  1821.51667 2010-12-27 13:00:00	 1662 2011-02-12 00:45:00
DD	  1821.51667 2010-12-27 11:30:00	 1637 2011-02-12 00:45:00
EOG	  1821.51667 2010-12-27 14:30:00	 1506 2011-02-12 00:45:00
FCX	  1821.51667 2010-12-27 12:45:00	 1843 2011-02-12 00:45:00
FSLR	  1821.51667 2010-12-27 13:00:00	 1553 2011-02-12 00:45:00
HD	  1821.51667 2010-12-27 12:30:00	 1611 2011-02-12 00:45:00
HON	  1821.51667 2010-12-27 14:15:00	 1516 2011-02-12 00:45:00
IBM	  1821.51667 2010-12-27 12:45:00	 1823 2011-02-12 00:45:00
IWM	  1821.51667 2010-12-27 11:00:00	 2024 2011-02-12 00:45:00
MEE	  1821.51667 2010-12-27 13:15:00	 1623 2011-02-12 00:45:00
NFLX	  1821.51667 2010-12-27 12:30:00	 1725 2011-02-12 00:45:00
PRU	  1821.51667 2010-12-27 13:45:00	 1519 2011-02-12 00:45:00
UPS	  1821.51667 2010-12-27 14:30:00	 1519 2011-02-12 00:45:00
WHR	  1821.51667 2010-12-27 14:30:00	 1487 2011-02-12 00:45:00
XLB	  1821.51667 2010-12-27 13:30:00	 1492 2011-02-12 00:45:00
XLE	  1821.51667 2010-12-27 13:00:00	 1635 2011-02-12 00:45:00
BEN	  1821.51667 2010-12-27 13:00:00	 1486 2011-02-12 00:45:00
CHK	  1821.51667 2011-01-18 13:00:00	  961 2011-02-12 00:45:00
CMI	  1821.51667 2010-12-27 12:30:00	 1590 2011-02-12 00:45:00
COST	  1821.51667 2010-12-27 14:30:00	 1532 2011-02-12 00:45:00
DTV	  1821.51667 2010-12-27 14:30:00	 1486 2011-02-12 00:45:00
ESRX	  1821.51667 2010-12-27 14:30:00	 1497 2011-02-12 00:45:00
GG	  1821.51667 2010-12-27 13:15:00	 1667 2011-02-12 00:45:00
HPQ	  1821.51667 2010-12-27 12:15:00	 1806 2011-02-12 00:45:00
KO	  1821.51667 2010-12-27 12:30:00	 1885 2011-02-12 00:45:00
MDY	  1821.51667 2010-12-27 13:15:00	 1625 2011-02-12 00:45:00
MET	  1821.51667 2010-12-27 14:30:00	 1520 2011-02-12 00:45:00
MVG	  1821.51667 2011-01-18 14:15:00	  807 2011-02-12 00:45:00
NOC	  1821.51667 2011-01-24 13:30:00	  648 2011-02-12 00:45:00
PAAS	  1821.51667 2011-01-18 14:00:00	  940 2011-02-12 00:45:00
PALL	  1821.51667 2011-01-18 14:00:00	  848 2011-02-12 00:45:00
PNC	  1821.51667 2010-12-27 14:15:00	 1565 2011-02-12 00:45:00
SJM	  1821.51667 2010-12-27 14:30:00	 1443 2011-02-12 00:45:00
SNDK	  1821.51667 2010-12-27 13:00:00	 1689 2011-02-12 00:45:00
SUN	  1821.51667 2010-12-27 14:30:00	 1500 2011-02-12 00:45:00
SWC	  1821.51667 2011-01-18 13:00:00	  910 2011-02-12 00:45:00
TGT	  1821.51667 2010-12-27 14:15:00	 1590 2011-02-12 00:45:00
TKR	  1821.51667 2011-01-24 14:30:00	  639 2011-02-12 00:45:00
XLU	  1821.51667 2010-12-27 14:30:00	 1448 2011-02-12 00:45:00
ABT	  1821.51667 2010-12-27 12:30:00	 1707 2011-02-12 00:45:00
AMGN	  1821.51667 2010-12-27 14:00:00	 1522 2011-02-12 00:45:00
AMZN	  1821.51667 2010-12-27 11:15:00	 1888 2011-02-12 00:45:00
BHP	  1821.51667 2010-12-27 12:15:00	 2085 2011-02-12 00:45:00
COF	  1821.51667 2010-12-27 14:30:00	 1496 2011-02-12 00:45:00
DNDN	  1821.51667 2010-12-27 14:15:00	 1545 2011-02-12 00:45:00
EBAY	  1821.51667 2011-01-18 13:00:00	  908 2011-02-12 00:45:00
EXK	  1821.51667 2011-01-18 13:00:00	  915 2011-02-12 00:45:00
FDX	  1821.51667 2010-12-27 12:30:00	 1567 2011-02-12 00:45:00
GLD	  1821.51667 2010-12-27 11:00:00	 2108 2011-02-12 00:45:00
JNJ	  1821.51667 2010-12-27 11:15:00	 1878 2011-02-12 00:45:00
LFT	  1821.51667 2010-12-27 14:00:00	 1449 2011-02-12 00:45:00
MOS	  1821.51667 2010-12-27 13:30:00	 1736 2011-02-12 00:45:00
NEM	  1821.51667 2010-12-27 14:15:00	 1751 2011-02-12 00:45:00
OXY	  1821.51667 2010-12-27 14:30:00	 1594 2011-02-12 00:45:00
PEP	  1821.51667 2010-12-27 14:15:00	 1577 2011-02-12 00:45:00
PG	  1821.51667 2010-12-27 11:30:00	 1764 2011-02-12 00:45:00
RIG	  1821.51667 2010-12-27 12:00:00	 2028 2011-02-12 00:45:00
VLO	  1821.51667 2011-01-31 13:00:00	  501 2011-02-12 00:45:00
AGU	  1821.51667 2011-01-18 13:00:00	  916 2011-02-12 00:45:00
BA	  1821.51667 2010-12-27 13:00:00	 1633 2011-02-12 00:45:00
BBT	  1821.51667 2010-12-27 14:15:00	 1532 2011-02-12 00:45:00
BIDU	  1821.51667 2010-12-27 12:15:00	 1778 2011-02-12 00:45:00
BRCM	  1821.51667 2010-12-27 14:30:00	 1636 2011-02-12 00:45:00
CELG	  1821.51667 2010-12-27 14:30:00	 1487 2011-02-12 00:45:00
CREE	  1821.51667 2010-12-27 14:00:00	 1646 2011-02-12 00:45:00
CVE	  1821.51667 2011-01-31 13:00:00	  444 2011-02-12 00:45:00
DE	  1821.51667 2010-12-27 13:00:00	 1648 2011-02-12 00:45:00
DIS	  1821.51667 2010-12-27 13:00:00	 1582 2011-02-12 00:45:00
EWZ	  1821.51667 2010-12-27 09:00:00	 2020 2011-02-12 00:45:00
FFIV	  1821.51667 2010-12-27 12:30:00	 1633 2011-02-12 00:45:00
GDX	  1821.51667 2010-12-27 13:00:00	 1770 2011-02-12 00:45:00
GILD	  1821.51667 2010-12-27 13:30:00	 1570 2011-02-12 00:45:00
GOOG	  1821.51667 2010-12-27 09:15:00	 1823 2011-02-12 00:45:00
GS	  1821.51667 2010-12-27 13:00:00	 1711 2011-02-12 00:45:00
HES	  1821.51667 2010-12-27 14:30:00	 1630 2011-02-12 00:45:00
MMM	  1821.51667 2010-12-27 13:30:00	 1593 2011-02-12 00:45:00
MON	  1821.51667 2010-12-27 13:30:00	 1663 2011-02-12 00:45:00
MT	  1821.51667 2010-12-27 12:45:00	 2041 2011-02-12 00:45:00
PBR	  1821.51667 2010-12-27 13:00:00	 1765 2011-02-12 00:45:00
PM	  1821.51667 2010-12-27 13:30:00	 1520 2011-02-12 00:45:00
POT	  1821.51667 2010-12-27 12:15:00	 1732 2011-02-12 00:45:00

TKR	 MINUTES_AGE MIN(YDATE) 	 COUNT(YDATE) MAX(YDATE)
-------- ----------- ------------------- ------------ -------------------
RDY	  1821.51667 2011-01-18 13:30:00	  864 2011-02-12 00:45:00
SCCO	  1821.51667 2011-01-18 13:30:00	  892 2011-02-12 00:45:00
TEVA	  1821.51667 2010-12-27 13:00:00	 1745 2011-02-12 00:45:00
TLT	  1821.51667 2010-12-27 12:30:00	 1773 2011-02-12 00:45:00
VMW	  1821.51667 2010-12-27 14:30:00	 1599 2011-02-12 00:45:00
WFMI	  1821.51667 2010-12-27 14:30:00	 1534 2011-02-12 00:45:00
X	  1821.51667 2010-12-27 13:00:00	 1836 2011-02-12 00:45:00
AAPL	  1821.51667 2010-12-27 09:00:00	 2098 2011-02-12 00:45:00
ALL	  1821.51667 2010-12-27 14:30:00	 1493 2011-02-12 00:45:00
BUCY	  1821.51667 2010-12-27 14:15:00	 1504 2011-02-12 00:45:00
CEO	  1821.51667 2011-01-18 14:15:00	  849 2011-02-12 00:45:00
CRM	  1821.51667 2010-12-27 13:00:00	 1644 2011-02-12 00:45:00
DVN	  1821.51667 2010-12-27 13:00:00	 1578 2011-02-12 00:45:00
FLS	  1821.51667 2010-12-27 14:30:00	 1474 2011-02-12 00:45:00
JOYG	  1821.51667 2010-12-27 14:30:00	 1542 2011-02-12 00:45:00
LMT	  1821.51667 2011-01-24 14:15:00	  652 2011-02-12 00:45:00
NUE	  1821.51667 2010-12-27 13:45:00	 1539 2011-02-12 00:45:00
PPLT	  1821.51667 2011-01-18 14:30:00	  825 2011-02-12 00:45:00
QCOM	  1821.51667 2010-12-27 13:00:00	 1638 2011-02-12 00:45:00
SLV	  1821.51667 2010-12-27 09:30:00	 2062 2011-02-12 00:45:00
SOHU	  1821.51667 2011-01-18 14:30:00	  865 2011-02-12 00:45:00
VALE	  1821.51667 2011-01-18 13:00:00	  958 2011-02-12 00:45:00
ABX	  1821.51667 2010-12-27 14:30:00	 1767 2011-02-12 00:45:00
AEM	  1821.51667 2010-12-27 14:30:00	 1607 2011-02-12 00:45:00
AMX	  1821.51667 2010-12-27 14:30:00	 1452 2011-02-12 00:45:00
ARG	  1821.51667 2010-12-27 14:00:00	 1513 2011-02-12 00:45:00
CLF	  1821.51667 2010-12-27 12:30:00	 1627 2011-02-12 00:45:00
COP	  1821.51667 2010-12-27 13:00:00	 1660 2011-02-12 00:45:00
DIA	  1821.51667 2010-12-27 12:00:00	 1902 2011-02-12 00:45:00
EFA	  1821.51667 2010-12-27 14:00:00	 1660 2011-02-12 00:45:00
JWN	  1821.51667 2010-12-27 13:45:00	 1470 2011-02-12 00:45:00
MCD	  1821.51667 2010-12-27 10:30:00	 1884 2011-02-12 00:45:00
MJN	  1821.51667 2010-12-27 14:30:00	 1477 2011-02-12 00:45:00
MRK	  1821.51667 2010-12-27 13:30:00	 1663 2011-02-12 00:45:00
OIH	  1821.51667 2010-12-27 14:30:00	 1617 2011-02-12 00:45:00
RIMM	  1821.51667 2010-12-27 12:45:00	 1697 2011-02-12 00:45:00
RTN	  1821.51667 2011-01-24 14:30:00	  663 2011-02-12 00:45:00
WMT	  1821.51667 2010-12-27 13:30:00	 1606 2011-02-12 00:45:00
WYNN	  1821.51667 2010-12-27 13:45:00	 1627 2011-02-12 00:45:00

159 rows selected.

Elapsed: 00:00:00.09
07:06:31 SQL> 
07:06:31 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
