
SQL*Plus: Release 11.2.0.1.0 Production on Sat Nov 6 02:55:42 2010

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

02:55:42 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
02:55:42 SQL> 02:55:42 SQL> --
02:55:42 SQL> -- sbw_woq_h.sql
02:55:42 SQL> --
02:55:42 SQL> 
02:55:42 SQL> -- For each pair, look at woq WHERE ydate > '2009-01-01'
02:55:42 SQL> -- This script is similar to sbw_wom.sql
02:55:42 SQL> SELECT pair,week_of_qtr,AVG(nhgain),SUM(nhgain),COUNT(nhgain)
02:55:42   2  FROM
02:55:42   3  (
02:55:42   4  	SELECT
02:55:42   5  	pair
02:55:42   6  	,ydate
02:55:42   7  	,nhgain
02:55:42   8  	-- Step 2 of calculating week_of_qtr:
02:55:42   9  	,week_of_year - 13*(qtr-1)week_of_qtr
02:55:42  10  	FROM
02:55:42  11  	(
02:55:42  12  	  SELECT
02:55:42  13  	  pair
02:55:42  14  	  ,ydate
02:55:42  15  	  -- Normalized hourly gain:
02:55:42  16  	  ,(clse-opn)/opn nhgain
02:55:42  17  	  -- Step 1 of calculating week_of_qtr:
02:55:42  18  	  ,0+TO_CHAR(ydate,'WW')week_of_year
02:55:42  19  	  ,0+TO_CHAR(ydate,'Q')qtr
02:55:42  20  	  FROM hourly
02:55:42  21  	  -- Guard against divide-by-zero:
02:55:42  22  	  WHERE opn>0
02:55:42  23  	  -- I mistrust the 2008 data quality:
02:55:42  24  	  AND ydate > '2009-01-01'
02:55:42  25  	)
02:55:42  26  )
02:55:42  27  GROUP BY pair,week_of_qtr
02:55:42  28  HAVING COUNT(pair)>200
02:55:42  29  ORDER BY ABS(AVG(nhgain))DESC
02:55:42  30  /

PAIR		WEEK_OF_QTR AVG(NHGAIN) SUM(NHGAIN) COUNT(NHGAIN)
--------------- ----------- ----------- ----------- -------------
eur_usd 		 11  .000122461  .103724668	      847
aud_usd 		  7  -.00012237   -.1029149	      841
usd_cad 		  2  -.00010228  -.09890215	      967
gbp_usd 		  6  -.00009937  -.08416394	      847
usd_chf 		  3  .000096331  .093248289	      968
usd_cad 		  3  .000095222  .092174571	      968
gbp_usd 		  3  -.00009187  -.08892668	      968
usd_cad 		  1  -.00009179  -.08885552	      968
aud_usd 		 11   .00008575  .072630048	      847
usd_chf 		  2  -.00008276  -.08003309	      967
gbp_usd 		  2  .000079435  .076813787	      967
gbp_usd 		 11  .000076925  .065155621	      847
usd_jpy 		  2  -.00007356  -.08003135	     1088
aud_usd 		  1  .000072905  .070572243	      968
gbp_usd 		  5  .000070638  .068165276	      965
aud_usd 		  9   .00007001  .059298658	      847
eur_usd 		  3  -.00006991   -.0676747	      968
usd_chf 		 11  -.00006782  -.05744528	      847
eur_usd 		  2  .000067627  .065395742	      967
aud_usd 		  3   -.0000633  -.06127845	      968
gbp_usd 		  4  .000062257  .060265077	      968
usd_jpy 		  7  -.00006213  -.06728285	     1083
usd_cad 		 10  -.00006122  -.05185511	      847
usd_chf 		 13   -.0000533  -.03917674	      735
usd_cad 		  7  .000051303  .043146199	      841
aud_usd 		  8  .000050976  .043176488	      847
usd_cad 		 13  .000050573  .037171081	      735
aud_usd 		  6   .00004972   .04211319	      847
usd_chf 		  9  -.00004894  -.04145524	      847
usd_jpy 		  5   -.0000457  -.04963064	     1086
aud_usd 		  2  .000045523   .04402078	      967
aud_usd 		 10  .000045388  .038443646	      847
usd_cad 		 11  -.00004514  -.03823168	      847
usd_cad 		  5  -.00004238  -.04089356	      965
usd_cad 		  4  -.00004209  -.04074662	      968
usd_chf 		 12  -.00004134  -.03497445	      846
usd_jpy 		  9  .000040468  .044069383	     1089
usd_chf 		  8  -.00003863  -.03272312	      847
usd_chf 		  1  .000037902  .036688732	      968
usd_chf 		  4  .000036633  .035460484	      968
aud_usd 		 13  .000035994    .0264556	      735
usd_cad 		  9  -.00003329  -.02819705	      847
usd_cad 		 12  .000033086  .027990875	      846
gbp_usd 		 12   -.0000292  -.02435127	      834
eur_usd 		 13  .000027212  .020000601	      735
eur_usd 		  9  .000025027  .021198238	      847
eur_usd 		  6  -.00002469  -.02091602	      847
usd_cad 		  8  -.00002467  -.02089278	      847
eur_usd 		  8   .00002431  .020590748	      847
usd_chf 		 10  -.00002338  -.01979943	      847
gbp_usd 		  7  .000023288  .019585098	      841
gbp_usd 		 10  -.00001943  -.01645578	      847
usd_chf 		  7   .00001934   .01626454	      841
usd_jpy 		 12  .000018963  .018318032	      966
usd_jpy 		 13  -.00001882  -.01565837	      832
eur_usd 		  1   -.0000184  -.01780821	      968
usd_jpy 		  1  -.00001742  -.01895086	     1088
eur_usd 		  7  -.00001741  -.01464138	      841
gbp_usd 		  8  -.00001734  -.01468482	      847
usd_chf 		  5  -.00001676    -.016175	      965
usd_cad 		  6   -.0000166  -.01405653	      847
eur_usd 		  4  .000014224  .013768428	      968
usd_jpy 		  3  -.00001372  -.01494303	     1089
usd_jpy 		 11  -.00001348  -.01348252	     1000
usd_jpy 		 10  -.00001247  -.01357867	     1089
eur_usd 		 12  .000011808  .009989792	      846
aud_usd 		  5  .000010437   .01007137	      965
eur_usd 		  5  -.00001017  -.00981443	      965
gbp_usd 		  1  9.5871E-06  .009280325	      968
aud_usd 		 12  -.00000669  -.00566015	      846
gbp_usd 		  9  5.3049E-06  .004493223	      847
usd_jpy 		  8  -4.313E-06  -.00469656	     1089
gbp_usd 		 13  3.8679E-06  .002842911	      735
usd_chf 		  6  -2.372E-06  -.00200902	      847
aud_usd 		  4  -.00000182  -.00176175	      968
usd_jpy 		  6  1.5357E-06  .001540293	     1003
eur_usd 		 10  1.1272E-06  .000954742	      847
usd_jpy 		  4  -5.823E-07  -.00063416	     1089

78 rows selected.

Elapsed: 00:00:00.20
02:55:43 SQL> 
02:55:43 SQL> -- What is the week_of_qtr calculation for today?
02:55:43 SQL> SELECT
02:55:43   2  (week_of_year - 13*(qtr-1))week_of_qtr
02:55:43   3  ,sysdate
02:55:43   4  FROM
02:55:43   5  (
02:55:43   6  	SELECT
02:55:43   7  	0+TO_CHAR(sysdate,'WW')week_of_year
02:55:43   8  	,0+TO_CHAR(sysdate,'Q')qtr
02:55:43   9  	FROM dual
02:55:43  10  )
02:55:43  11  /

WEEK_OF_QTR SYSDATE
----------- -------------------
	  6 2010-11-06 02:55:43

Elapsed: 00:00:00.00
02:55:43 SQL> 
02:55:43 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
                             2010

      January               February               March
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa
                1  2      1  2  3  4  5  6      1  2  3  4  5  6
 3  4  5  6  7  8  9   7  8  9 10 11 12 13   7  8  9 10 11 12 13
10 11 12 13 14 15 16  14 15 16 17 18 19 20  14 15 16 17 18 19 20
17 18 19 20 21 22 23  21 22 23 24 25 26 27  21 22 23 24 25 26 27
24 25 26 27 28 29 30  28                    28 29 30 31
31                                          
       April                  May                   June
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa
             1  2  3                     1         1  2  3  4  5
 4  5  6  7  8  9 10   2  3  4  5  6  7  8   6  7  8  9 10 11 12
11 12 13 14 15 16 17   9 10 11 12 13 14 15  13 14 15 16 17 18 19
18 19 20 21 22 23 24  16 17 18 19 20 21 22  20 21 22 23 24 25 26
25 26 27 28 29 30     23 24 25 26 27 28 29  27 28 29 30
                      30 31                 
        July                 August              September
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa
             1  2  3   1  2  3  4  5  6  7            1  2  3  4
 4  5  6  7  8  9 10   8  9 10 11 12 13 14   5  6  7  8  9 10 11
11 12 13 14 15 16 17  15 16 17 18 19 20 21  12 13 14 15 16 17 18
18 19 20 21 22 23 24  22 23 24 25 26 27 28  19 20 21 22 23 24 25
25 26 27 28 29 30 31  29 30 31              26 27 28 29 30
                                            
      October               November              December
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa
                1  2      1  2  3  4  5  6            1  2  3  4
 3  4  5  6  7  8  9   7  8  9 10 11 12 13   5  6  7  8  9 10 11
10 11 12 13 14 15 16  14 15 16 17 18 19 20  12 13 14 15 16 17 18
17 18 19 20 21 22 23  21 22 23 24 25 26 27  19 20 21 22 23 24 25
24 25 26 27 28 29 30  28 29 30              26 27 28 29 30 31
31                                          
