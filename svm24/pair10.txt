
SQL*Plus: Release 11.2.0.1.0 Production on Thu Feb 3 20:28:19 2011

Copyright (c) 1982, 2009, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options

20:28:21 SQL> ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD hh24:mi:ss';

Session altered.

Elapsed: 00:00:00.00
20:28:21 SQL> 20:28:21 SQL> --
20:28:21 SQL> -- pair10.sql
20:28:21 SQL> --
20:28:21 SQL> 
20:28:21 SQL> -- Creates views and tables needed by SVM.
20:28:21 SQL> 
20:28:21 SQL> -- Start by sanding off some dukas data so it resembles IB data:
20:28:21 SQL> DROP TABLE di5min24;

Table dropped.

Elapsed: 00:00:00.74
20:28:22 SQL> 
20:28:22 SQL> CREATE TABLE di5min24 COMPRESS AS SELECT * FROM di5min;

Table created.

Elapsed: 00:00:01.17
20:28:23 SQL> 
20:28:23 SQL> DELETE di5min24 WHERE TO_CHAR(ydate,'HH24 MI')IN('22 00','22 05','22 10');

825 rows deleted.

Elapsed: 00:00:00.40
20:28:23 SQL> 
20:28:23 SQL> CREATE OR REPLACE VIEW svm2410 AS
20:28:23   2  SELECT
20:28:23   3  pair
20:28:23   4  ,ydate
20:28:23   5  ,prdate
20:28:23   6  ,rownum rnum -- acts as t in my time-series
20:28:23   7  ,clse
20:28:23   8  -- Derive a bunch of attributes from clse, the latest price:
20:28:23   9  ,MIN(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*12 PRECEDING AND CURRENT ROW)min12
20:28:23  10  ,MIN(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*18 PRECEDING AND CURRENT ROW)min18
20:28:23  11  ,MIN(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*24 PRECEDING AND CURRENT ROW)min24
20:28:23  12  ,MIN(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*30 PRECEDING AND CURRENT ROW)min30
20:28:23  13  ,MIN(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*36 PRECEDING AND CURRENT ROW)min36
20:28:23  14  ,MIN(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*48 PRECEDING AND CURRENT ROW)min48
20:28:23  15  ,MIN(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*60 PRECEDING AND CURRENT ROW)min60
20:28:23  16  ,MIN(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*72 PRECEDING AND CURRENT ROW)min72
20:28:23  17  --
20:28:23  18  ,AVG(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*12 PRECEDING AND CURRENT ROW)avg12
20:28:23  19  ,AVG(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*18 PRECEDING AND CURRENT ROW)avg18
20:28:23  20  ,AVG(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*24 PRECEDING AND CURRENT ROW)avg24
20:28:23  21  ,AVG(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*30 PRECEDING AND CURRENT ROW)avg30
20:28:23  22  ,AVG(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*36 PRECEDING AND CURRENT ROW)avg36
20:28:23  23  ,AVG(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*48 PRECEDING AND CURRENT ROW)avg48
20:28:23  24  ,AVG(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*60 PRECEDING AND CURRENT ROW)avg60
20:28:23  25  ,AVG(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*72 PRECEDING AND CURRENT ROW)avg72
20:28:23  26  --
20:28:23  27  ,MAX(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*12 PRECEDING AND CURRENT ROW)max12
20:28:23  28  ,MAX(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*18 PRECEDING AND CURRENT ROW)max18
20:28:23  29  ,MAX(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*24 PRECEDING AND CURRENT ROW)max24
20:28:23  30  ,MAX(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*30 PRECEDING AND CURRENT ROW)max30
20:28:23  31  ,MAX(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*36 PRECEDING AND CURRENT ROW)max36
20:28:23  32  ,MAX(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*48 PRECEDING AND CURRENT ROW)max48
20:28:23  33  ,MAX(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*60 PRECEDING AND CURRENT ROW)max60
20:28:23  34  ,MAX(clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*72 PRECEDING AND CURRENT ROW)max72
20:28:23  35  --
20:28:23  36  ,LEAD(clse,12*24-3,NULL)OVER(PARTITION BY pair ORDER BY ydate)ld1day
20:28:23  37  ,LEAD(ydate,12*24-3,NULL)OVER(PARTITION BY pair ORDER BY ydate)ld_ydate
20:28:23  38  FROM di5min24 WHERE pair = '&1'
20:28:23  39  AND ydate > sysdate - 200
20:28:23  40  ORDER BY ydate
20:28:23  41  /
old  38: FROM di5min24 WHERE pair = '&1'
new  38: FROM di5min24 WHERE pair = 'usd_cad'

View created.

Elapsed: 00:00:00.11
20:28:24 SQL> 
20:28:24 SQL> -- rpt
20:28:24 SQL> 
20:28:24 SQL> -- I should see that ld_ydate is exactly 1 trading day ahead of ydate:
20:28:24 SQL> 
20:28:24 SQL> SELECT
20:28:24   2  TO_CHAR(ydate,'YYYY-MM-DD HH24:MI Dy')dday
20:28:24   3  ,TO_CHAR(ld_ydate,'YYYY-MM-DD HH24:MI Dy')ldday
20:28:24   4  from svm2410
20:28:24   5  WHERE pair='&1'
20:28:24   6  AND ld_ydate > (SELECT MAX(ld_ydate)-1 from svm2410)
20:28:24   7  ORDER BY ydate
20:28:24   8  /
old   5: WHERE pair='&1'
new   5: WHERE pair='usd_cad'

DDAY		     LDDAY
-------------------- --------------------
2011-02-01 19:10 Tue 2011-02-02 19:10 Wed
2011-02-01 19:15 Tue 2011-02-02 19:15 Wed
2011-02-01 19:20 Tue 2011-02-02 19:20 Wed
2011-02-01 19:25 Tue 2011-02-02 19:25 Wed
2011-02-01 19:30 Tue 2011-02-02 19:30 Wed
2011-02-01 19:35 Tue 2011-02-02 19:35 Wed
2011-02-01 19:40 Tue 2011-02-02 19:40 Wed
2011-02-01 19:45 Tue 2011-02-02 19:45 Wed
2011-02-01 19:50 Tue 2011-02-02 19:50 Wed
2011-02-01 19:55 Tue 2011-02-02 19:55 Wed
2011-02-01 20:00 Tue 2011-02-02 20:00 Wed
2011-02-01 20:05 Tue 2011-02-02 20:05 Wed
2011-02-01 20:10 Tue 2011-02-02 20:10 Wed
2011-02-01 20:15 Tue 2011-02-02 20:15 Wed
2011-02-01 20:20 Tue 2011-02-02 20:20 Wed
2011-02-01 20:25 Tue 2011-02-02 20:25 Wed
2011-02-01 20:30 Tue 2011-02-02 20:30 Wed
2011-02-01 20:35 Tue 2011-02-02 20:35 Wed
2011-02-01 20:40 Tue 2011-02-02 20:40 Wed
2011-02-01 20:45 Tue 2011-02-02 20:45 Wed
2011-02-01 20:50 Tue 2011-02-02 20:50 Wed
2011-02-01 20:55 Tue 2011-02-02 20:55 Wed
2011-02-01 21:00 Tue 2011-02-02 21:00 Wed
2011-02-01 21:05 Tue 2011-02-02 21:05 Wed
2011-02-01 21:10 Tue 2011-02-02 21:10 Wed
2011-02-01 21:15 Tue 2011-02-02 21:15 Wed
2011-02-01 21:20 Tue 2011-02-02 21:20 Wed
2011-02-01 21:25 Tue 2011-02-02 21:25 Wed
2011-02-01 21:30 Tue 2011-02-02 21:30 Wed
2011-02-01 21:35 Tue 2011-02-02 21:35 Wed
2011-02-01 21:40 Tue 2011-02-02 21:40 Wed
2011-02-01 21:45 Tue 2011-02-02 21:45 Wed
2011-02-01 21:50 Tue 2011-02-02 21:50 Wed
2011-02-01 21:55 Tue 2011-02-02 21:55 Wed
2011-02-01 22:15 Tue 2011-02-02 22:15 Wed
2011-02-01 22:20 Tue 2011-02-02 22:20 Wed
2011-02-01 22:25 Tue 2011-02-02 22:25 Wed
2011-02-01 22:30 Tue 2011-02-02 22:30 Wed
2011-02-01 22:35 Tue 2011-02-02 22:35 Wed
2011-02-01 22:40 Tue 2011-02-02 22:40 Wed
2011-02-01 22:45 Tue 2011-02-02 22:45 Wed
2011-02-01 22:50 Tue 2011-02-02 22:50 Wed
2011-02-01 22:55 Tue 2011-02-02 22:55 Wed
2011-02-01 23:00 Tue 2011-02-02 23:00 Wed
2011-02-01 23:05 Tue 2011-02-02 23:05 Wed
2011-02-01 23:10 Tue 2011-02-02 23:10 Wed
2011-02-01 23:15 Tue 2011-02-02 23:15 Wed
2011-02-01 23:20 Tue 2011-02-02 23:20 Wed
2011-02-01 23:25 Tue 2011-02-02 23:25 Wed
2011-02-01 23:30 Tue 2011-02-02 23:30 Wed
2011-02-01 23:35 Tue 2011-02-02 23:35 Wed
2011-02-01 23:40 Tue 2011-02-02 23:40 Wed
2011-02-01 23:45 Tue 2011-02-02 23:45 Wed
2011-02-01 23:50 Tue 2011-02-02 23:50 Wed
2011-02-01 23:55 Tue 2011-02-02 23:55 Wed
2011-02-02 00:00 Wed 2011-02-03 00:00 Thu
2011-02-02 00:05 Wed 2011-02-03 00:05 Thu
2011-02-02 00:10 Wed 2011-02-03 00:10 Thu
2011-02-02 00:15 Wed 2011-02-03 00:15 Thu
2011-02-02 00:20 Wed 2011-02-03 00:20 Thu
2011-02-02 00:25 Wed 2011-02-03 00:25 Thu
2011-02-02 00:30 Wed 2011-02-03 00:30 Thu
2011-02-02 00:35 Wed 2011-02-03 00:35 Thu
2011-02-02 00:40 Wed 2011-02-03 00:40 Thu
2011-02-02 00:45 Wed 2011-02-03 00:45 Thu
2011-02-02 00:50 Wed 2011-02-03 00:50 Thu
2011-02-02 00:55 Wed 2011-02-03 00:55 Thu
2011-02-02 01:00 Wed 2011-02-03 01:00 Thu
2011-02-02 01:05 Wed 2011-02-03 01:05 Thu
2011-02-02 01:10 Wed 2011-02-03 01:10 Thu
2011-02-02 01:15 Wed 2011-02-03 01:15 Thu
2011-02-02 01:20 Wed 2011-02-03 01:20 Thu
2011-02-02 01:25 Wed 2011-02-03 01:25 Thu
2011-02-02 01:30 Wed 2011-02-03 01:30 Thu
2011-02-02 01:35 Wed 2011-02-03 01:35 Thu
2011-02-02 01:40 Wed 2011-02-03 01:40 Thu
2011-02-02 01:45 Wed 2011-02-03 01:45 Thu
2011-02-02 01:50 Wed 2011-02-03 01:50 Thu
2011-02-02 01:55 Wed 2011-02-03 01:55 Thu
2011-02-02 02:00 Wed 2011-02-03 02:00 Thu
2011-02-02 02:05 Wed 2011-02-03 02:05 Thu
2011-02-02 02:10 Wed 2011-02-03 02:10 Thu
2011-02-02 02:15 Wed 2011-02-03 02:15 Thu
2011-02-02 02:20 Wed 2011-02-03 02:20 Thu
2011-02-02 02:25 Wed 2011-02-03 02:25 Thu
2011-02-02 02:30 Wed 2011-02-03 02:30 Thu
2011-02-02 02:35 Wed 2011-02-03 02:35 Thu
2011-02-02 02:40 Wed 2011-02-03 02:40 Thu
2011-02-02 02:45 Wed 2011-02-03 02:45 Thu
2011-02-02 02:50 Wed 2011-02-03 02:50 Thu
2011-02-02 02:55 Wed 2011-02-03 02:55 Thu
2011-02-02 03:00 Wed 2011-02-03 03:00 Thu
2011-02-02 03:05 Wed 2011-02-03 03:05 Thu
2011-02-02 03:10 Wed 2011-02-03 03:10 Thu
2011-02-02 03:15 Wed 2011-02-03 03:15 Thu
2011-02-02 03:20 Wed 2011-02-03 03:20 Thu
2011-02-02 03:25 Wed 2011-02-03 03:25 Thu
2011-02-02 03:30 Wed 2011-02-03 03:30 Thu
2011-02-02 03:35 Wed 2011-02-03 03:35 Thu
2011-02-02 03:40 Wed 2011-02-03 03:40 Thu
2011-02-02 03:45 Wed 2011-02-03 03:45 Thu
2011-02-02 03:50 Wed 2011-02-03 03:50 Thu
2011-02-02 03:55 Wed 2011-02-03 03:55 Thu
2011-02-02 04:00 Wed 2011-02-03 04:00 Thu
2011-02-02 04:05 Wed 2011-02-03 04:05 Thu
2011-02-02 04:10 Wed 2011-02-03 04:10 Thu
2011-02-02 04:15 Wed 2011-02-03 04:15 Thu
2011-02-02 04:20 Wed 2011-02-03 04:20 Thu
2011-02-02 04:25 Wed 2011-02-03 04:25 Thu
2011-02-02 04:30 Wed 2011-02-03 04:30 Thu
2011-02-02 04:35 Wed 2011-02-03 04:35 Thu
2011-02-02 04:40 Wed 2011-02-03 04:40 Thu
2011-02-02 04:45 Wed 2011-02-03 04:45 Thu
2011-02-02 04:50 Wed 2011-02-03 04:50 Thu
2011-02-02 04:55 Wed 2011-02-03 04:55 Thu
2011-02-02 05:00 Wed 2011-02-03 05:00 Thu
2011-02-02 05:05 Wed 2011-02-03 05:05 Thu
2011-02-02 05:10 Wed 2011-02-03 05:10 Thu
2011-02-02 05:15 Wed 2011-02-03 05:15 Thu
2011-02-02 05:20 Wed 2011-02-03 05:20 Thu

DDAY		     LDDAY
-------------------- --------------------
2011-02-02 05:25 Wed 2011-02-03 05:25 Thu
2011-02-02 05:30 Wed 2011-02-03 05:30 Thu
2011-02-02 05:35 Wed 2011-02-03 05:35 Thu
2011-02-02 05:40 Wed 2011-02-03 05:40 Thu
2011-02-02 05:45 Wed 2011-02-03 05:45 Thu
2011-02-02 05:50 Wed 2011-02-03 05:50 Thu
2011-02-02 05:55 Wed 2011-02-03 05:55 Thu
2011-02-02 06:00 Wed 2011-02-03 06:00 Thu
2011-02-02 06:05 Wed 2011-02-03 06:05 Thu
2011-02-02 06:10 Wed 2011-02-03 06:10 Thu
2011-02-02 06:15 Wed 2011-02-03 06:15 Thu
2011-02-02 06:20 Wed 2011-02-03 06:20 Thu
2011-02-02 06:25 Wed 2011-02-03 06:25 Thu
2011-02-02 06:30 Wed 2011-02-03 06:30 Thu
2011-02-02 06:35 Wed 2011-02-03 06:35 Thu
2011-02-02 06:40 Wed 2011-02-03 06:40 Thu
2011-02-02 06:45 Wed 2011-02-03 06:45 Thu
2011-02-02 06:50 Wed 2011-02-03 06:50 Thu
2011-02-02 06:55 Wed 2011-02-03 06:55 Thu
2011-02-02 07:00 Wed 2011-02-03 07:00 Thu
2011-02-02 07:05 Wed 2011-02-03 07:05 Thu
2011-02-02 07:10 Wed 2011-02-03 07:10 Thu
2011-02-02 07:15 Wed 2011-02-03 07:15 Thu
2011-02-02 07:20 Wed 2011-02-03 07:20 Thu
2011-02-02 07:25 Wed 2011-02-03 07:25 Thu
2011-02-02 07:30 Wed 2011-02-03 07:30 Thu
2011-02-02 07:35 Wed 2011-02-03 07:35 Thu
2011-02-02 07:40 Wed 2011-02-03 07:40 Thu
2011-02-02 07:45 Wed 2011-02-03 07:45 Thu
2011-02-02 07:50 Wed 2011-02-03 07:50 Thu
2011-02-02 07:55 Wed 2011-02-03 07:55 Thu
2011-02-02 08:00 Wed 2011-02-03 08:00 Thu
2011-02-02 08:05 Wed 2011-02-03 08:05 Thu
2011-02-02 08:10 Wed 2011-02-03 08:10 Thu
2011-02-02 08:15 Wed 2011-02-03 08:15 Thu
2011-02-02 08:20 Wed 2011-02-03 08:20 Thu
2011-02-02 08:25 Wed 2011-02-03 08:25 Thu
2011-02-02 08:30 Wed 2011-02-03 08:30 Thu
2011-02-02 08:35 Wed 2011-02-03 08:35 Thu
2011-02-02 08:40 Wed 2011-02-03 08:40 Thu
2011-02-02 08:45 Wed 2011-02-03 08:45 Thu
2011-02-02 08:50 Wed 2011-02-03 08:50 Thu
2011-02-02 08:55 Wed 2011-02-03 08:55 Thu
2011-02-02 09:00 Wed 2011-02-03 09:00 Thu
2011-02-02 09:05 Wed 2011-02-03 09:05 Thu
2011-02-02 09:10 Wed 2011-02-03 09:10 Thu
2011-02-02 09:15 Wed 2011-02-03 09:15 Thu
2011-02-02 09:20 Wed 2011-02-03 09:20 Thu
2011-02-02 09:25 Wed 2011-02-03 09:25 Thu
2011-02-02 09:30 Wed 2011-02-03 09:30 Thu
2011-02-02 09:35 Wed 2011-02-03 09:35 Thu
2011-02-02 09:40 Wed 2011-02-03 09:40 Thu
2011-02-02 09:45 Wed 2011-02-03 09:45 Thu
2011-02-02 09:50 Wed 2011-02-03 09:50 Thu
2011-02-02 09:55 Wed 2011-02-03 09:55 Thu
2011-02-02 10:00 Wed 2011-02-03 10:00 Thu
2011-02-02 10:05 Wed 2011-02-03 10:05 Thu
2011-02-02 10:10 Wed 2011-02-03 10:10 Thu
2011-02-02 10:15 Wed 2011-02-03 10:15 Thu
2011-02-02 10:20 Wed 2011-02-03 10:20 Thu
2011-02-02 10:25 Wed 2011-02-03 10:25 Thu
2011-02-02 10:30 Wed 2011-02-03 10:30 Thu
2011-02-02 10:35 Wed 2011-02-03 10:35 Thu
2011-02-02 10:40 Wed 2011-02-03 10:40 Thu
2011-02-02 10:45 Wed 2011-02-03 10:45 Thu
2011-02-02 10:50 Wed 2011-02-03 10:50 Thu
2011-02-02 10:55 Wed 2011-02-03 10:55 Thu
2011-02-02 11:00 Wed 2011-02-03 11:00 Thu
2011-02-02 11:05 Wed 2011-02-03 11:05 Thu
2011-02-02 11:10 Wed 2011-02-03 11:10 Thu
2011-02-02 11:15 Wed 2011-02-03 11:15 Thu
2011-02-02 11:20 Wed 2011-02-03 11:20 Thu
2011-02-02 11:25 Wed 2011-02-03 11:25 Thu
2011-02-02 11:30 Wed 2011-02-03 11:30 Thu
2011-02-02 11:35 Wed 2011-02-03 11:35 Thu
2011-02-02 11:40 Wed 2011-02-03 11:40 Thu
2011-02-02 11:45 Wed 2011-02-03 11:45 Thu
2011-02-02 11:50 Wed 2011-02-03 11:50 Thu
2011-02-02 11:55 Wed 2011-02-03 11:55 Thu
2011-02-02 12:00 Wed 2011-02-03 12:00 Thu
2011-02-02 12:05 Wed 2011-02-03 12:05 Thu
2011-02-02 12:10 Wed 2011-02-03 12:10 Thu
2011-02-02 12:15 Wed 2011-02-03 12:15 Thu
2011-02-02 12:20 Wed 2011-02-03 12:20 Thu
2011-02-02 12:25 Wed 2011-02-03 12:25 Thu
2011-02-02 12:30 Wed 2011-02-03 12:30 Thu
2011-02-02 12:35 Wed 2011-02-03 12:35 Thu
2011-02-02 12:40 Wed 2011-02-03 12:40 Thu
2011-02-02 12:45 Wed 2011-02-03 12:45 Thu
2011-02-02 12:50 Wed 2011-02-03 12:50 Thu
2011-02-02 12:55 Wed 2011-02-03 12:55 Thu
2011-02-02 13:00 Wed 2011-02-03 13:00 Thu
2011-02-02 13:05 Wed 2011-02-03 13:05 Thu
2011-02-02 13:10 Wed 2011-02-03 13:10 Thu
2011-02-02 13:15 Wed 2011-02-03 13:15 Thu
2011-02-02 13:20 Wed 2011-02-03 13:20 Thu
2011-02-02 13:25 Wed 2011-02-03 13:25 Thu
2011-02-02 13:30 Wed 2011-02-03 13:30 Thu
2011-02-02 13:35 Wed 2011-02-03 13:35 Thu
2011-02-02 13:40 Wed 2011-02-03 13:40 Thu
2011-02-02 13:45 Wed 2011-02-03 13:45 Thu
2011-02-02 13:50 Wed 2011-02-03 13:50 Thu
2011-02-02 13:55 Wed 2011-02-03 13:55 Thu
2011-02-02 14:00 Wed 2011-02-03 14:00 Thu
2011-02-02 14:05 Wed 2011-02-03 14:05 Thu
2011-02-02 14:10 Wed 2011-02-03 14:10 Thu
2011-02-02 14:15 Wed 2011-02-03 14:15 Thu
2011-02-02 14:20 Wed 2011-02-03 14:20 Thu
2011-02-02 14:25 Wed 2011-02-03 14:25 Thu
2011-02-02 14:30 Wed 2011-02-03 14:30 Thu
2011-02-02 14:35 Wed 2011-02-03 14:35 Thu
2011-02-02 14:40 Wed 2011-02-03 14:40 Thu
2011-02-02 14:45 Wed 2011-02-03 14:45 Thu
2011-02-02 14:50 Wed 2011-02-03 14:50 Thu
2011-02-02 14:55 Wed 2011-02-03 14:55 Thu
2011-02-02 15:00 Wed 2011-02-03 15:00 Thu
2011-02-02 15:05 Wed 2011-02-03 15:05 Thu
2011-02-02 15:10 Wed 2011-02-03 15:10 Thu
2011-02-02 15:15 Wed 2011-02-03 15:15 Thu
2011-02-02 15:20 Wed 2011-02-03 15:20 Thu

DDAY		     LDDAY
-------------------- --------------------
2011-02-02 15:25 Wed 2011-02-03 15:25 Thu
2011-02-02 15:30 Wed 2011-02-03 15:30 Thu
2011-02-02 15:35 Wed 2011-02-03 15:35 Thu
2011-02-02 15:40 Wed 2011-02-03 15:40 Thu
2011-02-02 15:45 Wed 2011-02-03 15:45 Thu
2011-02-02 15:50 Wed 2011-02-03 15:50 Thu
2011-02-02 15:55 Wed 2011-02-03 15:55 Thu
2011-02-02 16:00 Wed 2011-02-03 16:00 Thu
2011-02-02 16:05 Wed 2011-02-03 16:05 Thu
2011-02-02 16:10 Wed 2011-02-03 16:10 Thu
2011-02-02 16:15 Wed 2011-02-03 16:15 Thu
2011-02-02 16:20 Wed 2011-02-03 16:20 Thu
2011-02-02 16:25 Wed 2011-02-03 16:25 Thu
2011-02-02 16:30 Wed 2011-02-03 16:30 Thu
2011-02-02 16:35 Wed 2011-02-03 16:35 Thu
2011-02-02 16:40 Wed 2011-02-03 16:40 Thu
2011-02-02 16:45 Wed 2011-02-03 16:45 Thu
2011-02-02 16:50 Wed 2011-02-03 16:50 Thu
2011-02-02 16:55 Wed 2011-02-03 16:55 Thu
2011-02-02 17:00 Wed 2011-02-03 17:00 Thu
2011-02-02 17:05 Wed 2011-02-03 17:05 Thu
2011-02-02 17:10 Wed 2011-02-03 17:10 Thu
2011-02-02 17:15 Wed 2011-02-03 17:15 Thu
2011-02-02 17:20 Wed 2011-02-03 17:20 Thu
2011-02-02 17:25 Wed 2011-02-03 17:25 Thu
2011-02-02 17:30 Wed 2011-02-03 17:30 Thu
2011-02-02 17:35 Wed 2011-02-03 17:35 Thu
2011-02-02 17:40 Wed 2011-02-03 17:40 Thu
2011-02-02 17:45 Wed 2011-02-03 17:45 Thu
2011-02-02 17:50 Wed 2011-02-03 17:50 Thu
2011-02-02 17:55 Wed 2011-02-03 17:55 Thu
2011-02-02 18:00 Wed 2011-02-03 18:00 Thu
2011-02-02 18:05 Wed 2011-02-03 18:05 Thu
2011-02-02 18:10 Wed 2011-02-03 18:10 Thu
2011-02-02 18:15 Wed 2011-02-03 18:15 Thu
2011-02-02 18:20 Wed 2011-02-03 18:20 Thu
2011-02-02 18:25 Wed 2011-02-03 18:25 Thu
2011-02-02 18:30 Wed 2011-02-03 18:30 Thu
2011-02-02 18:35 Wed 2011-02-03 18:35 Thu
2011-02-02 18:40 Wed 2011-02-03 18:40 Thu
2011-02-02 18:45 Wed 2011-02-03 18:45 Thu
2011-02-02 18:50 Wed 2011-02-03 18:50 Thu
2011-02-02 18:55 Wed 2011-02-03 18:55 Thu
2011-02-02 19:00 Wed 2011-02-03 19:00 Thu
2011-02-02 19:05 Wed 2011-02-03 19:05 Thu

285 rows selected.

Elapsed: 00:00:02.38
20:28:26 SQL> 
20:28:26 SQL> -- I should see that hr 22 is missing 3 rows of data: 00, 05, 10
20:28:26 SQL> SELECT
20:28:26   2  TO_CHAR(ydate,'MI')
20:28:26   3  ,COUNT(TO_CHAR(ydate,'MI'))
20:28:26   4  FROM svm2410
20:28:26   5  WHERE TO_CHAR(ydate,'HH24')='22'
20:28:26   6  AND ydate > sysdate - 30
20:28:26   7  GROUP BY TO_CHAR(ydate,'MI')
20:28:26   8  ORDER BY 0+TO_CHAR(ydate,'MI')
20:28:26   9  /

TO COUNT(TO_CHAR(YDATE,'MI'))
-- --------------------------
15			   22
20			   22
25			   22
30			   22
35			   22
40			   22
45			   22
50			   22
55			   22

9 rows selected.

Elapsed: 00:00:01.16
20:28:27 SQL> 
20:28:27 SQL> -- I should see that other hours have all 12 rows of data
20:28:27 SQL> SELECT
20:28:27   2  TO_CHAR(ydate,'MI')
20:28:27   3  ,COUNT(TO_CHAR(ydate,'MI'))
20:28:27   4  FROM svm2410
20:28:27   5  WHERE TO_CHAR(ydate,'HH24')!='22'
20:28:27   6  AND ydate > sysdate - 30
20:28:27   7  GROUP BY TO_CHAR(ydate,'MI')
20:28:27   8  ORDER BY 0+TO_CHAR(ydate,'MI')
20:28:27   9  /

TO COUNT(TO_CHAR(YDATE,'MI'))
-- --------------------------
00			  505
05			  505
10			  504
15			  504
20			  504
25			  504
30			  505
35			  505
40			  505
45			  505
50			  505
55			  505

12 rows selected.

Elapsed: 00:00:01.21
20:28:28 SQL> 
20:28:28 SQL> -- Derive trend, clse-relations, moving correlation of clse, and date related params:
20:28:28 SQL> 
20:28:28 SQL> DROP TABLE svm2412;

Table dropped.

Elapsed: 00:00:00.05
20:28:28 SQL> CREATE TABLE svm2412 COMPRESS AS
20:28:28   2  SELECT
20:28:28   3  pair
20:28:28   4  ,ydate
20:28:28   5  ,prdate
20:28:28   6  ,clse
20:28:28   7  -- g1 is important. I want to predict g1:
20:28:28   8  ,(ld1day - clse)/clse g1
20:28:28   9  ,SIGN(avg24 - LAG(avg24,2,NULL)OVER(PARTITION BY pair ORDER BY ydate))trend
20:28:28  10  -- I want more attributes from the ones I derived above:
20:28:28  11  -- clse relation to moving-min
20:28:28  12  ,clse-min12 cm12
20:28:28  13  ,clse-min18 cm18
20:28:28  14  ,clse-min24 cm24
20:28:28  15  ,clse-min30 cm30
20:28:28  16  ,clse-min36 cm36
20:28:28  17  ,clse-min48 cm48
20:28:28  18  ,clse-min60 cm60
20:28:28  19  ,clse-min72 cm72
20:28:28  20  -- clse relation to moving-avg
20:28:28  21  ,clse-avg12 ca12
20:28:28  22  ,clse-avg18 ca18
20:28:28  23  ,clse-avg24 ca24
20:28:28  24  ,clse-avg30 ca30
20:28:28  25  ,clse-avg36 ca36
20:28:28  26  ,clse-avg48 ca48
20:28:28  27  ,clse-avg60 ca60
20:28:28  28  ,clse-avg72 ca72
20:28:28  29  -- clse relation to moving-max
20:28:28  30  ,clse-max12 cx12
20:28:28  31  ,clse-max18 cx18
20:28:28  32  ,clse-max24 cx24
20:28:28  33  ,clse-max30 cx30
20:28:28  34  ,clse-max36 cx36
20:28:28  35  ,clse-max48 cx48
20:28:28  36  ,clse-max60 cx60
20:28:28  37  ,clse-max72 cx72
20:28:28  38  -- Derive more attributes.
20:28:28  39  -- I want to use CORR() here to help SVM see the shape of the series.
20:28:28  40  -- But COVAR_POP is more stable:
20:28:28  41  ,COVAR_POP(rnum,clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*12 PRECEDING AND CURRENT ROW)crr12
20:28:28  42  ,COVAR_POP(rnum,clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*18 PRECEDING AND CURRENT ROW)crr18
20:28:28  43  ,COVAR_POP(rnum,clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*24 PRECEDING AND CURRENT ROW)crr24
20:28:28  44  ,COVAR_POP(rnum,clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*30 PRECEDING AND CURRENT ROW)crr30
20:28:28  45  ,COVAR_POP(rnum,clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*36 PRECEDING AND CURRENT ROW)crr36
20:28:28  46  ,COVAR_POP(rnum,clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*48 PRECEDING AND CURRENT ROW)crr48
20:28:28  47  ,COVAR_POP(rnum,clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*60 PRECEDING AND CURRENT ROW)crr60
20:28:28  48  ,COVAR_POP(rnum,clse)OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*72 PRECEDING AND CURRENT ROW)crr72
20:28:28  49  -- Derive date related attributes:
20:28:28  50  ,0+TO_CHAR( ROUND(ydate,'HH24'),'HH24')hh
20:28:28  51  ,0+TO_CHAR(ydate,'D')d
20:28:28  52  ,0+TO_CHAR(ydate,'W')w
20:28:28  53  -- mpm stands for minutes-past-midnight:
20:28:28  54  ,ROUND( (ydate - trunc(ydate))*24*60 )mpm
20:28:28  55  -- mph stands for minutes-past-hour:
20:28:28  56  ,0+TO_CHAR(ydate,'MI')mph
20:28:28  57  FROM svm2410
20:28:28  58  -- Protect against divide by zero:
20:28:28  59  WHERE clse > 0
20:28:28  60  ORDER BY ydate
20:28:28  61  /

Table created.

Elapsed: 00:00:02.32
20:28:31 SQL> 
20:28:31 SQL> -- rpt
20:28:31 SQL> 
20:28:31 SQL> SELECT
20:28:31   2  pair
20:28:31   3  ,TO_CHAR(ydate,'D')dnum
20:28:31   4  ,TO_CHAR(ydate,'dy')dday
20:28:31   5  ,AVG(g1)
20:28:31   6  ,COUNT(pair)
20:28:31   7  ,MIN(clse),MAX(clse)
20:28:31   8  ,MIN(ydate),MAX(ydate)
20:28:31   9  FROM svm2412
20:28:31  10  GROUP BY pair,TO_CHAR(ydate,'D'),TO_CHAR(ydate,'dy')
20:28:31  11  ORDER BY pair,TO_CHAR(ydate,'D'),TO_CHAR(ydate,'dy')
20:28:31  12  /

PAIR	D DDA	 AVG(G1) COUNT(PAIR)  MIN(CLSE)  MAX(CLSE) MIN(YDATE)	       MAX(YDATE)
------- - --- ---------- ----------- ---------- ---------- ------------------- -------------------
usd_cad 1 sun .000080218	 359	  .9874     1.0191 2010-10-31 20:55:00 2011-01-30 23:55:00
usd_cad 2 mon  .00013956	3989 .985875001     1.0249 2010-11-01 00:00:00 2011-01-31 23:55:00
usd_cad 3 tue  -.0004417	4011	.983925   1.028075 2010-10-26 19:15:00 2011-02-01 23:55:00
usd_cad 4 wed -.00211041	4245	.985175     1.0333 2010-10-27 00:00:00 2011-02-02 23:55:00
usd_cad 5 thu .000059192	4210	.985775     1.0285 2010-10-28 00:00:00 2011-02-03 19:05:00
usd_cad 6 fri -.00027118	3689	 .98875     1.0242 2010-10-29 00:00:00 2011-01-28 21:55:00

6 rows selected.

Elapsed: 00:00:00.12
20:28:31 SQL> 
20:28:31 SQL> -- Prepare for derivation of NTILE based params:
20:28:31 SQL> 
20:28:31 SQL> DROP TABLE svm2414;

Table dropped.

Elapsed: 00:00:00.12
20:28:31 SQL> CREATE TABLE svm2414 COMPRESS AS
20:28:31   2  SELECT
20:28:31   3  pair
20:28:31   4  ,ydate
20:28:31   5  ,prdate
20:28:31   6  ,clse
20:28:31   7  ,g1
20:28:31   8  ,CASE WHEN g1 IS NULL THEN NULL WHEN g1>0.0020 THEN'up'ELSE'nup'END gatt
20:28:31   9  ,CASE WHEN g1 IS NULL THEN NULL WHEN g1<-0.0020 THEN'up'ELSE'nup'END gattn
20:28:31  10  ,CASE WHEN trend IS NULL THEN 1
20:28:31  11  	    WHEN trend =0      THEN 1
20:28:31  12  	    ELSE trend END trend
20:28:31  13  ,cm12
20:28:31  14  ,cm18
20:28:31  15  ,cm24
20:28:31  16  ,cm30
20:28:31  17  ,cm36
20:28:31  18  ,cm48
20:28:31  19  ,cm60
20:28:31  20  ,cm72
20:28:31  21  --
20:28:31  22  ,ca12
20:28:31  23  ,ca18
20:28:31  24  ,ca24
20:28:31  25  ,ca30
20:28:31  26  ,ca36
20:28:31  27  ,ca48
20:28:31  28  ,ca60
20:28:31  29  ,ca72
20:28:31  30  --
20:28:31  31  ,cx12
20:28:31  32  ,cx18
20:28:31  33  ,cx24
20:28:31  34  ,cx30
20:28:31  35  ,cx36
20:28:31  36  ,cx48
20:28:31  37  ,cx60
20:28:31  38  ,cx72
20:28:31  39  --
20:28:31  40  ,crr12
20:28:31  41  ,crr18
20:28:31  42  ,crr24
20:28:31  43  ,crr30
20:28:31  44  ,crr36
20:28:31  45  ,crr48
20:28:31  46  ,crr60
20:28:31  47  ,crr72
20:28:31  48  --
20:28:31  49  ,hh
20:28:31  50  ,d
20:28:31  51  ,w
20:28:31  52  ,mpm
20:28:31  53  ,mph
20:28:31  54  FROM svm2412
20:28:31  55  ORDER BY ydate
20:28:31  56  /

Table created.

Elapsed: 00:00:00.42
20:28:31 SQL> 
20:28:31 SQL> -- rpt
20:28:31 SQL> 
20:28:31 SQL> SELECT
20:28:31   2  pair
20:28:31   3  ,trend
20:28:31   4  ,gatt
20:28:31   5  ,d
20:28:31   6  ,hh
20:28:31   7  ,COUNT(pair)
20:28:31   8  ,AVG(g1)
20:28:31   9  FROM svm2414
20:28:31  10  GROUP BY pair,trend,gatt,d,hh
20:28:31  11  ORDER BY AVG(g1),pair,trend,gatt,d,hh
20:28:31  12  -- 500 rows
20:28:31  13  
20:28:31 SQL> -- Derive NTILE based params:
20:28:31 SQL> 
20:28:31 SQL> DROP TABLE svm2416;

Table dropped.

Elapsed: 00:00:00.06
20:28:31 SQL> CREATE TABLE svm2416 COMPRESS AS
20:28:31   2  SELECT
20:28:31   3  pair
20:28:31   4  ,ydate
20:28:31   5  ,prdate
20:28:31   6  ,clse
20:28:31   7  ,g1
20:28:31   8  ,gatt
20:28:31   9  ,gattn
20:28:31  10  ,trend
20:28:31  11  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cm12)att00
20:28:31  12  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cm18)att01
20:28:31  13  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cm24)att02
20:28:31  14  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cm30)att03
20:28:31  15  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cm36)att04
20:28:31  16  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cm48)att05
20:28:31  17  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cm60)att06
20:28:31  18  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cm72)att07
20:28:31  19  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY ca12)att08
20:28:31  20  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY ca18)att09
20:28:31  21  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY ca24)att10
20:28:31  22  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY ca30)att11
20:28:31  23  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY ca36)att12
20:28:31  24  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY ca48)att13
20:28:31  25  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY ca60)att14
20:28:31  26  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY ca72)att15
20:28:31  27  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cx12)att16
20:28:31  28  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cx18)att17
20:28:31  29  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cx24)att18
20:28:31  30  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cx30)att19
20:28:31  31  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cx36)att20
20:28:31  32  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cx48)att21
20:28:31  33  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cx60)att22
20:28:31  34  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY cx72)att23
20:28:31  35  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY crr12)att24
20:28:31  36  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY crr18)att25
20:28:31  37  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY crr24)att26
20:28:31  38  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY crr30)att27
20:28:31  39  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY crr36)att28
20:28:31  40  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY crr48)att29
20:28:31  41  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY crr60)att30
20:28:31  42  ,NTILE(9)OVER(PARTITION BY trend,pair ORDER BY crr72)att31
20:28:31  43  ,hh  att32
20:28:31  44  ,d   att33
20:28:31  45  ,w   att34
20:28:31  46  ,mpm att35
20:28:31  47  ,mph att36
20:28:31  48  ,trend att37
20:28:31  49  FROM svm2414
20:28:31  50  ORDER BY ydate
20:28:31  51  /

Table created.

Elapsed: 00:00:05.37
20:28:37 SQL> 
20:28:37 SQL> -- rpt
20:28:37 SQL> 
20:28:37 SQL> SELECT
20:28:37   2  pair
20:28:37   3  ,trend
20:28:37   4  ,gatt
20:28:37   5  ,att33 daynum
20:28:37   6  ,COUNT(pair)
20:28:37   7  ,AVG(g1)
20:28:37   8  FROM svm2416
20:28:37   9  GROUP BY pair,trend,gatt,att33
20:28:37  10  ORDER BY pair,trend,gatt,att33
20:28:37  11  /

PAIR	     TREND GAT	   DAYNUM COUNT(PAIR)	 AVG(G1)
------- ---------- --- ---------- ----------- ----------
usd_cad 	-1 nup		1	  177 -.00113366
usd_cad 	-1 nup		2	 1450 -.00268256
usd_cad 	-1 nup		3	 1426 -.00310957
usd_cad 	-1 nup		4	 1880 -.00278737
usd_cad 	-1 nup		5	 1987 -.00225651
usd_cad 	-1 nup		6	 1520 -.00192585
usd_cad 	-1 up		1	   61 .002775948
usd_cad 	-1 up		2	  851 .006168567
usd_cad 	-1 up		3	  732 .006669872
usd_cad 	-1 up		4	  275 .003130611
usd_cad 	-1 up		5	  876 .006269129
usd_cad 	-1 up		6	  366 .004549743
usd_cad 	-1		4	   55
usd_cad 	-1		5	  156
usd_cad 	 1 nup		1	   90 -.00073447
usd_cad 	 1 nup		2	 1133 -.00300878
usd_cad 	 1 nup		3	 1326  -.0035509
usd_cad 	 1 nup		4	 1727 -.00361766
usd_cad 	 1 nup		5	  819 -.00299013
usd_cad 	 1 nup		6	 1160 -.00266286
usd_cad 	 1 up		1	   31 .004071819
usd_cad 	 1 up		2	  555 .004695357
usd_cad 	 1 up		3	  527 .004722496
usd_cad 	 1 up		4	  308 .005793604
usd_cad 	 1 up		5	  298 .005625618
usd_cad 	 1 up		6	  643 .005210918
usd_cad 	 1		5	   74

27 rows selected.

Elapsed: 00:00:00.06
20:28:37 SQL> 
20:28:37 SQL> -- Join scores and gains:
20:28:37 SQL> 
20:28:37 SQL> CREATE OR REPLACE VIEW sc12 AS
20:28:37   2  SELECT
20:28:37   3  m.pair
20:28:37   4  ,m.ydate
20:28:37   5  ,m.prdate
20:28:37   6  ,l.score score_long
20:28:37   7  ,s.score score_short
20:28:37   8  ,ROUND(l.score,1) rscore_long
20:28:37   9  ,ROUND(s.score,1) rscore_short
20:28:37  10  ,m.g1
20:28:37  11  FROM svm24scores l,svm24scores s,svm2416 m
20:28:37  12  WHERE l.targ='gatt'
20:28:37  13  AND   s.targ='gattn'
20:28:37  14  AND l.prdate = s.prdate
20:28:37  15  AND l.prdate = m.prdate
20:28:37  16  -- Speed things up:
20:28:37  17  AND l.pair = '&1'
20:28:37  18  AND s.pair = '&1'
20:28:37  19  /
old  17: AND l.pair = '&1'
new  17: AND l.pair = 'usd_cad'
old  18: AND s.pair = '&1'
new  18: AND s.pair = 'usd_cad'

View created.

Elapsed: 00:00:00.05
20:28:37 SQL> 
20:28:37 SQL> -- rpt
20:28:37 SQL> SELECT pair,rscore_long,AVG(g1),MIN(ydate),COUNT(pair),MAX(ydate)FROM sc12
20:28:37   2  GROUP BY pair,rscore_long
20:28:37   3  ORDER BY pair,rscore_long
20:28:37   4  /

PAIR	RSCORE_LONG    AVG(G1) MIN(YDATE)	   COUNT(PAIR) MAX(YDATE)
------- ----------- ---------- ------------------- ----------- -------------------
usd_cad 	  0 -.00432844 2011-02-01 14:35:00	     6 2011-02-02 01:20:00
usd_cad 	 .1 -.00350306 2011-02-01 07:05:00	    86 2011-02-02 22:55:00
usd_cad 	 .2 -.00374614 2011-02-01 06:55:00	   103 2011-02-03 14:40:00
usd_cad 	 .3 -.00421449 2011-02-01 06:15:00	    90 2011-02-03 15:50:00
usd_cad 	 .4 -.00398162 2011-02-01 05:40:00	    73 2011-02-03 14:55:00
usd_cad 	 .5 -.00307126 2011-02-01 06:20:00	    92 2011-02-03 15:55:00
usd_cad 	 .6 -.00241269 2011-02-01 05:55:00	    98 2011-02-03 16:20:00
usd_cad 	 .7 -.00109998 2011-02-01 05:50:00	    76 2011-02-03 16:25:00
usd_cad 	 .8 -.00070493 2011-02-01 05:45:00	    45 2011-02-03 16:35:00
usd_cad 	 .9 -.00007063 2011-02-01 05:35:00	    30 2011-02-03 16:30:00
usd_cad 	  1	       2011-02-03 00:45:00	     4 2011-02-03 12:35:00

11 rows selected.

Elapsed: 00:00:00.06
20:28:37 SQL> 
20:28:37 SQL> DROP TABLE score_corr;

Table dropped.

Elapsed: 00:00:00.03
20:28:37 SQL> 
20:28:37 SQL> CREATE TABLE score_corr COMPRESS AS
20:28:37   2  SELECT
20:28:37   3  pair
20:28:37   4  -- ,ydate
20:28:37   5  ,prdate
20:28:37   6  -- Find corr() tween score and g1 over 11 day period:
20:28:37   7  ,CORR((score_long - score_short),g1)
20:28:37   8  	OVER(PARTITION BY pair ORDER BY ydate ROWS BETWEEN 12*24*5 PRECEDING AND CURRENT ROW)sc_corr
20:28:37   9  FROM sc12
20:28:37  10  /

Table created.

Elapsed: 00:00:00.10
20:28:37 SQL> 
20:28:37 SQL> -- rpt
20:28:37 SQL> 
20:28:37 SQL> SELECT pair,AVG(sc_corr),COUNT(sc_corr)FROM score_corr GROUP BY pair;

PAIR	AVG(SC_CORR) COUNT(SC_CORR)
------- ------------ --------------
usd_cad   .311800445		702

Elapsed: 00:00:00.00
20:28:37 SQL> 
20:28:37 SQL> DROP TABLE modsrc24;

Table dropped.

Elapsed: 00:00:00.05
20:28:37 SQL> 
20:28:37 SQL> PURGE RECYCLEBIN;

Recyclebin purged.

Elapsed: 00:00:00.65
20:28:38 SQL> 
20:28:38 SQL> CREATE TABLE modsrc24 COMPRESS AS
20:28:38   2  SELECT
20:28:38   3  s.pair
20:28:38   4  ,ydate
20:28:38   5  ,s.prdate
20:28:38   6  ,trend
20:28:38   7  ,g1
20:28:38   8  ,gatt
20:28:38   9  ,gattn
20:28:38  10  ,SUM(g1)OVER(PARTITION BY trend,att00 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g00
20:28:38  11  ,SUM(g1)OVER(PARTITION BY trend,att01 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g01
20:28:38  12  ,SUM(g1)OVER(PARTITION BY trend,att02 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g02
20:28:38  13  ,SUM(g1)OVER(PARTITION BY trend,att03 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g03
20:28:38  14  ,SUM(g1)OVER(PARTITION BY trend,att04 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g04
20:28:38  15  ,SUM(g1)OVER(PARTITION BY trend,att05 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g05
20:28:38  16  ,SUM(g1)OVER(PARTITION BY trend,att06 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g06
20:28:38  17  ,SUM(g1)OVER(PARTITION BY trend,att07 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g07
20:28:38  18  ,SUM(g1)OVER(PARTITION BY trend,att08 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g08
20:28:38  19  ,SUM(g1)OVER(PARTITION BY trend,att09 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g09
20:28:38  20  ,SUM(g1)OVER(PARTITION BY trend,att10 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g10
20:28:38  21  ,SUM(g1)OVER(PARTITION BY trend,att11 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g11
20:28:38  22  ,SUM(g1)OVER(PARTITION BY trend,att12 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g12
20:28:38  23  ,SUM(g1)OVER(PARTITION BY trend,att13 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g13
20:28:38  24  ,SUM(g1)OVER(PARTITION BY trend,att14 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g14
20:28:38  25  ,SUM(g1)OVER(PARTITION BY trend,att15 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g15
20:28:38  26  ,SUM(g1)OVER(PARTITION BY trend,att16 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g16
20:28:38  27  ,SUM(g1)OVER(PARTITION BY trend,att17 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g17
20:28:38  28  ,SUM(g1)OVER(PARTITION BY trend,att18 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g18
20:28:38  29  ,SUM(g1)OVER(PARTITION BY trend,att19 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g19
20:28:38  30  ,SUM(g1)OVER(PARTITION BY trend,att20 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g20
20:28:38  31  ,SUM(g1)OVER(PARTITION BY trend,att21 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g21
20:28:38  32  ,SUM(g1)OVER(PARTITION BY trend,att22 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g22
20:28:38  33  ,SUM(g1)OVER(PARTITION BY trend,att23 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g23
20:28:38  34  ,SUM(g1)OVER(PARTITION BY trend,att24 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g24
20:28:38  35  ,SUM(g1)OVER(PARTITION BY trend,att25 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g25
20:28:38  36  ,SUM(g1)OVER(PARTITION BY trend,att26 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g26
20:28:38  37  ,SUM(g1)OVER(PARTITION BY trend,att27 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g27
20:28:38  38  ,SUM(g1)OVER(PARTITION BY trend,att28 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g28
20:28:38  39  ,SUM(g1)OVER(PARTITION BY trend,att29 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g29
20:28:38  40  ,SUM(g1)OVER(PARTITION BY trend,att30 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g30
20:28:38  41  ,SUM(g1)OVER(PARTITION BY trend,att31 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g31
20:28:38  42  ,SUM(g1)OVER(PARTITION BY trend,att32 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g32
20:28:38  43  ,SUM(g1)OVER(PARTITION BY trend,att33 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g33
20:28:38  44  ,SUM(g1)OVER(PARTITION BY trend,att34 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g34
20:28:38  45  ,SUM(g1)OVER(PARTITION BY trend,att35 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g35
20:28:38  46  ,SUM(g1)OVER(PARTITION BY trend,att36 ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g36
20:28:38  47  -- Add extra goodness attributes related to trend:
20:28:38  48  ,SUM(g1)OVER(PARTITION BY trend ORDER BY ydate ROWS BETWEEN 12*24*40 PRECEDING AND CURRENT ROW)g37
20:28:38  49  ,SUM(g1)OVER(PARTITION BY trend ORDER BY ydate ROWS BETWEEN 12*24*30 PRECEDING AND CURRENT ROW)g38
20:28:38  50  ,SUM(g1)OVER(PARTITION BY trend ORDER BY ydate ROWS BETWEEN 12*24*20 PRECEDING AND CURRENT ROW)g39
20:28:38  51  ,SUM(g1)OVER(PARTITION BY trend ORDER BY ydate ROWS BETWEEN 12*24*10 PRECEDING AND CURRENT ROW)g40
20:28:38  52  ,SUM(g1)OVER(PARTITION BY trend ORDER BY ydate ROWS BETWEEN 12*24*5  PRECEDING AND CURRENT ROW)g41
20:28:38  53  -- Recent CORR()tween scores and gains:
20:28:38  54  ,NVL(sc_corr,0)sc_corr
20:28:38  55  FROM svm2416 s,score_corr c
20:28:38  56  WHERE s.prdate = c.prdate(+)
20:28:38  57  /

Table created.

Elapsed: 00:00:07.02
20:28:45 SQL> 
20:28:45 SQL> ANALYZE TABLE modsrc24 COMPUTE STATISTICS;

Table analyzed.

Elapsed: 00:00:03.95
20:28:49 SQL> 
20:28:49 SQL> -- rpt
20:28:49 SQL> 
20:28:49 SQL> SELECT
20:28:49   2  pair
20:28:49   3  ,trend
20:28:49   4  ,gatt
20:28:49   5  ,COUNT(pair)
20:28:49   6  ,AVG(g41)
20:28:49   7  FROM modsrc24
20:28:49   8  GROUP BY pair,trend,gatt
20:28:49   9  ORDER BY pair,trend,gatt
20:28:49  10  /

PAIR	     TREND GAT COUNT(PAIR)   AVG(G41)
------- ---------- --- ----------- ----------
usd_cad 	-1 nup	      8440  -.6133627
usd_cad 	-1 up	      3161 .768264041
usd_cad 	-1	       211 -.81992261
usd_cad 	 1 nup	      6255 -1.1007482
usd_cad 	 1 up	      2362 -1.2658471
usd_cad 	 1		74 -1.2373511

6 rows selected.

Elapsed: 00:00:00.05
20:28:49 SQL> 
20:28:49 SQL> 
20:28:49 SQL> SELECT pair,COUNT(pair)FROM svm2410 GROUP BY pair;

PAIR	COUNT(PAIR)
------- -----------
usd_cad       20503

Elapsed: 00:00:01.23
20:28:50 SQL> 
20:28:50 SQL> SELECT pair,COUNT(pair)FROM modsrc24 GROUP BY pair;

PAIR	COUNT(PAIR)
------- -----------
usd_cad       20503

Elapsed: 00:00:00.02
20:28:50 SQL> 
20:28:50 SQL> exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
